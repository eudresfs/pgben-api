{"numFailedTestSuites":1,"numFailedTests":1,"numPassedTestSuites":0,"numPassedTests":22,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":23,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1750157012056,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["SseRateLimiterService","Inicialização"],"duration":13,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Inicialização deve ser definido","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve ser definido"},{"ancestorTitles":["SseRateLimiterService","Inicialização"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m\"SSE_RATE_LIMIT_DEFAULT\"\u001b[39m, \u001b[32m10\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m\"SSE_RATE_LIMIT_DEFAULT\"\u001b[39m, \u001b[32m10\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.<anonymous> (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\modules\\notificacao\\services\\__tests__\\sse-rate-limiter.service.spec.ts:90:33)\n    at Promise.then.completed (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"SseRateLimiterService Inicialização deve carregar configurações corretamente","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"deve carregar configurações corretamente"},{"ancestorTitles":["SseRateLimiterService","checkRateLimit"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService checkRateLimit deve permitir requisição quando dentro do limite","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve permitir requisição quando dentro do limite"},{"ancestorTitles":["SseRateLimiterService","checkRateLimit"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService checkRateLimit deve bloquear requisição quando limite excedido","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve bloquear requisição quando limite excedido"},{"ancestorTitles":["SseRateLimiterService","checkRateLimit"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService checkRateLimit deve usar perfil admin corretamente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve usar perfil admin corretamente"},{"ancestorTitles":["SseRateLimiterService","checkRateLimit"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService checkRateLimit deve pular rate limiting para IPs na whitelist","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve pular rate limiting para IPs na whitelist"},{"ancestorTitles":["SseRateLimiterService","checkRateLimit"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService checkRateLimit deve retornar permitido em caso de erro (fail-open)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve retornar permitido em caso de erro (fail-open)"},{"ancestorTitles":["SseRateLimiterService","getMetrics"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService getMetrics deve retornar métricas corretamente","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve retornar métricas corretamente"},{"ancestorTitles":["SseRateLimiterService","getMetrics"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService getMetrics deve retornar métricas vazias em caso de erro","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve retornar métricas vazias em caso de erro"},{"ancestorTitles":["SseRateLimiterService","resetRateLimit"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService resetRateLimit deve resetar rate limit corretamente","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve resetar rate limit corretamente"},{"ancestorTitles":["SseRateLimiterService","Whitelist Management"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Whitelist Management deve adicionar IP à whitelist","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve adicionar IP à whitelist"},{"ancestorTitles":["SseRateLimiterService","Whitelist Management"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Whitelist Management deve remover IP da whitelist","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve remover IP da whitelist"},{"ancestorTitles":["SseRateLimiterService","Whitelist Management"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Whitelist Management deve retornar lista de whitelist","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve retornar lista de whitelist"},{"ancestorTitles":["SseRateLimiterService","Sliding Window Algorithm"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Sliding Window Algorithm deve usar script Lua para operação atômica","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve usar script Lua para operação atômica"},{"ancestorTitles":["SseRateLimiterService","Sliding Window Algorithm"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Sliding Window Algorithm deve calcular janela deslizante corretamente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve calcular janela deslizante corretamente"},{"ancestorTitles":["SseRateLimiterService","Perfis de Usuário"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Perfis de Usuário deve usar configuração correta para perfil default","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deve usar configuração correta para perfil default"},{"ancestorTitles":["SseRateLimiterService","Perfis de Usuário"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Perfis de Usuário deve usar configuração correta para perfil admin","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deve usar configuração correta para perfil admin"},{"ancestorTitles":["SseRateLimiterService","Perfis de Usuário"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Perfis de Usuário deve usar configuração correta para perfil system","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deve usar configuração correta para perfil system"},{"ancestorTitles":["SseRateLimiterService","Perfis de Usuário"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Perfis de Usuário deve usar configuração correta para perfil premium","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deve usar configuração correta para perfil premium"},{"ancestorTitles":["SseRateLimiterService","Error Handling"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Error Handling deve logar erros mas não falhar","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve logar erros mas não falhar"},{"ancestorTitles":["SseRateLimiterService","Error Handling"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Error Handling deve tratar erro nas métricas graciosamente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"deve tratar erro nas métricas graciosamente"},{"ancestorTitles":["SseRateLimiterService","Métricas e Monitoramento"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Métricas e Monitoramento deve registrar métricas corretamente","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"deve registrar métricas corretamente"},{"ancestorTitles":["SseRateLimiterService","Métricas e Monitoramento"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"SseRateLimiterService Métricas e Monitoramento deve registrar requisições bloqueadas","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"deve registrar requisições bloqueadas"}],"endTime":1750157013477,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mSseRateLimiterService › Inicialização › deve carregar configurações corretamente\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m\"SSE_RATE_LIMIT_DEFAULT\"\u001b[39m, \u001b[32m10\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 88 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 89 |\u001b[39m     it(\u001b[32m'deve carregar configurações corretamente'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 90 |\u001b[39m       expect(configService\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[32m'SSE_RATE_LIMIT_DEFAULT'\u001b[39m\u001b[33m,\u001b[39m \u001b[35m10\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 91 |\u001b[39m       expect(configService\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[32m'SSE_RATE_LIMIT_ADMIN'\u001b[39m\u001b[33m,\u001b[39m \u001b[35m50\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 92 |\u001b[39m       expect(configService\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[32m'SSE_RATE_LIMIT_WHITELIST'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'127.0.0.1,::1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/modules/notificacao/services/__tests__/sse-rate-limiter.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:90:33)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\modules\\notificacao\\services\\__tests__\\sse-rate-limiter.service.spec.ts","startTime":1750157012103,"status":"failed","summary":""}],"wasInterrupted":false}
