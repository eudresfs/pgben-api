fe6b84a37ef56c82922fbc1c11d2e21e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const parametro_service_1 = require("../services/parametro.service");
const parametro_repository_1 = require("../repositories/parametro.repository");
const parametro_tipo_enum_1 = require("../enums/parametro-tipo.enum");
const common_1 = require("@nestjs/common");
const cache_manager_1 = require("@nestjs/cache-manager");
// Mock do Cache Manager
const mockCacheManager = {
    get: jest.fn(),
    set: jest.fn(),
    del: jest.fn(),
};
// Mock do Repositório
const mockParametroRepository = {
    findByChave: jest.fn(),
    findAll: jest.fn(),
    findByCategoria: jest.fn(),
    save: jest.fn(),
    remove: jest.fn(),
};
describe('ParametroService', () => {
    let service;
    let repository;
    let cacheManager;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                parametro_service_1.ParametroService,
                {
                    provide: parametro_repository_1.ParametroRepository,
                    useValue: mockParametroRepository,
                },
                {
                    provide: cache_manager_1.CACHE_MANAGER,
                    useValue: mockCacheManager,
                },
            ],
        }).compile();
        service = module.get(parametro_service_1.ParametroService);
        repository = module.get(parametro_repository_1.ParametroRepository);
        cacheManager = module.get(cache_manager_1.CACHE_MANAGER);
        // Limpar todos os mocks antes de cada teste
        jest.clearAllMocks();
    });
    it('deve ser definido', () => {
        expect(service).toBeDefined();
        expect(repository).toBeDefined();
        expect(cacheManager).toBeDefined();
    });
    describe('buscarPorChave', () => {
        it('deve retornar um parâmetro pelo cache quando disponível', async () => {
            // Arrange
            const parametroMock = {
                id: '1',
                chave: 'sistema.nome',
                valor: 'PGBen',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Nome do sistema',
                categoria: 'sistema',
            };
            jest.spyOn(cacheManager, 'get').mockResolvedValue(parametroMock);
            // Act
            const resultado = await service.buscarPorChave('sistema.nome');
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:sistema.nome');
            expect(repository.findByChave).not.toHaveBeenCalled();
        });
        it('deve retornar um parâmetro do repositório quando não estiver no cache', async () => {
            // Arrange
            const parametroMock = {
                id: '1',
                chave: 'sistema.nome',
                valor: 'PGBen',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Nome do sistema',
                categoria: 'sistema',
            };
            jest.spyOn(cacheManager, 'get').mockResolvedValue(null);
            jest.spyOn(repository, 'findByChave').mockResolvedValue(parametroMock);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.buscarPorChave('sistema.nome');
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:sistema.nome');
            expect(repository.findByChave).toHaveBeenCalledWith('sistema.nome');
            expect(cacheManager.set).toHaveBeenCalledWith('parametro:sistema.nome', parametroMock, { ttl: 3600 });
        });
        it('deve lançar NotFoundException quando o parâmetro não for encontrado', async () => {
            // Arrange
            jest.spyOn(cacheManager, 'get').mockResolvedValue(null);
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.buscarPorChave('parametro.inexistente')).rejects.toThrow(common_1.NotFoundException);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:parametro.inexistente');
            expect(repository.findByChave).toHaveBeenCalledWith('parametro.inexistente');
        });
    });
    describe('buscarTodos', () => {
        it('deve retornar todos os parâmetros', async () => {
            // Arrange
            const parametrosMock = [
                {
                    id: '1',
                    chave: 'sistema.nome',
                    valor: 'PGBen',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Nome do sistema',
                    categoria: 'sistema',
                },
                {
                    id: '2',
                    chave: 'sistema.versao',
                    valor: '1.0.0',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Versão do sistema',
                    categoria: 'sistema',
                },
            ];
            jest.spyOn(repository, 'findAll').mockResolvedValue(parametrosMock);
            // Act
            const resultado = await service.buscarTodos();
            // Assert
            expect(resultado).toEqual(parametrosMock);
            expect(repository.findAll).toHaveBeenCalled();
        });
    });
    describe('buscarPorCategoria', () => {
        it('deve retornar parâmetros filtrados por categoria', async () => {
            // Arrange
            const parametrosMock = [
                {
                    id: '1',
                    chave: 'sistema.nome',
                    valor: 'PGBen',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Nome do sistema',
                    categoria: 'sistema',
                },
                {
                    id: '2',
                    chave: 'sistema.versao',
                    valor: '1.0.0',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Versão do sistema',
                    categoria: 'sistema',
                },
            ];
            jest
                .spyOn(repository, 'findByCategoria')
                .mockResolvedValue(parametrosMock);
            // Act
            const resultado = await service.buscarPorCategoria('sistema');
            // Assert
            expect(resultado).toEqual(parametrosMock);
            expect(repository.findByCategoria).toHaveBeenCalledWith('sistema');
        });
    });
    describe('criar', () => {
        it('deve criar um novo parâmetro com sucesso', async () => {
            // Arrange
            const dto = {
                chave: 'novo.parametro',
                valor: 'Valor do novo parâmetro',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição do novo parâmetro',
                categoria: 'novo',
            };
            const parametroMock = {
                id: '3',
                ...dto,
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            jest.spyOn(repository, 'save').mockResolvedValue(parametroMock);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.criar(dto);
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(repository.findByChave).toHaveBeenCalledWith('novo.parametro');
            expect(repository.save).toHaveBeenCalledWith(expect.objectContaining(dto));
            expect(cacheManager.set).toHaveBeenCalledWith('parametro:novo.parametro', parametroMock, { ttl: 3600 });
        });
        it('deve lançar BadRequestException ao tentar criar um parâmetro com chave existente', async () => {
            // Arrange
            const dto = {
                chave: 'parametro.existente',
                valor: 'Valor do parâmetro',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição do parâmetro',
                categoria: 'existente',
            };
            const parametroExistente = {
                id: '4',
                ...dto,
            };
            jest
                .spyOn(repository, 'findByChave')
                .mockResolvedValue(parametroExistente);
            // Act & Assert
            await expect(service.criar(dto)).rejects.toThrow(common_1.BadRequestException);
            expect(repository.findByChave).toHaveBeenCalledWith('parametro.existente');
            expect(repository.save).not.toHaveBeenCalled();
        });
    });
    describe('atualizar', () => {
        it('deve atualizar um parâmetro existente com sucesso', async () => {
            // Arrange
            const chave = 'parametro.existente';
            const dto = {
                valor: 'Novo valor',
                descricao: 'Nova descrição',
                categoria: 'categoria-atualizada',
            };
            const parametroExistente = {
                id: '5',
                chave,
                valor: 'Valor antigo',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição antiga',
                categoria: 'categoria-antiga',
            };
            const parametroAtualizado = {
                ...parametroExistente,
                ...dto,
            };
            jest
                .spyOn(repository, 'findByChave')
                .mockResolvedValue(parametroExistente);
            jest.spyOn(repository, 'save').mockResolvedValue(parametroAtualizado);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.atualizar(chave, dto);
            // Assert
            expect(resultado).toEqual(parametroAtualizado);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.save).toHaveBeenCalledWith(expect.objectContaining({
                ...parametroExistente,
                ...dto,
            }));
            expect(cacheManager.set).toHaveBeenCalledWith(`parametro:${chave}`, parametroAtualizado, { ttl: 3600 });
        });
        it('deve lançar NotFoundException ao tentar atualizar um parâmetro inexistente', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            const dto = {
                valor: 'Novo valor',
                descricao: 'Nova descrição',
                categoria: 'nova-categoria',
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.atualizar(chave, dto)).rejects.toThrow(common_1.NotFoundException);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.save).not.toHaveBeenCalled();
        });
    });
    describe('remover', () => {
        it('deve remover um parâmetro existente com sucesso', async () => {
            // Arrange
            const chave = 'parametro.existente';
            const parametroExistente = {
                id: '6',
                chave,
                valor: 'Valor',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição',
                categoria: 'categoria',
            };
            jest
                .spyOn(repository, 'findByChave')
                .mockResolvedValue(parametroExistente);
            jest.spyOn(repository, 'remove').mockResolvedValue(undefined);
            jest.spyOn(cacheManager, 'del').mockResolvedValue(undefined);
            // Act
            await service.remover(chave);
            // Assert
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.remove).toHaveBeenCalledWith(parametroExistente);
            expect(cacheManager.del).toHaveBeenCalledWith(`parametro:${chave}`);
        });
        it('deve lançar NotFoundException ao tentar remover um parâmetro inexistente', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.remover(chave)).rejects.toThrow(common_1.NotFoundException);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.remove).not.toHaveBeenCalled();
            expect(cacheManager.del).not.toHaveBeenCalled();
        });
    });
    describe('obterValorTipado', () => {
        it('deve retornar o valor tipado para um parâmetro existente', async () => {
            // Arrange
            const chave = 'numero.parametro';
            const parametroMock = {
                id: '7',
                chave,
                valor: '123',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.NUMBER,
                descricao: 'Parâmetro numérico',
                categoria: 'numeros',
            };
            jest.spyOn(service, 'buscarPorChave').mockResolvedValue(parametroMock);
            // Act
            const resultado = await service.obterValorTipado(chave);
            // Assert
            expect(resultado).toBe(123);
            expect(service.buscarPorChave).toHaveBeenCalledWith(chave);
        });
        it('deve retornar o valor padrão quando o parâmetro não existir', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            const valorPadrao = 'valor padrão';
            jest.spyOn(service, 'buscarPorChave').mockImplementation(() => {
                throw new common_1.NotFoundException(`Parâmetro com chave '${chave}' não encontrado`);
            });
            // Act
            const resultado = await service.obterValorTipado(chave, valorPadrao);
            // Assert
            expect(resultado).toBe(valorPadrao);
            expect(service.buscarPorChave).toHaveBeenCalledWith(chave);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNvbmZpZ3VyYWNhb1xcdGVzdHNcXHBhcmFtZXRyby5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQscUVBQWlFO0FBQ2pFLCtFQUEyRTtBQUczRSxzRUFBaUU7QUFDakUsMkNBQXdFO0FBQ3hFLHlEQUFzRDtBQUd0RCx3QkFBd0I7QUFDeEIsTUFBTSxnQkFBZ0IsR0FBRztJQUN2QixHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNkLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2QsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDZixDQUFDO0FBRUYsc0JBQXNCO0FBQ3RCLE1BQU0sdUJBQXVCLEdBQUc7SUFDOUIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdEIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDbEIsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDMUIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNsQixDQUFDO0FBRUYsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLE9BQXlCLENBQUM7SUFDOUIsSUFBSSxVQUErQixDQUFDO0lBQ3BDLElBQUksWUFBbUIsQ0FBQztJQUV4QixVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsTUFBTSxNQUFNLEdBQWtCLE1BQU0sY0FBSSxDQUFDLG1CQUFtQixDQUFDO1lBQzNELFNBQVMsRUFBRTtnQkFDVCxvQ0FBZ0I7Z0JBQ2hCO29CQUNFLE9BQU8sRUFBRSwwQ0FBbUI7b0JBQzVCLFFBQVEsRUFBRSx1QkFBdUI7aUJBQ2xDO2dCQUNEO29CQUNFLE9BQU8sRUFB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Y2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxjb25maWd1cmFjYW9cXHRlc3RzXFxwYXJhbWV0cm8uc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgUGFyYW1ldHJvU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3BhcmFtZXRyby5zZXJ2aWNlJztcbmltcG9ydCB7IFBhcmFtZXRyb1JlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvcGFyYW1ldHJvLnJlcG9zaXRvcnknO1xuaW1wb3J0IHsgUGFyYW1ldHJvQ3JlYXRlRHRvIH0gZnJvbSAnLi4vZHRvcy9wYXJhbWV0cm8vcGFyYW1ldHJvLWNyZWF0ZS5kdG8nO1xuaW1wb3J0IHsgUGFyYW1ldHJvVXBkYXRlRHRvIH0gZnJvbSAnLi4vZHRvcy9wYXJhbWV0cm8vcGFyYW1ldHJvLXVwZGF0ZS5kdG8nO1xuaW1wb3J0IHsgUGFyYW1ldHJvVGlwb0VudW0gfSBmcm9tICcuLi9lbnVtcy9wYXJhbWV0cm8tdGlwby5lbnVtJztcbmltcG9ydCB7IE5vdEZvdW5kRXhjZXB0aW9uLCBCYWRSZXF1ZXN0RXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQ0FDSEVfTUFOQUdFUiB9IGZyb20gJ0BuZXN0anMvY2FjaGUtbWFuYWdlcic7XG5pbXBvcnQgeyBDYWNoZSB9IGZyb20gJ2NhY2hlLW1hbmFnZXInO1xuXG4vLyBNb2NrIGRvIENhY2hlIE1hbmFnZXJcbmNvbnN0IG1vY2tDYWNoZU1hbmFnZXIgPSB7XG4gIGdldDogamVzdC5mbigpLFxuICBzZXQ6IGplc3QuZm4oKSxcbiAgZGVsOiBqZXN0LmZuKCksXG59O1xuXG4vLyBNb2NrIGRvIFJlcG9zaXTDs3Jpb1xuY29uc3QgbW9ja1BhcmFtZXRyb1JlcG9zaXRvcnkgPSB7XG4gIGZpbmRCeUNoYXZlOiBqZXN0LmZuKCksXG4gIGZpbmRBbGw6IGplc3QuZm4oKSxcbiAgZmluZEJ5Q2F0ZWdvcmlhOiBqZXN0LmZuKCksXG4gIHNhdmU6IGplc3QuZm4oKSxcbiAgcmVtb3ZlOiBqZXN0LmZuKCksXG59O1xuXG5kZXNjcmliZSgnUGFyYW1ldHJvU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IFBhcmFtZXRyb1NlcnZpY2U7XG4gIGxldCByZXBvc2l0b3J5OiBQYXJhbWV0cm9SZXBvc2l0b3J5O1xuICBsZXQgY2FjaGVNYW5hZ2VyOiBDYWNoZTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIFBhcmFtZXRyb1NlcnZpY2UsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBQYXJhbWV0cm9SZXBvc2l0b3J5LFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrUGFyYW1ldHJvUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IENBQ0hFX01BTkFHRVIsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tDYWNoZU1hbmFnZXIsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHNlcnZpY2UgPSBtb2R1bGUuZ2V0PFBhcmFtZXRyb1NlcnZpY2U+KFBhcmFtZXRyb1NlcnZpY2UpO1xuICAgIHJlcG9zaXRvcnkgPSBtb2R1bGUuZ2V0PFBhcmFtZXRyb1JlcG9zaXRvcnk+KFBhcmFtZXRyb1JlcG9zaXRvcnkpO1xuICAgIGNhY2hlTWFuYWdlciA9IG1vZHVsZS5nZXQ8Q2FjaGU+KENBQ0hFX01BTkFHRVIpO1xuXG4gICAgLy8gTGltcGFyIHRvZG9zIG9zIG1vY2tzIGFudGVzIGRlIGNhZGEgdGVzdGVcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgaXQoJ2RldmUgc2VyIGRlZmluaWRvJywgKCkgPT4ge1xuICAgIGV4cGVjdChzZXJ2aWNlKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChyZXBvc2l0b3J5KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChjYWNoZU1hbmFnZXIpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdidXNjYXJQb3JDaGF2ZScsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciB1bSBwYXLDom1ldHJvIHBlbG8gY2FjaGUgcXVhbmRvIGRpc3BvbsOtdmVsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcGFyYW1ldHJvTW9jayA9IHtcbiAgICAgICAgaWQ6ICcxJyxcbiAgICAgICAgY2hhdmU6ICdzaXN0ZW1hLm5vbWUnLFxuICAgICAgICB2YWxvcjogJ1BHQmVuJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdOb21lIGRvIHNpc3RlbWEnLFxuICAgICAgICBjYXRlZ29yaWE6ICdzaXN0ZW1hJyxcbiAgICAgIH07XG5cbiAgICAgIGplc3Quc3B5T24oY2FjaGVNYW5hZ2VyLCAnZ2V0JykubW9ja1Jlc29sdmVkVmFsdWUocGFyYW1ldHJvTW9jayk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5idXNjYXJQb3JDaGF2ZSgnc2lzdGVtYS5ub21lJyk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbChwYXJhbWV0cm9Nb2NrKTtcbiAgICAgIGV4cGVjdChjYWNoZU1hbmFnZXIuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncGFyYW1ldHJvOnNpc3RlbWEubm9tZScpO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2hhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciB1bSBwYXLDom1ldHJvIGRvIHJlcG9zaXTDs3JpbyBxdWFuZG8gbsOjbyBlc3RpdmVyIG5vIGNhY2hlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcGFyYW1ldHJvTW9jayA9IHtcbiAgICAgICAgaWQ6ICcxJyxcbiAgICAgICAgY2hhdmU6ICdzaXN0ZW1hLm5vbWUnLFxuICAgICAgICB2YWxvcjogJ1BHQmVuJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdOb21lIGRvIHNpc3RlbWEnLFxuICAgICAgICBjYXRlZ29yaWE6ICdzaXN0ZW1hJyxcbiAgICAgIH07XG5cbiAgICAgIGplc3Quc3B5T24oY2FjaGVNYW5hZ2VyLCAnZ2V0JykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb01vY2spO1xuICAgICAgamVzdC5zcHlPbihjYWNoZU1hbmFnZXIsICdzZXQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUoJ3Npc3RlbWEubm9tZScpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvTW9jayk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3BhcmFtZXRybzpzaXN0ZW1hLm5vbWUnKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc2lzdGVtYS5ub21lJyk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLnNldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdwYXJhbWV0cm86c2lzdGVtYS5ub21lJyxcbiAgICAgICAgcGFyYW1ldHJvTW9jayxcbiAgICAgICAgeyB0dGw6IDM2MDAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIHF1YW5kbyBvIHBhcsOibWV0cm8gbsOjbyBmb3IgZW5jb250cmFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24oY2FjaGVNYW5hZ2VyLCAnZ2V0JykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5idXNjYXJQb3JDaGF2ZSgncGFyYW1ldHJvLmluZXhpc3RlbnRlJyksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdChjYWNoZU1hbmFnZXIuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3BhcmFtZXRybzpwYXJhbWV0cm8uaW5leGlzdGVudGUnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3BhcmFtZXRyby5pbmV4aXN0ZW50ZScsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYnVzY2FyVG9kb3MnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdG9kb3Mgb3MgcGFyw6JtZXRyb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBwYXJhbWV0cm9zTW9jayA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMScsXG4gICAgICAgICAgY2hhdmU6ICdzaXN0ZW1hLm5vbWUnLFxuICAgICAgICAgIHZhbG9yOiAnUEdCZW4nLFxuICAgICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgICBkZXNjcmljYW86ICdOb21lIGRvIHNpc3RlbWEnLFxuICAgICAgICAgIGNhdGVnb3JpYTogJ3Npc3RlbWEnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICcyJyxcbiAgICAgICAgICBjaGF2ZTogJ3Npc3RlbWEudmVyc2FvJyxcbiAgICAgICAgICB2YWxvcjogJzEuMC4wJyxcbiAgICAgICAgICB0aXBvOiBQYXJhbWV0cm9UaXBvRW51bS5TVFJJTkcsXG4gICAgICAgICAgZGVzY3JpY2FvOiAnVmVyc8OjbyBkbyBzaXN0ZW1hJyxcbiAgICAgICAgICBjYXRlZ29yaWE6ICdzaXN0ZW1hJyxcbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIGplc3Quc3B5T24ocmVwb3NpdG9yeSwgJ2ZpbmRBbGwnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9zTW9jayk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5idXNjYXJUb2RvcygpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvc01vY2spO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEFsbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYnVzY2FyUG9yQ2F0ZWdvcmlhJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIHBhcsOibWV0cm9zIGZpbHRyYWRvcyBwb3IgY2F0ZWdvcmlhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcGFyYW1ldHJvc01vY2sgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJzEnLFxuICAgICAgICAgIGNoYXZlOiAnc2lzdGVtYS5ub21lJyxcbiAgICAgICAgICB2YWxvcjogJ1BHQmVuJyxcbiAgICAgICAgICB0aXBvOiBQYXJhbWV0cm9UaXBvRW51bS5TVFJJTkcsXG4gICAgICAgICAgZGVzY3JpY2FvOiAnTm9tZSBkbyBzaXN0ZW1hJyxcbiAgICAgICAgICBjYXRlZ29yaWE6ICdzaXN0ZW1hJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMicsXG4gICAgICAgICAgY2hhdmU6ICdzaXN0ZW1hLnZlcnNhbycsXG4gICAgICAgICAgdmFsb3I6ICcxLjAuMCcsXG4gICAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICAgIGRlc2NyaWNhbzogJ1ZlcnPDo28gZG8gc2lzdGVtYScsXG4gICAgICAgICAgY2F0ZWdvcmlhOiAnc2lzdGVtYScsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBqZXN0XG4gICAgICAgIC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2F0ZWdvcmlhJylcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb3NNb2NrKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLmJ1c2NhclBvckNhdGVnb3JpYSgnc2lzdGVtYScpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvc01vY2spO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2F0ZWdvcmlhKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc2lzdGVtYScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JpYXInLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgdW0gbm92byBwYXLDom1ldHJvIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZHRvOiBQYXJhbWV0cm9DcmVhdGVEdG8gPSB7XG4gICAgICAgIGNoYXZlOiAnbm92by5wYXJhbWV0cm8nLFxuICAgICAgICB2YWxvcjogJ1ZhbG9yIGRvIG5vdm8gcGFyw6JtZXRybycsXG4gICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgZGVzY3JpY2FvOiAnRGVzY3Jpw6fDo28gZG8gbm92byBwYXLDom1ldHJvJyxcbiAgICAgICAgY2F0ZWdvcmlhOiAnbm92bycsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBwYXJhbWV0cm9Nb2NrID0ge1xuICAgICAgICBpZDogJzMnLFxuICAgICAgICAuLi5kdG8sXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnc2F2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb01vY2spO1xuICAgICAgamVzdC5zcHlPbihjYWNoZU1hbmFnZXIsICdzZXQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2UuY3JpYXIoZHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKHBhcmFtZXRyb01vY2spO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdub3ZvLnBhcmFtZXRybycpO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuc2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKGR0byksXG4gICAgICApO1xuICAgICAgZXhwZWN0KGNhY2hlTWFuYWdlci5zZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAncGFyYW1ldHJvOm5vdm8ucGFyYW1ldHJvJyxcbiAgICAgICAgcGFyYW1ldHJvTW9jayxcbiAgICAgICAgeyB0dGw6IDM2MDAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIEJhZFJlcXVlc3RFeGNlcHRpb24gYW8gdGVudGFyIGNyaWFyIHVtIHBhcsOibWV0cm8gY29tIGNoYXZlIGV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGR0bzogUGFyYW1ldHJvQ3JlYXRlRHRvID0ge1xuICAgICAgICBjaGF2ZTogJ3BhcmFtZXRyby5leGlzdGVudGUnLFxuICAgICAgICB2YWxvcjogJ1ZhbG9yIGRvIHBhcsOibWV0cm8nLFxuICAgICAgICB0aXBvOiBQYXJhbWV0cm9UaXBvRW51bS5TVFJJTkcsXG4gICAgICAgIGRlc2NyaWNhbzogJ0Rlc2NyacOnw6NvIGRvIHBhcsOibWV0cm8nLFxuICAgICAgICBjYXRlZ29yaWE6ICdleGlzdGVudGUnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcGFyYW1ldHJvRXhpc3RlbnRlID0ge1xuICAgICAgICBpZDogJzQnLFxuICAgICAgICAuLi5kdG8sXG4gICAgICB9O1xuXG4gICAgICBqZXN0XG4gICAgICAgIC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2hhdmUnKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUocGFyYW1ldHJvRXhpc3RlbnRlKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5jcmlhcihkdG8pKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3BhcmFtZXRyby5leGlzdGVudGUnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LnNhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhdHVhbGl6YXInLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYXR1YWxpemFyIHVtIHBhcsOibWV0cm8gZXhpc3RlbnRlIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY2hhdmUgPSAncGFyYW1ldHJvLmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBkdG86IFBhcmFtZXRyb1VwZGF0ZUR0byA9IHtcbiAgICAgICAgdmFsb3I6ICdOb3ZvIHZhbG9yJyxcbiAgICAgICAgZGVzY3JpY2FvOiAnTm92YSBkZXNjcmnDp8OjbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ2NhdGVnb3JpYS1hdHVhbGl6YWRhJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHBhcmFtZXRyb0V4aXN0ZW50ZSA9IHtcbiAgICAgICAgaWQ6ICc1JyxcbiAgICAgICAgY2hhdmUsXG4gICAgICAgIHZhbG9yOiAnVmFsb3IgYW50aWdvJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdEZXNjcmnDp8OjbyBhbnRpZ2EnLFxuICAgICAgICBjYXRlZ29yaWE6ICdjYXRlZ29yaWEtYW50aWdhJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHBhcmFtZXRyb0F0dWFsaXphZG8gPSB7XG4gICAgICAgIC4uLnBhcmFtZXRyb0V4aXN0ZW50ZSxcbiAgICAgICAgLi4uZHRvLFxuICAgICAgfTtcblxuICAgICAgamVzdFxuICAgICAgICAuc3B5T24ocmVwb3NpdG9yeSwgJ2ZpbmRCeUNoYXZlJylcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb0V4aXN0ZW50ZSk7XG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdzYXZlJykubW9ja1Jlc29sdmVkVmFsdWUocGFyYW1ldHJvQXR1YWxpemFkbyk7XG4gICAgICBqZXN0LnNweU9uKGNhY2hlTWFuYWdlciwgJ3NldCcpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5hdHVhbGl6YXIoY2hhdmUsIGR0byk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbChwYXJhbWV0cm9BdHVhbGl6YWRvKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaGF2ZSk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIC4uLnBhcmFtZXRyb0V4aXN0ZW50ZSxcbiAgICAgICAgICAuLi5kdG8sXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChjYWNoZU1hbmFnZXIuc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYHBhcmFtZXRybzoke2NoYXZlfWAsXG4gICAgICAgIHBhcmFtZXRyb0F0dWFsaXphZG8sXG4gICAgICAgIHsgdHRsOiAzNjAwIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBOb3RGb3VuZEV4Y2VwdGlvbiBhbyB0ZW50YXIgYXR1YWxpemFyIHVtIHBhcsOibWV0cm8gaW5leGlzdGVudGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBjaGF2ZSA9ICdwYXJhbWV0cm8uaW5leGlzdGVudGUnO1xuICAgICAgY29uc3QgZHRvOiBQYXJhbWV0cm9VcGRhdGVEdG8gPSB7XG4gICAgICAgIHZhbG9yOiAnTm92byB2YWxvcicsXG4gICAgICAgIGRlc2NyaWNhbzogJ05vdmEgZGVzY3Jpw6fDo28nLFxuICAgICAgICBjYXRlZ29yaWE6ICdub3ZhLWNhdGVnb3JpYScsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmF0dWFsaXphcihjaGF2ZSwgZHRvKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBOb3RGb3VuZEV4Y2VwdGlvbixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaGF2ZSk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5zYXZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlcicsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZW1vdmVyIHVtIHBhcsOibWV0cm8gZXhpc3RlbnRlIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY2hhdmUgPSAncGFyYW1ldHJvLmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBwYXJhbWV0cm9FeGlzdGVudGUgPSB7XG4gICAgICAgIGlkOiAnNicsXG4gICAgICAgIGNoYXZlLFxuICAgICAgICB2YWxvcjogJ1ZhbG9yJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdEZXNjcmnDp8OjbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ2NhdGVnb3JpYScsXG4gICAgICB9O1xuXG4gICAgICBqZXN0XG4gICAgICAgIC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2hhdmUnKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUocGFyYW1ldHJvRXhpc3RlbnRlKTtcbiAgICAgIGplc3Quc3B5T24ocmVwb3NpdG9yeSwgJ3JlbW92ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgICBqZXN0LnNweU9uKGNhY2hlTWFuYWdlciwgJ2RlbCcpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgc2VydmljZS5yZW1vdmVyKGNoYXZlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5maW5kQnlDaGF2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoY2hhdmUpO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkucmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXJhbWV0cm9FeGlzdGVudGUpO1xuICAgICAgZXhwZWN0KGNhY2hlTWFuYWdlci5kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGBwYXJhbWV0cm86JHtjaGF2ZX1gKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgTm90Rm91bmRFeGNlcHRpb24gYW8gdGVudGFyIHJlbW92ZXIgdW0gcGFyw6JtZXRybyBpbmV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ3BhcmFtZXRyby5pbmV4aXN0ZW50ZSc7XG5cbiAgICAgIGplc3Quc3B5T24ocmVwb3NpdG9yeSwgJ2ZpbmRCeUNoYXZlJykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVtb3ZlcihjaGF2ZSkpLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaGF2ZSk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5yZW1vdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLmRlbCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29idGVyVmFsb3JUaXBhZG8nLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgbyB2YWxvciB0aXBhZG8gcGFyYSB1bSBwYXLDom1ldHJvIGV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ251bWVyby5wYXJhbWV0cm8nO1xuICAgICAgY29uc3QgcGFyYW1ldHJvTW9jayA9IHtcbiAgICAgICAgaWQ6ICc3JyxcbiAgICAgICAgY2hhdmUsXG4gICAgICAgIHZhbG9yOiAnMTIzJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uTlVNQkVSLFxuICAgICAgICBkZXNjcmljYW86ICdQYXLDom1ldHJvIG51bcOpcmljbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ251bWVyb3MnLFxuICAgICAgfTtcblxuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnYnVzY2FyUG9yQ2hhdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9Nb2NrKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyVmFsb3JUaXBhZG88bnVtYmVyPihjaGF2ZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9CZSgxMjMpO1xuICAgICAgZXhwZWN0KHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNoYXZlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIG8gdmFsb3IgcGFkcsOjbyBxdWFuZG8gbyBwYXLDom1ldHJvIG7Do28gZXhpc3RpcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ3BhcmFtZXRyby5pbmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCB2YWxvclBhZHJhbyA9ICd2YWxvciBwYWRyw6NvJztcblxuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnYnVzY2FyUG9yQ2hhdmUnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb24oXG4gICAgICAgICAgYFBhcsOibWV0cm8gY29tIGNoYXZlICcke2NoYXZlfScgbsOjbyBlbmNvbnRyYWRvYCxcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2Uub2J0ZXJWYWxvclRpcGFkbzxzdHJpbmc+KFxuICAgICAgICBjaGF2ZSxcbiAgICAgICAgdmFsb3JQYWRyYW8sXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvQmUodmFsb3JQYWRyYW8pO1xuICAgICAgZXhwZWN0KHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNoYXZlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==