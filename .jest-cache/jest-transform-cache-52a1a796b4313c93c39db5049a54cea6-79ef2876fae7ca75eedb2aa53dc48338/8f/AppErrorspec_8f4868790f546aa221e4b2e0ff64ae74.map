{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\exceptions\\error-catalog\\AppError.spec.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\exceptions\\error-catalog\\AppError.spec.ts"],"sourcesContent":["/**\n * Testes para a classe AppError\n * \n * Valida a funcionalidade da classe principal\n * de erro do sistema de catálogo.\n */\n\nimport { AppError, ErrorContext } from './AppError';\nimport { ERROR_CATALOG, ErrorSeverity, ErrorCategory } from './catalog';\n\ndescribe('AppError', () => {\n  describe('Constructor', () => {\n    it('should create AppError with valid error code', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error).toBeInstanceOf(AppError);\n      expect(error.errorCode).toBe('VAL_CPF_001');\n      expect(error.definition).toBe(ERROR_CATALOG['VAL_CPF_001']);\n      expect(error.getStatus()).toBe(400);\n    });\n\n    it('should create AppError with context', () => {\n      const context: ErrorContext = {\n        cpf: '12345678901',\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n        },\n      };\n      \n      const error = new AppError('VAL_CPF_001', context);\n      \n      expect(error.context).toEqual(context);\n    });\n\n    it('should create AppError with custom message', () => {\n      const customMessage = 'Mensagem personalizada';\n      const error = new AppError('VAL_CPF_001', {}, customMessage);\n      \n      expect(error.message).toBe(customMessage);\n    });\n\n    it('should throw error for invalid error code', () => {\n      expect(() => {\n        new AppError('INVALID_CODE');\n      }).toThrow('Código de erro INVALID_CODE não encontrado no catálogo');\n    });\n  });\n\n  describe('Message Interpolation', () => {\n    it('should interpolate message with context values', () => {\n      const context = { cpf: '12345678901' };\n      const error = new AppError('VAL_CPF_002', context);\n      \n      expect(error.message).toBe('Já existe um cidadão cadastrado com o CPF 12345678901');\n    });\n\n    it('should handle missing context values gracefully', () => {\n      const error = new AppError('VAL_CPF_002', {});\n      \n      expect(error.message).toBe('Já existe um cidadão cadastrado com o CPF {cpf}');\n    });\n\n    it('should interpolate multiple placeholders', () => {\n      const context = { minAge: 18, maxAge: 65 };\n      const error = new AppError('VAL_AGE_001', context);\n      \n      expect(error.message).toBe('Idade deve estar entre 18 e 65 anos');\n    });\n  });\n\n  describe('Localized Messages', () => {\n    it('should return Portuguese message by default', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.getLocalizedMessage()).toBe('CPF informado é inválido');\n    });\n\n    it('should return Portuguese message for pt-BR locale', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.getLocalizedMessage('pt-BR')).toBe('CPF informado é inválido');\n    });\n\n    it('should fallback to default message for unsupported locale', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.getLocalizedMessage('en-US')).toBe('CPF informado é inválido');\n    });\n  });\n\n  describe('JSON Representation', () => {\n    it('should return complete JSON representation', () => {\n      const context: ErrorContext = {\n        cpf: '12345678901',\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n        },\n      };\n      \n      const error = new AppError('VAL_CPF_002', context);\n      const json = error.toJSON();\n      \n      expect(json).toHaveProperty('errorCode', 'VAL_CPF_002');\n      expect(json).toHaveProperty('message');\n      expect(json).toHaveProperty('httpStatus', 409);\n      expect(json).toHaveProperty('category', ErrorCategory.VALIDATION);\n      expect(json).toHaveProperty('severity', ErrorSeverity.MEDIUM);\n      expect(json).toHaveProperty('context', context);\n      expect(json).toHaveProperty('timestamp');\n    });\n\n    it('should include legal reference when available', () => {\n      const error = new AppError('BEN_NAT_001');\n      const json = error.toJSON();\n      \n      if (ERROR_CATALOG['BEN_NAT_001'].legalReference) {\n        expect(json).toHaveProperty('legalReference');\n      }\n    });\n  });\n\n  describe('Log Data', () => {\n    it('should return sanitized log data', () => {\n      const context: ErrorContext = {\n        cpf: '12345678901',\n        password: 'secret123',\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n        },\n      };\n      \n      const error = new AppError('VAL_CPF_002', context);\n      const logData = error.getLogData();\n      \n      expect(logData.context.cpf).toBe('***.***.***-**');\n      expect(logData.context.password).toBe('[REDACTED]');\n      expect(logData.context.operationalContext).toEqual(context.operationalContext);\n    });\n\n    it('should include stack trace in log data', () => {\n      const error = new AppError('VAL_CPF_001');\n      const logData = error.getLogData();\n      \n      expect(logData).toHaveProperty('stack');\n      expect(logData.stack).toBeTruthy();\n    });\n  });\n\n  describe('API Data', () => {\n    it('should return API-safe data without sensitive information', () => {\n      const context: ErrorContext = {\n        cpf: '12345678901',\n        password: 'secret123',\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n        },\n      };\n      \n      const error = new AppError('VAL_CPF_002', context);\n      const apiData = error.getApiData();\n      \n      expect(apiData.context).not.toHaveProperty('password');\n      expect(apiData).not.toHaveProperty('stack');\n      expect(apiData).toHaveProperty('errorCode');\n      expect(apiData).toHaveProperty('message');\n      expect(apiData).toHaveProperty('httpStatus');\n    });\n  });\n\n  describe('Severity and Category Checks', () => {\n    it('should correctly identify critical errors', () => {\n      const error = new AppError('INT_DB_001');\n      \n      expect(error.isCritical()).toBe(true);\n      expect(error.isHigh()).toBe(false);\n    });\n\n    it('should correctly identify high severity errors', () => {\n      const error = new AppError('BEN_NAT_001');\n      \n      expect(error.isHigh()).toBe(true);\n      expect(error.isCritical()).toBe(false);\n    });\n\n    it('should correctly identify validation category', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.isValidationError()).toBe(true);\n      expect(error.isBenefitError()).toBe(false);\n    });\n\n    it('should correctly identify benefit category', () => {\n      const error = new AppError('BEN_NAT_001');\n      \n      expect(error.isBenefitError()).toBe(true);\n      expect(error.isValidationError()).toBe(false);\n    });\n  });\n\n  describe('Static Factory Methods', () => {\n    it('should create AppError from PostgreSQL error code', () => {\n      const pgError = {\n        code: '23505',\n        message: 'duplicate key value violates unique constraint',\n        constraint: 'uk_cidadao_cpf',\n        table: 'cidadao',\n      };\n      \n      const context: ErrorContext = {\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n        },\n      };\n      \n      const error = AppError.fromPostgresError('23505', pgError, context);\n      \n      expect(error).toBeInstanceOf(AppError);\n      expect(error.errorCode).toBe('SYS_UNIQUE_001');\n    });\n\n    it('should throw error for unmapped PostgreSQL code', () => {\n      const pgError = {\n        code: '99999',\n        message: 'unknown error',\n      };\n      \n      expect(() => {\n        AppError.fromPostgresError('99999', pgError, {});\n      }).toThrow('Código PostgreSQL 99999 não mapeado no catálogo');\n    });\n  });\n\n  describe('Error Inheritance', () => {\n    it('should be instance of Error', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error).toBeInstanceOf(Error);\n    });\n\n    it('should have correct name property', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.name).toBe('AppError');\n    });\n\n    it('should have stack trace', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.stack).toBeTruthy();\n    });\n  });\n\n  describe('Context Validation', () => {\n    it('should handle empty context', () => {\n      const error = new AppError('VAL_CPF_001', {});\n      \n      expect(error.context).toEqual({});\n    });\n\n    it('should handle undefined context', () => {\n      const error = new AppError('VAL_CPF_001');\n      \n      expect(error.context).toEqual({});\n    });\n\n    it('should preserve complex context objects', () => {\n      const context: ErrorContext = {\n        operationalContext: {\n          module: 'cidadao',\n          operation: 'create',\n          entityType: 'Cidadao',\n          entityId: '123',\n        },\n        metadata: {\n          constraint: 'uk_cidadao_cpf',\n          table: 'cidadao',\n          userAgent: 'Mozilla/5.0...',\n        },\n      };\n      \n      const error = new AppError('VAL_CPF_001', context);\n      \n      expect(error.context).toEqual(context);\n    });\n  });\n});"],"version":3}