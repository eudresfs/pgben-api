{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\common\\decorators\\get-client-info.decorator.ts","mappings":";;;AAAA,2CAAwE;AAI3D,QAAA,aAAa,GAAG,IAAA,6BAAoB,EAC/C,CAAC,IAAa,EAAE,GAAqB,EAAc,EAAE;IACnD,MAAM,OAAO,GAAG,GAAG,CAAC,YAAY,EAAE,CAAC,UAAU,EAAW,CAAC;IAEzD,wCAAwC;IACxC,MAAM,WAAW,GAAG,CAAC,GAAY,EAAU,EAAE;QAC3C,OAAO,CACJ,GAAG,CAAC,OAAO,CAAC,iBAAiB,CAAY,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE;YAChE,GAAG,CAAC,OAAO,CAAC,WAAW,CAAY;YACpC,GAAG,CAAC,UAAU,EAAE,aAAa;YAC7B,GAAG,CAAC,MAAM,EAAE,aAAa;YACzB,WAAW,CACZ,CAAC;IACJ,CAAC,CAAC;IAEF,OAAO;QACL,EAAE,EAAE,WAAW,CAAC,OAAO,CAAC;QACxB,SAAS,EAAE,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,SAAS;QACrD,MAAM,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM;QAC9B,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO;KACjC,CAAC;AACJ,CAAC,CACF,CAAC","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\common\\decorators\\get-client-info.decorator.ts"],"sourcesContent":["import { createParamDecorator, ExecutionContext } from '@nestjs/common';\nimport { Request } from 'express';\nimport { ClientInfo } from '../interfaces/client-info.interface';\n\nexport const GetClientInfo = createParamDecorator(\n  (data: unknown, ctx: ExecutionContext): ClientInfo => {\n    const request = ctx.switchToHttp().getRequest<Request>();\n\n    // Extrai o IP real considerando proxies\n    const getClientIp = (req: Request): string => {\n      return (\n        (req.headers['x-forwarded-for'] as string)?.split(',')[0]?.trim() ||\n        (req.headers['x-real-ip'] as string) ||\n        req.connection?.remoteAddress ||\n        req.socket?.remoteAddress ||\n        '127.0.0.1'\n      );\n    };\n\n    return {\n      ip: getClientIp(request),\n      userAgent: request.headers['user-agent'] || 'Unknown',\n      origin: request.headers.origin,\n      referer: request.headers.referer,\n    };\n  },\n);\n"],"version":3}