df26a2da247f9b26d371259c6c0c396b
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfirmacaoController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const confirmacao_service_1 = require("../services/confirmacao.service");
const confirmacao_recebimento_dto_1 = require("../dtos/confirmacao-recebimento.dto");
const confirmacao_response_dto_1 = require("../dtos/confirmacao-response.dto");
const common_2 = require("@nestjs/common");
/**
 * Controller para gerenciamento de confirmações de recebimento
 *
 * Implementa endpoints para registrar e consultar as confirmações
 * de recebimento de pagamentos pelos beneficiários.
 *
 * @author Equipe PGBen
 */
let ConfirmacaoController = class ConfirmacaoController {
    confirmacaoService;
    constructor(confirmacaoService) {
        this.confirmacaoService = confirmacaoService;
    }
    /**
     * Lista confirmações para um determinado pagamento
     */
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    async findAll(pagamentoId) {
        const confirmacoes = await this.confirmacaoService.findByPagamento(pagamentoId);
        // Mapear para DTO de resposta
        return confirmacoes.map(confirmacao => ({
            id: confirmacao.id,
            pagamentoId: confirmacao.pagamento_id,
            dataConfirmacao: confirmacao.data_confirmacao,
            metodoConfirmacao: confirmacao.metodo_confirmacao,
            responsavel: {
                id: confirmacao.confirmado_por,
                nome: 'Responsável Confirmação' // seria obtido da entidade Usuario
            },
            destinatario: confirmacao.destinatario_id ? {
                id: confirmacao.destinatario_id,
                nome: 'Nome do Destinatário' // seria obtido da entidade Cidadao
            } : undefined,
            observacoes: confirmacao.observacoes
        }));
    }
    /**
     * Obtém uma confirmação específica por ID
     */
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    async findOne(id) {
        const confirmacao = await this.confirmacaoService.findOneWithRelations(id);
        if (!confirmacao) {
            throw new common_2.NotFoundException('Confirmação não encontrada');
        }
        // Mapear para DTO de resposta
        return {
            id: confirmacao.id,
            pagamentoId: confirmacao.pagamento_id,
            dataConfirmacao: confirmacao.data_confirmacao,
            metodoConfirmacao: confirmacao.metodo_confirmacao,
            responsavel: {
                id: confirmacao.confirmado_por,
                nome: 'Responsável Confirmação' // seria obtido da entidade Usuario
            },
            destinatario: confirmacao.destinatario_id ? {
                id: confirmacao.destinatario_id,
                nome: 'Nome do Destinatário' // seria obtido da entidade Cidadao
            } : undefined,
            pagamento: confirmacao.pagamento ? {
                id: confirmacao.pagamento.id,
                valor: confirmacao.pagamento.valor,
                dataLiberacao: confirmacao.pagamento.dataLiberacao,
                metodoPagamento: confirmacao.pagamento.metodoPagamento
            } : undefined,
            observacoes: confirmacao.observacoes
        };
    }
    /**
     * Registra uma nova confirmação de recebimento
     */
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    async create(pagamentoId, createDto) {
        // Usar o ID do usuário atual
        const usuarioId = 'placeholder'; // usuario.id;
        const confirmacao = await this.confirmacaoService.registrarConfirmacao(pagamentoId, createDto, usuarioId);
        // Mapear para DTO de resposta
        return {
            id: confirmacao.id,
            pagamentoId: confirmacao.pagamento_id,
            dataConfirmacao: confirmacao.data_confirmacao,
            metodoConfirmacao: confirmacao.metodo_confirmacao,
            responsavel: {
                id: usuarioId,
                nome: 'Responsável Confirmação' // seria obtido da entidade Usuario
            },
            destinatario: confirmacao.destinatario_id ? {
                id: confirmacao.destinatario_id,
                nome: 'Nome do Destinatário' // seria obtido da entidade Cidadao
            } : undefined,
            observacoes: confirmacao.observacoes
        };
    }
    /**
     * Verifica se um pagamento tem confirmação
     */
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    async verificaConfirmacao(pagamentoId) {
        const temConfirmacao = await this.confirmacaoService.temConfirmacao(pagamentoId);
        return {
            temConfirmacao,
            status: temConfirmacao ? 'CONFIRMADO' : 'PENDENTE_CONFIRMACAO'
        };
    }
};
exports.ConfirmacaoController = ConfirmacaoController;
__decorate([
    (0, common_1.Get)(),
    (0, swagger_1.ApiOperation)({ summary: 'Lista confirmações de recebimento para um pagamento' }),
    (0, swagger_1.ApiParam)({ name: 'pagamentoId', type: 'string', description: 'ID do pagamento' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Lista de confirmações',
        type: [confirmacao_response_dto_1.ConfirmacaoResponseDto]
    }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Pagamento não encontrado' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Acesso negado' })
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    ,
    __param(0, (0, common_1.Param)('pagamentoId', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], ConfirmacaoController.prototype, "findAll", null);
__decorate([
    (0, common_1.Get)(':id'),
    (0, swagger_1.ApiOperation)({ summary: 'Obtém detalhes de uma confirmação específica' }),
    (0, swagger_1.ApiParam)({ name: 'pagamentoId', type: 'string', description: 'ID do pagamento' }),
    (0, swagger_1.ApiParam)({ name: 'id', type: 'string', description: 'ID da confirmação' }),
    (0, swagger_1.ApiResponse)({ status: 200, description: 'Detalhes da confirmação', type: confirmacao_response_dto_1.ConfirmacaoResponseDto }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Confirmação não encontrada' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Acesso negado' })
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    ,
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], ConfirmacaoController.prototype, "findOne", null);
__decorate([
    (0, common_1.Post)(),
    (0, swagger_1.ApiOperation)({ summary: 'Registra uma confirmação de recebimento para um pagamento' }),
    (0, swagger_1.ApiParam)({ name: 'pagamentoId', type: 'string', description: 'ID do pagamento' }),
    (0, swagger_1.ApiResponse)({ status: 201, description: 'Confirmação registrada com sucesso', type: confirmacao_response_dto_1.ConfirmacaoResponseDto }),
    (0, swagger_1.ApiResponse)({ status: 400, description: 'Dados inválidos' }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Pagamento não encontrado' }),
    (0, swagger_1.ApiResponse)({ status: 409, description: 'Pagamento já confirmado ou não pode ser confirmado' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Acesso negado' })
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    ,
    __param(0, (0, common_1.Param)('pagamentoId', common_1.ParseUUIDPipe)),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_b = typeof confirmacao_recebimento_dto_1.ConfirmacaoRecebimentoDto !== "undefined" && confirmacao_recebimento_dto_1.ConfirmacaoRecebimentoDto) === "function" ? _b : Object]),
    __metadata("design:returntype", Promise)
], ConfirmacaoController.prototype, "create", null);
__decorate([
    (0, common_1.Get)('verificar'),
    (0, swagger_1.ApiOperation)({ summary: 'Verifica se um pagamento tem confirmação de recebimento' }),
    (0, swagger_1.ApiParam)({ name: 'pagamentoId', type: 'string', description: 'ID do pagamento' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Status da confirmação',
        schema: {
            type: 'object',
            properties: {
                temConfirmacao: { type: 'boolean' },
                status: { type: 'string' }
            }
        }
    }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Pagamento não encontrado' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Acesso negado' })
    // @UseGuards(RolesGuard)
    // @Roles('admin', 'gestor_semtas', 'tecnico')
    ,
    __param(0, (0, common_1.Param)('pagamentoId', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], ConfirmacaoController.prototype, "verificaConfirmacao", null);
exports.ConfirmacaoController = ConfirmacaoController = __decorate([
    (0, swagger_1.ApiTags)('Pagamentos'),
    (0, common_1.Controller)('pagamentos/:pagamentoId/confirmacao'),
    __metadata("design:paramtypes", [typeof (_a = typeof confirmacao_service_1.ConfirmacaoService !== "undefined" && confirmacao_service_1.ConfirmacaoService) === "function" ? _a : Object])
], ConfirmacaoController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcY29udHJvbGxlcnNcXGNvbmZpcm1hY2FvLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUE4RjtBQUM5Riw2Q0FBK0U7QUFDL0UseUVBQXFFO0FBQ3JFLHFGQUFnRjtBQUNoRiwrRUFBMEU7QUFDMUUsMkNBQW1EO0FBRW5EOzs7Ozs7O0dBT0c7QUFHSSxJQUFNLHFCQUFxQixHQUEzQixNQUFNLHFCQUFxQjtJQUNIO0lBQTdCLFlBQTZCLGtCQUFzQztRQUF0Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO0lBQUcsQ0FBQztJQUV2RTs7T0FFRztJQWFHLEFBRk4seUJBQXlCO0lBQ3pCLDhDQUE4QztJQUM5QyxLQUFLLENBQUMsT0FBTyxDQUFzQyxXQUFtQjtRQUNwRSxNQUFNLFlBQVksR0FBRyxNQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFaEYsOEJBQThCO1FBQzlCLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDdEMsRUFBRSxFQUFFLFdBQVcsQ0FBQyxFQUFFO1lBQ2xCLFdBQVcsRUFBRSxXQUFXLENBQUMsWUFBWTtZQUNyQyxlQUFlLEVBQUUsV0FBVyxDQUFDLGdCQUFnQjtZQUM3QyxpQkFBaUIsRUFBRSxXQUFXLENBQUMsa0JBQWtCO1lBQ2pELFdBQVcsRUFBRTtnQkFDWCxFQUFFLEVBQUUsV0FBVyxDQUFDLGNBQWM7Z0JBQzlCLElBQUksRUFBRSx5QkFBeUIsQ0FBQyxtQ0FBbUM7YUFDcEU7WUFDRCxZQUFZLEVBQUUsV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7Z0JBQzFDLEVBQUUsRUFBRSxXQUFXLENBQUMsZUFBZTtnQkFDL0IsSUFBSSxFQUFFLHNCQUFz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QWtCLG9CQUFsQix3Q0FBa0I7R0FEeEQscUJBQXFCLENBNEpqQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xccGFnYW1lbnRvXFxjb250cm9sbGVyc1xcY29uZmlybWFjYW8uY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCb2R5LCBDb250cm9sbGVyLCBHZXQsIFBhcmFtLCBQYXJzZVVVSURQaXBlLCBQb3N0LCBVc2VHdWFyZHMgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBBcGlPcGVyYXRpb24sIEFwaVBhcmFtLCBBcGlSZXNwb25zZSwgQXBpVGFncyB9IGZyb20gJ0BuZXN0anMvc3dhZ2dlcic7XG5pbXBvcnQgeyBDb25maXJtYWNhb1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9jb25maXJtYWNhby5zZXJ2aWNlJztcbmltcG9ydCB7IENvbmZpcm1hY2FvUmVjZWJpbWVudG9EdG8gfSBmcm9tICcuLi9kdG9zL2NvbmZpcm1hY2FvLXJlY2ViaW1lbnRvLmR0byc7XG5pbXBvcnQgeyBDb25maXJtYWNhb1Jlc3BvbnNlRHRvIH0gZnJvbSAnLi4vZHRvcy9jb25maXJtYWNhby1yZXNwb25zZS5kdG8nO1xuaW1wb3J0IHsgTm90Rm91bmRFeGNlcHRpb24gfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5cbi8qKlxuICogQ29udHJvbGxlciBwYXJhIGdlcmVuY2lhbWVudG8gZGUgY29uZmlybWHDp8O1ZXMgZGUgcmVjZWJpbWVudG9cbiAqIFxuICogSW1wbGVtZW50YSBlbmRwb2ludHMgcGFyYSByZWdpc3RyYXIgZSBjb25zdWx0YXIgYXMgY29uZmlybWHDp8O1ZXNcbiAqIGRlIHJlY2ViaW1lbnRvIGRlIHBhZ2FtZW50b3MgcGVsb3MgYmVuZWZpY2nDoXJpb3MuXG4gKiBcbiAqIEBhdXRob3IgRXF1aXBlIFBHQmVuXG4gKi9cbkBBcGlUYWdzKCdQYWdhbWVudG9zJylcbkBDb250cm9sbGVyKCdwYWdhbWVudG9zLzpwYWdhbWVudG9JZC9jb25maXJtYWNhbycpXG5leHBvcnQgY2xhc3MgQ29uZmlybWFjYW9Db250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjb25maXJtYWNhb1NlcnZpY2U6IENvbmZpcm1hY2FvU2VydmljZSkge31cblxuICAvKipcbiAgICogTGlzdGEgY29uZmlybWHDp8O1ZXMgcGFyYSB1bSBkZXRlcm1pbmFkbyBwYWdhbWVudG9cbiAgICovXG4gIEBHZXQoKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ0xpc3RhIGNvbmZpcm1hw6fDtWVzIGRlIHJlY2ViaW1lbnRvIHBhcmEgdW0gcGFnYW1lbnRvJyB9KVxuICBAQXBpUGFyYW0oeyBuYW1lOiAncGFnYW1lbnRvSWQnLCB0eXBlOiAnc3RyaW5nJywgZGVzY3JpcHRpb246ICdJRCBkbyBwYWdhbWVudG8nIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogMjAwLCBcbiAgICBkZXNjcmlwdGlvbjogJ0xpc3RhIGRlIGNvbmZpcm1hw6fDtWVzJywgXG4gICAgdHlwZTogW0NvbmZpcm1hY2FvUmVzcG9uc2VEdG9dIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwNCwgZGVzY3JpcHRpb246ICdQYWdhbWVudG8gbsOjbyBlbmNvbnRyYWRvJyB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMywgZGVzY3JpcHRpb246ICdBY2Vzc28gbmVnYWRvJyB9KVxuICAvLyBAVXNlR3VhcmRzKFJvbGVzR3VhcmQpXG4gIC8vIEBSb2xlcygnYWRtaW4nLCAnZ2VzdG9yX3NlbXRhcycsICd0ZWNuaWNvJylcbiAgYXN5bmMgZmluZEFsbChAUGFyYW0oJ3BhZ2FtZW50b0lkJywgUGFyc2VVVUlEUGlwZSkgcGFnYW1lbnRvSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IGNvbmZpcm1hY29lcyA9IGF3YWl0IHRoaXMuY29uZmlybWFjYW9TZXJ2aWNlLmZpbmRCeVBhZ2FtZW50byhwYWdhbWVudG9JZCk7XG4gICAgXG4gICAgLy8gTWFwZWFyIHBhcmEgRFRPIGRlIHJlc3Bvc3RhXG4gICAgcmV0dXJuIGNvbmZpcm1hY29lcy5tYXAoY29uZmlybWFjYW8gPT4gKHtcbiAgICAgIGlkOiBjb25maXJtYWNhby5pZCxcbiAgICAgIHBhZ2FtZW50b0lkOiBjb25maXJtYWNhby5wYWdhbWVudG9faWQsXG4gICAgICBkYXRhQ29uZmlybWFjYW86IGNvbmZpcm1hY2FvLmRhdGFfY29uZmlybWFjYW8sXG4gICAgICBtZXRvZG9Db25maXJtYWNhbzogY29uZmlybWFjYW8ubWV0b2RvX2NvbmZpcm1hY2FvLFxuICAgICAgcmVzcG9uc2F2ZWw6IHtcbiAgICAgICAgaWQ6IGNvbmZpcm1hY2FvLmNvbmZpcm1hZG9fcG9yLFxuICAgICAgICBub21lOiAnUmVzcG9uc8OhdmVsIENvbmZpcm1hw6fDo28nIC8vIHNlcmlhIG9idGlkbyBkYSBlbnRpZGFkZSBVc3VhcmlvXG4gICAgICB9LFxuICAgICAgZGVzdGluYXRhcmlvOiBjb25maXJtYWNhby5kZXN0aW5hdGFyaW9faWQgPyB7XG4gICAgICAgIGlkOiBjb25maXJtYWNhby5kZXN0aW5hdGFyaW9faWQsXG4gICAgICAgIG5vbWU6ICdOb21lIGRvIERlc3RpbmF0w6FyaW8nIC8vIHNlcmlhIG9idGlkbyBkYSBlbnRpZGFkZSBDaWRhZGFvXG4gICAgICB9IDogdW5kZWZpbmVkLFxuICAgICAgb2JzZXJ2YWNvZXM6IGNvbmZpcm1hY2FvLm9ic2VydmFjb2VzXG4gICAgfSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSB1bWEgY29uZmlybWHDp8OjbyBlc3BlY8OtZmljYSBwb3IgSURcbiAgICovXG4gIEBHZXQoJzppZCcpXG4gIEBBcGlPcGVyYXRpb24oeyBzdW1tYXJ5OiAnT2J0w6ltIGRldGFsaGVzIGRlIHVtYSBjb25maXJtYcOnw6NvIGVzcGVjw61maWNhJyB9KVxuICBAQXBpUGFyYW0oeyBuYW1lOiAncGFnYW1lbnRvSWQnLCB0eXBlOiAnc3RyaW5nJywgZGVzY3JpcHRpb246ICdJRCBkbyBwYWdhbWVudG8nIH0pXG4gIEBBcGlQYXJhbSh7IG5hbWU6ICdpZCcsIHR5cGU6ICdzdHJpbmcnLCBkZXNjcmlwdGlvbjogJ0lEIGRhIGNvbmZpcm1hw6fDo28nIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogMjAwLCBkZXNjcmlwdGlvbjogJ0RldGFsaGVzIGRhIGNvbmZpcm1hw6fDo28nLCB0eXBlOiBDb25maXJtYWNhb1Jlc3BvbnNlRHRvIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDA0LCBkZXNjcmlwdGlvbjogJ0NvbmZpcm1hw6fDo28gbsOjbyBlbmNvbnRyYWRhJyB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMywgZGVzY3JpcHRpb246ICdBY2Vzc28gbmVnYWRvJyB9KVxuICAvLyBAVXNlR3VhcmRzKFJvbGVzR3VhcmQpXG4gIC8vIEBSb2xlcygnYWRtaW4nLCAnZ2VzdG9yX3NlbXRhcycsICd0ZWNuaWNvJylcbiAgYXN5bmMgZmluZE9uZShAUGFyYW0oJ2lkJywgUGFyc2VVVUlEUGlwZSkgaWQ6IHN0cmluZykge1xuICAgIGNvbnN0IGNvbmZpcm1hY2FvID0gYXdhaXQgdGhpcy5jb25maXJtYWNhb1NlcnZpY2UuZmluZE9uZVdpdGhSZWxhdGlvbnMoaWQpO1xuICAgIFxuICAgIGlmICghY29uZmlybWFjYW8pIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignQ29uZmlybWHDp8OjbyBuw6NvIGVuY29udHJhZGEnKTtcbiAgICB9XG5cbiAgICAvLyBNYXBlYXIgcGFyYSBEVE8gZGUgcmVzcG9zdGFcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGNvbmZpcm1hY2FvLmlkLFxuICAgICAgcGFnYW1lbnRvSWQ6IGNvbmZpcm1hY2FvLnBhZ2FtZW50b19pZCxcbiAgICAgIGRhdGFDb25maXJtYWNhbzogY29uZmlybWFjYW8uZGF0YV9jb25maXJtYWNhbyxcbiAgICAgIG1ldG9kb0NvbmZpcm1hY2FvOiBjb25maXJtYWNhby5tZXRvZG9fY29uZmlybWFjYW8sXG4gICAgICByZXNwb25zYXZlbDoge1xuICAgICAgICBpZDogY29uZmlybWFjYW8uY29uZmlybWFkb19wb3IsXG4gICAgICAgIG5vbWU6ICdSZXNwb25zw6F2ZWwgQ29uZmlybWHDp8OjbycgLy8gc2VyaWEgb2J0aWRvIGRhIGVudGlkYWRlIFVzdWFyaW9cbiAgICAgIH0sXG4gICAgICBkZXN0aW5hdGFyaW86IGNvbmZpcm1hY2FvLmRlc3RpbmF0YXJpb19pZCA/IHtcbiAgICAgICAgaWQ6IGNvbmZpcm1hY2FvLmRlc3RpbmF0YXJpb19pZCxcbiAgICAgICAgbm9tZTogJ05vbWUgZG8gRGVzdGluYXTDoXJpbycgLy8gc2VyaWEgb2J0aWRvIGRhIGVudGlkYWRlIENpZGFkYW9cbiAgICAgIH0gOiB1bmRlZmluZWQsXG4gICAgICBwYWdhbWVudG86IGNvbmZpcm1hY2FvLnBhZ2FtZW50byA/IHtcbiAgICAgICAgaWQ6IGNvbmZpcm1hY2FvLnBhZ2FtZW50by5pZCxcbiAgICAgICAgdmFsb3I6IGNvbmZpcm1hY2FvLnBhZ2FtZW50by52YWxvcixcbiAgICAgICAgZGF0YUxpYmVyYWNhbzogY29uZmlybWFjYW8ucGFnYW1lbnRvLmRhdGFMaWJlcmFjYW8sXG4gICAgICAgIG1ldG9kb1BhZ2FtZW50bzogY29uZmlybWFjYW8ucGFnYW1lbnRvLm1ldG9kb1BhZ2FtZW50b1xuICAgICAgfSA6IHVuZGVmaW5lZCxcbiAgICAgIG9ic2VydmFjb2VzOiBjb25maXJtYWNhby5vYnNlcnZhY29lc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0cmEgdW1hIG5vdmEgY29uZmlybWHDp8OjbyBkZSByZWNlYmltZW50b1xuICAgKi9cbiAgQFBvc3QoKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ1JlZ2lzdHJhIHVtYSBjb25maXJtYcOnw6NvIGRlIHJlY2ViaW1lbnRvIHBhcmEgdW0gcGFnYW1lbnRvJyB9KVxuICBAQXBpUGFyYW0oeyBuYW1lOiAncGFnYW1lbnRvSWQnLCB0eXBlOiAnc3RyaW5nJywgZGVzY3JpcHRpb246ICdJRCBkbyBwYWdhbWVudG8nIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogMjAxLCBkZXNjcmlwdGlvbjogJ0NvbmZpcm1hw6fDo28gcmVnaXN0cmFkYSBjb20gc3VjZXNzbycsIHR5cGU6IENvbmZpcm1hY2FvUmVzcG9uc2VEdG8gfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDAsIGRlc2NyaXB0aW9uOiAnRGFkb3MgaW52w6FsaWRvcycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDQsIGRlc2NyaXB0aW9uOiAnUGFnYW1lbnRvIG7Do28gZW5jb250cmFkbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDksIGRlc2NyaXB0aW9uOiAnUGFnYW1lbnRvIGrDoSBjb25maXJtYWRvIG91IG7Do28gcG9kZSBzZXIgY29uZmlybWFkbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDMsIGRlc2NyaXB0aW9uOiAnQWNlc3NvIG5lZ2FkbycgfSlcbiAgLy8gQFVzZUd1YXJkcyhSb2xlc0d1YXJkKVxuICAvLyBAUm9sZXMoJ2FkbWluJywgJ2dlc3Rvcl9zZW10YXMnLCAndGVjbmljbycpXG4gIGFzeW5jIGNyZWF0ZShcbiAgICBAUGFyYW0oJ3BhZ2FtZW50b0lkJywgUGFyc2VVVUlEUGlwZSkgcGFnYW1lbnRvSWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIGNyZWF0ZUR0bzogQ29uZmlybWFjYW9SZWNlYmltZW50b0R0byxcbiAgICAvLyBAQ3VycmVudFVzZXIoKSB1c3VhcmlvOiBVc3VhcmlvXG4gICkge1xuICAgIC8vIFVzYXIgbyBJRCBkbyB1c3XDoXJpbyBhdHVhbFxuICAgIGNvbnN0IHVzdWFyaW9JZCA9ICdwbGFjZWhvbGRlcic7IC8vIHVzdWFyaW8uaWQ7XG4gICAgXG4gICAgY29uc3QgY29uZmlybWFjYW8gPSBhd2FpdCB0aGlzLmNvbmZpcm1hY2FvU2VydmljZS5yZWdpc3RyYXJDb25maXJtYWNhbyhcbiAgICAgIHBhZ2FtZW50b0lkLFxuICAgICAgY3JlYXRlRHRvLFxuICAgICAgdXN1YXJpb0lkXG4gICAgKTtcblxuICAgIC8vIE1hcGVhciBwYXJhIERUTyBkZSByZXNwb3N0YVxuICAgIHJldHVybiB7XG4gICAgICBpZDogY29uZmlybWFjYW8uaWQsXG4gICAgICBwYWdhbWVudG9JZDogY29uZmlybWFjYW8ucGFnYW1lbnRvX2lkLFxuICAgICAgZGF0YUNvbmZpcm1hY2FvOiBjb25maXJtYWNhby5kYXRhX2NvbmZpcm1hY2FvLFxuICAgICAgbWV0b2RvQ29uZmlybWFjYW86IGNvbmZpcm1hY2FvLm1ldG9kb19jb25maXJtYWNhbyxcbiAgICAgIHJlc3BvbnNhdmVsOiB7XG4gICAgICAgIGlkOiB1c3VhcmlvSWQsXG4gICAgICAgIG5vbWU6ICdSZXNwb25zw6F2ZWwgQ29uZmlybWHDp8OjbycgLy8gc2VyaWEgb2J0aWRvIGRhIGVudGlkYWRlIFVzdWFyaW9cbiAgICAgIH0sXG4gICAgICBkZXN0aW5hdGFyaW86IGNvbmZpcm1hY2FvLmRlc3RpbmF0YXJpb19pZCA/IHtcbiAgICAgICAgaWQ6IGNvbmZpcm1hY2FvLmRlc3RpbmF0YXJpb19pZCxcbiAgICAgICAgbm9tZTogJ05vbWUgZG8gRGVzdGluYXTDoXJpbycgLy8gc2VyaWEgb2J0aWRvIGRhIGVudGlkYWRlIENpZGFkYW9cbiAgICAgIH0gOiB1bmRlZmluZWQsXG4gICAgICBvYnNlcnZhY29lczogY29uZmlybWFjYW8ub2JzZXJ2YWNvZXNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHVtIHBhZ2FtZW50byB0ZW0gY29uZmlybWHDp8Ojb1xuICAgKi9cbiAgQEdldCgndmVyaWZpY2FyJylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdWZXJpZmljYSBzZSB1bSBwYWdhbWVudG8gdGVtIGNvbmZpcm1hw6fDo28gZGUgcmVjZWJpbWVudG8nIH0pXG4gIEBBcGlQYXJhbSh7IG5hbWU6ICdwYWdhbWVudG9JZCcsIHR5cGU6ICdzdHJpbmcnLCBkZXNjcmlwdGlvbjogJ0lEIGRvIHBhZ2FtZW50bycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDAsIFxuICAgIGRlc2NyaXB0aW9uOiAnU3RhdHVzIGRhIGNvbmZpcm1hw6fDo28nLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHRlbUNvbmZpcm1hY2FvOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICBzdGF0dXM6IHsgdHlwZTogJ3N0cmluZycgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDQsIGRlc2NyaXB0aW9uOiAnUGFnYW1lbnRvIG7Do28gZW5jb250cmFkbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDMsIGRlc2NyaXB0aW9uOiAnQWNlc3NvIG5lZ2FkbycgfSlcbiAgLy8gQFVzZUd1YXJkcyhSb2xlc0d1YXJkKVxuICAvLyBAUm9sZXMoJ2FkbWluJywgJ2dlc3Rvcl9zZW10YXMnLCAndGVjbmljbycpXG4gIGFzeW5jIHZlcmlmaWNhQ29uZmlybWFjYW8oQFBhcmFtKCdwYWdhbWVudG9JZCcsIFBhcnNlVVVJRFBpcGUpIHBhZ2FtZW50b0lkOiBzdHJpbmcpIHtcbiAgICBjb25zdCB0ZW1Db25maXJtYWNhbyA9IGF3YWl0IHRoaXMuY29uZmlybWFjYW9TZXJ2aWNlLnRlbUNvbmZpcm1hY2FvKHBhZ2FtZW50b0lkKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdGVtQ29uZmlybWFjYW8sXG4gICAgICBzdGF0dXM6IHRlbUNvbmZpcm1hY2FvID8gJ0NPTkZJUk1BRE8nIDogJ1BFTkRFTlRFX0NPTkZJUk1BQ0FPJ1xuICAgIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==