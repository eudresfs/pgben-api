fe4a604bce2efd6b40cb902663945f1f
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;
Object.defineProperty(exports, "__esModule", { value: true });
exports.RenovacaoAutomaticaController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const jwt_auth_guard_1 = require("../../../auth/guards/jwt-auth.guard");
const permission_guard_1 = require("../../../auth/guards/permission.guard");
const requires_permission_decorator_1 = require("../../../auth/decorators/requires-permission.decorator");
const user_permission_entity_1 = require("../../../entities/user-permission.entity");
const renovacao_automatica_service_1 = require("../services/renovacao-automatica.service");
const configuracao_renovacao_entity_1 = require("../../../entities/configuracao-renovacao.entity");
const create_configuracao_renovacao_dto_1 = require("../dto/create-configuracao-renovacao.dto");
const update_configuracao_renovacao_dto_1 = require("../dto/update-configuracao-renovacao.dto");
const solicitacao_entity_1 = require("../../../entities/solicitacao.entity");
const verificacao_renovacao_response_dto_1 = require("../dto/verificacao-renovacao-response.dto");
const verificacao_renovacoes_pendentes_response_dto_1 = require("../dto/verificacao-renovacoes-pendentes-response.dto");
const configurar_renovacao_solicitacao_dto_1 = require("../dto/configurar-renovacao-solicitacao.dto");
// Usando o DTO importado ConfigurarRenovacaoSolicitacaoDto
/**
 * Controller de Renovação Automática
 *
 * Responsável por expor os endpoints de gerenciamento das configurações de renovação
 * automática e do processo de renovação automática mensal.
 */
let RenovacaoAutomaticaController = class RenovacaoAutomaticaController {
    renovacaoService;
    constructor(renovacaoService) {
        this.renovacaoService = renovacaoService;
    }
    /**
     * Cria uma nova configuração de renovação automática
     * @param createConfiguracaoDto Dados da configuração
     * @param req Requisição
     * @returns Configuração criada
     */
    async create(createConfiguracaoDto, req) {
        return this.renovacaoService.create(createConfiguracaoDto, req.user.id);
    }
    /**
     * Busca todas as configurações de renovação
     * @returns Lista de configurações
     */
    async findAll() {
        return this.renovacaoService.findAll();
    }
    /**
     * Busca uma configuração de renovação pelo ID
     * @param id ID da configuração
     * @returns Configuração
     */
    async findById(id) {
        return this.renovacaoService.findById(id);
    }
    /**
     * Busca uma configuração de renovação pelo tipo de benefício
     * @param tipoBeneficioId ID do tipo de benefício
     * @returns Configuração
     */
    async findByTipoBeneficio(tipoBeneficioId) {
        return this.renovacaoService.findByTipoBeneficio(tipoBeneficioId);
    }
    /**
     * Atualiza uma configuração de renovação
     * @param id ID da configuração
     * @param updateConfiguracaoDto Dados para atualização
     * @returns Configuração atualizada
     */
    async update(id, updateConfiguracaoDto) {
        return this.renovacaoService.update(id, updateConfiguracaoDto);
    }
    /**
     * Remove uma configuração de renovação
     * @param id ID da configuração
     * @returns void
     */
    async remove(id) {
        return this.renovacaoService.remove(id);
    }
    /**
     * Ativa ou desativa uma configuração de renovação
     * @param id ID da configuração
     * @param body Corpo da requisição
     * @returns Configuração atualizada
     */
    async toggleAtivo(id, body) {
        return this.renovacaoService.toggleAtivo(id, body.ativo);
    }
    /**
     * Verifica a configuração de renovação automática de uma solicitação
     * @param solicitacaoId ID da solicitação
     * @returns Informações sobre a configuração de renovação da solicitação
     */
    async verificarRenovacaoSolicitacao(solicitacaoId) {
        return this.renovacaoService.verificarRenovacaoSolicitacao(solicitacaoId);
    }
    /**
     * Configura a renovação automática para uma solicitação
     * @param solicitacaoId ID da solicitação
     * @param body Corpo da requisição
     * @param req Requisição
     * @returns Solicitação atualizada
     */
    async configurarRenovacaoSolicitacao(solicitacaoId, body, req) {
        return this.renovacaoService.configurarRenovacaoSolicitacao(solicitacaoId, body.renovacao_automatica, req.user.id);
    }
    /**
     * Verifica e processa manualmente as renovações pendentes
     * @param req Requisição
     * @returns Número de solicitações renovadas
     */
    async verificarRenovacoesPendentes(req) {
        const renovacoesProcessadas = await this.renovacaoService.verificarRenovacoesPendentes(req.user.id);
        const response = {
            renovacoes_processadas: renovacoesProcessadas,
        };
        return response;
    }
};
exports.RenovacaoAutomaticaController = RenovacaoAutomaticaController;
__decorate([
    (0, common_1.Post)('configuracao'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.criar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Cria uma nova configuração de renovação automática',
        description: 'Cria uma configuração de renovação automática para um tipo de benefício.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Configuração criada com sucesso',
        type: configuracao_renovacao_entity_1.ConfiguracaoRenovacao,
    }),
    __param(0, (0, common_1.Body)()),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_b = typeof create_configuracao_renovacao_dto_1.CreateConfiguracaoRenovacaoDto !== "undefined" && create_configuracao_renovacao_dto_1.CreateConfiguracaoRenovacaoDto) === "function" ? _b : Object, Object]),
    __metadata("design:returntype", typeof (_c = typeof Promise !== "undefined" && Promise) === "function" ? _c : Object)
], RenovacaoAutomaticaController.prototype, "create", null);
__decorate([
    (0, common_1.Get)('configuracao'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.listar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Busca todas as configurações de renovação',
        description: 'Retorna a lista de todas as configurações de renovação automática.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Lista de configurações retornada com sucesso',
        type: [configuracao_renovacao_entity_1.ConfiguracaoRenovacao],
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", typeof (_d = typeof Promise !== "undefined" && Promise) === "function" ? _d : Object)
], RenovacaoAutomaticaController.prototype, "findAll", null);
__decorate([
    (0, common_1.Get)('configuracao/:id'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.visualizar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Busca uma configuração de renovação pelo ID',
        description: 'Retorna os detalhes de uma configuração de renovação específica.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração encontrada com sucesso',
        type: configuracao_renovacao_entity_1.ConfiguracaoRenovacao,
    }),
    __param(0, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], RenovacaoAutomaticaController.prototype, "findById", null);
__decorate([
    (0, common_1.Get)('configuracao/tipo-beneficio/:tipoBeneficioId'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.visualizar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Busca uma configuração de renovação pelo tipo de benefício',
        description: 'Retorna a configuração de renovação para um tipo de benefício específico.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração encontrada com sucesso',
        type: configuracao_renovacao_entity_1.ConfiguracaoRenovacao,
    }),
    __param(0, (0, common_1.Param)('tipoBeneficioId')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_f = typeof Promise !== "undefined" && Promise) === "function" ? _f : Object)
], RenovacaoAutomaticaController.prototype, "findByTipoBeneficio", null);
__decorate([
    (0, common_1.Patch)('configuracao/:id'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.atualizar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Atualiza uma configuração de renovação',
        description: 'Atualiza os dados de uma configuração de renovação existente.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração atualizada com sucesso',
        type: configuracao_renovacao_entity_1.ConfiguracaoRenovacao,
    }),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_g = typeof update_configuracao_renovacao_dto_1.UpdateConfiguracaoRenovacaoDto !== "undefined" && update_configuracao_renovacao_dto_1.UpdateConfiguracaoRenovacaoDto) === "function" ? _g : Object]),
    __metadata("design:returntype", typeof (_h = typeof Promise !== "undefined" && Promise) === "function" ? _h : Object)
], RenovacaoAutomaticaController.prototype, "update", null);
__decorate([
    (0, common_1.Delete)('configuracao/:id'),
    (0, common_1.HttpCode)(common_1.HttpStatus.NO_CONTENT),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.remover' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Remove uma configuração de renovação',
        description: 'Remove permanentemente uma configuração de renovação.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 204,
        description: 'Configuração removida com sucesso',
    }),
    __param(0, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_j = typeof Promise !== "undefined" && Promise) === "function" ? _j : Object)
], RenovacaoAutomaticaController.prototype, "remove", null);
__decorate([
    (0, common_1.Patch)('configuracao/:id/ativar'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.configuracao.atualizar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Ativa ou desativa uma configuração de renovação',
        description: 'Altera o status de ativação de uma configuração de renovação.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Status de ativação atualizado com sucesso',
        type: configuracao_renovacao_entity_1.ConfiguracaoRenovacao,
    }),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object]),
    __metadata("design:returntype", typeof (_k = typeof Promise !== "undefined" && Promise) === "function" ? _k : Object)
], RenovacaoAutomaticaController.prototype, "toggleAtivo", null);
__decorate([
    (0, common_1.Get)('solicitacao/:solicitacaoId/verificar'),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'solicitacao.visualizar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'solicitacao.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Verifica a configuração de renovação automática de uma solicitação',
        description: 'Retorna informações sobre a configuração de renovação automática de uma solicitação específica.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Informações sobre renovação automática retornadas com sucesso',
        type: verificacao_renovacao_response_dto_1.VerificacaoRenovacaoResponseDto,
    }),
    __param(0, (0, common_1.Param)('solicitacaoId')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_l = typeof Promise !== "undefined" && Promise) === "function" ? _l : Object)
], RenovacaoAutomaticaController.prototype, "verificarRenovacaoSolicitacao", null);
__decorate([
    (0, common_1.Patch)('solicitacao/:solicitacaoId'),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'solicitacao.configurar-renovacao',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'solicitacao.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Configura a renovação automática para uma solicitação',
        description: 'Ativa ou desativa a renovação automática para uma solicitação específica.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração de renovação atualizada com sucesso',
        type: solicitacao_entity_1.Solicitacao,
    }),
    __param(0, (0, common_1.Param)('solicitacaoId')),
    __param(1, (0, common_1.Body)()),
    __param(2, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_m = typeof configurar_renovacao_solicitacao_dto_1.ConfigurarRenovacaoSolicitacaoDto !== "undefined" && configurar_renovacao_solicitacao_dto_1.ConfigurarRenovacaoSolicitacaoDto) === "function" ? _m : Object, Object]),
    __metadata("design:returntype", typeof (_o = typeof Promise !== "undefined" && Promise) === "function" ? _o : Object)
], RenovacaoAutomaticaController.prototype, "configurarRenovacaoSolicitacao", null);
__decorate([
    (0, common_1.Post)('verificar-pendentes'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'beneficio.renovacao.verificar' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Verifica e processa manualmente as renovações pendentes',
        description: 'Executa manualmente o processo de verificação e renovação automática.',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Verificação concluída com sucesso',
        type: verificacao_renovacoes_pendentes_response_dto_1.VerificacaoRenovacoesPendentesResponseDto,
    }),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", typeof (_p = typeof Promise !== "undefined" && Promise) === "function" ? _p : Object)
], RenovacaoAutomaticaController.prototype, "verificarRenovacoesPendentes", null);
exports.RenovacaoAutomaticaController = RenovacaoAutomaticaController = __decorate([
    (0, swagger_1.ApiTags)('Benefícios'),
    (0, common_1.Controller)('beneficio/renovacao-automatica'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, permission_guard_1.PermissionGuard),
    (0, swagger_1.ApiBearerAuth)(),
    __metadata("design:paramtypes", [typeof (_a = typeof renovacao_automatica_service_1.RenovacaoAutomaticaService !== "undefined" && renovacao_automatica_service_1.RenovacaoAutomaticaService) === "function" ? _a : Object])
], RenovacaoAutomaticaController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGJlbmVmaWNpb1xcY29udHJvbGxlcnNcXHJlbm92YWNhby1hdXRvbWF0aWNhLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQVl3QjtBQUN4Qiw2Q0FLeUI7QUFDekIsd0VBQW1FO0FBQ25FLDRFQUF3RTtBQUN4RSwwR0FBNEY7QUFDNUYscUZBQXFFO0FBQ3JFLDJGQUFzRjtBQUN0RixtR0FBd0Y7QUFDeEYsZ0dBQTBGO0FBQzFGLGdHQUEwRjtBQUMxRiw2RUFBbUU7QUFDbkUsa0dBQTRGO0FBQzVGLHdIQUFpSDtBQUNqSCxzR0FBZ0c7QUFJaEcsMkRBQTJEO0FBRTNEOzs7OztHQUtHO0FBS0ksSUFBTSw2QkFBNkIsR0FBbkMsTUFBTSw2QkFBNkI7SUFDWDtJQUE3QixZQUE2QixnQkFBNEM7UUFBNUMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUE0QjtJQUFHLENBQUM7SUFFN0U7Ozs7O09BS0c7SUFhRyxBQUFOLEtBQUssQ0FBQyxNQUFNLENBQ0YscUJBQXFELEVBQ3RELEdBQVE7UUFFZixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMscUJBQXFCLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMxRSxDQUFDO0lBRUQ7OztPQUdHO0lBYUcsQUFBTixLQUFLLENBQUMsT0FBTztRQUNYLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ3pDLENBQUM7SUFFRDs7OztPQUlHO0lBYUcsQUFBTixLQUFLLENBQUMsUUFBUSxDQUFjLEVBQVU7UUFDcEMsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7OztPQUlHO0lBYUcsQUFBTixLQUFLLENBQUMsbUJB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QUEsa0RBQWtCLEVBQUMsRUFBRSxjQUFjLEVBQUUsK0JBQStCLEVBQUUsQ0FBQztJQUN2RSxJQUFBLHNCQUFZLEVBQUM7UUFDWixPQUFPLEVBQUUseURBQXlEO1FBQ2xFLFdBQVcsRUFDVCx1RUFBdUU7S0FDMUUsQ0FBQztJQUNELElBQUEscUJBQVcsRUFBQztRQUNYLE1BQU0sRUFBRSxHQUFHO1FBQ1gsV0FBVyxFQUFFLG1DQUFtQztRQUNoRCxJQUFJLEVBQUUseUZBQXlDO0tBQ2hELENBQUM7SUFFQyxXQUFBLElBQUEsWUFBRyxHQUFFLENBQUE7Ozt3REFDTCxPQUFPLG9CQUFQLE9BQU87aUZBT1Q7d0NBNVBVLDZCQUE2QjtJQUp6QyxJQUFBLGlCQUFPLEVBQUMsWUFBWSxDQUFDO0lBQ3JCLElBQUEsbUJBQVUsRUFBQyxnQ0FBZ0MsQ0FBQztJQUM1QyxJQUFBLGtCQUFTLEVBQUMsNkJBQVksRUFBRSxrQ0FBZSxDQUFDO0lBQ3hDLElBQUEsdUJBQWEsR0FBRTt5REFFaUMseURBQTBCLG9CQUExQix5REFBMEI7R0FEOUQsNkJBQTZCLENBNlB6QyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcYmVuZWZpY2lvXFxjb250cm9sbGVyc1xccmVub3ZhY2FvLWF1dG9tYXRpY2EuY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb250cm9sbGVyLFxuICBHZXQsXG4gIFBvc3QsXG4gIEJvZHksXG4gIFBhcmFtLFxuICBQYXRjaCxcbiAgRGVsZXRlLFxuICBVc2VHdWFyZHMsXG4gIFJlcSxcbiAgSHR0cENvZGUsXG4gIEh0dHBTdGF0dXMsXG59IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7XG4gIEFwaUJlYXJlckF1dGgsXG4gIEFwaU9wZXJhdGlvbixcbiAgQXBpUmVzcG9uc2UsXG4gIEFwaVRhZ3MsXG59IGZyb20gJ0BuZXN0anMvc3dhZ2dlcic7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi8uLi8uLi9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBQZXJtaXNzaW9uR3VhcmQgfSBmcm9tICcuLi8uLi8uLi9hdXRoL2d1YXJkcy9wZXJtaXNzaW9uLmd1YXJkJztcbmltcG9ydCB7IFJlcXVpcmVzUGVybWlzc2lvbiB9IGZyb20gJy4uLy4uLy4uL2F1dGgvZGVjb3JhdG9ycy9yZXF1aXJlcy1wZXJtaXNzaW9uLmRlY29yYXRvcic7XG5pbXBvcnQgeyBTY29wZVR5cGUgfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy91c2VyLXBlcm1pc3Npb24uZW50aXR5JztcbmltcG9ydCB7IFJlbm92YWNhb0F1dG9tYXRpY2FTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcmVub3ZhY2FvLWF1dG9tYXRpY2Euc2VydmljZSc7XG5pbXBvcnQgeyBDb25maWd1cmFjYW9SZW5vdmFjYW8gfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9jb25maWd1cmFjYW8tcmVub3ZhY2FvLmVudGl0eSc7XG5pbXBvcnQgeyBDcmVhdGVDb25maWd1cmFjYW9SZW5vdmFjYW9EdG8gfSBmcm9tICcuLi9kdG8vY3JlYXRlLWNvbmZpZ3VyYWNhby1yZW5vdmFjYW8uZHRvJztcbmltcG9ydCB7IFVwZGF0ZUNvbmZpZ3VyYWNhb1Jlbm92YWNhb0R0byB9IGZyb20gJy4uL2R0by91cGRhdGUtY29uZmlndXJhY2FvLXJlbm92YWNhby5kdG8nO1xuaW1wb3J0IHsgU29saWNpdGFjYW8gfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9zb2xpY2l0YWNhby5lbnRpdHknO1xuaW1wb3J0IHsgVmVyaWZpY2FjYW9SZW5vdmFjYW9SZXNwb25zZUR0byB9IGZyb20gJy4uL2R0by92ZXJpZmljYWNhby1yZW5vdmFjYW8tcmVzcG9uc2UuZHRvJztcbmltcG9ydCB7IFZlcmlmaWNhY2FvUmVub3ZhY29lc1BlbmRlbnRlc1Jlc3BvbnNlRHRvIH0gZnJvbSAnLi4vZHRvL3ZlcmlmaWNhY2FvLXJlbm92YWNvZXMtcGVuZGVudGVzLXJlc3BvbnNlLmR0byc7XG5pbXBvcnQgeyBDb25maWd1cmFyUmVub3ZhY2FvU29saWNpdGFjYW9EdG8gfSBmcm9tICcuLi9kdG8vY29uZmlndXJhci1yZW5vdmFjYW8tc29saWNpdGFjYW8uZHRvJztcbmltcG9ydCB7IFZlcmlmaWNhY2FvQ29uZmlndXJhY2FvUmVub3ZhY2FvUmVzcG9uc2VEdG8gfSBmcm9tICcuLi9kdG8vdmVyaWZpY2FjYW8tY29uZmlndXJhY2FvLXJlbm92YWNhby1yZXNwb25zZS5kdG8nO1xuaW1wb3J0IHsgQ29uZmlndXJhY2FvUmVub3ZhY2FvUmVzcG9uc2VEdG8gfSBmcm9tICcuLi9kdG8vY29uZmlndXJhY2FvLXJlbm92YWNhby1yZXNwb25zZS5kdG8nO1xuXG4vLyBVc2FuZG8gbyBEVE8gaW1wb3J0YWRvIENvbmZpZ3VyYXJSZW5vdmFjYW9Tb2xpY2l0YWNhb0R0b1xuXG4vKipcbiAqIENvbnRyb2xsZXIgZGUgUmVub3Zhw6fDo28gQXV0b23DoXRpY2FcbiAqXG4gKiBSZXNwb25zw6F2ZWwgcG9yIGV4cG9yIG9zIGVuZHBvaW50cyBkZSBnZXJlbmNpYW1lbnRvIGRhcyBjb25maWd1cmHDp8O1ZXMgZGUgcmVub3Zhw6fDo29cbiAqIGF1dG9tw6F0aWNhIGUgZG8gcHJvY2Vzc28gZGUgcmVub3Zhw6fDo28gYXV0b23DoXRpY2EgbWVuc2FsLlxuICovXG5AQXBpVGFncygnQmVuZWbDrWNpb3MnKVxuQENvbnRyb2xsZXIoJ2JlbmVmaWNpby9yZW5vdmFjYW8tYXV0b21hdGljYScpXG5AVXNlR3VhcmRzKEp3dEF1dGhHdWFyZCwgUGVybWlzc2lvbkd1YXJkKVxuQEFwaUJlYXJlckF1dGgoKVxuZXhwb3J0IGNsYXNzIFJlbm92YWNhb0F1dG9tYXRpY2FDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSByZW5vdmFjYW9TZXJ2aWNlOiBSZW5vdmFjYW9BdXRvbWF0aWNhU2VydmljZSkge31cblxuICAvKipcbiAgICogQ3JpYSB1bWEgbm92YSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYVxuICAgKiBAcGFyYW0gY3JlYXRlQ29uZmlndXJhY2FvRHRvIERhZG9zIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEBwYXJhbSByZXEgUmVxdWlzacOnw6NvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvIGNyaWFkYVxuICAgKi9cbiAgQFBvc3QoJ2NvbmZpZ3VyYWNhbycpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oeyBwZXJtaXNzaW9uTmFtZTogJ2JlbmVmaWNpby5jb25maWd1cmFjYW8uY3JpYXInIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDcmlhIHVtYSBub3ZhIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvIGF1dG9tw6F0aWNhJyxcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgICdDcmlhIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYSBwYXJhIHVtIHRpcG8gZGUgYmVuZWbDrWNpby4nLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAxLFxuICAgIGRlc2NyaXB0aW9uOiAnQ29uZmlndXJhw6fDo28gY3JpYWRhIGNvbSBzdWNlc3NvJyxcbiAgICB0eXBlOiBDb25maWd1cmFjYW9SZW5vdmFjYW8sXG4gIH0pXG4gIGFzeW5jIGNyZWF0ZShcbiAgICBAQm9keSgpIGNyZWF0ZUNvbmZpZ3VyYWNhb0R0bzogQ3JlYXRlQ29uZmlndXJhY2FvUmVub3ZhY2FvRHRvLFxuICAgIEBSZXEoKSByZXE6IGFueSxcbiAgKTogUHJvbWlzZTxDb25maWd1cmFjYW9SZW5vdmFjYW8+IHtcbiAgICByZXR1cm4gdGhpcy5yZW5vdmFjYW9TZXJ2aWNlLmNyZWF0ZShjcmVhdGVDb25maWd1cmFjYW9EdG8sIHJlcS51c2VyLmlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYSB0b2RhcyBhcyBjb25maWd1cmHDp8O1ZXMgZGUgcmVub3Zhw6fDo29cbiAgICogQHJldHVybnMgTGlzdGEgZGUgY29uZmlndXJhw6fDtWVzXG4gICAqL1xuICBAR2V0KCdjb25maWd1cmFjYW8nKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHsgcGVybWlzc2lvbk5hbWU6ICdiZW5lZmljaW8uY29uZmlndXJhY2FvLmxpc3RhcicgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0J1c2NhIHRvZGFzIGFzIGNvbmZpZ3VyYcOnw7VlcyBkZSByZW5vdmHDp8OjbycsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnUmV0b3JuYSBhIGxpc3RhIGRlIHRvZGFzIGFzIGNvbmZpZ3VyYcOnw7VlcyBkZSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYS4nLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnTGlzdGEgZGUgY29uZmlndXJhw6fDtWVzIHJldG9ybmFkYSBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogW0NvbmZpZ3VyYWNhb1Jlbm92YWNhb10sXG4gIH0pXG4gIGFzeW5jIGZpbmRBbGwoKTogUHJvbWlzZTxDb25maWd1cmFjYW9SZW5vdmFjYW9bXT4ge1xuICAgIHJldHVybiB0aGlzLnJlbm92YWNhb1NlcnZpY2UuZmluZEFsbCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1c2NhIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBwZWxvIElEXG4gICAqIEBwYXJhbSBpZCBJRCBkYSBjb25maWd1cmHDp8Ojb1xuICAgKiBAcmV0dXJucyBDb25maWd1cmHDp8Ojb1xuICAgKi9cbiAgQEdldCgnY29uZmlndXJhY2FvLzppZCcpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oeyBwZXJtaXNzaW9uTmFtZTogJ2JlbmVmaWNpby5jb25maWd1cmFjYW8udmlzdWFsaXphcicgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0J1c2NhIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBwZWxvIElEJyxcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgICdSZXRvcm5hIG9zIGRldGFsaGVzIGRlIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBlc3BlY8OtZmljYS4nLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQ29uZmlndXJhw6fDo28gZW5jb250cmFkYSBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQ29uZmlndXJhY2FvUmVub3ZhY2FvLFxuICB9KVxuICBhc3luYyBmaW5kQnlJZChAUGFyYW0oJ2lkJykgaWQ6IHN0cmluZyk6IFByb21pc2U8Q29uZmlndXJhY2FvUmVub3ZhY2FvPiB7XG4gICAgcmV0dXJuIHRoaXMucmVub3ZhY2FvU2VydmljZS5maW5kQnlJZChpZCk7XG4gIH1cblxuICAvKipcbiAgICogQnVzY2EgdW1hIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvIHBlbG8gdGlwbyBkZSBiZW5lZsOtY2lvXG4gICAqIEBwYXJhbSB0aXBvQmVuZWZpY2lvSWQgSUQgZG8gdGlwbyBkZSBiZW5lZsOtY2lvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvXG4gICAqL1xuICBAR2V0KCdjb25maWd1cmFjYW8vdGlwby1iZW5lZmljaW8vOnRpcG9CZW5lZmljaW9JZCcpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oeyBwZXJtaXNzaW9uTmFtZTogJ2JlbmVmaWNpby5jb25maWd1cmFjYW8udmlzdWFsaXphcicgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0J1c2NhIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBwZWxvIHRpcG8gZGUgYmVuZWbDrWNpbycsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnUmV0b3JuYSBhIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvIHBhcmEgdW0gdGlwbyBkZSBiZW5lZsOtY2lvIGVzcGVjw61maWNvLicsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyBlbmNvbnRyYWRhIGNvbSBzdWNlc3NvJyxcbiAgICB0eXBlOiBDb25maWd1cmFjYW9SZW5vdmFjYW8sXG4gIH0pXG4gIGFzeW5jIGZpbmRCeVRpcG9CZW5lZmljaW8oXG4gICAgQFBhcmFtKCd0aXBvQmVuZWZpY2lvSWQnKSB0aXBvQmVuZWZpY2lvSWQ6IHN0cmluZyxcbiAgKTogUHJvbWlzZTxDb25maWd1cmFjYW9SZW5vdmFjYW8+IHtcbiAgICByZXR1cm4gdGhpcy5yZW5vdmFjYW9TZXJ2aWNlLmZpbmRCeVRpcG9CZW5lZmljaW8odGlwb0JlbmVmaWNpb0lkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHVhbGl6YSB1bWEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo29cbiAgICogQHBhcmFtIGlkIElEIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEBwYXJhbSB1cGRhdGVDb25maWd1cmFjYW9EdG8gRGFkb3MgcGFyYSBhdHVhbGl6YcOnw6NvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvIGF0dWFsaXphZGFcbiAgICovXG4gIEBQYXRjaCgnY29uZmlndXJhY2FvLzppZCcpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oeyBwZXJtaXNzaW9uTmFtZTogJ2JlbmVmaWNpby5jb25maWd1cmFjYW8uYXR1YWxpemFyJyB9KVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnQXR1YWxpemEgdW1hIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvJyxcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgICdBdHVhbGl6YSBvcyBkYWRvcyBkZSB1bWEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo28gZXhpc3RlbnRlLicsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyBhdHVhbGl6YWRhIGNvbSBzdWNlc3NvJyxcbiAgICB0eXBlOiBDb25maWd1cmFjYW9SZW5vdmFjYW8sXG4gIH0pXG4gIGFzeW5jIHVwZGF0ZShcbiAgICBAUGFyYW0oJ2lkJykgaWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIHVwZGF0ZUNvbmZpZ3VyYWNhb0R0bzogVXBkYXRlQ29uZmlndXJhY2FvUmVub3ZhY2FvRHRvLFxuICApOiBQcm9taXNlPENvbmZpZ3VyYWNhb1Jlbm92YWNhbz4ge1xuICAgIHJldHVybiB0aGlzLnJlbm92YWNhb1NlcnZpY2UudXBkYXRlKGlkLCB1cGRhdGVDb25maWd1cmFjYW9EdG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB1bWEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo29cbiAgICogQHBhcmFtIGlkIElEIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEByZXR1cm5zIHZvaWRcbiAgICovXG4gIEBEZWxldGUoJ2NvbmZpZ3VyYWNhby86aWQnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5OT19DT05URU5UKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHsgcGVybWlzc2lvbk5hbWU6ICdiZW5lZmljaW8uY29uZmlndXJhY2FvLnJlbW92ZXInIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdSZW1vdmUgdW1hIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvJyxcbiAgICBkZXNjcmlwdGlvbjogJ1JlbW92ZSBwZXJtYW5lbnRlbWVudGUgdW1hIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvLicsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDQsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyByZW1vdmlkYSBjb20gc3VjZXNzbycsXG4gIH0pXG4gIGFzeW5jIHJlbW92ZShAUGFyYW0oJ2lkJykgaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnJlbm92YWNhb1NlcnZpY2UucmVtb3ZlKGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdGl2YSBvdSBkZXNhdGl2YSB1bWEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo29cbiAgICogQHBhcmFtIGlkIElEIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEBwYXJhbSBib2R5IENvcnBvIGRhIHJlcXVpc2nDp8Ojb1xuICAgKiBAcmV0dXJucyBDb25maWd1cmHDp8OjbyBhdHVhbGl6YWRhXG4gICAqL1xuICBAUGF0Y2goJ2NvbmZpZ3VyYWNhby86aWQvYXRpdmFyJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnYmVuZWZpY2lvLmNvbmZpZ3VyYWNhby5hdHVhbGl6YXInIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdBdGl2YSBvdSBkZXNhdGl2YSB1bWEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo28nLFxuICAgIGRlc2NyaXB0aW9uOlxuICAgICAgJ0FsdGVyYSBvIHN0YXR1cyBkZSBhdGl2YcOnw6NvIGRlIHVtYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8Ojby4nLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnU3RhdHVzIGRlIGF0aXZhw6fDo28gYXR1YWxpemFkbyBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQ29uZmlndXJhY2FvUmVub3ZhY2FvLFxuICB9KVxuICBhc3luYyB0b2dnbGVBdGl2byhcbiAgICBAUGFyYW0oJ2lkJykgaWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIGJvZHk6IHsgYXRpdm86IGJvb2xlYW4gfSxcbiAgKTogUHJvbWlzZTxDb25maWd1cmFjYW9SZW5vdmFjYW8+IHtcbiAgICByZXR1cm4gdGhpcy5yZW5vdmFjYW9TZXJ2aWNlLnRvZ2dsZUF0aXZvKGlkLCBib2R5LmF0aXZvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBhIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvIGF1dG9tw6F0aWNhIGRlIHVtYSBzb2xpY2l0YcOnw6NvXG4gICAqIEBwYXJhbSBzb2xpY2l0YWNhb0lkIElEIGRhIHNvbGljaXRhw6fDo29cbiAgICogQHJldHVybnMgSW5mb3JtYcOnw7VlcyBzb2JyZSBhIGNvbmZpZ3VyYcOnw6NvIGRlIHJlbm92YcOnw6NvIGRhIHNvbGljaXRhw6fDo29cbiAgICovXG4gIEBHZXQoJ3NvbGljaXRhY2FvLzpzb2xpY2l0YWNhb0lkL3ZlcmlmaWNhcicpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oe1xuICAgIHBlcm1pc3Npb25OYW1lOiAnc29saWNpdGFjYW8udmlzdWFsaXphcicsXG4gICAgc2NvcGVUeXBlOiBTY29wZVR5cGUuVU5JVCxcbiAgICBzY29wZUlkRXhwcmVzc2lvbjogJ3NvbGljaXRhY2FvLnVuaWRhZGVJZCcsXG4gIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6XG4gICAgICAnVmVyaWZpY2EgYSBjb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYSBkZSB1bWEgc29saWNpdGHDp8OjbycsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnUmV0b3JuYSBpbmZvcm1hw6fDtWVzIHNvYnJlIGEgY29uZmlndXJhw6fDo28gZGUgcmVub3Zhw6fDo28gYXV0b23DoXRpY2EgZGUgdW1hIHNvbGljaXRhw6fDo28gZXNwZWPDrWZpY2EuJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgICdJbmZvcm1hw6fDtWVzIHNvYnJlIHJlbm92YcOnw6NvIGF1dG9tw6F0aWNhIHJldG9ybmFkYXMgY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IFZlcmlmaWNhY2FvUmVub3ZhY2FvUmVzcG9uc2VEdG8sXG4gIH0pXG4gIGFzeW5jIHZlcmlmaWNhclJlbm92YWNhb1NvbGljaXRhY2FvKFxuICAgIEBQYXJhbSgnc29saWNpdGFjYW9JZCcpIHNvbGljaXRhY2FvSWQ6IHN0cmluZyxcbiAgKTogUHJvbWlzZTxWZXJpZmljYWNhb1Jlbm92YWNhb1Jlc3BvbnNlRHRvPiB7XG4gICAgcmV0dXJuIHRoaXMucmVub3ZhY2FvU2VydmljZS52ZXJpZmljYXJSZW5vdmFjYW9Tb2xpY2l0YWNhbyhzb2xpY2l0YWNhb0lkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb25maWd1cmEgYSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYSBwYXJhIHVtYSBzb2xpY2l0YcOnw6NvXG4gICAqIEBwYXJhbSBzb2xpY2l0YWNhb0lkIElEIGRhIHNvbGljaXRhw6fDo29cbiAgICogQHBhcmFtIGJvZHkgQ29ycG8gZGEgcmVxdWlzacOnw6NvXG4gICAqIEBwYXJhbSByZXEgUmVxdWlzacOnw6NvXG4gICAqIEByZXR1cm5zIFNvbGljaXRhw6fDo28gYXR1YWxpemFkYVxuICAgKi9cbiAgQFBhdGNoKCdzb2xpY2l0YWNhby86c29saWNpdGFjYW9JZCcpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oe1xuICAgIHBlcm1pc3Npb25OYW1lOiAnc29saWNpdGFjYW8uY29uZmlndXJhci1yZW5vdmFjYW8nLFxuICAgIHNjb3BlVHlwZTogU2NvcGVUeXBlLlVOSVQsXG4gICAgc2NvcGVJZEV4cHJlc3Npb246ICdzb2xpY2l0YWNhby51bmlkYWRlSWQnLFxuICB9KVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnQ29uZmlndXJhIGEgcmVub3Zhw6fDo28gYXV0b23DoXRpY2EgcGFyYSB1bWEgc29saWNpdGHDp8OjbycsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnQXRpdmEgb3UgZGVzYXRpdmEgYSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYSBwYXJhIHVtYSBzb2xpY2l0YcOnw6NvIGVzcGVjw61maWNhLicsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyBkZSByZW5vdmHDp8OjbyBhdHVhbGl6YWRhIGNvbSBzdWNlc3NvJyxcbiAgICB0eXBlOiBTb2xpY2l0YWNhbyxcbiAgfSlcbiAgYXN5bmMgY29uZmlndXJhclJlbm92YWNhb1NvbGljaXRhY2FvKFxuICAgIEBQYXJhbSgnc29saWNpdGFjYW9JZCcpIHNvbGljaXRhY2FvSWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIGJvZHk6IENvbmZpZ3VyYXJSZW5vdmFjYW9Tb2xpY2l0YWNhb0R0byxcbiAgICBAUmVxKCkgcmVxOiBhbnksXG4gICk6IFByb21pc2U8U29saWNpdGFjYW8+IHtcbiAgICByZXR1cm4gdGhpcy5yZW5vdmFjYW9TZXJ2aWNlLmNvbmZpZ3VyYXJSZW5vdmFjYW9Tb2xpY2l0YWNhbyhcbiAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICBib2R5LnJlbm92YWNhb19hdXRvbWF0aWNhLFxuICAgICAgcmVxLnVzZXIuaWQsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBlIHByb2Nlc3NhIG1hbnVhbG1lbnRlIGFzIHJlbm92YcOnw7VlcyBwZW5kZW50ZXNcbiAgICogQHBhcmFtIHJlcSBSZXF1aXNpw6fDo29cbiAgICogQHJldHVybnMgTsO6bWVybyBkZSBzb2xpY2l0YcOnw7VlcyByZW5vdmFkYXNcbiAgICovXG4gIEBQb3N0KCd2ZXJpZmljYXItcGVuZGVudGVzJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnYmVuZWZpY2lvLnJlbm92YWNhby52ZXJpZmljYXInIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdWZXJpZmljYSBlIHByb2Nlc3NhIG1hbnVhbG1lbnRlIGFzIHJlbm92YcOnw7VlcyBwZW5kZW50ZXMnLFxuICAgIGRlc2NyaXB0aW9uOlxuICAgICAgJ0V4ZWN1dGEgbWFudWFsbWVudGUgbyBwcm9jZXNzbyBkZSB2ZXJpZmljYcOnw6NvIGUgcmVub3Zhw6fDo28gYXV0b23DoXRpY2EuJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ1ZlcmlmaWNhw6fDo28gY29uY2x1w61kYSBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogVmVyaWZpY2FjYW9SZW5vdmFjb2VzUGVuZGVudGVzUmVzcG9uc2VEdG8sXG4gIH0pXG4gIGFzeW5jIHZlcmlmaWNhclJlbm92YWNvZXNQZW5kZW50ZXMoXG4gICAgQFJlcSgpIHJlcTogYW55LFxuICApOiBQcm9taXNlPFZlcmlmaWNhY2FvUmVub3ZhY29lc1BlbmRlbnRlc1Jlc3BvbnNlRHRvPiB7XG4gICAgY29uc3QgcmVub3ZhY29lc1Byb2Nlc3NhZGFzID1cbiAgICAgIGF3YWl0IHRoaXMucmVub3ZhY2FvU2VydmljZS52ZXJpZmljYXJSZW5vdmFjb2VzUGVuZGVudGVzKHJlcS51c2VyLmlkKTtcbiAgICBjb25zdCByZXNwb25zZTogVmVyaWZpY2FjYW9SZW5vdmFjb2VzUGVuZGVudGVzUmVzcG9uc2VEdG8gPSB7XG4gICAgICByZW5vdmFjb2VzX3Byb2Nlc3NhZGFzOiByZW5vdmFjb2VzUHJvY2Vzc2FkYXMsXG4gICAgfTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==