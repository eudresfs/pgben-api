98b0dc875a490e94f4c105d71ef9c42f
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.FluxoBeneficio = exports.TipoEtapa = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const tipo_beneficio_entity_1 = require("./tipo-beneficio.entity");
const role_enum_1 = require("../enums/role.enum");
var TipoEtapa;
(function (TipoEtapa) {
    TipoEtapa["ABERTURA"] = "abertura";
    TipoEtapa["ANALISE_DOCUMENTOS"] = "analise_documentos";
    TipoEtapa["ANALISE_TECNICA"] = "analise_tecnica";
    TipoEtapa["APROVACAO"] = "aprovacao";
    TipoEtapa["LIBERACAO"] = "liberacao";
})(TipoEtapa || (exports.TipoEtapa = TipoEtapa = {}));
let FluxoBeneficio = class FluxoBeneficio {
    id;
    tipo_beneficio_id;
    tipo_beneficio;
    nome_etapa;
    tipo_etapa;
    ordem;
    perfil_responsavel;
    setor_id;
    descricao;
    obrigatorio;
    permite_retorno;
    created_at;
    updated_at;
    removed_at;
    // Getters e Setters
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    get removedAt() {
        return this.removed_at;
    }
    // Métodos Utilitários
    /**
     * Verifica se o fluxo foi criado recentemente (últimas 24 horas)
     */
    isCriadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.created_at > umDiaAtras;
    }
    /**
     * Calcula a idade do registro em dias
     */
    getIdadeRegistroEmDias() {
        const agora = new Date();
        const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    /**
     * Verifica se foi removido
     */
    foiRemovido() {
        return !!this.removed_at;
    }
    /**
     * Verifica se está ativo
     */
    isAtivo() {
        return !this.removed_at;
    }
    /**
     * Verifica se é obrigatório
     */
    isObrigatorio() {
        return this.obrigatorio;
    }
    /**
     * Verifica se permite retorno
     */
    permiteRetorno() {
        return this.permite_retorno;
    }
    /**
     * Verifica se tem setor definido
     */
    temSetor() {
        return this.setor_id !== null && this.setor_id !== undefined && this.setor_id.trim() !== '';
    }
    /**
     * Verifica se tem descrição
     */
    temDescricao() {
        return this.descricao !== null && this.descricao !== undefined && this.descricao.trim() !== '';
    }
    /**
     * Obtém a descrição do tipo de etapa
     */
    getDescricaoTipoEtapa() {
        const descricoes = {
            [TipoEtapa.ABERTURA]: 'Abertura da Solicitação',
            [TipoEtapa.ANALISE_DOCUMENTOS]: 'Análise de Documentos',
            [TipoEtapa.ANALISE_TECNICA]: 'Análise Técnica',
            [TipoEtapa.APROVACAO]: 'Aprovação',
            [TipoEtapa.LIBERACAO]: 'Liberação do Benefício',
        };
        return descricoes[this.tipo_etapa] || 'Tipo de etapa desconhecido';
    }
    /**
     * Obtém a descrição do perfil responsável
     */
    getDescricaoPerfilResponsavel() {
        const descricoes = {
            [role_enum_1.Role.ADMIN]: 'Administrador',
            [role_enum_1.Role.GESTOR]: 'Gestor',
            [role_enum_1.Role.TECNICO]: 'Técnico',
            [role_enum_1.Role.COORDENADOR]: 'Coordenador',
            [role_enum_1.Role.ASSISTENTE_SOCIAL]: 'Assistente Social',
            [role_enum_1.Role.AUDITOR]: 'Auditor',
        };
        return descricoes[this.perfil_responsavel] || 'Perfil desconhecido';
    }
    /**
     * Verifica se é a primeira etapa do fluxo
     */
    isPrimeiraEtapa() {
        return this.ordem === 1;
    }
    /**
     * Verifica se é uma etapa de análise
     */
    isEtapaAnalise() {
        return this.tipo_etapa === TipoEtapa.ANALISE_DOCUMENTOS ||
            this.tipo_etapa === TipoEtapa.ANALISE_TECNICA;
    }
    /**
     * Verifica se é uma etapa de decisão
     */
    isEtapaDecisao() {
        return this.tipo_etapa === TipoEtapa.APROVACAO;
    }
    /**
     * Verifica se é a etapa final
     */
    isEtapaFinal() {
        return this.tipo_etapa === TipoEtapa.LIBERACAO;
    }
    /**
     * Verifica se é uma etapa crítica (obrigatória e não permite retorno)
     */
    isEtapaCritica() {
        return this.isObrigatorio() && !this.permiteRetorno();
    }
    /**
     * Obtém o nível de criticidade da etapa
     */
    getNivelCriticidade() {
        let pontos = 0;
        if (this.isObrigatorio())
            pontos += 2;
        if (!this.permiteRetorno())
            pontos += 2;
        if (this.isEtapaDecisao() || this.isEtapaFinal())
            pontos += 1;
        if (pontos <= 2)
            return 'BAIXA';
        if (pontos <= 4)
            return 'MEDIA';
        return 'ALTA';
    }
    /**
     * Verifica se pertence a um tipo de benefício
     */
    pertenceAoTipoBeneficio(tipoBeneficioId) {
        return this.tipo_beneficio_id === tipoBeneficioId;
    }
    /**
     * Obtém um resumo da etapa
     */
    getSummary() {
        const obrigatorio = this.isObrigatorio() ? 'Obrigatória' : 'Opcional';
        const retorno = this.permiteRetorno() ? 'Permite retorno' : 'Não permite retorno';
        return `${this.ordem}. ${this.nome_etapa} (${obrigatorio}, ${retorno})`;
    }
    /**
     * Gera uma chave única para a etapa
     */
    getUniqueKey() {
        return `fluxo_${this.tipo_beneficio_id}_${this.ordem}`;
    }
    /**
     * Verifica se a etapa é consistente
     */
    isConsistente() {
        // Verifica se tem tipo de benefício
        if (!this.tipo_beneficio_id)
            return false;
        // Verifica se tem nome da etapa
        if (!this.nome_etapa || this.nome_etapa.trim() === '')
            return false;
        // Verifica se ordem é válida
        if (this.ordem < 1)
            return false;
        // Verifica se tipo de etapa é válido
        if (!Object.values(TipoEtapa).includes(this.tipo_etapa))
            return false;
        // Verifica se perfil responsável é válido
        if (!Object.values(role_enum_1.Role).includes(this.perfil_responsavel))
            return false;
        return true;
    }
    /**
     * Verifica se pode ser removida
     */
    podeSerRemovida() {
        // Não pode remover se já foi removida
        if (this.foiRemovido())
            return false;
        // Primeira etapa geralmente não pode ser removida
        if (this.isPrimeiraEtapa())
            return false;
        // Etapas obrigatórias precisam de cuidado especial
        if (this.isObrigatorio())
            return false;
        return true;
    }
    /**
     * Clona a etapa (sem ID)
     */
    clone() {
        return {
            tipo_beneficio_id: this.tipo_beneficio_id,
            nome_etapa: this.nome_etapa,
            tipo_etapa: this.tipo_etapa,
            ordem: this.ordem,
            perfil_responsavel: this.perfil_responsavel,
            setor_id: this.setor_id,
            descricao: this.descricao,
            obrigatorio: this.obrigatorio,
            permite_retorno: this.permite_retorno,
        };
    }
    /**
     * Verifica se é uma etapa flexível
     */
    isFlexivel() {
        return !this.isObrigatorio() && this.permiteRetorno();
    }
    /**
     * Formata a data de criação
     */
    getCriacaoFormatada() {
        return this.created_at.toLocaleDateString('pt-BR');
    }
    /**
     * Formata a data de atualização
     */
    getAtualizacaoFormatada() {
        return this.updated_at.toLocaleDateString('pt-BR');
    }
    /**
     * Remove informações sensíveis para logs
     */
    toSafeLog() {
        return {
            id: this.id,
            tipo_beneficio_id: this.tipo_beneficio_id,
            nome_etapa: this.nome_etapa,
            tipo_etapa: this.tipo_etapa,
            ordem: this.ordem,
            perfil_responsavel: this.perfil_responsavel,
            obrigatorio: this.obrigatorio,
            permite_retorno: this.permite_retorno,
            created_at: this.created_at,
            updated_at: this.updated_at,
        };
    }
    /**
     * Obtém sugestões de melhoria para a etapa
     */
    getSugestoesMelhoria() {
        const sugestoes = [];
        if (!this.temDescricao()) {
            sugestoes.push('Adicionar descrição detalhada da etapa');
        }
        if (!this.temSetor()) {
            sugestoes.push('Definir setor responsável pela etapa');
        }
        if (this.isEtapaCritica() && !this.temDescricao()) {
            sugestoes.push('Etapa crítica deve ter descrição detalhada');
        }
        if (this.isEtapaAnalise() && this.permiteRetorno()) {
            sugestoes.push('Considerar não permitir retorno em etapas de análise');
        }
        if (!this.isConsistente()) {
            sugestoes.push('Verificar e corrigir inconsistências nos dados');
        }
        return sugestoes;
    }
    /**
     * Verifica se precisa de atualização (dados muito antigos)
     */
    precisaAtualizacao() {
        // Fluxos com mais de 6 meses podem precisar de revisão
        const seisMesesAtras = new Date();
        seisMesesAtras.setMonth(seisMesesAtras.getMonth() - 6);
        return this.updated_at < seisMesesAtras;
    }
    /**
     * Obtém estatísticas da etapa
     */
    getEstatisticas() {
        return {
            ordem: this.ordem,
            tipoEtapa: this.getDescricaoTipoEtapa(),
            perfilResponsavel: this.getDescricaoPerfilResponsavel(),
            obrigatorio: this.isObrigatorio(),
            permiteRetorno: this.permiteRetorno(),
            nivelCriticidade: this.getNivelCriticidade(),
            temSetor: this.temSetor(),
            temDescricao: this.temDescricao(),
        };
    }
    /**
     * Simula a execução da etapa
     */
    simularExecucao(dados) {
        const motivos = [];
        const observacoes = [];
        // Verifica se o perfil do usuário pode executar a etapa
        if (dados.perfilUsuario !== this.perfil_responsavel) {
            motivos.push(`Perfil ${dados.perfilUsuario} não autorizado. Requer: ${this.perfil_responsavel}`);
        }
        // Verifica se o setor do usuário corresponde (se definido)
        if (this.temSetor() && dados.setorUsuario !== this.setor_id) {
            motivos.push('Usuário não pertence ao setor responsável pela etapa');
        }
        // Observações sobre a etapa
        if (this.isObrigatorio()) {
            observacoes.push('Esta é uma etapa obrigatória');
        }
        if (!this.permiteRetorno()) {
            observacoes.push('Atenção: Esta etapa não permite retorno');
        }
        if (this.isEtapaFinal()) {
            observacoes.push('Esta é a etapa final do processo');
        }
        return {
            podeExecutar: motivos.length === 0,
            motivos,
            observacoes,
        };
    }
};
exports.FluxoBeneficio = FluxoBeneficio;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'Tipo de benefício é obrigatório' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "tipo_beneficio_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => tipo_beneficio_entity_1.TipoBeneficio, (tipoBeneficio) => tipoBeneficio.id, {
        onDelete: 'CASCADE',
    }),
    (0, typeorm_1.JoinColumn)({ name: 'tipo_beneficio_id' }),
    __metadata("design:type", typeof (_a = typeof tipo_beneficio_entity_1.TipoBeneficio !== "undefined" && tipo_beneficio_entity_1.TipoBeneficio) === "function" ? _a : Object)
], FluxoBeneficio.prototype, "tipo_beneficio", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'Nome da etapa é obrigatório' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "nome_etapa", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: TipoEtapa,
        enumName: 'tipo_etapa',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Tipo de etapa é obrigatório' }),
    (0, class_validator_1.IsEnum)(TipoEtapa, { message: 'Tipo de etapa inválido' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "tipo_etapa", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNumber)({}, { message: 'Ordem deve ser um número' }),
    (0, class_validator_1.Min)(1, { message: 'Ordem deve ser maior que zero' }),
    __metadata("design:type", Number)
], FluxoBeneficio.prototype, "ordem", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: role_enum_1.Role,
        enumName: 'perfil_responsavel',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Perfil responsável é obrigatório' }),
    (0, class_validator_1.IsEnum)(role_enum_1.Role, { message: 'Perfil responsável inválido' }),
    __metadata("design:type", typeof (_b = typeof role_enum_1.Role !== "undefined" && role_enum_1.Role) === "function" ? _b : Object)
], FluxoBeneficio.prototype, "perfil_responsavel", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "setor_id", void 0);
__decorate([
    (0, typeorm_1.Column)('text', { nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "descricao", void 0);
__decorate([
    (0, typeorm_1.Column)({ default: true }),
    __metadata("design:type", Boolean)
], FluxoBeneficio.prototype, "obrigatorio", void 0);
__decorate([
    (0, typeorm_1.Column)({ default: false }),
    __metadata("design:type", Boolean)
], FluxoBeneficio.prototype, "permite_retorno", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)(),
    __metadata("design:type", typeof (_c = typeof Date !== "undefined" && Date) === "function" ? _c : Object)
], FluxoBeneficio.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)(),
    __metadata("design:type", typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object)
], FluxoBeneficio.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.DeleteDateColumn)(),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], FluxoBeneficio.prototype, "removed_at", void 0);
exports.FluxoBeneficio = FluxoBeneficio = __decorate([
    (0, typeorm_1.Entity)('fluxo_beneficio'),
    (0, typeorm_1.Index)(['tipo_beneficio_id', 'ordem'], { unique: true })
], FluxoBeneficio);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxmbHV4by1iZW5lZmljaW8uZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FVaUI7QUFDakIscURBQWdGO0FBQ2hGLG1FQUF3RDtBQUN4RCxrREFBeUM7QUFFekMsSUFBWSxTQU1YO0FBTkQsV0FBWSxTQUFTO0lBQ25CLGtDQUFxQixDQUFBO0lBQ3JCLHNEQUF5QyxDQUFBO0lBQ3pDLGdEQUFtQyxDQUFBO0lBQ25DLG9DQUF1QixDQUFBO0lBQ3ZCLG9DQUF1QixDQUFBO0FBQ3pCLENBQUMsRUFOVyxTQUFTLHlCQUFULFNBQVMsUUFNcEI7QUFJTSxJQUFNLGNBQWMsR0FBcEIsTUFBTSxjQUFjO0lBRXpCLEVBQUUsQ0FBUztJQUlYLGlCQUFpQixDQUFTO0lBTTFCLGNBQWMsQ0FBZ0I7SUFJOUIsVUFBVSxDQUFTO0lBU25CLFVBQVUsQ0FBWTtJQUt0QixLQUFLLENBQVM7SUFTZCxrQkFBa0IsQ0FBTztJQUl6QixRQUFRLENBQVM7SUFJakIsU0FBUyxDQUFTO0lBR2xCLFdBQVcsQ0FBVTtJQUdyQixlQUFlLENBQVU7SUFHekIsVUFBVSxDQUFPO0lBR2pCLFVBQVUsQ0FBTztJQUdqQixVQUFVLENBQU87SUFFakIsb0JBQW9CO0lBQ3BCLElBQUksU0FBUztRQUNYLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN6QixDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVELHNCQUFzQjtJQUV0Qjs7T0FFRztJQUNILG9CQUFvQjtRQUNsQixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksSUFB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QUNGO0FBR3pCO0lBREMsSUFBQSwwQkFBZ0IsR0FBRTtrREFDUCxJQUFJLG9CQUFKLElBQUk7a0RBQUM7QUFHakI7SUFEQyxJQUFBLDBCQUFnQixHQUFFO2tEQUNQLElBQUksb0JBQUosSUFBSTtrREFBQztBQUdqQjtJQURDLElBQUEsMEJBQWdCLEdBQUU7a0RBQ1AsSUFBSSxvQkFBSixJQUFJO2tEQUFDO3lCQTlETixjQUFjO0lBRjFCLElBQUEsZ0JBQU0sRUFBQyxpQkFBaUIsQ0FBQztJQUN6QixJQUFBLGVBQUssRUFBQyxDQUFDLG1CQUFtQixFQUFFLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDO0dBQzNDLGNBQWMsQ0EyYjFCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxlbnRpdGllc1xcZmx1eG8tYmVuZWZpY2lvLmVudGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbnRpdHksXG4gIFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4sXG4gIENvbHVtbixcbiAgQ3JlYXRlRGF0ZUNvbHVtbixcbiAgVXBkYXRlRGF0ZUNvbHVtbixcbiAgRGVsZXRlRGF0ZUNvbHVtbixcbiAgTWFueVRvT25lLFxuICBKb2luQ29sdW1uLFxuICBJbmRleCxcbn0gZnJvbSAndHlwZW9ybSc7XG5pbXBvcnQgeyBJc05vdEVtcHR5LCBJc09wdGlvbmFsLCBJc051bWJlciwgTWluLCBJc0VudW0gfSBmcm9tICdjbGFzcy12YWxpZGF0b3InO1xuaW1wb3J0IHsgVGlwb0JlbmVmaWNpbyB9IGZyb20gJy4vdGlwby1iZW5lZmljaW8uZW50aXR5JztcbmltcG9ydCB7IFJvbGUgfSBmcm9tICcuLi9lbnVtcy9yb2xlLmVudW0nXG5cbmV4cG9ydCBlbnVtIFRpcG9FdGFwYSB7XG4gIEFCRVJUVVJBID0gJ2FiZXJ0dXJhJyxcbiAgQU5BTElTRV9ET0NVTUVOVE9TID0gJ2FuYWxpc2VfZG9jdW1lbnRvcycsXG4gIEFOQUxJU0VfVEVDTklDQSA9ICdhbmFsaXNlX3RlY25pY2EnLFxuICBBUFJPVkFDQU8gPSAnYXByb3ZhY2FvJyxcbiAgTElCRVJBQ0FPID0gJ2xpYmVyYWNhbycsXG59XG5cbkBFbnRpdHkoJ2ZsdXhvX2JlbmVmaWNpbycpXG5ASW5kZXgoWyd0aXBvX2JlbmVmaWNpb19pZCcsICdvcmRlbSddLCB7IHVuaXF1ZTogdHJ1ZSB9KVxuZXhwb3J0IGNsYXNzIEZsdXhvQmVuZWZpY2lvIHtcbiAgQFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4oJ3V1aWQnKVxuICBpZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oKVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdUaXBvIGRlIGJlbmVmw61jaW8gw6kgb2JyaWdhdMOzcmlvJyB9KVxuICB0aXBvX2JlbmVmaWNpb19pZDogc3RyaW5nO1xuXG4gIEBNYW55VG9PbmUoKCkgPT4gVGlwb0JlbmVmaWNpbywgKHRpcG9CZW5lZmljaW8pID0+IHRpcG9CZW5lZmljaW8uaWQsIHtcbiAgICBvbkRlbGV0ZTogJ0NBU0NBREUnLFxuICB9KVxuICBASm9pbkNvbHVtbih7IG5hbWU6ICd0aXBvX2JlbmVmaWNpb19pZCcgfSlcbiAgdGlwb19iZW5lZmljaW86IFRpcG9CZW5lZmljaW87XG5cbiAgQENvbHVtbigpXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ05vbWUgZGEgZXRhcGEgw6kgb2JyaWdhdMOzcmlvJyB9KVxuICBub21lX2V0YXBhOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7XG4gICAgdHlwZTogJ2VudW0nLFxuICAgIGVudW06IFRpcG9FdGFwYSxcbiAgICBlbnVtTmFtZTogJ3RpcG9fZXRhcGEnLFxuICB9KVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdUaXBvIGRlIGV0YXBhIMOpIG9icmlnYXTDs3JpbycgfSlcbiAgQElzRW51bShUaXBvRXRhcGEsIHsgbWVzc2FnZTogJ1RpcG8gZGUgZXRhcGEgaW52w6FsaWRvJyB9KVxuICB0aXBvX2V0YXBhOiBUaXBvRXRhcGE7XG5cbiAgQENvbHVtbigpXG4gIEBJc051bWJlcih7fSwgeyBtZXNzYWdlOiAnT3JkZW0gZGV2ZSBzZXIgdW0gbsO6bWVybycgfSlcbiAgQE1pbigxLCB7IG1lc3NhZ2U6ICdPcmRlbSBkZXZlIHNlciBtYWlvciBxdWUgemVybycgfSlcbiAgb3JkZW06IG51bWJlcjtcblxuICBAQ29sdW1uKHtcbiAgICB0eXBlOiAnZW51bScsXG4gICAgZW51bTogUm9sZSxcbiAgICBlbnVtTmFtZTogJ3BlcmZpbF9yZXNwb25zYXZlbCcsXG4gIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ1BlcmZpbCByZXNwb25zw6F2ZWwgw6kgb2JyaWdhdMOzcmlvJyB9KVxuICBASXNFbnVtKFJvbGUsIHsgbWVzc2FnZTogJ1BlcmZpbCByZXNwb25zw6F2ZWwgaW52w6FsaWRvJyB9KVxuICBwZXJmaWxfcmVzcG9uc2F2ZWw6IFJvbGU7XG5cbiAgQENvbHVtbih7IG51bGxhYmxlOiB0cnVlIH0pXG4gIEBJc09wdGlvbmFsKClcbiAgc2V0b3JfaWQ6IHN0cmluZztcblxuICBAQ29sdW1uKCd0ZXh0JywgeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIGRlc2NyaWNhbzogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyBkZWZhdWx0OiB0cnVlIH0pXG4gIG9icmlnYXRvcmlvOiBib29sZWFuO1xuXG4gIEBDb2x1bW4oeyBkZWZhdWx0OiBmYWxzZSB9KVxuICBwZXJtaXRlX3JldG9ybm86IGJvb2xlYW47XG5cbiAgQENyZWF0ZURhdGVDb2x1bW4oKVxuICBjcmVhdGVkX2F0OiBEYXRlO1xuXG4gIEBVcGRhdGVEYXRlQ29sdW1uKClcbiAgdXBkYXRlZF9hdDogRGF0ZTtcblxuICBARGVsZXRlRGF0ZUNvbHVtbigpXG4gIHJlbW92ZWRfYXQ6IERhdGU7XG5cbiAgLy8gR2V0dGVycyBlIFNldHRlcnNcbiAgZ2V0IGNyZWF0ZWRBdCgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0O1xuICB9XG5cbiAgZ2V0IHVwZGF0ZWRBdCgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0O1xuICB9XG5cbiAgZ2V0IHJlbW92ZWRBdCgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5yZW1vdmVkX2F0O1xuICB9XG5cbiAgLy8gTcOpdG9kb3MgVXRpbGl0w6FyaW9zXG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZmx1eG8gZm9pIGNyaWFkbyByZWNlbnRlbWVudGUgKMO6bHRpbWFzIDI0IGhvcmFzKVxuICAgKi9cbiAgaXNDcmlhZG9SZWNlbnRlbWVudGUoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYWdvcmEgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHVtRGlhQXRyYXMgPSBuZXcgRGF0ZShhZ29yYS5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0ID4gdW1EaWFBdHJhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGEgaWRhZGUgZG8gcmVnaXN0cm8gZW0gZGlhc1xuICAgKi9cbiAgZ2V0SWRhZGVSZWdpc3Ryb0VtRGlhcygpOiBudW1iZXIge1xuICAgIGNvbnN0IGFnb3JhID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBkaWZmVGltZSA9IE1hdGguYWJzKGFnb3JhLmdldFRpbWUoKSAtIHRoaXMuY3JlYXRlZF9hdC5nZXRUaW1lKCkpO1xuICAgIHJldHVybiBNYXRoLmNlaWwoZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGZvaSByZW1vdmlkb1xuICAgKi9cbiAgZm9pUmVtb3ZpZG8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5yZW1vdmVkX2F0O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGVzdMOhIGF0aXZvXG4gICAqL1xuICBpc0F0aXZvKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5yZW1vdmVkX2F0O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIG9icmlnYXTDs3Jpb1xuICAgKi9cbiAgaXNPYnJpZ2F0b3JpbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5vYnJpZ2F0b3JpbztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBwZXJtaXRlIHJldG9ybm9cbiAgICovXG4gIHBlcm1pdGVSZXRvcm5vKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnBlcm1pdGVfcmV0b3JubztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSB0ZW0gc2V0b3IgZGVmaW5pZG9cbiAgICovXG4gIHRlbVNldG9yKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNldG9yX2lkICE9PSBudWxsICYmIHRoaXMuc2V0b3JfaWQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNldG9yX2lkLnRyaW0oKSAhPT0gJyc7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgdGVtIGRlc2NyacOnw6NvXG4gICAqL1xuICB0ZW1EZXNjcmljYW8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZGVzY3JpY2FvICE9PSBudWxsICYmIHRoaXMuZGVzY3JpY2FvICE9PSB1bmRlZmluZWQgJiYgdGhpcy5kZXNjcmljYW8udHJpbSgpICE9PSAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gYSBkZXNjcmnDp8OjbyBkbyB0aXBvIGRlIGV0YXBhXG4gICAqL1xuICBnZXREZXNjcmljYW9UaXBvRXRhcGEoKTogc3RyaW5nIHtcbiAgICBjb25zdCBkZXNjcmljb2VzID0ge1xuICAgICAgW1RpcG9FdGFwYS5BQkVSVFVSQV06ICdBYmVydHVyYSBkYSBTb2xpY2l0YcOnw6NvJyxcbiAgICAgIFtUaXBvRXRhcGEuQU5BTElTRV9ET0NVTUVOVE9TXTogJ0Fuw6FsaXNlIGRlIERvY3VtZW50b3MnLFxuICAgICAgW1RpcG9FdGFwYS5BTkFMSVNFX1RFQ05JQ0FdOiAnQW7DoWxpc2UgVMOpY25pY2EnLFxuICAgICAgW1RpcG9FdGFwYS5BUFJPVkFDQU9dOiAnQXByb3Zhw6fDo28nLFxuICAgICAgW1RpcG9FdGFwYS5MSUJFUkFDQU9dOiAnTGliZXJhw6fDo28gZG8gQmVuZWbDrWNpbycsXG4gICAgfTtcbiAgICByZXR1cm4gZGVzY3JpY29lc1t0aGlzLnRpcG9fZXRhcGFdIHx8ICdUaXBvIGRlIGV0YXBhIGRlc2NvbmhlY2lkbyc7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIGEgZGVzY3Jpw6fDo28gZG8gcGVyZmlsIHJlc3BvbnPDoXZlbFxuICAgKi9cbiAgZ2V0RGVzY3JpY2FvUGVyZmlsUmVzcG9uc2F2ZWwoKTogc3RyaW5nIHtcbiAgICBjb25zdCBkZXNjcmljb2VzID0ge1xuICAgICAgW1JvbGUuQURNSU5dOiAnQWRtaW5pc3RyYWRvcicsXG4gICAgICBbUm9sZS5HRVNUT1JdOiAnR2VzdG9yJyxcbiAgICAgIFtSb2xlLlRFQ05JQ09dOiAnVMOpY25pY28nLFxuICAgICAgW1JvbGUuQ09PUkRFTkFET1JdOiAnQ29vcmRlbmFkb3InLFxuICAgICAgW1JvbGUuQVNTSVNURU5URV9TT0NJQUxdOiAnQXNzaXN0ZW50ZSBTb2NpYWwnLFxuICAgICAgW1JvbGUuQVVESVRPUl06ICdBdWRpdG9yJyxcbiAgICB9O1xuICAgIHJldHVybiBkZXNjcmljb2VzW3RoaXMucGVyZmlsX3Jlc3BvbnNhdmVsIGFzIGtleW9mIHR5cGVvZiBkZXNjcmljb2VzXSB8fCAnUGVyZmlsIGRlc2NvbmhlY2lkbyc7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgYSBwcmltZWlyYSBldGFwYSBkbyBmbHV4b1xuICAgKi9cbiAgaXNQcmltZWlyYUV0YXBhKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm9yZGVtID09PSAxO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIHVtYSBldGFwYSBkZSBhbsOhbGlzZVxuICAgKi9cbiAgaXNFdGFwYUFuYWxpc2UoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19ldGFwYSA9PT0gVGlwb0V0YXBhLkFOQUxJU0VfRE9DVU1FTlRPUyB8fCBcbiAgICAgICAgICAgdGhpcy50aXBvX2V0YXBhID09PSBUaXBvRXRhcGEuQU5BTElTRV9URUNOSUNBO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIHVtYSBldGFwYSBkZSBkZWNpc8Ojb1xuICAgKi9cbiAgaXNFdGFwYURlY2lzYW8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19ldGFwYSA9PT0gVGlwb0V0YXBhLkFQUk9WQUNBTztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSBhIGV0YXBhIGZpbmFsXG4gICAqL1xuICBpc0V0YXBhRmluYWwoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19ldGFwYSA9PT0gVGlwb0V0YXBhLkxJQkVSQUNBTztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSB1bWEgZXRhcGEgY3LDrXRpY2EgKG9icmlnYXTDs3JpYSBlIG7Do28gcGVybWl0ZSByZXRvcm5vKVxuICAgKi9cbiAgaXNFdGFwYUNyaXRpY2EoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNPYnJpZ2F0b3JpbygpICYmICF0aGlzLnBlcm1pdGVSZXRvcm5vKCk7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIG8gbsOtdmVsIGRlIGNyaXRpY2lkYWRlIGRhIGV0YXBhXG4gICAqL1xuICBnZXROaXZlbENyaXRpY2lkYWRlKCk6ICdCQUlYQScgfCAnTUVESUEnIHwgJ0FMVEEnIHtcbiAgICBsZXQgcG9udG9zID0gMDtcbiAgICBcbiAgICBpZiAodGhpcy5pc09icmlnYXRvcmlvKCkpIHBvbnRvcyArPSAyO1xuICAgIGlmICghdGhpcy5wZXJtaXRlUmV0b3JubygpKSBwb250b3MgKz0gMjtcbiAgICBpZiAodGhpcy5pc0V0YXBhRGVjaXNhbygpIHx8IHRoaXMuaXNFdGFwYUZpbmFsKCkpIHBvbnRvcyArPSAxO1xuICAgIFxuICAgIGlmIChwb250b3MgPD0gMikgcmV0dXJuICdCQUlYQSc7XG4gICAgaWYgKHBvbnRvcyA8PSA0KSByZXR1cm4gJ01FRElBJztcbiAgICByZXR1cm4gJ0FMVEEnO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBlcnRlbmNlIGEgdW0gdGlwbyBkZSBiZW5lZsOtY2lvXG4gICAqL1xuICBwZXJ0ZW5jZUFvVGlwb0JlbmVmaWNpbyh0aXBvQmVuZWZpY2lvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkID09PSB0aXBvQmVuZWZpY2lvSWQ7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIHVtIHJlc3VtbyBkYSBldGFwYVxuICAgKi9cbiAgZ2V0U3VtbWFyeSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IG9icmlnYXRvcmlvID0gdGhpcy5pc09icmlnYXRvcmlvKCkgPyAnT2JyaWdhdMOzcmlhJyA6ICdPcGNpb25hbCc7XG4gICAgY29uc3QgcmV0b3JubyA9IHRoaXMucGVybWl0ZVJldG9ybm8oKSA/ICdQZXJtaXRlIHJldG9ybm8nIDogJ07Do28gcGVybWl0ZSByZXRvcm5vJztcbiAgICByZXR1cm4gYCR7dGhpcy5vcmRlbX0uICR7dGhpcy5ub21lX2V0YXBhfSAoJHtvYnJpZ2F0b3Jpb30sICR7cmV0b3Jub30pYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXJhIHVtYSBjaGF2ZSDDum5pY2EgcGFyYSBhIGV0YXBhXG4gICAqL1xuICBnZXRVbmlxdWVLZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGZsdXhvXyR7dGhpcy50aXBvX2JlbmVmaWNpb19pZH1fJHt0aGlzLm9yZGVtfWA7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBldGFwYSDDqSBjb25zaXN0ZW50ZVxuICAgKi9cbiAgaXNDb25zaXN0ZW50ZSgpOiBib29sZWFuIHtcbiAgICAvLyBWZXJpZmljYSBzZSB0ZW0gdGlwbyBkZSBiZW5lZsOtY2lvXG4gICAgaWYgKCF0aGlzLnRpcG9fYmVuZWZpY2lvX2lkKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gVmVyaWZpY2Egc2UgdGVtIG5vbWUgZGEgZXRhcGFcbiAgICBpZiAoIXRoaXMubm9tZV9ldGFwYSB8fCB0aGlzLm5vbWVfZXRhcGEudHJpbSgpID09PSAnJykgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIFZlcmlmaWNhIHNlIG9yZGVtIMOpIHbDoWxpZGFcbiAgICBpZiAodGhpcy5vcmRlbSA8IDEpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAvLyBWZXJpZmljYSBzZSB0aXBvIGRlIGV0YXBhIMOpIHbDoWxpZG9cbiAgICBpZiAoIU9iamVjdC52YWx1ZXMoVGlwb0V0YXBhKS5pbmNsdWRlcyh0aGlzLnRpcG9fZXRhcGEpKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gVmVyaWZpY2Egc2UgcGVyZmlsIHJlc3BvbnPDoXZlbCDDqSB2w6FsaWRvXG4gICAgaWYgKCFPYmplY3QudmFsdWVzKFJvbGUpLmluY2x1ZGVzKHRoaXMucGVyZmlsX3Jlc3BvbnNhdmVsKSkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBvZGUgc2VyIHJlbW92aWRhXG4gICAqL1xuICBwb2RlU2VyUmVtb3ZpZGEoKTogYm9vbGVhbiB7XG4gICAgLy8gTsOjbyBwb2RlIHJlbW92ZXIgc2UgasOhIGZvaSByZW1vdmlkYVxuICAgIGlmICh0aGlzLmZvaVJlbW92aWRvKCkpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAvLyBQcmltZWlyYSBldGFwYSBnZXJhbG1lbnRlIG7Do28gcG9kZSBzZXIgcmVtb3ZpZGFcbiAgICBpZiAodGhpcy5pc1ByaW1laXJhRXRhcGEoKSkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIEV0YXBhcyBvYnJpZ2F0w7NyaWFzIHByZWNpc2FtIGRlIGN1aWRhZG8gZXNwZWNpYWxcbiAgICBpZiAodGhpcy5pc09icmlnYXRvcmlvKCkpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9uYSBhIGV0YXBhIChzZW0gSUQpXG4gICAqL1xuICBjbG9uZSgpOiBQYXJ0aWFsPEZsdXhvQmVuZWZpY2lvPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpcG9fYmVuZWZpY2lvX2lkOiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkLFxuICAgICAgbm9tZV9ldGFwYTogdGhpcy5ub21lX2V0YXBhLFxuICAgICAgdGlwb19ldGFwYTogdGhpcy50aXBvX2V0YXBhLFxuICAgICAgb3JkZW06IHRoaXMub3JkZW0sXG4gICAgICBwZXJmaWxfcmVzcG9uc2F2ZWw6IHRoaXMucGVyZmlsX3Jlc3BvbnNhdmVsLFxuICAgICAgc2V0b3JfaWQ6IHRoaXMuc2V0b3JfaWQsXG4gICAgICBkZXNjcmljYW86IHRoaXMuZGVzY3JpY2FvLFxuICAgICAgb2JyaWdhdG9yaW86IHRoaXMub2JyaWdhdG9yaW8sXG4gICAgICBwZXJtaXRlX3JldG9ybm86IHRoaXMucGVybWl0ZV9yZXRvcm5vLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIGV0YXBhIGZsZXjDrXZlbFxuICAgKi9cbiAgaXNGbGV4aXZlbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMuaXNPYnJpZ2F0b3JpbygpICYmIHRoaXMucGVybWl0ZVJldG9ybm8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRhIGEgZGF0YSBkZSBjcmlhw6fDo29cbiAgICovXG4gIGdldENyaWFjYW9Gb3JtYXRhZGEoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0LnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRhIGEgZGF0YSBkZSBhdHVhbGl6YcOnw6NvXG4gICAqL1xuICBnZXRBdHVhbGl6YWNhb0Zvcm1hdGFkYSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZWRfYXQudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBpbmZvcm1hw6fDtWVzIHNlbnPDrXZlaXMgcGFyYSBsb2dzXG4gICAqL1xuICB0b1NhZmVMb2coKTogUGFydGlhbDxGbHV4b0JlbmVmaWNpbz4ge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCxcbiAgICAgIHRpcG9fYmVuZWZpY2lvX2lkOiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkLFxuICAgICAgbm9tZV9ldGFwYTogdGhpcy5ub21lX2V0YXBhLFxuICAgICAgdGlwb19ldGFwYTogdGhpcy50aXBvX2V0YXBhLFxuICAgICAgb3JkZW06IHRoaXMub3JkZW0sXG4gICAgICBwZXJmaWxfcmVzcG9uc2F2ZWw6IHRoaXMucGVyZmlsX3Jlc3BvbnNhdmVsLFxuICAgICAgb2JyaWdhdG9yaW86IHRoaXMub2JyaWdhdG9yaW8sXG4gICAgICBwZXJtaXRlX3JldG9ybm86IHRoaXMucGVybWl0ZV9yZXRvcm5vLFxuICAgICAgY3JlYXRlZF9hdDogdGhpcy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogdGhpcy51cGRhdGVkX2F0LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIHN1Z2VzdMO1ZXMgZGUgbWVsaG9yaWEgcGFyYSBhIGV0YXBhXG4gICAqL1xuICBnZXRTdWdlc3RvZXNNZWxob3JpYSgpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc3VnZXN0b2VzOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIGlmICghdGhpcy50ZW1EZXNjcmljYW8oKSkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ0FkaWNpb25hciBkZXNjcmnDp8OjbyBkZXRhbGhhZGEgZGEgZXRhcGEnKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCF0aGlzLnRlbVNldG9yKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdEZWZpbmlyIHNldG9yIHJlc3BvbnPDoXZlbCBwZWxhIGV0YXBhJyk7XG4gICAgfVxuICAgIFxuICAgIGlmICh0aGlzLmlzRXRhcGFDcml0aWNhKCkgJiYgIXRoaXMudGVtRGVzY3JpY2FvKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdFdGFwYSBjcsOtdGljYSBkZXZlIHRlciBkZXNjcmnDp8OjbyBkZXRhbGhhZGEnKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHRoaXMuaXNFdGFwYUFuYWxpc2UoKSAmJiB0aGlzLnBlcm1pdGVSZXRvcm5vKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdDb25zaWRlcmFyIG7Do28gcGVybWl0aXIgcmV0b3JubyBlbSBldGFwYXMgZGUgYW7DoWxpc2UnKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCF0aGlzLmlzQ29uc2lzdGVudGUoKSkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ1ZlcmlmaWNhciBlIGNvcnJpZ2lyIGluY29uc2lzdMOqbmNpYXMgbm9zIGRhZG9zJyk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzdWdlc3RvZXM7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgcHJlY2lzYSBkZSBhdHVhbGl6YcOnw6NvIChkYWRvcyBtdWl0byBhbnRpZ29zKVxuICAgKi9cbiAgcHJlY2lzYUF0dWFsaXphY2FvKCk6IGJvb2xlYW4ge1xuICAgIC8vIEZsdXhvcyBjb20gbWFpcyBkZSA2IG1lc2VzIHBvZGVtIHByZWNpc2FyIGRlIHJldmlzw6NvXG4gICAgY29uc3Qgc2Vpc01lc2VzQXRyYXMgPSBuZXcgRGF0ZSgpO1xuICAgIHNlaXNNZXNlc0F0cmFzLnNldE1vbnRoKHNlaXNNZXNlc0F0cmFzLmdldE1vbnRoKCkgLSA2KTtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0IDwgc2Vpc01lc2VzQXRyYXM7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIGVzdGF0w61zdGljYXMgZGEgZXRhcGFcbiAgICovXG4gIGdldEVzdGF0aXN0aWNhcygpOiB7XG4gICAgb3JkZW06IG51bWJlcjtcbiAgICB0aXBvRXRhcGE6IHN0cmluZztcbiAgICBwZXJmaWxSZXNwb25zYXZlbDogc3RyaW5nO1xuICAgIG9icmlnYXRvcmlvOiBib29sZWFuO1xuICAgIHBlcm1pdGVSZXRvcm5vOiBib29sZWFuO1xuICAgIG5pdmVsQ3JpdGljaWRhZGU6IHN0cmluZztcbiAgICB0ZW1TZXRvcjogYm9vbGVhbjtcbiAgICB0ZW1EZXNjcmljYW86IGJvb2xlYW47XG4gIH0ge1xuICAgIHJldHVybiB7XG4gICAgICBvcmRlbTogdGhpcy5vcmRlbSxcbiAgICAgIHRpcG9FdGFwYTogdGhpcy5nZXREZXNjcmljYW9UaXBvRXRhcGEoKSxcbiAgICAgIHBlcmZpbFJlc3BvbnNhdmVsOiB0aGlzLmdldERlc2NyaWNhb1BlcmZpbFJlc3BvbnNhdmVsKCksXG4gICAgICBvYnJpZ2F0b3JpbzogdGhpcy5pc09icmlnYXRvcmlvKCksXG4gICAgICBwZXJtaXRlUmV0b3JubzogdGhpcy5wZXJtaXRlUmV0b3JubygpLFxuICAgICAgbml2ZWxDcml0aWNpZGFkZTogdGhpcy5nZXROaXZlbENyaXRpY2lkYWRlKCksXG4gICAgICB0ZW1TZXRvcjogdGhpcy50ZW1TZXRvcigpLFxuICAgICAgdGVtRGVzY3JpY2FvOiB0aGlzLnRlbURlc2NyaWNhbygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU2ltdWxhIGEgZXhlY3XDp8OjbyBkYSBldGFwYVxuICAgKi9cbiAgc2ltdWxhckV4ZWN1Y2FvKGRhZG9zOiB7XG4gICAgcGVyZmlsVXN1YXJpbzogUm9sZTtcbiAgICBzZXRvclVzdWFyaW8/OiBzdHJpbmc7XG4gIH0pOiB7XG4gICAgcG9kZUV4ZWN1dGFyOiBib29sZWFuO1xuICAgIG1vdGl2b3M6IHN0cmluZ1tdO1xuICAgIG9ic2VydmFjb2VzOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3QgbW90aXZvczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBvYnNlcnZhY29lczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICAvLyBWZXJpZmljYSBzZSBvIHBlcmZpbCBkbyB1c3XDoXJpbyBwb2RlIGV4ZWN1dGFyIGEgZXRhcGFcbiAgICBpZiAoZGFkb3MucGVyZmlsVXN1YXJpbyAhPT0gdGhpcy5wZXJmaWxfcmVzcG9uc2F2ZWwpIHtcbiAgICAgIG1vdGl2b3MucHVzaChgUGVyZmlsICR7ZGFkb3MucGVyZmlsVXN1YXJpb30gbsOjbyBhdXRvcml6YWRvLiBSZXF1ZXI6ICR7dGhpcy5wZXJmaWxfcmVzcG9uc2F2ZWx9YCk7XG4gICAgfVxuICAgIFxuICAgIC8vIFZlcmlmaWNhIHNlIG8gc2V0b3IgZG8gdXN1w6FyaW8gY29ycmVzcG9uZGUgKHNlIGRlZmluaWRvKVxuICAgIGlmICh0aGlzLnRlbVNldG9yKCkgJiYgZGFkb3Muc2V0b3JVc3VhcmlvICE9PSB0aGlzLnNldG9yX2lkKSB7XG4gICAgICBtb3Rpdm9zLnB1c2goJ1VzdcOhcmlvIG7Do28gcGVydGVuY2UgYW8gc2V0b3IgcmVzcG9uc8OhdmVsIHBlbGEgZXRhcGEnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gT2JzZXJ2YcOnw7VlcyBzb2JyZSBhIGV0YXBhXG4gICAgaWYgKHRoaXMuaXNPYnJpZ2F0b3JpbygpKSB7XG4gICAgICBvYnNlcnZhY29lcy5wdXNoKCdFc3RhIMOpIHVtYSBldGFwYSBvYnJpZ2F0w7NyaWEnKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCF0aGlzLnBlcm1pdGVSZXRvcm5vKCkpIHtcbiAgICAgIG9ic2VydmFjb2VzLnB1c2goJ0F0ZW7Dp8OjbzogRXN0YSBldGFwYSBuw6NvIHBlcm1pdGUgcmV0b3JubycpO1xuICAgIH1cbiAgICBcbiAgICBpZiAodGhpcy5pc0V0YXBhRmluYWwoKSkge1xuICAgICAgb2JzZXJ2YWNvZXMucHVzaCgnRXN0YSDDqSBhIGV0YXBhIGZpbmFsIGRvIHByb2Nlc3NvJyk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBwb2RlRXhlY3V0YXI6IG1vdGl2b3MubGVuZ3RoID09PSAwLFxuICAgICAgbW90aXZvcyxcbiAgICAgIG9ic2VydmFjb2VzLFxuICAgIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==