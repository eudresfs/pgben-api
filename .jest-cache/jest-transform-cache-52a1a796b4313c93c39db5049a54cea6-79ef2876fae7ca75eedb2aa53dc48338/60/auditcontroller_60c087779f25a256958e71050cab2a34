2ed9df52bdc1d4cd64ff219c1ca3f32b
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuditController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const throttler_1 = require("@nestjs/throttler");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const roles_guard_1 = require("../../auth/guards/roles.guard");
const role_decorator_1 = require("../../auth/decorators/role.decorator");
const get_user_decorator_1 = require("../../auth/decorators/get-user.decorator");
const get_client_info_decorator_1 = require("../../common/decorators/get-client-info.decorator");
const audit_service_1 = require("../services/audit.service");
const audit_log_dto_1 = require("../dto/audit-log.dto");
const usuario_entity_1 = require("../../entities/usuario.entity");
const client_info_interface_1 = require("../../common/interfaces/client-info.interface");
let AuditController = class AuditController {
    auditService;
    constructor(auditService) {
        this.auditService = auditService;
    }
    async createLog(createAuditLogDto, user, clientInfo) {
        // Adiciona informações do cliente se não fornecidas
        const logData = {
            ...createAuditLogDto,
            client_ip: createAuditLogDto.client_ip || clientInfo.ip,
            user_agent: createAuditLogDto.user_agent || clientInfo.userAgent,
        };
        const log = await this.auditService.createLog(logData);
        return this.mapToResponseDto(log);
    }
    async findLogs(queryDto) {
        return await this.auditService.findLogs(queryDto);
    }
    async findLogById(id) {
        return await this.auditService.findLogById(id);
    }
    async getStats(startDate, endDate) {
        const start = startDate ? new Date(startDate) : undefined;
        const end = endDate ? new Date(endDate) : undefined;
        return await this.auditService.getStats(start, end);
    }
    async manualCleanup(user, clientInfo) {
        // Log da ação administrativa
        await this.auditService.logUserAction(user.id, 'SYSTEM_CONFIG', 'AuditLog', undefined, 'Limpeza manual de logs executada', { action: 'manual_cleanup' }, {
            ip: clientInfo.ip,
            userAgent: clientInfo.userAgent,
            method: 'POST',
            url: '/api/audit/cleanup',
        });
        await this.auditService.cleanupOldLogs();
        return {
            message: 'Limpeza de logs executada com sucesso',
            timestamp: new Date().toISOString(),
        };
    }
    async getSecurityEvents() {
        const endDate = new Date();
        const startDate = new Date(endDate.getTime() - 24 * 60 * 60 * 1000); // 24h atrás
        const result = await this.auditService.findLogs({
            start_date: startDate.toISOString(),
            end_date: endDate.toISOString(),
            security_events_only: true,
            sort_by: 'created_at',
            sort_order: 'DESC',
            limit: 100,
        });
        return {
            data: result.data,
            total: result.total,
        };
    }
    async getCriticalEvents() {
        const endDate = new Date();
        const startDate = new Date(endDate.getTime() - 24 * 60 * 60 * 1000); // 24h atrás
        const result = await this.auditService.findLogs({
            start_date: startDate.toISOString(),
            end_date: endDate.toISOString(),
            critical_only: true,
            sort_by: 'created_at',
            sort_order: 'DESC',
            limit: 50,
        });
        return {
            data: result.data,
            total: result.total,
        };
    }
    /**
     * Método privado para mapear entidade para DTO
     */
    mapToResponseDto(log) {
        return {
            id: log.id,
            usuario_id: log.usuario_id,
            usuario: log.usuario
                ? {
                    id: log.usuario.id,
                    nome: log.usuario.nome,
                    email: log.usuario.email,
                }
                : undefined,
            action: log.action,
            resource_type: log.resource_type,
            resource_id: log.resource_id,
            description: log.description,
            severity: log.severity,
            client_ip: log.client_ip,
            user_agent: log.user_agent,
            created_at: log.created_at,
            metadata: log.metadata,
        };
    }
};
exports.AuditController = AuditController;
__decorate([
    (0, common_1.Post)('logs'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR'),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 60000 } }) // 10 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Criar log de auditoria',
        description: 'Cria um novo registro de auditoria no sistema',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.CREATED,
        description: 'Log de auditoria criado com sucesso',
        type: audit_log_dto_1.AuditLogResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.BAD_REQUEST,
        description: 'Dados inválidos fornecidos',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.FORBIDDEN,
        description: 'Acesso negado - permissões insuficientes',
    }),
    __param(0, (0, common_1.Body)(common_1.ValidationPipe)),
    __param(1, (0, get_user_decorator_1.GetUser)()),
    __param(2, (0, get_client_info_decorator_1.GetClientInfo)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_b = typeof audit_log_dto_1.CreateAuditLogDto !== "undefined" && audit_log_dto_1.CreateAuditLogDto) === "function" ? _b : Object, typeof (_c = typeof usuario_entity_1.Usuario !== "undefined" && usuario_entity_1.Usuario) === "function" ? _c : Object, typeof (_d = typeof client_info_interface_1.ClientInfo !== "undefined" && client_info_interface_1.ClientInfo) === "function" ? _d : Object]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], AuditController.prototype, "createLog", null);
__decorate([
    (0, common_1.Get)('logs'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR', 'AUDITOR'),
    (0, throttler_1.Throttle)({ default: { limit: 30, ttl: 60000 } }) // 30 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Listar logs de auditoria',
        description: 'Busca logs de auditoria com filtros e paginação',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'usuario_id',
        required: false,
        description: 'Filtrar por ID do usuário',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'action',
        required: false,
        description: 'Filtrar por ação',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'resource_type',
        required: false,
        description: 'Filtrar por tipo de recurso',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'severity',
        required: false,
        description: 'Filtrar por severidade',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'start_date',
        required: false,
        description: 'Data de início (ISO 8601)',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'end_date',
        required: false,
        description: 'Data de fim (ISO 8601)',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'page',
        required: false,
        description: 'Número da página',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'limit',
        required: false,
        description: 'Itens por página',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'security_events_only',
        required: false,
        description: 'Filtrar apenas eventos de segurança',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'critical_only',
        required: false,
        description: 'Filtrar apenas eventos críticos',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Lista de logs de auditoria',
        schema: {
            type: 'object',
            properties: {
                data: {
                    type: 'array',
                    items: { $ref: '#/components/schemas/AuditLogResponseDto' },
                },
                total: { type: 'number' },
                page: { type: 'number' },
                limit: { type: 'number' },
                totalPages: { type: 'number' },
            },
        },
    }),
    __param(0, (0, common_1.Query)(common_1.ValidationPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_f = typeof audit_log_dto_1.AuditLogQueryDto !== "undefined" && audit_log_dto_1.AuditLogQueryDto) === "function" ? _f : Object]),
    __metadata("design:returntype", typeof (_g = typeof Promise !== "undefined" && Promise) === "function" ? _g : Object)
], AuditController.prototype, "findLogs", null);
__decorate([
    (0, common_1.Get)('logs/:id'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR', 'AUDITOR'),
    (0, throttler_1.Throttle)({ default: { limit: 60, ttl: 60000 } }) // 60 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Buscar log específico',
        description: 'Busca um log de auditoria específico por ID',
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        description: 'ID do log de auditoria',
        type: 'string',
        format: 'uuid',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Log de auditoria encontrado',
        type: audit_log_dto_1.AuditLogResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.NOT_FOUND,
        description: 'Log de auditoria não encontrado',
    }),
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_h = typeof Promise !== "undefined" && Promise) === "function" ? _h : Object)
], AuditController.prototype, "findLogById", null);
__decorate([
    (0, common_1.Get)('stats'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR'),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 60000 } }) // 10 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Estatísticas de auditoria',
        description: 'Gera estatísticas e métricas dos logs de auditoria',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'start_date',
        required: false,
        description: 'Data de início para análise (ISO 8601)',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'end_date',
        required: false,
        description: 'Data de fim para análise (ISO 8601)',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Estatísticas de auditoria',
        type: audit_log_dto_1.AuditLogStatsDto,
    }),
    __param(0, (0, common_1.Query)('start_date')),
    __param(1, (0, common_1.Query)('end_date')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", typeof (_j = typeof Promise !== "undefined" && Promise) === "function" ? _j : Object)
], AuditController.prototype, "getStats", null);
__decorate([
    (0, common_1.Post)('cleanup'),
    (0, role_decorator_1.Roles)('ADMIN'),
    (0, throttler_1.Throttle)({ default: { limit: 1, ttl: 300000 } }) // 1 request per 5 minutes
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Limpeza manual de logs',
        description: 'Executa limpeza manual de logs antigos (apenas administradores)',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Limpeza executada com sucesso',
        schema: {
            type: 'object',
            properties: {
                message: { type: 'string' },
                timestamp: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.FORBIDDEN,
        description: 'Acesso negado - apenas administradores',
    }),
    __param(0, (0, get_user_decorator_1.GetUser)()),
    __param(1, (0, get_client_info_decorator_1.GetClientInfo)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_k = typeof usuario_entity_1.Usuario !== "undefined" && usuario_entity_1.Usuario) === "function" ? _k : Object, typeof (_l = typeof client_info_interface_1.ClientInfo !== "undefined" && client_info_interface_1.ClientInfo) === "function" ? _l : Object]),
    __metadata("design:returntype", typeof (_m = typeof Promise !== "undefined" && Promise) === "function" ? _m : Object)
], AuditController.prototype, "manualCleanup", null);
__decorate([
    (0, common_1.Get)('security-events'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR', 'AUDITOR'),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 60000 } }) // 20 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Eventos de segurança recentes',
        description: 'Lista eventos de segurança das últimas 24 horas',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Lista de eventos de segurança',
        schema: {
            type: 'object',
            properties: {
                data: {
                    type: 'array',
                    items: { $ref: '#/components/schemas/AuditLogResponseDto' },
                },
                total: { type: 'number' },
            },
        },
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", typeof (_o = typeof Promise !== "undefined" && Promise) === "function" ? _o : Object)
], AuditController.prototype, "getSecurityEvents", null);
__decorate([
    (0, common_1.Get)('critical-events'),
    (0, role_decorator_1.Roles)('ADMIN', 'GESTOR'),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 60000 } }) // 20 requests per minute
    ,
    (0, swagger_1.ApiOperation)({
        summary: 'Eventos críticos recentes',
        description: 'Lista eventos críticos das últimas 24 horas',
    }),
    (0, swagger_1.ApiResponse)({
        status: common_1.HttpStatus.OK,
        description: 'Lista de eventos críticos',
        schema: {
            type: 'object',
            properties: {
                data: {
                    type: 'array',
                    items: { $ref: '#/components/schemas/AuditLogResponseDto' },
                },
                total: { type: 'number' },
            },
        },
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", typeof (_p = typeof Promise !== "undefined" && Promise) === "function" ? _p : Object)
], AuditController.prototype, "getCriticalEvents", null);
exports.AuditController = AuditController = __decorate([
    (0, swagger_1.ApiTags)('Auditoria'),
    (0, common_1.Controller)('audit'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, roles_guard_1.RolesGuard),
    (0, swagger_1.ApiBearerAuth)(),
    __metadata("design:paramtypes", [typeof (_a = typeof audit_service_1.AuditService !== "undefined" && audit_service_1.AuditService) === "function" ? _a : Object])
], AuditController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGF1ZGl0XFxjb250cm9sbGVyc1xcYXVkaXQuY29udHJvbGxlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBV3dCO0FBQ3hCLDZDQU95QjtBQUN6QixpREFBNkM7QUFDN0MscUVBQWdFO0FBQ2hFLCtEQUEyRDtBQUMzRCx5RUFBNkQ7QUFDN0QsaUZBQW1FO0FBQ25FLGlHQUFrRjtBQUNsRiw2REFBeUQ7QUFDekQsd0RBSzhCO0FBQzlCLGtFQUF3RDtBQUN4RCx5RkFBMkU7QUFNcEUsSUFBTSxlQUFlLEdBQXJCLE1BQU0sZUFBZTtJQUNHO0lBQTdCLFlBQTZCLFlBQTBCO1FBQTFCLGlCQUFZLEdBQVosWUFBWSxDQUFjO0lBQUcsQ0FBQztJQXNCckQsQUFBTixLQUFLLENBQUMsU0FBUyxDQUNTLGlCQUFvQyxFQUMvQyxJQUFhLEVBQ1AsVUFBc0I7UUFFdkMsb0RBQW9EO1FBQ3BELE1BQU0sT0FBTyxHQUFHO1lBQ2QsR0FBRyxpQkFBaUI7WUFDcEIsU0FBUyxFQUFFLGlCQUFpQixDQUFDLFNBQVMsSUFBSSxVQUFVLENBQUMsRUFBRTtZQUN2RCxVQUFVLEVBQUUsaUJBQWlCLENBQUMsVUFBVSxJQUFJLFVBQVUsQ0FBQyxTQUFTO1NBQ2pFLENBQUM7UUFFRixNQUFNLEdBQUcsR0FBRyxNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZELE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUE0RUssQUFBTixLQUFLLENBQUMsUUFBUSxDQUF3QixRQUEwQjtRQU85RCxPQUFPLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQXdCSyxBQUFOLEtBQUssQ0FBQyxXQUFXLENBQ2EsRUFB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RTthQUMxQjtTQUNGO0tBQ0YsQ0FBQzs7O3dEQUN5QixPQUFPLG9CQUFQLE9BQU87d0RBb0JqQzswQkE5VFUsZUFBZTtJQUozQixJQUFBLGlCQUFPLEVBQUMsV0FBVyxDQUFDO0lBQ3BCLElBQUEsbUJBQVUsRUFBQyxPQUFPLENBQUM7SUFDbkIsSUFBQSxrQkFBUyxFQUFDLDZCQUFZLEVBQUUsd0JBQVUsQ0FBQztJQUNuQyxJQUFBLHVCQUFhLEdBQUU7eURBRTZCLDRCQUFZLG9CQUFaLDRCQUFZO0dBRDVDLGVBQWUsQ0F5VjNCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxhdWRpdFxcY29udHJvbGxlcnNcXGF1ZGl0LmNvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29udHJvbGxlcixcbiAgR2V0LFxuICBQb3N0LFxuICBCb2R5LFxuICBRdWVyeSxcbiAgUGFyYW0sXG4gIFVzZUd1YXJkcyxcbiAgSHR0cFN0YXR1cyxcbiAgUGFyc2VVVUlEUGlwZSxcbiAgVmFsaWRhdGlvblBpcGUsXG59IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7XG4gIEFwaVRhZ3MsXG4gIEFwaU9wZXJhdGlvbixcbiAgQXBpUmVzcG9uc2UsXG4gIEFwaUJlYXJlckF1dGgsXG4gIEFwaVF1ZXJ5LFxuICBBcGlQYXJhbSxcbn0gZnJvbSAnQG5lc3Rqcy9zd2FnZ2VyJztcbmltcG9ydCB7IFRocm90dGxlIH0gZnJvbSAnQG5lc3Rqcy90aHJvdHRsZXInO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgUm9sZXNHdWFyZCB9IGZyb20gJy4uLy4uL2F1dGgvZ3VhcmRzL3JvbGVzLmd1YXJkJztcbmltcG9ydCB7IFJvbGVzIH0gZnJvbSAnLi4vLi4vYXV0aC9kZWNvcmF0b3JzL3JvbGUuZGVjb3JhdG9yJztcbmltcG9ydCB7IEdldFVzZXIgfSBmcm9tICcuLi8uLi9hdXRoL2RlY29yYXRvcnMvZ2V0LXVzZXIuZGVjb3JhdG9yJztcbmltcG9ydCB7IEdldENsaWVudEluZm8gfSBmcm9tICcuLi8uLi9jb21tb24vZGVjb3JhdG9ycy9nZXQtY2xpZW50LWluZm8uZGVjb3JhdG9yJztcbmltcG9ydCB7IEF1ZGl0U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2F1ZGl0LnNlcnZpY2UnO1xuaW1wb3J0IHtcbiAgQ3JlYXRlQXVkaXRMb2dEdG8sXG4gIEF1ZGl0TG9nUXVlcnlEdG8sXG4gIEF1ZGl0TG9nUmVzcG9uc2VEdG8sXG4gIEF1ZGl0TG9nU3RhdHNEdG8sXG59IGZyb20gJy4uL2R0by9hdWRpdC1sb2cuZHRvJztcbmltcG9ydCB7IFVzdWFyaW8gfSBmcm9tICcuLi8uLi9lbnRpdGllcy91c3VhcmlvLmVudGl0eSc7XG5pbXBvcnQgeyBDbGllbnRJbmZvIH0gZnJvbSAnLi4vLi4vY29tbW9uL2ludGVyZmFjZXMvY2xpZW50LWluZm8uaW50ZXJmYWNlJztcblxuQEFwaVRhZ3MoJ0F1ZGl0b3JpYScpXG5AQ29udHJvbGxlcignYXVkaXQnKVxuQFVzZUd1YXJkcyhKd3RBdXRoR3VhcmQsIFJvbGVzR3VhcmQpXG5AQXBpQmVhcmVyQXV0aCgpXG5leHBvcnQgY2xhc3MgQXVkaXRDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBhdWRpdFNlcnZpY2U6IEF1ZGl0U2VydmljZSkge31cblxuICBAUG9zdCgnbG9ncycpXG4gIEBSb2xlcygnQURNSU4nLCAnR0VTVE9SJylcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMTAsIHR0bDogNjAwMDAgfSB9KSAvLyAxMCByZXF1ZXN0cyBwZXIgbWludXRlXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDcmlhciBsb2cgZGUgYXVkaXRvcmlhJyxcbiAgICBkZXNjcmlwdGlvbjogJ0NyaWEgdW0gbm92byByZWdpc3RybyBkZSBhdWRpdG9yaWEgbm8gc2lzdGVtYScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLkNSRUFURUQsXG4gICAgZGVzY3JpcHRpb246ICdMb2cgZGUgYXVkaXRvcmlhIGNyaWFkbyBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQXVkaXRMb2dSZXNwb25zZUR0byxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IEh0dHBTdGF0dXMuQkFEX1JFUVVFU1QsXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zIGZvcm5lY2lkb3MnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogSHR0cFN0YXR1cy5GT1JCSURERU4sXG4gICAgZGVzY3JpcHRpb246ICdBY2Vzc28gbmVnYWRvIC0gcGVybWlzc8O1ZXMgaW5zdWZpY2llbnRlcycsXG4gIH0pXG4gIGFzeW5jIGNyZWF0ZUxvZyhcbiAgICBAQm9keShWYWxpZGF0aW9uUGlwZSkgY3JlYXRlQXVkaXRMb2dEdG86IENyZWF0ZUF1ZGl0TG9nRHRvLFxuICAgIEBHZXRVc2VyKCkgdXNlcjogVXN1YXJpbyxcbiAgICBAR2V0Q2xpZW50SW5mbygpIGNsaWVudEluZm86IENsaWVudEluZm8sXG4gICk6IFByb21pc2U8QXVkaXRMb2dSZXNwb25zZUR0bz4ge1xuICAgIC8vIEFkaWNpb25hIGluZm9ybWHDp8O1ZXMgZG8gY2xpZW50ZSBzZSBuw6NvIGZvcm5lY2lkYXNcbiAgICBjb25zdCBsb2dEYXRhID0ge1xuICAgICAgLi4uY3JlYXRlQXVkaXRMb2dEdG8sXG4gICAgICBjbGllbnRfaXA6IGNyZWF0ZUF1ZGl0TG9nRHRvLmNsaWVudF9pcCB8fCBjbGllbnRJbmZvLmlwLFxuICAgICAgdXNlcl9hZ2VudDogY3JlYXRlQXVkaXRMb2dEdG8udXNlcl9hZ2VudCB8fCBjbGllbnRJbmZvLnVzZXJBZ2VudCxcbiAgICB9O1xuXG4gICAgY29uc3QgbG9nID0gYXdhaXQgdGhpcy5hdWRpdFNlcnZpY2UuY3JlYXRlTG9nKGxvZ0RhdGEpO1xuICAgIHJldHVybiB0aGlzLm1hcFRvUmVzcG9uc2VEdG8obG9nKTtcbiAgfVxuXG4gIEBHZXQoJ2xvZ3MnKVxuICBAUm9sZXMoJ0FETUlOJywgJ0dFU1RPUicsICdBVURJVE9SJylcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMzAsIHR0bDogNjAwMDAgfSB9KSAvLyAzMCByZXF1ZXN0cyBwZXIgbWludXRlXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdMaXN0YXIgbG9ncyBkZSBhdWRpdG9yaWEnLFxuICAgIGRlc2NyaXB0aW9uOiAnQnVzY2EgbG9ncyBkZSBhdWRpdG9yaWEgY29tIGZpbHRyb3MgZSBwYWdpbmHDp8OjbycsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ3VzdWFyaW9faWQnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbHRyYXIgcG9yIElEIGRvIHVzdcOhcmlvJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnYWN0aW9uJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgZGVzY3JpcHRpb246ICdGaWx0cmFyIHBvciBhw6fDo28nLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdyZXNvdXJjZV90eXBlJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgZGVzY3JpcHRpb246ICdGaWx0cmFyIHBvciB0aXBvIGRlIHJlY3Vyc28nLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdzZXZlcml0eScsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnRmlsdHJhciBwb3Igc2V2ZXJpZGFkZScsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ3N0YXJ0X2RhdGUnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGEgZGUgaW7DrWNpbyAoSVNPIDg2MDEpJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnZW5kX2RhdGUnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGEgZGUgZmltIChJU08gODYwMSknLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdwYWdlJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgZGVzY3JpcHRpb246ICdOw7ptZXJvIGRhIHDDoWdpbmEnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdsaW1pdCcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnSXRlbnMgcG9yIHDDoWdpbmEnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdzZWN1cml0eV9ldmVudHNfb25seScsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnRmlsdHJhciBhcGVuYXMgZXZlbnRvcyBkZSBzZWd1cmFuw6dhJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnY3JpdGljYWxfb25seScsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIGRlc2NyaXB0aW9uOiAnRmlsdHJhciBhcGVuYXMgZXZlbnRvcyBjcsOtdGljb3MnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogSHR0cFN0YXR1cy5PSyxcbiAgICBkZXNjcmlwdGlvbjogJ0xpc3RhIGRlIGxvZ3MgZGUgYXVkaXRvcmlhJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdHlwZTogJ2FycmF5JyxcbiAgICAgICAgICBpdGVtczogeyAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvQXVkaXRMb2dSZXNwb25zZUR0bycgfSxcbiAgICAgICAgfSxcbiAgICAgICAgdG90YWw6IHsgdHlwZTogJ251bWJlcicgfSxcbiAgICAgICAgcGFnZTogeyB0eXBlOiAnbnVtYmVyJyB9LFxuICAgICAgICBsaW1pdDogeyB0eXBlOiAnbnVtYmVyJyB9LFxuICAgICAgICB0b3RhbFBhZ2VzOiB7IHR5cGU6ICdudW1iZXInIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIGFzeW5jIGZpbmRMb2dzKEBRdWVyeShWYWxpZGF0aW9uUGlwZSkgcXVlcnlEdG86IEF1ZGl0TG9nUXVlcnlEdG8pOiBQcm9taXNlPHtcbiAgICBkYXRhOiBBdWRpdExvZ1Jlc3BvbnNlRHRvW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgbGltaXQ6IG51bWJlcjtcbiAgICB0b3RhbFBhZ2VzOiBudW1iZXI7XG4gIH0+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdWRpdFNlcnZpY2UuZmluZExvZ3MocXVlcnlEdG8pO1xuICB9XG5cbiAgQEdldCgnbG9ncy86aWQnKVxuICBAUm9sZXMoJ0FETUlOJywgJ0dFU1RPUicsICdBVURJVE9SJylcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogNjAsIHR0bDogNjAwMDAgfSB9KSAvLyA2MCByZXF1ZXN0cyBwZXIgbWludXRlXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdCdXNjYXIgbG9nIGVzcGVjw61maWNvJyxcbiAgICBkZXNjcmlwdGlvbjogJ0J1c2NhIHVtIGxvZyBkZSBhdWRpdG9yaWEgZXNwZWPDrWZpY28gcG9yIElEJyxcbiAgfSlcbiAgQEFwaVBhcmFtKHtcbiAgICBuYW1lOiAnaWQnLFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgZG8gbG9nIGRlIGF1ZGl0b3JpYScsXG4gICAgdHlwZTogJ3N0cmluZycsXG4gICAgZm9ybWF0OiAndXVpZCcsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgIGRlc2NyaXB0aW9uOiAnTG9nIGRlIGF1ZGl0b3JpYSBlbmNvbnRyYWRvJyxcbiAgICB0eXBlOiBBdWRpdExvZ1Jlc3BvbnNlRHRvLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogSHR0cFN0YXR1cy5OT1RfRk9VTkQsXG4gICAgZGVzY3JpcHRpb246ICdMb2cgZGUgYXVkaXRvcmlhIG7Do28gZW5jb250cmFkbycsXG4gIH0pXG4gIGFzeW5jIGZpbmRMb2dCeUlkKFxuICAgIEBQYXJhbSgnaWQnLCBQYXJzZVVVSURQaXBlKSBpZDogc3RyaW5nLFxuICApOiBQcm9taXNlPEF1ZGl0TG9nUmVzcG9uc2VEdG8gfCBudWxsPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuYXVkaXRTZXJ2aWNlLmZpbmRMb2dCeUlkKGlkKTtcbiAgfVxuXG4gIEBHZXQoJ3N0YXRzJylcbiAgQFJvbGVzKCdBRE1JTicsICdHRVNUT1InKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAxMCwgdHRsOiA2MDAwMCB9IH0pIC8vIDEwIHJlcXVlc3RzIHBlciBtaW51dGVcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0VzdGF0w61zdGljYXMgZGUgYXVkaXRvcmlhJyxcbiAgICBkZXNjcmlwdGlvbjogJ0dlcmEgZXN0YXTDrXN0aWNhcyBlIG3DqXRyaWNhcyBkb3MgbG9ncyBkZSBhdWRpdG9yaWEnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdzdGFydF9kYXRlJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgZGVzY3JpcHRpb246ICdEYXRhIGRlIGluw61jaW8gcGFyYSBhbsOhbGlzZSAoSVNPIDg2MDEpJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnZW5kX2RhdGUnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGEgZGUgZmltIHBhcmEgYW7DoWxpc2UgKElTTyA4NjAxKScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgIGRlc2NyaXB0aW9uOiAnRXN0YXTDrXN0aWNhcyBkZSBhdWRpdG9yaWEnLFxuICAgIHR5cGU6IEF1ZGl0TG9nU3RhdHNEdG8sXG4gIH0pXG4gIGFzeW5jIGdldFN0YXRzKFxuICAgIEBRdWVyeSgnc3RhcnRfZGF0ZScpIHN0YXJ0RGF0ZT86IHN0cmluZyxcbiAgICBAUXVlcnkoJ2VuZF9kYXRlJykgZW5kRGF0ZT86IHN0cmluZyxcbiAgKTogUHJvbWlzZTxBdWRpdExvZ1N0YXRzRHRvPiB7XG4gICAgY29uc3Qgc3RhcnQgPSBzdGFydERhdGUgPyBuZXcgRGF0ZShzdGFydERhdGUpIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IGVuZCA9IGVuZERhdGUgPyBuZXcgRGF0ZShlbmREYXRlKSA6IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiBhd2FpdCB0aGlzLmF1ZGl0U2VydmljZS5nZXRTdGF0cyhzdGFydCwgZW5kKTtcbiAgfVxuXG4gIEBQb3N0KCdjbGVhbnVwJylcbiAgQFJvbGVzKCdBRE1JTicpXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDEsIHR0bDogMzAwMDAwIH0gfSkgLy8gMSByZXF1ZXN0IHBlciA1IG1pbnV0ZXNcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0xpbXBlemEgbWFudWFsIGRlIGxvZ3MnLFxuICAgIGRlc2NyaXB0aW9uOlxuICAgICAgJ0V4ZWN1dGEgbGltcGV6YSBtYW51YWwgZGUgbG9ncyBhbnRpZ29zIChhcGVuYXMgYWRtaW5pc3RyYWRvcmVzKScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgIGRlc2NyaXB0aW9uOiAnTGltcGV6YSBleGVjdXRhZGEgY29tIHN1Y2Vzc28nLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1lc3NhZ2U6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgdGltZXN0YW1wOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLkZPUkJJRERFTixcbiAgICBkZXNjcmlwdGlvbjogJ0FjZXNzbyBuZWdhZG8gLSBhcGVuYXMgYWRtaW5pc3RyYWRvcmVzJyxcbiAgfSlcbiAgYXN5bmMgbWFudWFsQ2xlYW51cChcbiAgICBAR2V0VXNlcigpIHVzZXI6IFVzdWFyaW8sXG4gICAgQEdldENsaWVudEluZm8oKSBjbGllbnRJbmZvOiBDbGllbnRJbmZvLFxuICApOiBQcm9taXNlPHsgbWVzc2FnZTogc3RyaW5nOyB0aW1lc3RhbXA6IHN0cmluZyB9PiB7XG4gICAgLy8gTG9nIGRhIGHDp8OjbyBhZG1pbmlzdHJhdGl2YVxuICAgIGF3YWl0IHRoaXMuYXVkaXRTZXJ2aWNlLmxvZ1VzZXJBY3Rpb24oXG4gICAgICB1c2VyLmlkLFxuICAgICAgJ1NZU1RFTV9DT05GSUcnIGFzIGFueSxcbiAgICAgICdBdWRpdExvZycsXG4gICAgICB1bmRlZmluZWQsXG4gICAgICAnTGltcGV6YSBtYW51YWwgZGUgbG9ncyBleGVjdXRhZGEnLFxuICAgICAgeyBhY3Rpb246ICdtYW51YWxfY2xlYW51cCcgfSxcbiAgICAgIHtcbiAgICAgICAgaXA6IGNsaWVudEluZm8uaXAsXG4gICAgICAgIHVzZXJBZ2VudDogY2xpZW50SW5mby51c2VyQWdlbnQsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICB1cmw6ICcvYXBpL2F1ZGl0L2NsZWFudXAnLFxuICAgICAgfSxcbiAgICApO1xuXG4gICAgYXdhaXQgdGhpcy5hdWRpdFNlcnZpY2UuY2xlYW51cE9sZExvZ3MoKTtcblxuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlOiAnTGltcGV6YSBkZSBsb2dzIGV4ZWN1dGFkYSBjb20gc3VjZXNzbycsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9O1xuICB9XG5cbiAgQEdldCgnc2VjdXJpdHktZXZlbnRzJylcbiAgQFJvbGVzKCdBRE1JTicsICdHRVNUT1InLCAnQVVESVRPUicpXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDIwLCB0dGw6IDYwMDAwIH0gfSkgLy8gMjAgcmVxdWVzdHMgcGVyIG1pbnV0ZVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnRXZlbnRvcyBkZSBzZWd1cmFuw6dhIHJlY2VudGVzJyxcbiAgICBkZXNjcmlwdGlvbjogJ0xpc3RhIGV2ZW50b3MgZGUgc2VndXJhbsOnYSBkYXMgw7psdGltYXMgMjQgaG9yYXMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogSHR0cFN0YXR1cy5PSyxcbiAgICBkZXNjcmlwdGlvbjogJ0xpc3RhIGRlIGV2ZW50b3MgZGUgc2VndXJhbsOnYScsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHR5cGU6ICdhcnJheScsXG4gICAgICAgICAgaXRlbXM6IHsgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL0F1ZGl0TG9nUmVzcG9uc2VEdG8nIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsOiB7IHR5cGU6ICdudW1iZXInIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIGFzeW5jIGdldFNlY3VyaXR5RXZlbnRzKCk6IFByb21pc2U8e1xuICAgIGRhdGE6IEF1ZGl0TG9nUmVzcG9uc2VEdG9bXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICB9PiB7XG4gICAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoZW5kRGF0ZS5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMjRoIGF0csOhc1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hdWRpdFNlcnZpY2UuZmluZExvZ3Moe1xuICAgICAgc3RhcnRfZGF0ZTogc3RhcnREYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICBlbmRfZGF0ZTogZW5kRGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgc2VjdXJpdHlfZXZlbnRzX29ubHk6IHRydWUsXG4gICAgICBzb3J0X2J5OiAnY3JlYXRlZF9hdCcsXG4gICAgICBzb3J0X29yZGVyOiAnREVTQycsXG4gICAgICBsaW1pdDogMTAwLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IHJlc3VsdC5kYXRhLFxuICAgICAgdG90YWw6IHJlc3VsdC50b3RhbCxcbiAgICB9O1xuICB9XG5cbiAgQEdldCgnY3JpdGljYWwtZXZlbnRzJylcbiAgQFJvbGVzKCdBRE1JTicsICdHRVNUT1InKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAyMCwgdHRsOiA2MDAwMCB9IH0pIC8vIDIwIHJlcXVlc3RzIHBlciBtaW51dGVcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0V2ZW50b3MgY3LDrXRpY29zIHJlY2VudGVzJyxcbiAgICBkZXNjcmlwdGlvbjogJ0xpc3RhIGV2ZW50b3MgY3LDrXRpY29zIGRhcyDDumx0aW1hcyAyNCBob3JhcycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgIGRlc2NyaXB0aW9uOiAnTGlzdGEgZGUgZXZlbnRvcyBjcsOtdGljb3MnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgICAgIGl0ZW1zOiB7ICRyZWY6ICcjL2NvbXBvbmVudHMvc2NoZW1hcy9BdWRpdExvZ1Jlc3BvbnNlRHRvJyB9LFxuICAgICAgICB9LFxuICAgICAgICB0b3RhbDogeyB0eXBlOiAnbnVtYmVyJyB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KVxuICBhc3luYyBnZXRDcml0aWNhbEV2ZW50cygpOiBQcm9taXNlPHtcbiAgICBkYXRhOiBBdWRpdExvZ1Jlc3BvbnNlRHRvW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgfT4ge1xuICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKGVuZERhdGUuZ2V0VGltZSgpIC0gMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDI0aCBhdHLDoXNcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXVkaXRTZXJ2aWNlLmZpbmRMb2dzKHtcbiAgICAgIHN0YXJ0X2RhdGU6IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgZW5kX2RhdGU6IGVuZERhdGUudG9JU09TdHJpbmcoKSxcbiAgICAgIGNyaXRpY2FsX29ubHk6IHRydWUsXG4gICAgICBzb3J0X2J5OiAnY3JlYXRlZF9hdCcsXG4gICAgICBzb3J0X29yZGVyOiAnREVTQycsXG4gICAgICBsaW1pdDogNTAsXG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogcmVzdWx0LmRhdGEsXG4gICAgICB0b3RhbDogcmVzdWx0LnRvdGFsLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogTcOpdG9kbyBwcml2YWRvIHBhcmEgbWFwZWFyIGVudGlkYWRlIHBhcmEgRFRPXG4gICAqL1xuICBwcml2YXRlIG1hcFRvUmVzcG9uc2VEdG8obG9nOiBhbnkpOiBBdWRpdExvZ1Jlc3BvbnNlRHRvIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGxvZy5pZCxcbiAgICAgIHVzdWFyaW9faWQ6IGxvZy51c3VhcmlvX2lkLFxuICAgICAgdXN1YXJpbzogbG9nLnVzdWFyaW9cbiAgICAgICAgPyB7XG4gICAgICAgICAgICBpZDogbG9nLnVzdWFyaW8uaWQsXG4gICAgICAgICAgICBub21lOiBsb2cudXN1YXJpby5ub21lLFxuICAgICAgICAgICAgZW1haWw6IGxvZy51c3VhcmlvLmVtYWlsLFxuICAgICAgICAgIH1cbiAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICBhY3Rpb246IGxvZy5hY3Rpb24sXG4gICAgICByZXNvdXJjZV90eXBlOiBsb2cucmVzb3VyY2VfdHlwZSxcbiAgICAgIHJlc291cmNlX2lkOiBsb2cucmVzb3VyY2VfaWQsXG4gICAgICBkZXNjcmlwdGlvbjogbG9nLmRlc2NyaXB0aW9uLFxuICAgICAgc2V2ZXJpdHk6IGxvZy5zZXZlcml0eSxcbiAgICAgIGNsaWVudF9pcDogbG9nLmNsaWVudF9pcCxcbiAgICAgIHVzZXJfYWdlbnQ6IGxvZy51c2VyX2FnZW50LFxuICAgICAgY3JlYXRlZF9hdDogbG9nLmNyZWF0ZWRfYXQsXG4gICAgICBtZXRhZGF0YTogbG9nLm1ldGFkYXRhLFxuICAgIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==