44338f2213582e0f42b4029e2467a98e
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuditLog = exports.AuditSeverity = exports.AuditAction = void 0;
const typeorm_1 = require("typeorm");
const usuario_entity_1 = require("./usuario.entity");
var AuditAction;
(function (AuditAction) {
    AuditAction["CREATE"] = "create";
    AuditAction["READ"] = "read";
    AuditAction["UPDATE"] = "update";
    AuditAction["DELETE"] = "delete";
    AuditAction["LOGIN"] = "login";
    AuditAction["LOGOUT"] = "logout";
    AuditAction["LOGIN_FAILED"] = "login_failed";
    AuditAction["PASSWORD_RESET"] = "password_reset";
    AuditAction["PASSWORD_CHANGE"] = "password_change";
    AuditAction["PERMISSION_DENIED"] = "permission_denied";
    AuditAction["TOKEN_REFRESH"] = "token_refresh";
    AuditAction["TOKEN_REVOKE"] = "token_revoke";
    AuditAction["EXPORT_DATA"] = "export_data";
    AuditAction["IMPORT_DATA"] = "import_data";
    AuditAction["SYSTEM_CONFIG"] = "system_config";
})(AuditAction || (exports.AuditAction = AuditAction = {}));
var AuditSeverity;
(function (AuditSeverity) {
    AuditSeverity["LOW"] = "low";
    AuditSeverity["MEDIUM"] = "medium";
    AuditSeverity["HIGH"] = "high";
    AuditSeverity["CRITICAL"] = "critical";
})(AuditSeverity || (exports.AuditSeverity = AuditSeverity = {}));
let AuditLog = class AuditLog {
    id;
    usuario_id;
    usuario;
    action;
    resource_type;
    resource_id;
    description;
    severity;
    client_ip;
    user_agent;
    session_id;
    request_method;
    request_url;
    response_status;
    response_time_ms;
    old_values;
    new_values;
    metadata;
    error_message;
    stack_trace;
    created_at;
    // Métodos utilitários
    isSecurityEvent() {
        const securityActions = [
            AuditAction.LOGIN,
            AuditAction.LOGOUT,
            AuditAction.LOGIN_FAILED,
            AuditAction.PASSWORD_RESET,
            AuditAction.PASSWORD_CHANGE,
            AuditAction.PERMISSION_DENIED,
            AuditAction.TOKEN_REFRESH,
            AuditAction.TOKEN_REVOKE,
        ];
        return securityActions.includes(this.action);
    }
    isCritical() {
        return this.severity === AuditSeverity.CRITICAL;
    }
    isHighRisk() {
        return [AuditSeverity.HIGH, AuditSeverity.CRITICAL].includes(this.severity);
    }
    getFormattedMessage() {
        const user = this.usuario
            ? `${this.usuario.nome} (${this.usuario.email})`
            : 'Sistema';
        const resource = this.resource_id
            ? `${this.resource_type}:${this.resource_id}`
            : this.resource_type;
        return `${user} executou ${this.action} em ${resource}`;
    }
};
exports.AuditLog = AuditLog;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], AuditLog.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "usuario_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { nullable: true, onDelete: 'SET NULL' }),
    (0, typeorm_1.JoinColumn)({ name: 'usuario_id' }),
    __metadata("design:type", typeof (_a = typeof usuario_entity_1.Usuario !== "undefined" && usuario_entity_1.Usuario) === "function" ? _a : Object)
], AuditLog.prototype, "usuario", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: AuditAction,
    }),
    __metadata("design:type", String)
], AuditLog.prototype, "action", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 100 }),
    __metadata("design:type", String)
], AuditLog.prototype, "resource_type", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 255, nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "resource_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'text', nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "description", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: AuditSeverity,
        default: AuditSeverity.LOW,
    }),
    __metadata("design:type", String)
], AuditLog.prototype, "severity", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'inet', nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "client_ip", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 500, nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "user_agent", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 100, nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "session_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 50, nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "request_method", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'varchar', length: 500, nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "request_url", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'integer', nullable: true }),
    __metadata("design:type", Number)
], AuditLog.prototype, "response_status", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'integer', nullable: true }),
    __metadata("design:type", Number)
], AuditLog.prototype, "response_time_ms", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'jsonb', nullable: true }),
    __metadata("design:type", typeof (_b = typeof Record !== "undefined" && Record) === "function" ? _b : Object)
], AuditLog.prototype, "old_values", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'jsonb', nullable: true }),
    __metadata("design:type", typeof (_c = typeof Record !== "undefined" && Record) === "function" ? _c : Object)
], AuditLog.prototype, "new_values", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'jsonb', nullable: true }),
    __metadata("design:type", typeof (_d = typeof Record !== "undefined" && Record) === "function" ? _d : Object)
], AuditLog.prototype, "metadata", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'text', nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "error_message", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'text', nullable: true }),
    __metadata("design:type", String)
], AuditLog.prototype, "stack_trace", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)(),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], AuditLog.prototype, "created_at", void 0);
exports.AuditLog = AuditLog = __decorate([
    (0, typeorm_1.Entity)('audit_logs'),
    (0, typeorm_1.Index)(['usuario_id', 'created_at']),
    (0, typeorm_1.Index)(['action', 'created_at']),
    (0, typeorm_1.Index)(['severity', 'created_at']),
    (0, typeorm_1.Index)(['resource_type', 'resource_id']),
    (0, typeorm_1.Index)(['client_ip', 'created_at'])
], AuditLog);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxhdWRpdC1sb2cuZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FRaUI7QUFDakIscURBQTJDO0FBRTNDLElBQVksV0FnQlg7QUFoQkQsV0FBWSxXQUFXO0lBQ3JCLGdDQUFpQixDQUFBO0lBQ2pCLDRCQUFhLENBQUE7SUFDYixnQ0FBaUIsQ0FBQTtJQUNqQixnQ0FBaUIsQ0FBQTtJQUNqQiw4QkFBZSxDQUFBO0lBQ2YsZ0NBQWlCLENBQUE7SUFDakIsNENBQTZCLENBQUE7SUFDN0IsZ0RBQWlDLENBQUE7SUFDakMsa0RBQW1DLENBQUE7SUFDbkMsc0RBQXVDLENBQUE7SUFDdkMsOENBQStCLENBQUE7SUFDL0IsNENBQTZCLENBQUE7SUFDN0IsMENBQTJCLENBQUE7SUFDM0IsMENBQTJCLENBQUE7SUFDM0IsOENBQStCLENBQUE7QUFDakMsQ0FBQyxFQWhCVyxXQUFXLDJCQUFYLFdBQVcsUUFnQnRCO0FBRUQsSUFBWSxhQUtYO0FBTEQsV0FBWSxhQUFhO0lBQ3ZCLDRCQUFXLENBQUE7SUFDWCxrQ0FBaUIsQ0FBQTtJQUNqQiw4QkFBYSxDQUFBO0lBQ2Isc0NBQXFCLENBQUE7QUFDdkIsQ0FBQyxFQUxXLGFBQWEsNkJBQWIsYUFBYSxRQUt4QjtBQVFNLElBQU0sUUFBUSxHQUFkLE1BQU0sUUFBUTtJQUVuQixFQUFFLENBQVM7SUFHWCxVQUFVLENBQVM7SUFJbkIsT0FBTyxDQUFVO0lBTWpCLE1BQU0sQ0FBYztJQUdwQixhQUFhLENBQVM7SUFHdEIsV0FBVyxDQUFTO0lBR3BCLFdBQVcsQ0FBUztJQU9wQixRQUFRLENBQWdCO0lBR3hCLFNBQVMsQ0FBUztJQUdsQixVQUFVLENBQVM7SUFHbkIsVUFBVSxDQUFTO0lBR25CLGNBQWMsQ0FBUztJQUd2QixXQUFXLENBQVM7SUFHcEIsZUFBZSxDQUFTO0lBR3hCLGdC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LFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQztrREFDaEMsTUFBTSxvQkFBTixNQUFNOzBDQUFjO0FBRzlCO0lBREMsSUFBQSxnQkFBTSxFQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7OytDQUNuQjtBQUd0QjtJQURDLElBQUEsZ0JBQU0sRUFBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDOzs2Q0FDckI7QUFHcEI7SUFEQyxJQUFBLDBCQUFnQixHQUFFO2tEQUNQLElBQUksb0JBQUosSUFBSTs0Q0FBQzttQkF0RU4sUUFBUTtJQU5wQixJQUFBLGdCQUFNLEVBQUMsWUFBWSxDQUFDO0lBQ3BCLElBQUEsZUFBSyxFQUFDLENBQUMsWUFBWSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ25DLElBQUEsZUFBSyxFQUFDLENBQUMsUUFBUSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQy9CLElBQUEsZUFBSyxFQUFDLENBQUMsVUFBVSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ2pDLElBQUEsZUFBSyxFQUFDLENBQUMsZUFBZSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQ3ZDLElBQUEsZUFBSyxFQUFDLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FBQyxDQUFDO0dBQ3RCLFFBQVEsQ0F3R3BCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxlbnRpdGllc1xcYXVkaXQtbG9nLmVudGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbnRpdHksXG4gIFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4sXG4gIENvbHVtbixcbiAgQ3JlYXRlRGF0ZUNvbHVtbixcbiAgSW5kZXgsXG4gIE1hbnlUb09uZSxcbiAgSm9pbkNvbHVtbixcbn0gZnJvbSAndHlwZW9ybSc7XG5pbXBvcnQgeyBVc3VhcmlvIH0gZnJvbSAnLi91c3VhcmlvLmVudGl0eSc7XG5cbmV4cG9ydCBlbnVtIEF1ZGl0QWN0aW9uIHtcbiAgQ1JFQVRFID0gJ2NyZWF0ZScsXG4gIFJFQUQgPSAncmVhZCcsXG4gIFVQREFURSA9ICd1cGRhdGUnLFxuICBERUxFVEUgPSAnZGVsZXRlJyxcbiAgTE9HSU4gPSAnbG9naW4nLFxuICBMT0dPVVQgPSAnbG9nb3V0JyxcbiAgTE9HSU5fRkFJTEVEID0gJ2xvZ2luX2ZhaWxlZCcsXG4gIFBBU1NXT1JEX1JFU0VUID0gJ3Bhc3N3b3JkX3Jlc2V0JyxcbiAgUEFTU1dPUkRfQ0hBTkdFID0gJ3Bhc3N3b3JkX2NoYW5nZScsXG4gIFBFUk1JU1NJT05fREVOSUVEID0gJ3Blcm1pc3Npb25fZGVuaWVkJyxcbiAgVE9LRU5fUkVGUkVTSCA9ICd0b2tlbl9yZWZyZXNoJyxcbiAgVE9LRU5fUkVWT0tFID0gJ3Rva2VuX3Jldm9rZScsXG4gIEVYUE9SVF9EQVRBID0gJ2V4cG9ydF9kYXRhJyxcbiAgSU1QT1JUX0RBVEEgPSAnaW1wb3J0X2RhdGEnLFxuICBTWVNURU1fQ09ORklHID0gJ3N5c3RlbV9jb25maWcnLFxufVxuXG5leHBvcnQgZW51bSBBdWRpdFNldmVyaXR5IHtcbiAgTE9XID0gJ2xvdycsXG4gIE1FRElVTSA9ICdtZWRpdW0nLFxuICBISUdIID0gJ2hpZ2gnLFxuICBDUklUSUNBTCA9ICdjcml0aWNhbCcsXG59XG5cbkBFbnRpdHkoJ2F1ZGl0X2xvZ3MnKVxuQEluZGV4KFsndXN1YXJpb19pZCcsICdjcmVhdGVkX2F0J10pXG5ASW5kZXgoWydhY3Rpb24nLCAnY3JlYXRlZF9hdCddKVxuQEluZGV4KFsnc2V2ZXJpdHknLCAnY3JlYXRlZF9hdCddKVxuQEluZGV4KFsncmVzb3VyY2VfdHlwZScsICdyZXNvdXJjZV9pZCddKVxuQEluZGV4KFsnY2xpZW50X2lwJywgJ2NyZWF0ZWRfYXQnXSlcbmV4cG9ydCBjbGFzcyBBdWRpdExvZyB7XG4gIEBQcmltYXJ5R2VuZXJhdGVkQ29sdW1uKCd1dWlkJylcbiAgaWQ6IHN0cmluZztcblxuICBAQ29sdW1uKHsgdHlwZTogJ3V1aWQnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICB1c3VhcmlvX2lkOiBzdHJpbmc7XG5cbiAgQE1hbnlUb09uZSgoKSA9PiBVc3VhcmlvLCB7IG51bGxhYmxlOiB0cnVlLCBvbkRlbGV0ZTogJ1NFVCBOVUxMJyB9KVxuICBASm9pbkNvbHVtbih7IG5hbWU6ICd1c3VhcmlvX2lkJyB9KVxuICB1c3VhcmlvOiBVc3VhcmlvO1xuXG4gIEBDb2x1bW4oe1xuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBBdWRpdEFjdGlvbixcbiAgfSlcbiAgYWN0aW9uOiBBdWRpdEFjdGlvbjtcblxuICBAQ29sdW1uKHsgdHlwZTogJ3ZhcmNoYXInLCBsZW5ndGg6IDEwMCB9KVxuICByZXNvdXJjZV90eXBlOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd2YXJjaGFyJywgbGVuZ3RoOiAyNTUsIG51bGxhYmxlOiB0cnVlIH0pXG4gIHJlc291cmNlX2lkOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd0ZXh0JywgbnVsbGFibGU6IHRydWUgfSlcbiAgZGVzY3JpcHRpb246IHN0cmluZztcblxuICBAQ29sdW1uKHtcbiAgICB0eXBlOiAnZW51bScsXG4gICAgZW51bTogQXVkaXRTZXZlcml0eSxcbiAgICBkZWZhdWx0OiBBdWRpdFNldmVyaXR5LkxPVyxcbiAgfSlcbiAgc2V2ZXJpdHk6IEF1ZGl0U2V2ZXJpdHk7XG5cbiAgQENvbHVtbih7IHR5cGU6ICdpbmV0JywgbnVsbGFibGU6IHRydWUgfSlcbiAgY2xpZW50X2lwOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd2YXJjaGFyJywgbGVuZ3RoOiA1MDAsIG51bGxhYmxlOiB0cnVlIH0pXG4gIHVzZXJfYWdlbnQ6IHN0cmluZztcblxuICBAQ29sdW1uKHsgdHlwZTogJ3ZhcmNoYXInLCBsZW5ndGg6IDEwMCwgbnVsbGFibGU6IHRydWUgfSlcbiAgc2Vzc2lvbl9pZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyB0eXBlOiAndmFyY2hhcicsIGxlbmd0aDogNTAsIG51bGxhYmxlOiB0cnVlIH0pXG4gIHJlcXVlc3RfbWV0aG9kOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd2YXJjaGFyJywgbGVuZ3RoOiA1MDAsIG51bGxhYmxlOiB0cnVlIH0pXG4gIHJlcXVlc3RfdXJsOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICdpbnRlZ2VyJywgbnVsbGFibGU6IHRydWUgfSlcbiAgcmVzcG9uc2Vfc3RhdHVzOiBudW1iZXI7XG5cbiAgQENvbHVtbih7IHR5cGU6ICdpbnRlZ2VyJywgbnVsbGFibGU6IHRydWUgfSlcbiAgcmVzcG9uc2VfdGltZV9tczogbnVtYmVyO1xuXG4gIEBDb2x1bW4oeyB0eXBlOiAnanNvbmInLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBvbGRfdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXG4gIEBDb2x1bW4oeyB0eXBlOiAnanNvbmInLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBuZXdfdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXG4gIEBDb2x1bW4oeyB0eXBlOiAnanNvbmInLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBtZXRhZGF0YTogUmVjb3JkPHN0cmluZywgYW55PjtcblxuICBAQ29sdW1uKHsgdHlwZTogJ3RleHQnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBlcnJvcl9tZXNzYWdlOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd0ZXh0JywgbnVsbGFibGU6IHRydWUgfSlcbiAgc3RhY2tfdHJhY2U6IHN0cmluZztcblxuICBAQ3JlYXRlRGF0ZUNvbHVtbigpXG4gIGNyZWF0ZWRfYXQ6IERhdGU7XG5cbiAgLy8gTcOpdG9kb3MgdXRpbGl0w6FyaW9zXG4gIGlzU2VjdXJpdHlFdmVudCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBzZWN1cml0eUFjdGlvbnMgPSBbXG4gICAgICBBdWRpdEFjdGlvbi5MT0dJTixcbiAgICAgIEF1ZGl0QWN0aW9uLkxPR09VVCxcbiAgICAgIEF1ZGl0QWN0aW9uLkxPR0lOX0ZBSUxFRCxcbiAgICAgIEF1ZGl0QWN0aW9uLlBBU1NXT1JEX1JFU0VULFxuICAgICAgQXVkaXRBY3Rpb24uUEFTU1dPUkRfQ0hBTkdFLFxuICAgICAgQXVkaXRBY3Rpb24uUEVSTUlTU0lPTl9ERU5JRUQsXG4gICAgICBBdWRpdEFjdGlvbi5UT0tFTl9SRUZSRVNILFxuICAgICAgQXVkaXRBY3Rpb24uVE9LRU5fUkVWT0tFLFxuICAgIF07XG4gICAgcmV0dXJuIHNlY3VyaXR5QWN0aW9ucy5pbmNsdWRlcyh0aGlzLmFjdGlvbik7XG4gIH1cblxuICBpc0NyaXRpY2FsKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNldmVyaXR5ID09PSBBdWRpdFNldmVyaXR5LkNSSVRJQ0FMO1xuICB9XG5cbiAgaXNIaWdoUmlzaygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gW0F1ZGl0U2V2ZXJpdHkuSElHSCwgQXVkaXRTZXZlcml0eS5DUklUSUNBTF0uaW5jbHVkZXModGhpcy5zZXZlcml0eSk7XG4gIH1cblxuICBnZXRGb3JtYXR0ZWRNZXNzYWdlKCk6IHN0cmluZyB7XG4gICAgY29uc3QgdXNlciA9IHRoaXMudXN1YXJpb1xuICAgICAgPyBgJHt0aGlzLnVzdWFyaW8ubm9tZX0gKCR7dGhpcy51c3VhcmlvLmVtYWlsfSlgXG4gICAgICA6ICdTaXN0ZW1hJztcbiAgICBjb25zdCByZXNvdXJjZSA9IHRoaXMucmVzb3VyY2VfaWRcbiAgICAgID8gYCR7dGhpcy5yZXNvdXJjZV90eXBlfToke3RoaXMucmVzb3VyY2VfaWR9YFxuICAgICAgOiB0aGlzLnJlc291cmNlX3R5cGU7XG4gICAgcmV0dXJuIGAke3VzZXJ9IGV4ZWN1dG91ICR7dGhpcy5hY3Rpb259IGVtICR7cmVzb3VyY2V9YDtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9