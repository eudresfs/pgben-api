522c30ec118497fd44f1cc354ea3dee6
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d;
Object.defineProperty(exports, "__esModule", { value: true });
exports.HistoricoConversaoPapel = void 0;
const typeorm_1 = require("typeorm");
const cidadao_entity_1 = require("./cidadao.entity");
const tipo_papel_enum_1 = require("../enums/tipo-papel.enum");
/**
 * Entidade de Histórico de Conversão de Papel
 *
 * Registra o histórico de conversões de papéis de cidadãos no sistema,
 * permitindo rastrear quando um cidadão foi convertido de um papel para outro.
 */
let HistoricoConversaoPapel = class HistoricoConversaoPapel {
    id;
    cidadao_id;
    cidadao;
    papel_anterior;
    papel_novo;
    composicao_familiar_id;
    usuario_id;
    justificativa;
    notificacao_enviada;
    tecnico_notificado_id;
    created_at;
    // Getters e Setters
    get cidadaoId() {
        return this.cidadao_id;
    }
    set cidadaoId(value) {
        this.cidadao_id = value;
    }
    get usuarioId() {
        return this.usuario_id;
    }
    set usuarioId(value) {
        this.usuario_id = value;
    }
    get composicaoFamiliarId() {
        return this.composicao_familiar_id;
    }
    set composicaoFamiliarId(value) {
        this.composicao_familiar_id = value;
    }
    get tecnicoNotificadoId() {
        return this.tecnico_notificado_id;
    }
    set tecnicoNotificadoId(value) {
        this.tecnico_notificado_id = value;
    }
    get createdAt() {
        return this.created_at;
    }
    // Métodos Utilitários
    /**
     * Verifica se a conversão foi criada recentemente (últimas 24 horas)
     */
    isCriadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.created_at > umDiaAtras;
    }
    /**
     * Calcula a idade do registro em dias
     */
    getIdadeRegistroEmDias() {
        const agora = new Date();
        const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    /**
     * Verifica se a notificação foi enviada
     */
    isNotificacaoEnviada() {
        return this.notificacao_enviada;
    }
    /**
     * Verifica se tem técnico notificado
     */
    temTecnicoNotificado() {
        return !!this.tecnico_notificado_id;
    }
    /**
     * Verifica se tem composição familiar associada
     */
    temComposicaoFamiliar() {
        return !!this.composicao_familiar_id;
    }
    /**
     * Verifica se é uma promoção (papel novo é "superior" ao anterior)
     */
    isPromocao() {
        const hierarquia = {
            [tipo_papel_enum_1.TipoPapel.DEPENDENTE]: 1,
            [tipo_papel_enum_1.TipoPapel.BENEFICIARIO]: 2,
            [tipo_papel_enum_1.TipoPapel.REPRESENTANTE_LEGAL]: 3,
            [tipo_papel_enum_1.TipoPapel.REQUERENTE]: 4,
        };
        return hierarquia[this.papel_novo] > hierarquia[this.papel_anterior];
    }
    /**
     * Verifica se é uma redução de papel
     */
    isReducao() {
        const hierarquia = {
            [tipo_papel_enum_1.TipoPapel.DEPENDENTE]: 1,
            [tipo_papel_enum_1.TipoPapel.BENEFICIARIO]: 2,
            [tipo_papel_enum_1.TipoPapel.REPRESENTANTE_LEGAL]: 3,
            [tipo_papel_enum_1.TipoPapel.REQUERENTE]: 4,
        };
        return hierarquia[this.papel_novo] < hierarquia[this.papel_anterior];
    }
    /**
     * Verifica se é uma mudança lateral (mesmo nível hierárquico)
     */
    isMudancaLateral() {
        return !this.isPromocao() && !this.isReducao();
    }
    /**
     * Obtém a descrição do papel anterior
     */
    getDescricaoPapelAnterior() {
        const descricoes = {
            [tipo_papel_enum_1.TipoPapel.REQUERENTE]: 'Responsável Familiar',
            [tipo_papel_enum_1.TipoPapel.BENEFICIARIO]: 'Beneficiário',
            [tipo_papel_enum_1.TipoPapel.REPRESENTANTE_LEGAL]: 'Representante Legal',
            [tipo_papel_enum_1.TipoPapel.DEPENDENTE]: 'Dependente',
        };
        return descricoes[this.papel_anterior] || this.papel_anterior;
    }
    /**
     * Obtém a descrição do papel novo
     */
    getDescricaoPapelNovo() {
        const descricoes = {
            [tipo_papel_enum_1.TipoPapel.REQUERENTE]: 'Responsável Familiar',
            [tipo_papel_enum_1.TipoPapel.BENEFICIARIO]: 'Beneficiário',
            [tipo_papel_enum_1.TipoPapel.REPRESENTANTE_LEGAL]: 'Representante Legal',
            [tipo_papel_enum_1.TipoPapel.DEPENDENTE]: 'Dependente',
        };
        return descricoes[this.papel_novo] || this.papel_novo;
    }
    /**
     * Obtém a descrição da mudança
     */
    getDescricaoMudanca() {
        const anterior = this.getDescricaoPapelAnterior();
        const novo = this.getDescricaoPapelNovo();
        if (this.isPromocao()) {
            return `Promoção: ${anterior} → ${novo}`;
        }
        else if (this.isReducao()) {
            return `Redução: ${anterior} → ${novo}`;
        }
        else {
            return `Mudança: ${anterior} → ${novo}`;
        }
    }
    /**
     * Verifica se pertence a um cidadão específico
     */
    pertenceAoCidadao(cidadaoId) {
        return this.cidadao_id === cidadaoId;
    }
    /**
     * Verifica se foi executado por um usuário específico
     */
    foiExecutadoPorUsuario(usuarioId) {
        return this.usuario_id === usuarioId;
    }
    /**
     * Verifica se o técnico notificado é específico
     */
    tecnicoNotificadoEh(tecnicoId) {
        return this.tecnico_notificado_id === tecnicoId;
    }
    /**
     * Obtém um resumo da conversão
     */
    getSummary() {
        const mudanca = this.getDescricaoMudanca();
        const data = this.getCriacaoFormatada();
        const notificacao = this.isNotificacaoEnviada() ? ' (Notificado)' : '';
        return `${mudanca} em ${data}${notificacao}`;
    }
    /**
     * Gera uma chave única para o histórico
     */
    getUniqueKey() {
        return `historico_${this.cidadao_id}_${this.created_at.getTime()}`;
    }
    /**
     * Verifica se o histórico é consistente
     */
    isConsistente() {
        // Verifica se tem cidadão
        if (!this.cidadao_id)
            return false;
        // Verifica se tem usuário
        if (!this.usuario_id)
            return false;
        // Verifica se tem papéis válidos
        if (!this.papel_anterior || !this.papel_novo)
            return false;
        // Verifica se os papéis são diferentes
        if (this.papel_anterior === this.papel_novo)
            return false;
        // Verifica se tem justificativa
        if (!this.justificativa || this.justificativa.trim().length === 0)
            return false;
        return true;
    }
    /**
     * Clona o histórico (sem ID)
     */
    clone() {
        return {
            cidadao_id: this.cidadao_id,
            papel_anterior: this.papel_anterior,
            papel_novo: this.papel_novo,
            composicao_familiar_id: this.composicao_familiar_id,
            usuario_id: this.usuario_id,
            justificativa: this.justificativa,
            notificacao_enviada: this.notificacao_enviada,
            tecnico_notificado_id: this.tecnico_notificado_id,
        };
    }
    /**
     * Verifica se é uma conversão crítica (requer atenção especial)
     */
    isCritico() {
        // Conversões para responsável familiar são críticas
        if (this.papel_novo === tipo_papel_enum_1.TipoPapel.REQUERENTE)
            return true;
        // Remoção de responsável familiar é crítica
        if (this.papel_anterior === tipo_papel_enum_1.TipoPapel.REQUERENTE)
            return true;
        // Conversões recentes sem notificação são críticas
        if (this.isCriadoRecentemente() && !this.isNotificacaoEnviada())
            return true;
        return false;
    }
    /**
     * Verifica se requer aprovação adicional
     */
    requerAprovacao() {
        // Mudanças para responsável familiar requerem aprovação
        if (this.papel_novo === tipo_papel_enum_1.TipoPapel.REQUERENTE)
            return true;
        // Reduções de papel requerem aprovação
        if (this.isReducao())
            return true;
        return false;
    }
    /**
     * Obtém o tipo de impacto da conversão
     */
    getTipoImpacto() {
        if (this.isCritico())
            return 'ALTO';
        if (this.requerAprovacao())
            return 'MEDIO';
        return 'BAIXO';
    }
    /**
     * Formata a data de criação
     */
    getCriacaoFormatada() {
        return this.created_at.toLocaleDateString('pt-BR', {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit'
        });
    }
    /**
     * Remove informações sensíveis para logs
     */
    toSafeLog() {
        return {
            id: this.id,
            papel_anterior: this.papel_anterior,
            papel_novo: this.papel_novo,
            notificacao_enviada: this.notificacao_enviada,
            created_at: this.created_at,
        };
    }
    /**
     * Verifica se a notificação está pendente há muito tempo
     */
    notificacaoPendenteMuitoTempo() {
        if (this.isNotificacaoEnviada())
            return false;
        const seteDiasAtras = new Date();
        seteDiasAtras.setDate(seteDiasAtras.getDate() - 7);
        return this.created_at < seteDiasAtras;
    }
    /**
     * Obtém sugestões de ação para o histórico
     */
    getSugestoesAcao() {
        const sugestoes = [];
        if (!this.isNotificacaoEnviada()) {
            sugestoes.push('Enviar notificação sobre a conversão');
        }
        if (this.notificacaoPendenteMuitoTempo()) {
            sugestoes.push('Notificação pendente há mais de 7 dias - verificar urgência');
        }
        if (this.isCritico() && !this.temTecnicoNotificado()) {
            sugestoes.push('Conversão crítica - notificar técnico responsável');
        }
        if (!this.isConsistente()) {
            sugestoes.push('Verificar consistência dos dados do histórico');
        }
        return sugestoes;
    }
    /**
     * Verifica se pode ser auditado
     */
    podeSerAuditado() {
        return this.isConsistente() && this.getIdadeRegistroEmDias() >= 1;
    }
    /**
     * Obtém estatísticas da conversão
     */
    getEstatisticas() {
        return {
            tipo_mudanca: this.isPromocao() ? 'PROMOCAO' : this.isReducao() ? 'REDUCAO' : 'LATERAL',
            impacto: this.getTipoImpacto(),
            dias_desde_conversao: this.getIdadeRegistroEmDias(),
            notificacao_status: this.isNotificacaoEnviada() ? 'ENVIADA' : 'PENDENTE'
        };
    }
};
exports.HistoricoConversaoPapel = HistoricoConversaoPapel;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'cidadao_id', type: 'uuid' }),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "cidadao_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => cidadao_entity_1.Cidadao, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'cidadao_id' }),
    __metadata("design:type", typeof (_a = typeof cidadao_entity_1.Cidadao !== "undefined" && cidadao_entity_1.Cidadao) === "function" ? _a : Object)
], HistoricoConversaoPapel.prototype, "cidadao", void 0);
__decorate([
    (0, typeorm_1.Column)({
        name: 'papel_anterior',
        type: 'enum',
        enum: tipo_papel_enum_1.TipoPapel,
        enumName: 'tipo_papel',
    }),
    __metadata("design:type", typeof (_b = typeof tipo_papel_enum_1.PaperType !== "undefined" && tipo_papel_enum_1.PaperType) === "function" ? _b : Object)
], HistoricoConversaoPapel.prototype, "papel_anterior", void 0);
__decorate([
    (0, typeorm_1.Column)({
        name: 'papel_novo',
        type: 'enum',
        enum: tipo_papel_enum_1.TipoPapel,
        enumName: 'tipo_papel',
    }),
    __metadata("design:type", typeof (_c = typeof tipo_papel_enum_1.PaperType !== "undefined" && tipo_papel_enum_1.PaperType) === "function" ? _c : Object)
], HistoricoConversaoPapel.prototype, "papel_novo", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'composicao_familiar_id', type: 'uuid', nullable: true }),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "composicao_familiar_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'usuario_id', type: 'uuid' }),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "usuario_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'justificativa', type: 'text' }),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "justificativa", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'notificacao_enviada', type: 'boolean', default: false }),
    __metadata("design:type", Boolean)
], HistoricoConversaoPapel.prototype, "notificacao_enviada", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'tecnico_notificado_id', type: 'uuid', nullable: true }),
    __metadata("design:type", String)
], HistoricoConversaoPapel.prototype, "tecnico_notificado_id", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)({ name: 'created_at' }),
    __metadata("design:type", typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object)
], HistoricoConversaoPapel.prototype, "created_at", void 0);
exports.HistoricoConversaoPapel = HistoricoConversaoPapel = __decorate([
    (0, typeorm_1.Entity)('historico_conversao_papel'),
    (0, typeorm_1.Index)(['cidadao_id', 'created_at'])
], HistoricoConversaoPapel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxoaXN0b3JpY28tY29udmVyc2FvLXBhcGVsLmVudGl0eS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEscUNBUWlCO0FBQ2pCLHFEQUEyQztBQUMzQyw4REFBZ0U7QUFFaEU7Ozs7O0dBS0c7QUFHSSxJQUFNLHVCQUF1QixHQUE3QixNQUFNLHVCQUF1QjtJQUVsQyxFQUFFLENBQVM7SUFHWCxVQUFVLENBQVM7SUFJbkIsT0FBTyxDQUFVO0lBUWpCLGNBQWMsQ0FBWTtJQVExQixVQUFVLENBQVk7SUFHdEIsc0JBQXNCLENBQVM7SUFHL0IsVUFBVSxDQUFTO0lBR25CLGFBQWEsQ0FBUztJQUd0QixtQkFBbUIsQ0FBVTtJQUc3QixxQkFBcUIsQ0FBUztJQUc5QixVQUFVLENBQU87SUFFakIsb0JBQW9CO0lBQ3BCLElBQUksU0FBUztRQUNYLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN6QixDQUFDO0lBRUQsSUFBSSxTQUFTLENBQUMsS0FBYTtRQUN6QixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztJQUMxQixDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLFNBQVMsQ0FBQyxLQUFhO1FBQ3pCLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO0lBQzFCLENBQUM7SUFFRCxJQUFJLG9CQUFvQjtRQUN0QixPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztJQUNyQyxDQUFDO0lBRUQsSUFBSSxvQkFBb0IsQ0FBQyxLQUFhO1FBQ3BDLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxLQUFLLENBQUM7SUFDdEMsQ0FBQztJQUVELElBQUksbUJBQW1CO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixDQUFDO0lBQ3BDLENBQUM7SUFFRCxJQUFJ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QVMsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUM7O29FQUM1QztBQUc3QjtJQURDLElBQUEsZ0JBQU0sRUFBQyxFQUFFLElBQUksRUFBRSx1QkFBdUIsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQzs7c0VBQzFDO0FBRzlCO0lBREMsSUFBQSwwQkFBZ0IsRUFBQyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUUsQ0FBQztrREFDN0IsSUFBSSxvQkFBSixJQUFJOzJEQUFDO2tDQTNDTix1QkFBdUI7SUFGbkMsSUFBQSxnQkFBTSxFQUFDLDJCQUEyQixDQUFDO0lBQ25DLElBQUEsZUFBSyxFQUFDLENBQUMsWUFBWSxFQUFFLFlBQVksQ0FBQyxDQUFDO0dBQ3ZCLHVCQUF1QixDQStZbkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxoaXN0b3JpY28tY29udmVyc2FvLXBhcGVsLmVudGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbnRpdHksXG4gIFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4sXG4gIENvbHVtbixcbiAgQ3JlYXRlRGF0ZUNvbHVtbixcbiAgTWFueVRvT25lLFxuICBKb2luQ29sdW1uLFxuICBJbmRleCxcbn0gZnJvbSAndHlwZW9ybSc7XG5pbXBvcnQgeyBDaWRhZGFvIH0gZnJvbSAnLi9jaWRhZGFvLmVudGl0eSc7XG5pbXBvcnQgeyBUaXBvUGFwZWwsIFBhcGVyVHlwZSB9IGZyb20gJy4uL2VudW1zL3RpcG8tcGFwZWwuZW51bSc7XG5cbi8qKlxuICogRW50aWRhZGUgZGUgSGlzdMOzcmljbyBkZSBDb252ZXJzw6NvIGRlIFBhcGVsXG4gKlxuICogUmVnaXN0cmEgbyBoaXN0w7NyaWNvIGRlIGNvbnZlcnPDtWVzIGRlIHBhcMOpaXMgZGUgY2lkYWTDo29zIG5vIHNpc3RlbWEsXG4gKiBwZXJtaXRpbmRvIHJhc3RyZWFyIHF1YW5kbyB1bSBjaWRhZMOjbyBmb2kgY29udmVydGlkbyBkZSB1bSBwYXBlbCBwYXJhIG91dHJvLlxuICovXG5ARW50aXR5KCdoaXN0b3JpY29fY29udmVyc2FvX3BhcGVsJylcbkBJbmRleChbJ2NpZGFkYW9faWQnLCAnY3JlYXRlZF9hdCddKVxuZXhwb3J0IGNsYXNzIEhpc3Rvcmljb0NvbnZlcnNhb1BhcGVsIHtcbiAgQFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4oJ3V1aWQnKVxuICBpZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyBuYW1lOiAnY2lkYWRhb19pZCcsIHR5cGU6ICd1dWlkJyB9KVxuICBjaWRhZGFvX2lkOiBzdHJpbmc7XG5cbiAgQE1hbnlUb09uZSgoKSA9PiBDaWRhZGFvLCB7IG9uRGVsZXRlOiAnQ0FTQ0FERScgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAnY2lkYWRhb19pZCcgfSlcbiAgY2lkYWRhbzogQ2lkYWRhbztcblxuICBAQ29sdW1uKHtcbiAgICBuYW1lOiAncGFwZWxfYW50ZXJpb3InLFxuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBUaXBvUGFwZWwsXG4gICAgZW51bU5hbWU6ICd0aXBvX3BhcGVsJyxcbiAgfSlcbiAgcGFwZWxfYW50ZXJpb3I6IFBhcGVyVHlwZTtcblxuICBAQ29sdW1uKHtcbiAgICBuYW1lOiAncGFwZWxfbm92bycsXG4gICAgdHlwZTogJ2VudW0nLFxuICAgIGVudW06IFRpcG9QYXBlbCxcbiAgICBlbnVtTmFtZTogJ3RpcG9fcGFwZWwnLFxuICB9KVxuICBwYXBlbF9ub3ZvOiBQYXBlclR5cGU7XG5cbiAgQENvbHVtbih7IG5hbWU6ICdjb21wb3NpY2FvX2ZhbWlsaWFyX2lkJywgdHlwZTogJ3V1aWQnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBjb21wb3NpY2FvX2ZhbWlsaWFyX2lkOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IG5hbWU6ICd1c3VhcmlvX2lkJywgdHlwZTogJ3V1aWQnIH0pXG4gIHVzdWFyaW9faWQ6IHN0cmluZztcblxuICBAQ29sdW1uKHsgbmFtZTogJ2p1c3RpZmljYXRpdmEnLCB0eXBlOiAndGV4dCcgfSlcbiAganVzdGlmaWNhdGl2YTogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyBuYW1lOiAnbm90aWZpY2FjYW9fZW52aWFkYScsIHR5cGU6ICdib29sZWFuJywgZGVmYXVsdDogZmFsc2UgfSlcbiAgbm90aWZpY2FjYW9fZW52aWFkYTogYm9vbGVhbjtcblxuICBAQ29sdW1uKHsgbmFtZTogJ3RlY25pY29fbm90aWZpY2Fkb19pZCcsIHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUgfSlcbiAgdGVjbmljb19ub3RpZmljYWRvX2lkOiBzdHJpbmc7XG5cbiAgQENyZWF0ZURhdGVDb2x1bW4oeyBuYW1lOiAnY3JlYXRlZF9hdCcgfSlcbiAgY3JlYXRlZF9hdDogRGF0ZTtcblxuICAvLyBHZXR0ZXJzIGUgU2V0dGVyc1xuICBnZXQgY2lkYWRhb0lkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY2lkYWRhb19pZDtcbiAgfVxuXG4gIHNldCBjaWRhZGFvSWQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuY2lkYWRhb19pZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHVzdWFyaW9JZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnVzdWFyaW9faWQ7XG4gIH1cblxuICBzZXQgdXN1YXJpb0lkKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnVzdWFyaW9faWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBjb21wb3NpY2FvRmFtaWxpYXJJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvbXBvc2ljYW9fZmFtaWxpYXJfaWQ7XG4gIH1cblxuICBzZXQgY29tcG9zaWNhb0ZhbWlsaWFySWQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuY29tcG9zaWNhb19mYW1pbGlhcl9pZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHRlY25pY29Ob3RpZmljYWRvSWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy50ZWNuaWNvX25vdGlmaWNhZG9faWQ7XG4gIH1cblxuICBzZXQgdGVjbmljb05vdGlmaWNhZG9JZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy50ZWNuaWNvX25vdGlmaWNhZG9faWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBjcmVhdGVkQXQoKTogRGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlZF9hdDtcbiAgfVxuXG4gIC8vIE3DqXRvZG9zIFV0aWxpdMOhcmlvc1xuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIGNvbnZlcnPDo28gZm9pIGNyaWFkYSByZWNlbnRlbWVudGUgKMO6bHRpbWFzIDI0IGhvcmFzKVxuICAgKi9cbiAgaXNDcmlhZG9SZWNlbnRlbWVudGUoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYWdvcmEgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHVtRGlhQXRyYXMgPSBuZXcgRGF0ZShhZ29yYS5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0ID4gdW1EaWFBdHJhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGEgaWRhZGUgZG8gcmVnaXN0cm8gZW0gZGlhc1xuICAgKi9cbiAgZ2V0SWRhZGVSZWdpc3Ryb0VtRGlhcygpOiBudW1iZXIge1xuICAgIGNvbnN0IGFnb3JhID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBkaWZmVGltZSA9IE1hdGguYWJzKGFnb3JhLmdldFRpbWUoKSAtIHRoaXMuY3JlYXRlZF9hdC5nZXRUaW1lKCkpO1xuICAgIHJldHVybiBNYXRoLmNlaWwoZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgbm90aWZpY2HDp8OjbyBmb2kgZW52aWFkYVxuICAgKi9cbiAgaXNOb3RpZmljYWNhb0VudmlhZGEoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubm90aWZpY2FjYW9fZW52aWFkYTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSB0ZW0gdMOpY25pY28gbm90aWZpY2Fkb1xuICAgKi9cbiAgdGVtVGVjbmljb05vdGlmaWNhZG8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy50ZWNuaWNvX25vdGlmaWNhZG9faWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgdGVtIGNvbXBvc2nDp8OjbyBmYW1pbGlhciBhc3NvY2lhZGFcbiAgICovXG4gIHRlbUNvbXBvc2ljYW9GYW1pbGlhcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISF0aGlzLmNvbXBvc2ljYW9fZmFtaWxpYXJfaWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIHByb21vw6fDo28gKHBhcGVsIG5vdm8gw6kgXCJzdXBlcmlvclwiIGFvIGFudGVyaW9yKVxuICAgKi9cbiAgaXNQcm9tb2NhbygpOiBib29sZWFuIHtcbiAgICBjb25zdCBoaWVyYXJxdWlhID0ge1xuICAgICAgW1RpcG9QYXBlbC5ERVBFTkRFTlRFXTogMSxcbiAgICAgIFtUaXBvUGFwZWwuQkVORUZJQ0lBUklPXTogMixcbiAgICAgIFtUaXBvUGFwZWwuUkVQUkVTRU5UQU5URV9MRUdBTF06IDMsXG4gICAgICBbVGlwb1BhcGVsLlJFUVVFUkVOVEVdOiA0LFxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIGhpZXJhcnF1aWFbdGhpcy5wYXBlbF9ub3ZvXSA+IGhpZXJhcnF1aWFbdGhpcy5wYXBlbF9hbnRlcmlvcl07XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIHJlZHXDp8OjbyBkZSBwYXBlbFxuICAgKi9cbiAgaXNSZWR1Y2FvKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGhpZXJhcnF1aWEgPSB7XG4gICAgICBbVGlwb1BhcGVsLkRFUEVOREVOVEVdOiAxLFxuICAgICAgW1RpcG9QYXBlbC5CRU5FRklDSUFSSU9dOiAyLFxuICAgICAgW1RpcG9QYXBlbC5SRVBSRVNFTlRBTlRFX0xFR0FMXTogMyxcbiAgICAgIFtUaXBvUGFwZWwuUkVRVUVSRU5URV06IDQsXG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gaGllcmFycXVpYVt0aGlzLnBhcGVsX25vdm9dIDwgaGllcmFycXVpYVt0aGlzLnBhcGVsX2FudGVyaW9yXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSB1bWEgbXVkYW7Dp2EgbGF0ZXJhbCAobWVzbW8gbsOtdmVsIGhpZXLDoXJxdWljbylcbiAgICovXG4gIGlzTXVkYW5jYUxhdGVyYWwoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLmlzUHJvbW9jYW8oKSAmJiAhdGhpcy5pc1JlZHVjYW8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gYSBkZXNjcmnDp8OjbyBkbyBwYXBlbCBhbnRlcmlvclxuICAgKi9cbiAgZ2V0RGVzY3JpY2FvUGFwZWxBbnRlcmlvcigpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRlc2NyaWNvZXMgPSB7XG4gICAgICBbVGlwb1BhcGVsLlJFUVVFUkVOVEVdOiAnUmVzcG9uc8OhdmVsIEZhbWlsaWFyJyxcbiAgICAgIFtUaXBvUGFwZWwuQkVORUZJQ0lBUklPXTogJ0JlbmVmaWNpw6FyaW8nLFxuICAgICAgW1RpcG9QYXBlbC5SRVBSRVNFTlRBTlRFX0xFR0FMXTogJ1JlcHJlc2VudGFudGUgTGVnYWwnLFxuICAgICAgW1RpcG9QYXBlbC5ERVBFTkRFTlRFXTogJ0RlcGVuZGVudGUnLFxuICAgIH07XG4gICAgcmV0dXJuIGRlc2NyaWNvZXNbdGhpcy5wYXBlbF9hbnRlcmlvcl0gfHwgdGhpcy5wYXBlbF9hbnRlcmlvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gYSBkZXNjcmnDp8OjbyBkbyBwYXBlbCBub3ZvXG4gICAqL1xuICBnZXREZXNjcmljYW9QYXBlbE5vdm8oKTogc3RyaW5nIHtcbiAgICBjb25zdCBkZXNjcmljb2VzID0ge1xuICAgICAgW1RpcG9QYXBlbC5SRVFVRVJFTlRFXTogJ1Jlc3BvbnPDoXZlbCBGYW1pbGlhcicsXG4gICAgICBbVGlwb1BhcGVsLkJFTkVGSUNJQVJJT106ICdCZW5lZmljacOhcmlvJyxcbiAgICAgIFtUaXBvUGFwZWwuUkVQUkVTRU5UQU5URV9MRUdBTF06ICdSZXByZXNlbnRhbnRlIExlZ2FsJyxcbiAgICAgIFtUaXBvUGFwZWwuREVQRU5ERU5URV06ICdEZXBlbmRlbnRlJyxcbiAgICB9O1xuICAgIHJldHVybiBkZXNjcmljb2VzW3RoaXMucGFwZWxfbm92b10gfHwgdGhpcy5wYXBlbF9ub3ZvO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBhIGRlc2NyacOnw6NvIGRhIG11ZGFuw6dhXG4gICAqL1xuICBnZXREZXNjcmljYW9NdWRhbmNhKCk6IHN0cmluZyB7XG4gICAgY29uc3QgYW50ZXJpb3IgPSB0aGlzLmdldERlc2NyaWNhb1BhcGVsQW50ZXJpb3IoKTtcbiAgICBjb25zdCBub3ZvID0gdGhpcy5nZXREZXNjcmljYW9QYXBlbE5vdm8oKTtcbiAgICBcbiAgICBpZiAodGhpcy5pc1Byb21vY2FvKCkpIHtcbiAgICAgIHJldHVybiBgUHJvbW/Dp8OjbzogJHthbnRlcmlvcn0g4oaSICR7bm92b31gO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc1JlZHVjYW8oKSkge1xuICAgICAgcmV0dXJuIGBSZWR1w6fDo286ICR7YW50ZXJpb3J9IOKGkiAke25vdm99YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBNdWRhbsOnYTogJHthbnRlcmlvcn0g4oaSICR7bm92b31gO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBwZXJ0ZW5jZSBhIHVtIGNpZGFkw6NvIGVzcGVjw61maWNvXG4gICAqL1xuICBwZXJ0ZW5jZUFvQ2lkYWRhbyhjaWRhZGFvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNpZGFkYW9faWQgPT09IGNpZGFkYW9JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBmb2kgZXhlY3V0YWRvIHBvciB1bSB1c3XDoXJpbyBlc3BlY8OtZmljb1xuICAgKi9cbiAgZm9pRXhlY3V0YWRvUG9yVXN1YXJpbyh1c3VhcmlvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnVzdWFyaW9faWQgPT09IHVzdWFyaW9JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBvIHTDqWNuaWNvIG5vdGlmaWNhZG8gw6kgZXNwZWPDrWZpY29cbiAgICovXG4gIHRlY25pY29Ob3RpZmljYWRvRWgodGVjbmljb0lkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50ZWNuaWNvX25vdGlmaWNhZG9faWQgPT09IHRlY25pY29JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gdW0gcmVzdW1vIGRhIGNvbnZlcnPDo29cbiAgICovXG4gIGdldFN1bW1hcnkoKTogc3RyaW5nIHtcbiAgICBjb25zdCBtdWRhbmNhID0gdGhpcy5nZXREZXNjcmljYW9NdWRhbmNhKCk7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0Q3JpYWNhb0Zvcm1hdGFkYSgpO1xuICAgIGNvbnN0IG5vdGlmaWNhY2FvID0gdGhpcy5pc05vdGlmaWNhY2FvRW52aWFkYSgpID8gJyAoTm90aWZpY2FkbyknIDogJyc7XG4gICAgcmV0dXJuIGAke211ZGFuY2F9IGVtICR7ZGF0YX0ke25vdGlmaWNhY2FvfWA7XG4gIH1cblxuICAvKipcbiAgICogR2VyYSB1bWEgY2hhdmUgw7puaWNhIHBhcmEgbyBoaXN0w7NyaWNvXG4gICAqL1xuICBnZXRVbmlxdWVLZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGhpc3Rvcmljb18ke3RoaXMuY2lkYWRhb19pZH1fJHt0aGlzLmNyZWF0ZWRfYXQuZ2V0VGltZSgpfWA7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBoaXN0w7NyaWNvIMOpIGNvbnNpc3RlbnRlXG4gICAqL1xuICBpc0NvbnNpc3RlbnRlKCk6IGJvb2xlYW4ge1xuICAgIC8vIFZlcmlmaWNhIHNlIHRlbSBjaWRhZMOjb1xuICAgIGlmICghdGhpcy5jaWRhZGFvX2lkKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gVmVyaWZpY2Egc2UgdGVtIHVzdcOhcmlvXG4gICAgaWYgKCF0aGlzLnVzdWFyaW9faWQpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAvLyBWZXJpZmljYSBzZSB0ZW0gcGFww6lpcyB2w6FsaWRvc1xuICAgIGlmICghdGhpcy5wYXBlbF9hbnRlcmlvciB8fCAhdGhpcy5wYXBlbF9ub3ZvKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gVmVyaWZpY2Egc2Ugb3MgcGFww6lpcyBzw6NvIGRpZmVyZW50ZXNcbiAgICBpZiAodGhpcy5wYXBlbF9hbnRlcmlvciA9PT0gdGhpcy5wYXBlbF9ub3ZvKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gVmVyaWZpY2Egc2UgdGVtIGp1c3RpZmljYXRpdmFcbiAgICBpZiAoIXRoaXMuanVzdGlmaWNhdGl2YSB8fCB0aGlzLmp1c3RpZmljYXRpdmEudHJpbSgpLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb25hIG8gaGlzdMOzcmljbyAoc2VtIElEKVxuICAgKi9cbiAgY2xvbmUoKTogUGFydGlhbDxIaXN0b3JpY29Db252ZXJzYW9QYXBlbD4ge1xuICAgIHJldHVybiB7XG4gICAgICBjaWRhZGFvX2lkOiB0aGlzLmNpZGFkYW9faWQsXG4gICAgICBwYXBlbF9hbnRlcmlvcjogdGhpcy5wYXBlbF9hbnRlcmlvcixcbiAgICAgIHBhcGVsX25vdm86IHRoaXMucGFwZWxfbm92byxcbiAgICAgIGNvbXBvc2ljYW9fZmFtaWxpYXJfaWQ6IHRoaXMuY29tcG9zaWNhb19mYW1pbGlhcl9pZCxcbiAgICAgIHVzdWFyaW9faWQ6IHRoaXMudXN1YXJpb19pZCxcbiAgICAgIGp1c3RpZmljYXRpdmE6IHRoaXMuanVzdGlmaWNhdGl2YSxcbiAgICAgIG5vdGlmaWNhY2FvX2VudmlhZGE6IHRoaXMubm90aWZpY2FjYW9fZW52aWFkYSxcbiAgICAgIHRlY25pY29fbm90aWZpY2Fkb19pZDogdGhpcy50ZWNuaWNvX25vdGlmaWNhZG9faWQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSB1bWEgY29udmVyc8OjbyBjcsOtdGljYSAocmVxdWVyIGF0ZW7Dp8OjbyBlc3BlY2lhbClcbiAgICovXG4gIGlzQ3JpdGljbygpOiBib29sZWFuIHtcbiAgICAvLyBDb252ZXJzw7VlcyBwYXJhIHJlc3BvbnPDoXZlbCBmYW1pbGlhciBzw6NvIGNyw610aWNhc1xuICAgIGlmICh0aGlzLnBhcGVsX25vdm8gPT09IFRpcG9QYXBlbC5SRVFVRVJFTlRFKSByZXR1cm4gdHJ1ZTtcbiAgICBcbiAgICAvLyBSZW1vw6fDo28gZGUgcmVzcG9uc8OhdmVsIGZhbWlsaWFyIMOpIGNyw610aWNhXG4gICAgaWYgKHRoaXMucGFwZWxfYW50ZXJpb3IgPT09IFRpcG9QYXBlbC5SRVFVRVJFTlRFKSByZXR1cm4gdHJ1ZTtcbiAgICBcbiAgICAvLyBDb252ZXJzw7VlcyByZWNlbnRlcyBzZW0gbm90aWZpY2HDp8OjbyBzw6NvIGNyw610aWNhc1xuICAgIGlmICh0aGlzLmlzQ3JpYWRvUmVjZW50ZW1lbnRlKCkgJiYgIXRoaXMuaXNOb3RpZmljYWNhb0VudmlhZGEoKSkgcmV0dXJuIHRydWU7XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHJlcXVlciBhcHJvdmHDp8OjbyBhZGljaW9uYWxcbiAgICovXG4gIHJlcXVlckFwcm92YWNhbygpOiBib29sZWFuIHtcbiAgICAvLyBNdWRhbsOnYXMgcGFyYSByZXNwb25zw6F2ZWwgZmFtaWxpYXIgcmVxdWVyZW0gYXByb3Zhw6fDo29cbiAgICBpZiAodGhpcy5wYXBlbF9ub3ZvID09PSBUaXBvUGFwZWwuUkVRVUVSRU5URSkgcmV0dXJuIHRydWU7XG4gICAgXG4gICAgLy8gUmVkdcOnw7VlcyBkZSBwYXBlbCByZXF1ZXJlbSBhcHJvdmHDp8Ojb1xuICAgIGlmICh0aGlzLmlzUmVkdWNhbygpKSByZXR1cm4gdHJ1ZTtcbiAgICBcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIG8gdGlwbyBkZSBpbXBhY3RvIGRhIGNvbnZlcnPDo29cbiAgICovXG4gIGdldFRpcG9JbXBhY3RvKCk6ICdBTFRPJyB8ICdNRURJTycgfCAnQkFJWE8nIHtcbiAgICBpZiAodGhpcy5pc0NyaXRpY28oKSkgcmV0dXJuICdBTFRPJztcbiAgICBpZiAodGhpcy5yZXF1ZXJBcHJvdmFjYW8oKSkgcmV0dXJuICdNRURJTyc7XG4gICAgcmV0dXJuICdCQUlYTyc7XG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0YSBhIGRhdGEgZGUgY3JpYcOnw6NvXG4gICAqL1xuICBnZXRDcmlhY2FvRm9ybWF0YWRhKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlZF9hdC50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJywge1xuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgbW9udGg6ICcyLWRpZ2l0JyxcbiAgICAgIGRheTogJzItZGlnaXQnLFxuICAgICAgaG91cjogJzItZGlnaXQnLFxuICAgICAgbWludXRlOiAnMi1kaWdpdCdcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgaW5mb3JtYcOnw7VlcyBzZW5zw612ZWlzIHBhcmEgbG9nc1xuICAgKi9cbiAgdG9TYWZlTG9nKCk6IFBhcnRpYWw8SGlzdG9yaWNvQ29udmVyc2FvUGFwZWw+IHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICBwYXBlbF9hbnRlcmlvcjogdGhpcy5wYXBlbF9hbnRlcmlvcixcbiAgICAgIHBhcGVsX25vdm86IHRoaXMucGFwZWxfbm92byxcbiAgICAgIG5vdGlmaWNhY2FvX2VudmlhZGE6IHRoaXMubm90aWZpY2FjYW9fZW52aWFkYSxcbiAgICAgIGNyZWF0ZWRfYXQ6IHRoaXMuY3JlYXRlZF9hdCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgbm90aWZpY2HDp8OjbyBlc3TDoSBwZW5kZW50ZSBow6EgbXVpdG8gdGVtcG9cbiAgICovXG4gIG5vdGlmaWNhY2FvUGVuZGVudGVNdWl0b1RlbXBvKCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmlzTm90aWZpY2FjYW9FbnZpYWRhKCkpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICBjb25zdCBzZXRlRGlhc0F0cmFzID0gbmV3IERhdGUoKTtcbiAgICBzZXRlRGlhc0F0cmFzLnNldERhdGUoc2V0ZURpYXNBdHJhcy5nZXREYXRlKCkgLSA3KTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0IDwgc2V0ZURpYXNBdHJhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gc3VnZXN0w7VlcyBkZSBhw6fDo28gcGFyYSBvIGhpc3TDs3JpY29cbiAgICovXG4gIGdldFN1Z2VzdG9lc0FjYW8oKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1Z2VzdG9lczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICBpZiAoIXRoaXMuaXNOb3RpZmljYWNhb0VudmlhZGEoKSkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ0VudmlhciBub3RpZmljYcOnw6NvIHNvYnJlIGEgY29udmVyc8OjbycpO1xuICAgIH1cbiAgICBcbiAgICBpZiAodGhpcy5ub3RpZmljYWNhb1BlbmRlbnRlTXVpdG9UZW1wbygpKSB7XG4gICAgICBzdWdlc3RvZXMucHVzaCgnTm90aWZpY2HDp8OjbyBwZW5kZW50ZSBow6EgbWFpcyBkZSA3IGRpYXMgLSB2ZXJpZmljYXIgdXJnw6puY2lhJyk7XG4gICAgfVxuICAgIFxuICAgIGlmICh0aGlzLmlzQ3JpdGljbygpICYmICF0aGlzLnRlbVRlY25pY29Ob3RpZmljYWRvKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdDb252ZXJzw6NvIGNyw610aWNhIC0gbm90aWZpY2FyIHTDqWNuaWNvIHJlc3BvbnPDoXZlbCcpO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXRoaXMuaXNDb25zaXN0ZW50ZSgpKSB7XG4gICAgICBzdWdlc3RvZXMucHVzaCgnVmVyaWZpY2FyIGNvbnNpc3TDqm5jaWEgZG9zIGRhZG9zIGRvIGhpc3TDs3JpY28nKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHN1Z2VzdG9lcztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBwb2RlIHNlciBhdWRpdGFkb1xuICAgKi9cbiAgcG9kZVNlckF1ZGl0YWRvKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzQ29uc2lzdGVudGUoKSAmJiB0aGlzLmdldElkYWRlUmVnaXN0cm9FbURpYXMoKSA+PSAxO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBlc3RhdMOtc3RpY2FzIGRhIGNvbnZlcnPDo29cbiAgICovXG4gIGdldEVzdGF0aXN0aWNhcygpOiB7XG4gICAgdGlwb19tdWRhbmNhOiBzdHJpbmc7XG4gICAgaW1wYWN0bzogc3RyaW5nO1xuICAgIGRpYXNfZGVzZGVfY29udmVyc2FvOiBudW1iZXI7XG4gICAgbm90aWZpY2FjYW9fc3RhdHVzOiBzdHJpbmc7XG4gIH0ge1xuICAgIHJldHVybiB7XG4gICAgICB0aXBvX211ZGFuY2E6IHRoaXMuaXNQcm9tb2NhbygpID8gJ1BST01PQ0FPJyA6IHRoaXMuaXNSZWR1Y2FvKCkgPyAnUkVEVUNBTycgOiAnTEFURVJBTCcsXG4gICAgICBpbXBhY3RvOiB0aGlzLmdldFRpcG9JbXBhY3RvKCksXG4gICAgICBkaWFzX2Rlc2RlX2NvbnZlcnNhbzogdGhpcy5nZXRJZGFkZVJlZ2lzdHJvRW1EaWFzKCksXG4gICAgICBub3RpZmljYWNhb19zdGF0dXM6IHRoaXMuaXNOb3RpZmljYWNhb0VudmlhZGEoKSA/ICdFTlZJQURBJyA6ICdQRU5ERU5URSdcbiAgICB9O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=