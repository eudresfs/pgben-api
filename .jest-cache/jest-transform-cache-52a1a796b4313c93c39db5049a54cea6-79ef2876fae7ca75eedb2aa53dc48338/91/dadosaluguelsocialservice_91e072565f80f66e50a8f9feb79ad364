079c6b35ac6459b30a0b02c98c0ef038
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.DadosAluguelSocialService = void 0;
const common_1 = require("@nestjs/common");
const typeorm_1 = require("@nestjs/typeorm");
const typeorm_2 = require("typeorm");
const dados_aluguel_social_entity_1 = require("../../../entities/dados-aluguel-social.entity");
/**
 * Serviço para gerenciar dados específicos de Aluguel Social
 */
let DadosAluguelSocialService = class DadosAluguelSocialService {
    dadosAluguelSocialRepository;
    constructor(dadosAluguelSocialRepository) {
        this.dadosAluguelSocialRepository = dadosAluguelSocialRepository;
    }
    /**
     * Criar dados de aluguel social para uma solicitação
     */
    async create(createDto) {
        // Verificar se já existem dados para esta solicitação
        const existingData = await this.dadosAluguelSocialRepository.findOne({
            where: { solicitacao_id: createDto.solicitacao_id },
        });
        if (existingData) {
            throw new Error('Já existem dados de aluguel social para esta solicitação');
        }
        const dadosAluguelSocial = this.dadosAluguelSocialRepository.create(createDto);
        return this.dadosAluguelSocialRepository.save(dadosAluguelSocial);
    }
    /**
     * Buscar dados de aluguel social por ID
     */
    async findOne(id) {
        const dadosAluguelSocial = await this.dadosAluguelSocialRepository.findOne({
            where: { id },
            relations: ['solicitacao'],
        });
        if (!dadosAluguelSocial) {
            throw new common_1.NotFoundException('Dados de aluguel social não encontrados');
        }
        return dadosAluguelSocial;
    }
    /**
     * Buscar dados de aluguel social por solicitação
     */
    async findBySolicitacao(solicitacaoId) {
        const dadosAluguelSocial = await this.dadosAluguelSocialRepository.findOne({
            where: { solicitacao_id: solicitacaoId },
            relations: ['solicitacao'],
        });
        if (!dadosAluguelSocial) {
            throw new common_1.NotFoundException('Dados de aluguel social não encontrados para esta solicitação');
        }
        return dadosAluguelSocial;
    }
    /**
     * Atualizar dados de aluguel social
     */
    async update(id, updateDto) {
        const dadosAluguelSocial = await this.findOne(id);
        // Atualizar apenas os campos fornecidos
        Object.assign(dadosAluguelSocial, updateDto);
        return this.dadosAluguelSocialRepository.save(dadosAluguelSocial);
    }
    /**
     * Remover dados de aluguel social
     */
    async remove(id) {
        const dadosAluguelSocial = await this.findOne(id);
        await this.dadosAluguelSocialRepository.remove(dadosAluguelSocial);
    }
    /**
     * Verificar se existem dados de aluguel social para uma solicitação
     */
    async existsBySolicitacao(solicitacaoId) {
        const count = await this.dadosAluguelSocialRepository.count({
            where: { solicitacao_id: solicitacaoId },
        });
        return count > 0;
    }
    /**
     * Buscar todos os dados de aluguel social com paginação
     */
    async findAll(page = 1, limit = 10) {
        const [data, total] = await this.dadosAluguelSocialRepository.findAndCount({
            relations: ['solicitacao'],
            skip: (page - 1) * limit,
            take: limit,
            order: { created_at: 'DESC' },
        });
        return {
            data,
            total,
            page,
            limit,
        };
    }
    /**
     * Buscar dados por público prioritário
     */
    async findByPublicoPrioritario(publicoPrioritario, page = 1, limit = 10) {
        const [data, total] = await this.dadosAluguelSocialRepository.findAndCount({
            where: { publico_prioritario: publicoPrioritario },
            relations: ['solicitacao'],
            skip: (page - 1) * limit,
            take: limit,
            order: { created_at: 'DESC' },
        });
        return {
            data,
            total,
            page,
            limit,
        };
    }
};
exports.DadosAluguelSocialService = DadosAluguelSocialService;
exports.DadosAluguelSocialService = DadosAluguelSocialService = __decorate([
    (0, common_1.Injectable)(),
    __param(0, (0, typeorm_1.InjectRepository)(dados_aluguel_social_entity_1.DadosAluguelSocial)),
    __metadata("design:paramtypes", [typeof (_a = typeof typeorm_2.Repository !== "undefined" && typeorm_2.Repository) === "function" ? _a : Object])
], DadosAluguelSocialService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGJlbmVmaWNpb1xcc2VydmljZXNcXGRhZG9zLWFsdWd1ZWwtc29jaWFsLnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUErRDtBQUMvRCw2Q0FBbUQ7QUFDbkQscUNBQXFDO0FBQ3JDLCtGQUFtRjtBQU1uRjs7R0FFRztBQUVJLElBQU0seUJBQXlCLEdBQS9CLE1BQU0seUJBQXlCO0lBR2pCO0lBRm5CLFlBRW1CLDRCQUE0RDtRQUE1RCxpQ0FBNEIsR0FBNUIsNEJBQTRCLENBQWdDO0lBQzVFLENBQUM7SUFFSjs7T0FFRztJQUNILEtBQUssQ0FBQyxNQUFNLENBQ1YsU0FBc0M7UUFFdEMsc0RBQXNEO1FBQ3RELE1BQU0sWUFBWSxHQUFHLE1BQU0sSUFBSSxDQUFDLDRCQUE0QixDQUFDLE9BQU8sQ0FBQztZQUNuRSxLQUFLLEVBQUUsRUFBRSxjQUFjLEVBQUUsU0FBUyxDQUFDLGNBQWMsRUFBRTtTQUNwRCxDQUFDLENBQUM7UUFFSCxJQUFJLFlBQVksRUFBRSxDQUFDO1lBQ2pCLE1BQU0sSUFBSSxLQUFLLENBQ2IsMERBQTBELENBQzNELENBQUM7UUFDSixDQUFDO1FBRUQsTUFBTSxrQkFBa0IsR0FDdEIsSUFBSSxDQUFDLDRCQUE0QixDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RCxPQUFPLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQVU7UUFDdEIsTUFBTSxrQkFBa0IsR0FBRyxNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxPQUFPLENBQUM7WUFDekUsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFO1lBQ2IsU0FBUyxFQUFFLENBQUMsYUFBYSxDQUFD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Q0FBQyxDQUFDO1FBRUgsT0FBTztZQUNMLElBQUk7WUFDSixLQUFLO1lBQ0wsSUFBSTtZQUNKLEtBQUs7U0FDTixDQUFDO0lBQ0osQ0FBQztDQUNGLENBQUE7QUF0SlksOERBQXlCO29DQUF6Qix5QkFBeUI7SUFEckMsSUFBQSxtQkFBVSxHQUFFO0lBR1IsV0FBQSxJQUFBLDBCQUFnQixFQUFDLGdEQUFrQixDQUFDLENBQUE7eURBQ1Usb0JBQVUsb0JBQVYsb0JBQVU7R0FIaEQseUJBQXlCLENBc0pyQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcYmVuZWZpY2lvXFxzZXJ2aWNlc1xcZGFkb3MtYWx1Z3VlbC1zb2NpYWwuc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBOb3RGb3VuZEV4Y2VwdGlvbiB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IEluamVjdFJlcG9zaXRvcnkgfSBmcm9tICdAbmVzdGpzL3R5cGVvcm0nO1xuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgRGFkb3NBbHVndWVsU29jaWFsIH0gZnJvbSAnLi4vLi4vLi4vZW50aXRpZXMvZGFkb3MtYWx1Z3VlbC1zb2NpYWwuZW50aXR5JztcbmltcG9ydCB7XG4gIENyZWF0ZURhZG9zQWx1Z3VlbFNvY2lhbER0byxcbiAgVXBkYXRlRGFkb3NBbHVndWVsU29jaWFsRHRvLFxufSBmcm9tICcuLi9kdG8vY3JlYXRlLWRhZG9zLWFsdWd1ZWwtc29jaWFsLmR0byc7XG5cbi8qKlxuICogU2VydmnDp28gcGFyYSBnZXJlbmNpYXIgZGFkb3MgZXNwZWPDrWZpY29zIGRlIEFsdWd1ZWwgU29jaWFsXG4gKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBEYWRvc0FsdWd1ZWxTb2NpYWxTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdFJlcG9zaXRvcnkoRGFkb3NBbHVndWVsU29jaWFsKVxuICAgIHByaXZhdGUgcmVhZG9ubHkgZGFkb3NBbHVndWVsU29jaWFsUmVwb3NpdG9yeTogUmVwb3NpdG9yeTxEYWRvc0FsdWd1ZWxTb2NpYWw+LFxuICApIHt9XG5cbiAgLyoqXG4gICAqIENyaWFyIGRhZG9zIGRlIGFsdWd1ZWwgc29jaWFsIHBhcmEgdW1hIHNvbGljaXRhw6fDo29cbiAgICovXG4gIGFzeW5jIGNyZWF0ZShcbiAgICBjcmVhdGVEdG86IENyZWF0ZURhZG9zQWx1Z3VlbFNvY2lhbER0byxcbiAgKTogUHJvbWlzZTxEYWRvc0FsdWd1ZWxTb2NpYWw+IHtcbiAgICAvLyBWZXJpZmljYXIgc2UgasOhIGV4aXN0ZW0gZGFkb3MgcGFyYSBlc3RhIHNvbGljaXRhw6fDo29cbiAgICBjb25zdCBleGlzdGluZ0RhdGEgPSBhd2FpdCB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkuZmluZE9uZSh7XG4gICAgICB3aGVyZTogeyBzb2xpY2l0YWNhb19pZDogY3JlYXRlRHRvLnNvbGljaXRhY2FvX2lkIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoZXhpc3RpbmdEYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdKw6EgZXhpc3RlbSBkYWRvcyBkZSBhbHVndWVsIHNvY2lhbCBwYXJhIGVzdGEgc29saWNpdGHDp8OjbycsXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhZG9zQWx1Z3VlbFNvY2lhbCA9XG4gICAgICB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkuY3JlYXRlKGNyZWF0ZUR0byk7XG4gICAgcmV0dXJuIHRoaXMuZGFkb3NBbHVndWVsU29jaWFsUmVwb3NpdG9yeS5zYXZlKGRhZG9zQWx1Z3VlbFNvY2lhbCk7XG4gIH1cblxuICAvKipcbiAgICogQnVzY2FyIGRhZG9zIGRlIGFsdWd1ZWwgc29jaWFsIHBvciBJRFxuICAgKi9cbiAgYXN5bmMgZmluZE9uZShpZDogc3RyaW5nKTogUHJvbWlzZTxEYWRvc0FsdWd1ZWxTb2NpYWw+IHtcbiAgICBjb25zdCBkYWRvc0FsdWd1ZWxTb2NpYWwgPSBhd2FpdCB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkuZmluZE9uZSh7XG4gICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgcmVsYXRpb25zOiBbJ3NvbGljaXRhY2FvJ10sXG4gICAgfSk7XG5cbiAgICBpZiAoIWRhZG9zQWx1Z3VlbFNvY2lhbCkge1xuICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdEYWRvcyBkZSBhbHVndWVsIHNvY2lhbCBuw6NvIGVuY29udHJhZG9zJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhZG9zQWx1Z3VlbFNvY2lhbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgZGUgYWx1Z3VlbCBzb2NpYWwgcG9yIHNvbGljaXRhw6fDo29cbiAgICovXG4gIGFzeW5jIGZpbmRCeVNvbGljaXRhY2FvKHNvbGljaXRhY2FvSWQ6IHN0cmluZyk6IFByb21pc2U8RGFkb3NBbHVndWVsU29jaWFsPiB7XG4gICAgY29uc3QgZGFkb3NBbHVndWVsU29jaWFsID0gYXdhaXQgdGhpcy5kYWRvc0FsdWd1ZWxTb2NpYWxSZXBvc2l0b3J5LmZpbmRPbmUoe1xuICAgICAgd2hlcmU6IHsgc29saWNpdGFjYW9faWQ6IHNvbGljaXRhY2FvSWQgfSxcbiAgICAgIHJlbGF0aW9uczogWydzb2xpY2l0YWNhbyddLFxuICAgIH0pO1xuXG4gICAgaWYgKCFkYWRvc0FsdWd1ZWxTb2NpYWwpIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbihcbiAgICAgICAgJ0RhZG9zIGRlIGFsdWd1ZWwgc29jaWFsIG7Do28gZW5jb250cmFkb3MgcGFyYSBlc3RhIHNvbGljaXRhw6fDo28nLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGFkb3NBbHVndWVsU29jaWFsO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dWFsaXphciBkYWRvcyBkZSBhbHVndWVsIHNvY2lhbFxuICAgKi9cbiAgYXN5bmMgdXBkYXRlKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgdXBkYXRlRHRvOiBVcGRhdGVEYWRvc0FsdWd1ZWxTb2NpYWxEdG8sXG4gICk6IFByb21pc2U8RGFkb3NBbHVndWVsU29jaWFsPiB7XG4gICAgY29uc3QgZGFkb3NBbHVndWVsU29jaWFsID0gYXdhaXQgdGhpcy5maW5kT25lKGlkKTtcblxuICAgIC8vIEF0dWFsaXphciBhcGVuYXMgb3MgY2FtcG9zIGZvcm5lY2lkb3NcbiAgICBPYmplY3QuYXNzaWduKGRhZG9zQWx1Z3VlbFNvY2lhbCwgdXBkYXRlRHRvKTtcblxuICAgIHJldHVybiB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkuc2F2ZShkYWRvc0FsdWd1ZWxTb2NpYWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXIgZGFkb3MgZGUgYWx1Z3VlbCBzb2NpYWxcbiAgICovXG4gIGFzeW5jIHJlbW92ZShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZGFkb3NBbHVndWVsU29jaWFsID0gYXdhaXQgdGhpcy5maW5kT25lKGlkKTtcbiAgICBhd2FpdCB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkucmVtb3ZlKGRhZG9zQWx1Z3VlbFNvY2lhbCk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2FyIHNlIGV4aXN0ZW0gZGFkb3MgZGUgYWx1Z3VlbCBzb2NpYWwgcGFyYSB1bWEgc29saWNpdGHDp8Ojb1xuICAgKi9cbiAgYXN5bmMgZXhpc3RzQnlTb2xpY2l0YWNhbyhzb2xpY2l0YWNhb0lkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBjb3VudCA9IGF3YWl0IHRoaXMuZGFkb3NBbHVndWVsU29jaWFsUmVwb3NpdG9yeS5jb3VudCh7XG4gICAgICB3aGVyZTogeyBzb2xpY2l0YWNhb19pZDogc29saWNpdGFjYW9JZCB9LFxuICAgIH0pO1xuICAgIHJldHVybiBjb3VudCA+IDA7XG4gIH1cblxuICAvKipcbiAgICogQnVzY2FyIHRvZG9zIG9zIGRhZG9zIGRlIGFsdWd1ZWwgc29jaWFsIGNvbSBwYWdpbmHDp8Ojb1xuICAgKi9cbiAgYXN5bmMgZmluZEFsbChcbiAgICBwYWdlOiBudW1iZXIgPSAxLFxuICAgIGxpbWl0OiBudW1iZXIgPSAxMCxcbiAgKTogUHJvbWlzZTx7XG4gICAgZGF0YTogRGFkb3NBbHVndWVsU29jaWFsW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgbGltaXQ6IG51bWJlcjtcbiAgfT4ge1xuICAgIGNvbnN0IFtkYXRhLCB0b3RhbF0gPSBhd2FpdCB0aGlzLmRhZG9zQWx1Z3VlbFNvY2lhbFJlcG9zaXRvcnkuZmluZEFuZENvdW50KHtcbiAgICAgIHJlbGF0aW9uczogWydzb2xpY2l0YWNhbyddLFxuICAgICAgc2tpcDogKHBhZ2UgLSAxKSAqIGxpbWl0LFxuICAgICAgdGFrZTogbGltaXQsXG4gICAgICBvcmRlcjogeyBjcmVhdGVkX2F0OiAnREVTQycgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhLFxuICAgICAgdG90YWwsXG4gICAgICBwYWdlLFxuICAgICAgbGltaXQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgcG9yIHDDumJsaWNvIHByaW9yaXTDoXJpb1xuICAgKi9cbiAgYXN5bmMgZmluZEJ5UHVibGljb1ByaW9yaXRhcmlvKFxuICAgIHB1YmxpY29Qcmlvcml0YXJpbzogc3RyaW5nLFxuICAgIHBhZ2U6IG51bWJlciA9IDEsXG4gICAgbGltaXQ6IG51bWJlciA9IDEwLFxuICApOiBQcm9taXNlPHtcbiAgICBkYXRhOiBEYWRvc0FsdWd1ZWxTb2NpYWxbXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIHBhZ2U6IG51bWJlcjtcbiAgICBsaW1pdDogbnVtYmVyO1xuICB9PiB7XG4gICAgY29uc3QgW2RhdGEsIHRvdGFsXSA9IGF3YWl0IHRoaXMuZGFkb3NBbHVndWVsU29jaWFsUmVwb3NpdG9yeS5maW5kQW5kQ291bnQoe1xuICAgICAgd2hlcmU6IHsgcHVibGljb19wcmlvcml0YXJpbzogcHVibGljb1ByaW9yaXRhcmlvIGFzIGFueSB9LFxuICAgICAgcmVsYXRpb25zOiBbJ3NvbGljaXRhY2FvJ10sXG4gICAgICBza2lwOiAocGFnZSAtIDEpICogbGltaXQsXG4gICAgICB0YWtlOiBsaW1pdCxcbiAgICAgIG9yZGVyOiB7IGNyZWF0ZWRfYXQ6ICdERVNDJyB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGEsXG4gICAgICB0b3RhbCxcbiAgICAgIHBhZ2UsXG4gICAgICBsaW1pdCxcbiAgICB9O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=