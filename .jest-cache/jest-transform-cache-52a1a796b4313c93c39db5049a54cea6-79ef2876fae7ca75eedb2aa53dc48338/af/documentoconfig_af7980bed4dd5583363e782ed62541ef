5e8394e0594a39f8da3169718ab2547d
"use strict";
/**
 * Configuração consolidada para o módulo de documentos
 *
 * Este arquivo centraliza todas as configurações relacionadas a documentos,
 * incluindo tipos MIME permitidos e configurações de upload.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.UPLOAD_CONFIG = exports.SECURITY_CONFIG = exports.BLOCKED_MIME_TYPES = exports.BLOCKED_EXTENSIONS = exports.EXTENSOES_PERMITIDAS = exports.MIME_TYPES_POR_CATEGORIA = exports.TODOS_MIME_TYPES_PERMITIDOS = exports.MIME_TYPE_CONFIGS = void 0;
exports.getMimeTypeConfig = getMimeTypeConfig;
exports.isMimeTypePermitido = isMimeTypePermitido;
exports.getCategoriaMimeType = getCategoriaMimeType;
exports.getExtensoesParaMimeType = getExtensoesParaMimeType;
exports.requiresEncryption = requiresEncryption;
exports.allowsThumbnail = allowsThumbnail;
exports.getMaxFileSize = getMaxFileSize;
/**
 * Configuração detalhada de tipos MIME permitidos
 */
exports.MIME_TYPE_CONFIGS = {
    // Documentos PDF
    pdf: {
        extension: 'pdf',
        mimeTypes: ['application/pdf'],
        maxSize: 10 * 1024 * 1024, // 10MB
        description: 'Documento PDF',
        allowThumbnail: true,
        category: 'DOCUMENTOS',
    },
    // Documentos do Microsoft Office
    docx: {
        extension: 'docx',
        mimeTypes: [
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        ],
        maxSize: 5 * 1024 * 1024, // 5MB
        description: 'Documento Word',
        allowThumbnail: false,
        category: 'DOCUMENTOS',
    },
    // Imagens
    jpg: {
        extension: 'jpg',
        mimeTypes: ['image/jpeg'],
        maxSize: 5 * 1024 * 1024, // 5MB
        description: 'Imagem JPEG',
        allowThumbnail: true,
        category: 'IMAGENS',
    },
    png: {
        extension: 'png',
        mimeTypes: ['image/png'],
        maxSize: 5 * 1024 * 1024, // 5MB
        description: 'Imagem PNG',
        allowThumbnail: true,
        category: 'IMAGENS',
    },
    // Texto
    txt: {
        extension: 'txt',
        mimeTypes: ['text/plain'],
        maxSize: 1 * 1024 * 1024, // 1MB
        description: 'Arquivo de texto',
        allowThumbnail: false,
        category: 'TEXTO',
    },
};
/**
 * Lista de todos os tipos MIME permitidos (extraída das configurações)
 */
exports.TODOS_MIME_TYPES_PERMITIDOS = Object.values(exports.MIME_TYPE_CONFIGS).flatMap((config) => config.mimeTypes);
/**
 * Mapeamento de tipos MIME por categoria
 */
exports.MIME_TYPES_POR_CATEGORIA = {
    DOCUMENTOS: Object.values(exports.MIME_TYPE_CONFIGS)
        .filter((config) => config.category === 'DOCUMENTOS')
        .flatMap((config) => config.mimeTypes),
    IMAGENS: Object.values(exports.MIME_TYPE_CONFIGS)
        .filter((config) => config.category === 'IMAGENS')
        .flatMap((config) => config.mimeTypes),
    PLANILHAS: Object.values(exports.MIME_TYPE_CONFIGS)
        .filter((config) => config.category === 'PLANILHAS')
        .flatMap((config) => config.mimeTypes),
    // APRESENTACOES: Categoria não definida na interface MimeTypeConfig
    TEXTO: Object.values(exports.MIME_TYPE_CONFIGS)
        .filter((config) => config.category === 'TEXTO')
        .flatMap((config) => config.mimeTypes),
};
/**
 * Extensões de arquivo correspondentes aos tipos MIME
 */
exports.EXTENSOES_PERMITIDAS = Object.values(exports.MIME_TYPE_CONFIGS).reduce((acc, config) => {
    config.mimeTypes.forEach((mimeType) => {
        if (!acc[mimeType]) {
            acc[mimeType] = [];
        }
        acc[mimeType].push(`.${config.extension}`);
    });
    return acc;
}, {});
/**
 * Lista de extensões perigosas que devem ser sempre bloqueadas
 */
exports.BLOCKED_EXTENSIONS = [
    // Executáveis
    'exe',
    'bat',
    'cmd',
    'com',
    'scr',
    'pif',
    'msi',
    'dll',
    // Scripts
    'js',
    'vbs',
    'ps1',
    'sh',
    'py',
    'pl',
    'php',
    'asp',
    'jsp',
    // Arquivos compactados (podem conter malware)
    'zip',
    'rar',
    '7z',
    'tar',
    'gz',
    // Outros formatos perigosos
    'html',
    'htm',
    'xml',
    'svg',
];
/**
 * Lista de tipos MIME perigosos que devem ser sempre bloqueados
 */
exports.BLOCKED_MIME_TYPES = [
    // Executáveis
    'application/x-msdownload',
    'application/x-executable',
    'application/x-dosexec',
    // Scripts
    'text/javascript',
    'application/javascript',
    'text/html',
    'application/x-httpd-php',
    // Arquivos compactados
    'application/zip',
    'application/x-rar-compressed',
    'application/x-7z-compressed',
    // XML/SVG (podem conter scripts)
    'image/svg+xml',
    'application/xml',
    'text/xml',
];
/**
 * Configurações de segurança para validação de arquivos
 */
exports.SECURITY_CONFIG = {
    // Tamanho máximo global para qualquer arquivo (20MB)
    MAX_FILE_SIZE: 20 * 1024 * 1024,
    // Número máximo de arquivos por upload
    MAX_FILES_PER_UPLOAD: 5,
    // Verificar magic numbers (assinatura do arquivo)
    VERIFY_MAGIC_NUMBERS: true,
    // Escanear conteúdo em busca de padrões suspeitos
    SCAN_CONTENT: true,
    // Verificar vírus/malware
    MALWARE_SCAN: true,
    // Criptografar documentos sensíveis
    ENCRYPT_SENSITIVE_DOCS: true,
    // Colocar arquivos suspeitos em quarentena
    QUARANTINE_SUSPICIOUS: true,
};
/**
 * Configurações de upload
 */
exports.UPLOAD_CONFIG = {
    // Diretório temporário para uploads
    TEMP_DIR: 'uploads/temp',
    // Diretório final para documentos
    DOCS_DIR: 'uploads/documentos',
    // Diretório para thumbnails
    THUMBNAILS_DIR: 'uploads/thumbnails',
    // Tempo limite para upload (em segundos)
    UPLOAD_TIMEOUT: 300,
    // Número máximo de tentativas de upload
    MAX_UPLOAD_RETRIES: 3,
};
/**
 * Funções utilitárias
 */
/**
 * Obtém a configuração de um tipo MIME
 */
function getMimeTypeConfig(mimeType) {
    return Object.values(exports.MIME_TYPE_CONFIGS).find((config) => config.mimeTypes.includes(mimeType));
}
/**
 * Verifica se um tipo MIME é permitido
 */
function isMimeTypePermitido(mimeType) {
    return exports.TODOS_MIME_TYPES_PERMITIDOS.includes(mimeType);
}
/**
 * Obtém a categoria de um tipo MIME
 */
function getCategoriaMimeType(mimeType) {
    const config = getMimeTypeConfig(mimeType);
    return config?.category || 'DESCONHECIDO';
}
/**
 * Obtém as extensões permitidas para um tipo MIME
 */
function getExtensoesParaMimeType(mimeType) {
    return exports.EXTENSOES_PERMITIDAS[mimeType] || [];
}
/**
 * Verifica se um arquivo requer criptografia
 */
function requiresEncryption(mimeType) {
    // Funcionalidade de criptografia não implementada ainda
    return false;
}
/**
 * Verifica se um arquivo permite thumbnail
 */
function allowsThumbnail(mimeType) {
    const config = getMimeTypeConfig(mimeType);
    return config?.allowThumbnail || false;
}
/**
 * Obtém o tamanho máximo permitido para um tipo MIME
 */
function getMaxFileSize(mimeType) {
    const config = getMimeTypeConfig(mimeType);
    return config?.maxSize || exports.SECURITY_CONFIG.MAX_FILE_SIZE;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGRvY3VtZW50b1xcY29uZmlnXFxkb2N1bWVudG8uY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7O0FBNk5ILDhDQU1DO0FBS0Qsa0RBRUM7QUFLRCxvREFHQztBQUtELDREQUVDO0FBS0QsZ0RBR0M7QUFLRCwwQ0FHQztBQUtELHdDQUdDO0FBdFFEOztHQUVHO0FBQ1UsUUFBQSxpQkFBaUIsR0FBbUM7SUFDL0QsaUJBQWlCO0lBQ2pCLEdBQUcsRUFBRTtRQUNILFNBQVMsRUFBRSxLQUFLO1FBQ2hCLFNBQVMsRUFBRSxDQUFDLGlCQUFpQixDQUFDO1FBQzlCLE9BQU8sRUFBRSxFQUFFLEdBQUcsSUFBSSxHQUFHLElBQUksRUFBRSxPQUFPO1FBQ2xDLFdBQVcsRUFBRSxlQUFlO1FBQzVCLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLFFBQVEsRUFBRSxZQUFZO0tBQ3ZCO0lBRUQsaUNBQWlDO0lBQ2pDLElBQUksRUFBRTtRQUNKLFNBQVMsRUFBRSxNQUFNO1FBQ2pCLFNBQVMsRUFBRTtZQUNULHlFQUF5RTtTQUMxRTtRQUNELE9BQU8sRUFBRSxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksRUFBRSxNQUFNO1FBQ2hDLFdBQVcsRUFBRSxnQkFBZ0I7UUFDN0IsY0FBYyxFQUFFLEtBQUs7UUFDckIsUUFBUSxFQUFFLFlBQVk7S0FDdkI7SUFFRCxVQUFVO0lBQ1YsR0FBRyxFQUFFO1FBQ0gsU0FBUyxFQUFFLEtBQUs7UUFDaEIsU0FBUyxFQUFFLENBQUMsWUFBWSxDQUFDO1FBQ3pCLE9BQU8sRUFBRSxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksRUFBRSxNQUFNO1FBQ2hDLFdBQVcsRUFBRSxhQUFhO1FBQzFCLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLFFBQVEsRUFBRSxTQUFTO0tBQ3BCO0lBRUQsR0FBRyxFQUFFO1FBQ0gsU0FBUyxF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Q0FBQyxRQUFnQjtJQUM3QyxNQUFNLE1BQU0sR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMzQyxPQUFPLE1BQU0sRUFBRSxPQUFPLElBQUksdUJBQWUsQ0FBQyxhQUFhLENBQUM7QUFDMUQsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcZG9jdW1lbnRvXFxjb25maWdcXGRvY3VtZW50by5jb25maWcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb25maWd1cmHDp8OjbyBjb25zb2xpZGFkYSBwYXJhIG8gbcOzZHVsbyBkZSBkb2N1bWVudG9zXG4gKlxuICogRXN0ZSBhcnF1aXZvIGNlbnRyYWxpemEgdG9kYXMgYXMgY29uZmlndXJhw6fDtWVzIHJlbGFjaW9uYWRhcyBhIGRvY3VtZW50b3MsXG4gKiBpbmNsdWluZG8gdGlwb3MgTUlNRSBwZXJtaXRpZG9zIGUgY29uZmlndXJhw6fDtWVzIGRlIHVwbG9hZC5cbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIE1pbWVUeXBlQ29uZmlnIHtcbiAgZXh0ZW5zaW9uOiBzdHJpbmc7XG4gIG1pbWVUeXBlczogc3RyaW5nW107XG4gIG1heFNpemU6IG51bWJlcjsgLy8gZW0gYnl0ZXNcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgYWxsb3dUaHVtYm5haWw6IGJvb2xlYW47XG4gIGNhdGVnb3J5OiAnRE9DVU1FTlRPUycgfCAnSU1BR0VOUycgfCAnUExBTklMSEFTJyB8ICdURVhUTyc7XG59XG5cbi8qKlxuICogQ29uZmlndXJhw6fDo28gZGV0YWxoYWRhIGRlIHRpcG9zIE1JTUUgcGVybWl0aWRvc1xuICovXG5leHBvcnQgY29uc3QgTUlNRV9UWVBFX0NPTkZJR1M6IFJlY29yZDxzdHJpbmcsIE1pbWVUeXBlQ29uZmlnPiA9IHtcbiAgLy8gRG9jdW1lbnRvcyBQREZcbiAgcGRmOiB7XG4gICAgZXh0ZW5zaW9uOiAncGRmJyxcbiAgICBtaW1lVHlwZXM6IFsnYXBwbGljYXRpb24vcGRmJ10sXG4gICAgbWF4U2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxuICAgIGRlc2NyaXB0aW9uOiAnRG9jdW1lbnRvIFBERicsXG4gICAgYWxsb3dUaHVtYm5haWw6IHRydWUsXG4gICAgY2F0ZWdvcnk6ICdET0NVTUVOVE9TJyxcbiAgfSxcblxuICAvLyBEb2N1bWVudG9zIGRvIE1pY3Jvc29mdCBPZmZpY2VcbiAgZG9jeDoge1xuICAgIGV4dGVuc2lvbjogJ2RvY3gnLFxuICAgIG1pbWVUeXBlczogW1xuICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50JyxcbiAgICBdLFxuICAgIG1heFNpemU6IDUgKiAxMDI0ICogMTAyNCwgLy8gNU1CXG4gICAgZGVzY3JpcHRpb246ICdEb2N1bWVudG8gV29yZCcsXG4gICAgYWxsb3dUaHVtYm5haWw6IGZhbHNlLFxuICAgIGNhdGVnb3J5OiAnRE9DVU1FTlRPUycsXG4gIH0sXG5cbiAgLy8gSW1hZ2Vuc1xuICBqcGc6IHtcbiAgICBleHRlbnNpb246ICdqcGcnLFxuICAgIG1pbWVUeXBlczogWydpbWFnZS9qcGVnJ10sXG4gICAgbWF4U2l6ZTogNSAqIDEwMjQgKiAxMDI0LCAvLyA1TUJcbiAgICBkZXNjcmlwdGlvbjogJ0ltYWdlbSBKUEVHJyxcbiAgICBhbGxvd1RodW1ibmFpbDogdHJ1ZSxcbiAgICBjYXRlZ29yeTogJ0lNQUdFTlMnLFxuICB9LFxuXG4gIHBuZzoge1xuICAgIGV4dGVuc2lvbjogJ3BuZycsXG4gICAgbWltZVR5cGVzOiBbJ2ltYWdlL3BuZyddLFxuICAgIG1heFNpemU6IDUgKiAxMDI0ICogMTAyNCwgLy8gNU1CXG4gICAgZGVzY3JpcHRpb246ICdJbWFnZW0gUE5HJyxcbiAgICBhbGxvd1RodW1ibmFpbDogdHJ1ZSxcbiAgICBjYXRlZ29yeTogJ0lNQUdFTlMnLFxuICB9LFxuXG4gIC8vIFRleHRvXG4gIHR4dDoge1xuICAgIGV4dGVuc2lvbjogJ3R4dCcsXG4gICAgbWltZVR5cGVzOiBbJ3RleHQvcGxhaW4nXSxcbiAgICBtYXhTaXplOiAxICogMTAyNCAqIDEwMjQsIC8vIDFNQlxuICAgIGRlc2NyaXB0aW9uOiAnQXJxdWl2byBkZSB0ZXh0bycsXG4gICAgYWxsb3dUaHVtYm5haWw6IGZhbHNlLFxuICAgIGNhdGVnb3J5OiAnVEVYVE8nLFxuICB9LFxufTtcblxuLyoqXG4gKiBMaXN0YSBkZSB0b2RvcyBvcyB0aXBvcyBNSU1FIHBlcm1pdGlkb3MgKGV4dHJhw61kYSBkYXMgY29uZmlndXJhw6fDtWVzKVxuICovXG5leHBvcnQgY29uc3QgVE9ET1NfTUlNRV9UWVBFU19QRVJNSVRJRE9TID0gT2JqZWN0LnZhbHVlcyhcbiAgTUlNRV9UWVBFX0NPTkZJR1MsXG4pLmZsYXRNYXAoKGNvbmZpZykgPT4gY29uZmlnLm1pbWVUeXBlcyk7XG5cbi8qKlxuICogTWFwZWFtZW50byBkZSB0aXBvcyBNSU1FIHBvciBjYXRlZ29yaWFcbiAqL1xuZXhwb3J0IGNvbnN0IE1JTUVfVFlQRVNfUE9SX0NBVEVHT1JJQSA9IHtcbiAgRE9DVU1FTlRPUzogT2JqZWN0LnZhbHVlcyhNSU1FX1RZUEVfQ09ORklHUylcbiAgICAuZmlsdGVyKChjb25maWcpID0+IGNvbmZpZy5jYXRlZ29yeSA9PT0gJ0RPQ1VNRU5UT1MnKVxuICAgIC5mbGF0TWFwKChjb25maWcpID0+IGNvbmZpZy5taW1lVHlwZXMpLFxuICBJTUFHRU5TOiBPYmplY3QudmFsdWVzKE1JTUVfVFlQRV9DT05GSUdTKVxuICAgIC5maWx0ZXIoKGNvbmZpZykgPT4gY29uZmlnLmNhdGVnb3J5ID09PSAnSU1BR0VOUycpXG4gICAgLmZsYXRNYXAoKGNvbmZpZykgPT4gY29uZmlnLm1pbWVUeXBlcyksXG4gIFBMQU5JTEhBUzogT2JqZWN0LnZhbHVlcyhNSU1FX1RZUEVfQ09ORklHUylcbiAgICAuZmlsdGVyKChjb25maWcpID0+IGNvbmZpZy5jYXRlZ29yeSA9PT0gJ1BMQU5JTEhBUycpXG4gICAgLmZsYXRNYXAoKGNvbmZpZykgPT4gY29uZmlnLm1pbWVUeXBlcyksXG4gIC8vIEFQUkVTRU5UQUNPRVM6IENhdGVnb3JpYSBuw6NvIGRlZmluaWRhIG5hIGludGVyZmFjZSBNaW1lVHlwZUNvbmZpZ1xuICBURVhUTzogT2JqZWN0LnZhbHVlcyhNSU1FX1RZUEVfQ09ORklHUylcbiAgICAuZmlsdGVyKChjb25maWcpID0+IGNvbmZpZy5jYXRlZ29yeSA9PT0gJ1RFWFRPJylcbiAgICAuZmxhdE1hcCgoY29uZmlnKSA9PiBjb25maWcubWltZVR5cGVzKSxcbn07XG5cbi8qKlxuICogRXh0ZW5zw7VlcyBkZSBhcnF1aXZvIGNvcnJlc3BvbmRlbnRlcyBhb3MgdGlwb3MgTUlNRVxuICovXG5leHBvcnQgY29uc3QgRVhURU5TT0VTX1BFUk1JVElEQVMgPSBPYmplY3QudmFsdWVzKE1JTUVfVFlQRV9DT05GSUdTKS5yZWR1Y2UoXG4gIChhY2MsIGNvbmZpZykgPT4ge1xuICAgIGNvbmZpZy5taW1lVHlwZXMuZm9yRWFjaCgobWltZVR5cGUpID0+IHtcbiAgICAgIGlmICghYWNjW21pbWVUeXBlXSkge1xuICAgICAgICBhY2NbbWltZVR5cGVdID0gW107XG4gICAgICB9XG4gICAgICBhY2NbbWltZVR5cGVdLnB1c2goYC4ke2NvbmZpZy5leHRlbnNpb259YCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGFjYztcbiAgfSxcbiAge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nW10+LFxuKTtcblxuLyoqXG4gKiBMaXN0YSBkZSBleHRlbnPDtWVzIHBlcmlnb3NhcyBxdWUgZGV2ZW0gc2VyIHNlbXByZSBibG9xdWVhZGFzXG4gKi9cbmV4cG9ydCBjb25zdCBCTE9DS0VEX0VYVEVOU0lPTlMgPSBbXG4gIC8vIEV4ZWN1dMOhdmVpc1xuICAnZXhlJyxcbiAgJ2JhdCcsXG4gICdjbWQnLFxuICAnY29tJyxcbiAgJ3NjcicsXG4gICdwaWYnLFxuICAnbXNpJyxcbiAgJ2RsbCcsXG4gIC8vIFNjcmlwdHNcbiAgJ2pzJyxcbiAgJ3ZicycsXG4gICdwczEnLFxuICAnc2gnLFxuICAncHknLFxuICAncGwnLFxuICAncGhwJyxcbiAgJ2FzcCcsXG4gICdqc3AnLFxuICAvLyBBcnF1aXZvcyBjb21wYWN0YWRvcyAocG9kZW0gY29udGVyIG1hbHdhcmUpXG4gICd6aXAnLFxuICAncmFyJyxcbiAgJzd6JyxcbiAgJ3RhcicsXG4gICdneicsXG4gIC8vIE91dHJvcyBmb3JtYXRvcyBwZXJpZ29zb3NcbiAgJ2h0bWwnLFxuICAnaHRtJyxcbiAgJ3htbCcsXG4gICdzdmcnLFxuXTtcblxuLyoqXG4gKiBMaXN0YSBkZSB0aXBvcyBNSU1FIHBlcmlnb3NvcyBxdWUgZGV2ZW0gc2VyIHNlbXByZSBibG9xdWVhZG9zXG4gKi9cbmV4cG9ydCBjb25zdCBCTE9DS0VEX01JTUVfVFlQRVMgPSBbXG4gIC8vIEV4ZWN1dMOhdmVpc1xuICAnYXBwbGljYXRpb24veC1tc2Rvd25sb2FkJyxcbiAgJ2FwcGxpY2F0aW9uL3gtZXhlY3V0YWJsZScsXG4gICdhcHBsaWNhdGlvbi94LWRvc2V4ZWMnLFxuICAvLyBTY3JpcHRzXG4gICd0ZXh0L2phdmFzY3JpcHQnLFxuICAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcsXG4gICd0ZXh0L2h0bWwnLFxuICAnYXBwbGljYXRpb24veC1odHRwZC1waHAnLFxuICAvLyBBcnF1aXZvcyBjb21wYWN0YWRvc1xuICAnYXBwbGljYXRpb24vemlwJyxcbiAgJ2FwcGxpY2F0aW9uL3gtcmFyLWNvbXByZXNzZWQnLFxuICAnYXBwbGljYXRpb24veC03ei1jb21wcmVzc2VkJyxcbiAgLy8gWE1ML1NWRyAocG9kZW0gY29udGVyIHNjcmlwdHMpXG4gICdpbWFnZS9zdmcreG1sJyxcbiAgJ2FwcGxpY2F0aW9uL3htbCcsXG4gICd0ZXh0L3htbCcsXG5dO1xuXG4vKipcbiAqIENvbmZpZ3VyYcOnw7VlcyBkZSBzZWd1cmFuw6dhIHBhcmEgdmFsaWRhw6fDo28gZGUgYXJxdWl2b3NcbiAqL1xuZXhwb3J0IGNvbnN0IFNFQ1VSSVRZX0NPTkZJRyA9IHtcbiAgLy8gVGFtYW5obyBtw6F4aW1vIGdsb2JhbCBwYXJhIHF1YWxxdWVyIGFycXVpdm8gKDIwTUIpXG4gIE1BWF9GSUxFX1NJWkU6IDIwICogMTAyNCAqIDEwMjQsXG5cbiAgLy8gTsO6bWVybyBtw6F4aW1vIGRlIGFycXVpdm9zIHBvciB1cGxvYWRcbiAgTUFYX0ZJTEVTX1BFUl9VUExPQUQ6IDUsXG5cbiAgLy8gVmVyaWZpY2FyIG1hZ2ljIG51bWJlcnMgKGFzc2luYXR1cmEgZG8gYXJxdWl2bylcbiAgVkVSSUZZX01BR0lDX05VTUJFUlM6IHRydWUsXG5cbiAgLy8gRXNjYW5lYXIgY29udGXDumRvIGVtIGJ1c2NhIGRlIHBhZHLDtWVzIHN1c3BlaXRvc1xuICBTQ0FOX0NPTlRFTlQ6IHRydWUsXG5cbiAgLy8gVmVyaWZpY2FyIHbDrXJ1cy9tYWx3YXJlXG4gIE1BTFdBUkVfU0NBTjogdHJ1ZSxcblxuICAvLyBDcmlwdG9ncmFmYXIgZG9jdW1lbnRvcyBzZW5zw612ZWlzXG4gIEVOQ1JZUFRfU0VOU0lUSVZFX0RPQ1M6IHRydWUsXG5cbiAgLy8gQ29sb2NhciBhcnF1aXZvcyBzdXNwZWl0b3MgZW0gcXVhcmVudGVuYVxuICBRVUFSQU5USU5FX1NVU1BJQ0lPVVM6IHRydWUsXG59O1xuXG4vKipcbiAqIENvbmZpZ3VyYcOnw7VlcyBkZSB1cGxvYWRcbiAqL1xuZXhwb3J0IGNvbnN0IFVQTE9BRF9DT05GSUcgPSB7XG4gIC8vIERpcmV0w7NyaW8gdGVtcG9yw6FyaW8gcGFyYSB1cGxvYWRzXG4gIFRFTVBfRElSOiAndXBsb2Fkcy90ZW1wJyxcblxuICAvLyBEaXJldMOzcmlvIGZpbmFsIHBhcmEgZG9jdW1lbnRvc1xuICBET0NTX0RJUjogJ3VwbG9hZHMvZG9jdW1lbnRvcycsXG5cbiAgLy8gRGlyZXTDs3JpbyBwYXJhIHRodW1ibmFpbHNcbiAgVEhVTUJOQUlMU19ESVI6ICd1cGxvYWRzL3RodW1ibmFpbHMnLFxuXG4gIC8vIFRlbXBvIGxpbWl0ZSBwYXJhIHVwbG9hZCAoZW0gc2VndW5kb3MpXG4gIFVQTE9BRF9USU1FT1VUOiAzMDAsXG5cbiAgLy8gTsO6bWVybyBtw6F4aW1vIGRlIHRlbnRhdGl2YXMgZGUgdXBsb2FkXG4gIE1BWF9VUExPQURfUkVUUklFUzogMyxcbn07XG5cbi8qKlxuICogRnVuw6fDtWVzIHV0aWxpdMOhcmlhc1xuICovXG5cbi8qKlxuICogT2J0w6ltIGEgY29uZmlndXJhw6fDo28gZGUgdW0gdGlwbyBNSU1FXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNaW1lVHlwZUNvbmZpZyhcbiAgbWltZVR5cGU6IHN0cmluZyxcbik6IE1pbWVUeXBlQ29uZmlnIHwgdW5kZWZpbmVkIHtcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoTUlNRV9UWVBFX0NPTkZJR1MpLmZpbmQoKGNvbmZpZykgPT5cbiAgICBjb25maWcubWltZVR5cGVzLmluY2x1ZGVzKG1pbWVUeXBlKSxcbiAgKTtcbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzZSB1bSB0aXBvIE1JTUUgw6kgcGVybWl0aWRvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc01pbWVUeXBlUGVybWl0aWRvKG1pbWVUeXBlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIFRPRE9TX01JTUVfVFlQRVNfUEVSTUlUSURPUy5pbmNsdWRlcyhtaW1lVHlwZSk7XG59XG5cbi8qKlxuICogT2J0w6ltIGEgY2F0ZWdvcmlhIGRlIHVtIHRpcG8gTUlNRVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2F0ZWdvcmlhTWltZVR5cGUobWltZVR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGNvbmZpZyA9IGdldE1pbWVUeXBlQ29uZmlnKG1pbWVUeXBlKTtcbiAgcmV0dXJuIGNvbmZpZz8uY2F0ZWdvcnkgfHwgJ0RFU0NPTkhFQ0lETyc7XG59XG5cbi8qKlxuICogT2J0w6ltIGFzIGV4dGVuc8O1ZXMgcGVybWl0aWRhcyBwYXJhIHVtIHRpcG8gTUlNRVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXh0ZW5zb2VzUGFyYU1pbWVUeXBlKG1pbWVUeXBlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIHJldHVybiBFWFRFTlNPRVNfUEVSTUlUSURBU1ttaW1lVHlwZV0gfHwgW107XG59XG5cbi8qKlxuICogVmVyaWZpY2Egc2UgdW0gYXJxdWl2byByZXF1ZXIgY3JpcHRvZ3JhZmlhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlc0VuY3J5cHRpb24obWltZVR5cGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAvLyBGdW5jaW9uYWxpZGFkZSBkZSBjcmlwdG9ncmFmaWEgbsOjbyBpbXBsZW1lbnRhZGEgYWluZGFcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFZlcmlmaWNhIHNlIHVtIGFycXVpdm8gcGVybWl0ZSB0aHVtYm5haWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFsbG93c1RodW1ibmFpbChtaW1lVHlwZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IGNvbmZpZyA9IGdldE1pbWVUeXBlQ29uZmlnKG1pbWVUeXBlKTtcbiAgcmV0dXJuIGNvbmZpZz8uYWxsb3dUaHVtYm5haWwgfHwgZmFsc2U7XG59XG5cbi8qKlxuICogT2J0w6ltIG8gdGFtYW5obyBtw6F4aW1vIHBlcm1pdGlkbyBwYXJhIHVtIHRpcG8gTUlNRVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWF4RmlsZVNpemUobWltZVR5cGU6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGNvbmZpZyA9IGdldE1pbWVUeXBlQ29uZmlnKG1pbWVUeXBlKTtcbiAgcmV0dXJuIGNvbmZpZz8ubWF4U2l6ZSB8fCBTRUNVUklUWV9DT05GSUcuTUFYX0ZJTEVfU0laRTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==