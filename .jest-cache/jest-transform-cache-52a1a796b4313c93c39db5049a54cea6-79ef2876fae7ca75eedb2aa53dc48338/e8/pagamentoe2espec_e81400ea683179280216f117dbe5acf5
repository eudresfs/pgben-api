de058b15980ba0365a198366bd42e99d
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const request = __importStar(require("supertest"));
const config_1 = require("@nestjs/config");
const typeorm_1 = require("@nestjs/typeorm");
const jwt_1 = require("@nestjs/jwt");
const app_module_1 = require("../../src/app.module");
const status_pagamento_enum_1 = require("../../src/modules/pagamento/enums/status-pagamento.enum");
const metodo_pagamento_enum_1 = require("../../src/modules/pagamento/enums/metodo-pagamento.enum");
/**
 * Testes E2E para o fluxo completo de pagamento
 *
 * Este teste valida a integração completa do módulo de pagamento com outros
 * módulos do sistema em um ambiente próximo ao de produção. Testa-se o fluxo
 * completo desde a criação do pagamento até a confirmação de recebimento.
 *
 * Execução: npm run test:e2e -- pagamento-e2e
 *
 * @author Equipe PGBen
 */
describe('PagamentoController (e2e)', () => {
    let app;
    let jwtService;
    // Dados de teste
    const usuarioId = 'e2e-usuario-teste';
    const gestorId = 'e2e-gestor-teste';
    const adminId = 'e2e-admin-teste';
    const unidadeId = 'e2e-unidade-teste';
    const solicitacaoId = 'e2e-solicitacao-teste';
    const beneficiarioId = 'e2e-beneficiario-teste';
    const infoBancariaId = 'e2e-info-bancaria-teste';
    // IDs gerados durante os testes
    let pagamentoId;
    let comprovanteId;
    let confirmacaoId;
    beforeAll(async () => {
        // Usar banco de dados SQLite em memória para testes E2E
        const moduleFixture = await testing_1.Test.createTestingModule({
            imports: [
                config_1.ConfigModule.forRoot({
                    isGlobal: true,
                    envFilePath: '.env.test',
                }),
                typeorm_1.TypeOrmModule.forRootAsync({
                    imports: [config_1.ConfigModule],
                    inject: [config_1.ConfigService],
                    useFactory: (configService) => ({
                        type: 'sqlite',
                        database: ':memory:',
                        entities: [__dirname + '/../../src/**/*.entity{.ts,.js}'],
                        synchronize: true, // Apenas para testes
                        logging: false,
                    }),
                }),
                jwt_1.JwtModule.registerAsync({
                    imports: [config_1.ConfigModule],
                    inject: [config_1.ConfigService],
                    useFactory: (configService) => ({
                        secret: configService.get('JWT_SECRET') || 'teste-secret',
                        signOptions: { expiresIn: '1h' },
                    }),
                }),
                app_module_1.AppModule,
            ],
        }).compile();
        app = moduleFixture.createNestApplication();
        app.useGlobalPipes(new common_1.ValidationPipe({
            transform: true,
            whitelist: true,
            forbidNonWhitelisted: true,
        }));
        jwtService = moduleFixture.get(jwt_1.JwtService);
        await app.init();
        // Preparar dados necessários para os testes
        await prepararDadosParaTestes();
    });
    afterAll(async () => {
        await app.close();
    });
    /**
     * Função auxiliar para preparar dados necessários no banco de testes
     * Como estamos usando SQLite em memória, precisamos criar os dados iniciais
     */
    async function prepararDadosParaTestes() {
        // Esta função seria implementada para criar dados necessários no banco de testes
        // Como usuários, solicitações, beneficiários, etc.
        // Para fins deste teste, vamos usar mocks e stubs onde necessário
    }
    /**
     * Função auxiliar para gerar tokens JWT com diferentes perfis
     */
    const gerarToken = (userId, perfis = ['usuario'], unidadeId = 'e2e-unidade-teste') => {
        return jwtService.sign({
            sub: userId,
            perfis,
            unidade: unidadeId,
        });
    };
    describe('Fluxo Completo de Pagamento', () => {
        it('1. Deve criar um novo pagamento com sucesso', async () => {
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/solicitacao/${solicitacaoId}`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                valor: 750.0,
                metodoPagamento: metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX,
                infoBancariaId,
                dadosBancarios: {
                    pixTipo: 'CPF',
                    pixChave: '12345678900',
                },
                dataLiberacao: new Date().toISOString(),
            });
            expect(response.status).toBe(201);
            expect(response.body).toHaveProperty('id');
            expect(response.body.status).toBe(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(response.body.metodoPagamento).toBe(metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX);
            // Guardar ID para próximos testes
            pagamentoId = response.body.id;
        });
        it('2. Deve consultar um pagamento existente', async () => {
            // Pular se o teste anterior falhou
            if (!pagamentoId) {
                console.warn('Pulando teste - pagamentoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('id', pagamentoId);
            expect(response.body).toHaveProperty('solicitacaoId', solicitacaoId);
            expect(response.body).toHaveProperty('valor', 750);
        });
        it('3. Deve listar pagamentos com paginação', async () => {
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get('/pagamentos')
                .query({ page: 1, limit: 10 })
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('items');
            expect(response.body).toHaveProperty('meta');
            expect(Array.isArray(response.body.items)).toBe(true);
            // Deve encontrar o pagamento criado anteriormente
            if (pagamentoId) {
                const encontrado = response.body.items.some((item) => item.id === pagamentoId);
                expect(encontrado).toBe(true);
            }
        });
        it('4. Deve atualizar o status do pagamento para LIBERADO', async () => {
            // Pular se o teste de criação falhou
            if (!pagamentoId) {
                console.warn('Pulando teste - pagamentoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            const response = await request(app.getHttpServer())
                .patch(`/pagamentos/${pagamentoId}/status`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO,
                observacoes: 'Pagamento liberado para transferência',
            });
            expect(response.status).toBe(200);
            expect(response.body.status).toBe(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
        });
        it('5. Deve atualizar o status do pagamento para PAGO', async () => {
            // Pular se o teste anterior falhou
            if (!pagamentoId) {
                console.warn('Pulando teste - pagamentoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            const response = await request(app.getHttpServer())
                .patch(`/pagamentos/${pagamentoId}/status`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
                observacoes: 'Transferência PIX realizada',
            });
            expect(response.status).toBe(200);
            expect(response.body.status).toBe(status_pagamento_enum_1.StatusPagamentoEnum.PAGO);
        });
        it('6. Deve fazer upload de comprovante de pagamento', async () => {
            // Pular se o teste anterior falhou
            if (!pagamentoId) {
                console.warn('Pulando teste - pagamentoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            // Criar buffer simulando um arquivo PDF
            const buffer = Buffer.from('Conteúdo do comprovante de pagamento para testes e2e');
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/comprovantes`)
                .set('Authorization', `Bearer ${token}`)
                .attach('arquivo', buffer, 'comprovante.pdf');
            expect(response.status).toBe(201);
            expect(response.body).toHaveProperty('id');
            expect(response.body).toHaveProperty('pagamentoId', pagamentoId);
            // Guardar ID para próximos testes
            comprovanteId = response.body.id;
        });
        it('7. Deve listar comprovantes de um pagamento', async () => {
            // Pular se os testes anteriores falharam
            if (!pagamentoId || !comprovanteId) {
                console.warn('Pulando teste - pagamentoId ou comprovanteId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}/comprovantes`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(Array.isArray(response.body)).toBe(true);
            expect(response.body.length).toBeGreaterThanOrEqual(1);
            expect(response.body[0]).toHaveProperty('id', comprovanteId);
        });
        it('8. Deve registrar confirmação de recebimento', async () => {
            // Pular se os testes anteriores falharam
            if (!pagamentoId) {
                console.warn('Pulando teste - pagamentoId não disponível');
                return;
            }
            const token = gerarToken(beneficiarioId, ['usuario'], unidadeId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Pagamento recebido via PIX em minha conta',
                dataConfirmacao: new Date().toISOString(),
            });
            expect(response.status).toBe(201);
            expect(response.body).toHaveProperty('id');
            expect(response.body).toHaveProperty('pagamentoId', pagamentoId);
            // Guardar ID para próximos testes
            confirmacaoId = response.body.id;
        });
        it('9. Deve consultar confirmação de recebimento', async () => {
            // Pular se os testes anteriores falharam
            if (!pagamentoId || !confirmacaoId) {
                console.warn('Pulando teste - pagamentoId ou confirmacaoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}/confirmacao`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('id', confirmacaoId);
            expect(response.body).toHaveProperty('pagamentoId', pagamentoId);
            expect(response.body).toHaveProperty('dataConfirmacao');
            expect(response.body).toHaveProperty('observacoes');
        });
        it('10. Deve finalizar o pagamento após confirmação', async () => {
            // Pular se os testes anteriores falharam
            if (!pagamentoId || !confirmacaoId) {
                console.warn('Pulando teste - pagamentoId ou confirmacaoId não disponível');
                return;
            }
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            const response = await request(app.getHttpServer())
                .patch(`/pagamentos/${pagamentoId}/status`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                status: status_pagamento_enum_1.StatusPagamentoEnum.FINALIZADO,
                observacoes: 'Pagamento finalizado após confirmação de recebimento',
            });
            expect(response.status).toBe(200);
            expect(response.body.status).toBe(status_pagamento_enum_1.StatusPagamentoEnum.FINALIZADO);
        });
    });
    describe('Testes de Segurança E2E', () => {
        it('Deve rejeitar acesso sem autenticação', async () => {
            const response = await request(app.getHttpServer()).get('/pagamentos');
            expect(response.status).toBe(401);
        });
        it('Deve rejeitar token JWT inválido', async () => {
            const response = await request(app.getHttpServer())
                .get('/pagamentos')
                .set('Authorization', 'Bearer token-invalido');
            expect(response.status).toBe(401);
        });
        it('Deve rejeitar acesso a recursos restritos por perfil', async () => {
            const token = gerarToken(usuarioId, ['usuario_basico'], unidadeId);
            const response = await request(app.getHttpServer())
                .patch(`/pagamentos/${pagamentoId || 'pagamento-id'}/status`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
            });
            expect(response.status).toBe(403);
        });
    });
    describe('Casos de Erro', () => {
        it('Deve retornar 404 para pagamento inexistente', async () => {
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get('/pagamentos/pagamento-inexistente')
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(404);
            expect(response.body.message).toContain('não encontrado');
        });
        it('Deve rejeitar transição de status inválida', async () => {
            // Pular se o teste de criação falhou
            if (!pagamentoId) {
                // Criar um pagamento específico para este teste
                const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
                const createResponse = await request(app.getHttpServer())
                    .post(`/pagamentos/solicitacao/${solicitacaoId}`)
                    .set('Authorization', `Bearer ${token}`)
                    .send({
                    valor: 300.0,
                    metodoPagamento: metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX,
                    infoBancariaId,
                    dadosBancarios: {
                        pixTipo: 'CPF',
                        pixChave: '12345678900',
                    },
                    dataLiberacao: new Date().toISOString(),
                });
                if (createResponse.status === 201) {
                    pagamentoId = createResponse.body.id;
                }
                else {
                    console.warn('Não foi possível criar pagamento para teste');
                    return;
                }
            }
            const token = gerarToken(gestorId, ['gestor', 'financeiro'], unidadeId);
            // Tentar uma transição inválida (de AGENDADO para FINALIZADO pulando estados)
            const response = await request(app.getHttpServer())
                .patch(`/pagamentos/${pagamentoId}/status`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                status: status_pagamento_enum_1.StatusPagamentoEnum.FINALIZADO,
            });
            expect(response.status).toBe(400);
            expect(response.body.message).toContain('Transição de status');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFx0ZXN0XFxwYWdhbWVudG9cXHBhZ2FtZW50by1lMmUuc3BlYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FBa0U7QUFDbEUsbURBQXFDO0FBQ3JDLDJDQUE2RDtBQUM3RCw2Q0FBZ0Q7QUFDaEQscUNBQW9EO0FBRXBELHFEQUFpRDtBQUNqRCxtR0FBOEY7QUFDOUYsbUdBQThGO0FBRTlGOzs7Ozs7Ozs7O0dBVUc7QUFDSCxRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLElBQUksR0FBcUIsQ0FBQztJQUMxQixJQUFJLFVBQXNCLENBQUM7SUFFM0IsaUJBQWlCO0lBQ2pCLE1BQU0sU0FBUyxHQUFHLG1CQUFtQixDQUFDO0lBQ3RDLE1BQU0sUUFBUSxHQUFHLGtCQUFrQixDQUFDO0lBQ3BDLE1BQU0sT0FBTyxHQUFHLGlCQUFpQixDQUFDO0lBQ2xDLE1BQU0sU0FBUyxHQUFHLG1CQUFtQixDQUFDO0lBQ3RDLE1BQU0sYUFBYSxHQUFHLHVCQUF1QixDQUFDO0lBQzlDLE1BQU0sY0FBYyxHQUFHLHdCQUF3QixDQUFDO0lBQ2hELE1BQU0sY0FBYyxHQUFHLHlCQUF5QixDQUFDO0lBRWpELGdDQUFnQztJQUNoQyxJQUFJLFdBQW1CLENBQUM7SUFDeEIsSUFBSSxhQUFxQixDQUFDO0lBQzFCLElBQUksYUFBcUIsQ0FBQztJQUUxQixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsd0RBQXdEO1FBQ3hELE1BQU0sYUFBYSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUNsRSxPQUFPLEVBQUU7Z0JBQ1AscUJBQVksQ0FBQyxPQUFPLENBQUM7b0JBQ25CLFFBQVEsRUFBRSxJQUFJO29CQUNkLFdBQVcsRUFBRSxXQUFXO2lCQUN6QixDQUFDO2dCQUNG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QUFJLGNBQWMsQ0FBQyxNQUFNLEtBQUssR0FBRyxFQUFFLENBQUM7b0JBQ2xDLFdBQVcsR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztnQkFDdkMsQ0FBQztxQkFBTSxDQUFDO29CQUNOLE9BQU8sQ0FBQyxJQUFJLENBQUMsNkNBQTZDLENBQUMsQ0FBQztvQkFDNUQsT0FBTztnQkFDVCxDQUFDO1lBQ0gsQ0FBQztZQUVELE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFeEUsOEVBQThFO1lBQzlFLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsS0FBSyxDQUFDLGVBQWUsV0FBVyxTQUFTLENBQUM7aUJBQzFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsQ0FBQztpQkFDdkMsSUFBSSxDQUFDO2dCQUNKLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxVQUFVO2FBQ3ZDLENBQUMsQ0FBQztZQUVMLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHRlc3RcXHBhZ2FtZW50b1xccGFnYW1lbnRvLWUyZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgSU5lc3RBcHBsaWNhdGlvbiwgVmFsaWRhdGlvblBpcGUgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgKiBhcyByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgeyBDb25maWdNb2R1bGUsIENvbmZpZ1NlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2NvbmZpZyc7XG5pbXBvcnQgeyBUeXBlT3JtTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90eXBlb3JtJztcbmltcG9ydCB7IEp3dE1vZHVsZSwgSnd0U2VydmljZSB9IGZyb20gJ0BuZXN0anMvand0JztcblxuaW1wb3J0IHsgQXBwTW9kdWxlIH0gZnJvbSAnLi4vLi4vc3JjL2FwcC5tb2R1bGUnO1xuaW1wb3J0IHsgU3RhdHVzUGFnYW1lbnRvRW51bSB9IGZyb20gJy4uLy4uL3NyYy9tb2R1bGVzL3BhZ2FtZW50by9lbnVtcy9zdGF0dXMtcGFnYW1lbnRvLmVudW0nO1xuaW1wb3J0IHsgTWV0b2RvUGFnYW1lbnRvRW51bSB9IGZyb20gJy4uLy4uL3NyYy9tb2R1bGVzL3BhZ2FtZW50by9lbnVtcy9tZXRvZG8tcGFnYW1lbnRvLmVudW0nO1xuXG4vKipcbiAqIFRlc3RlcyBFMkUgcGFyYSBvIGZsdXhvIGNvbXBsZXRvIGRlIHBhZ2FtZW50b1xuICpcbiAqIEVzdGUgdGVzdGUgdmFsaWRhIGEgaW50ZWdyYcOnw6NvIGNvbXBsZXRhIGRvIG3Ds2R1bG8gZGUgcGFnYW1lbnRvIGNvbSBvdXRyb3NcbiAqIG3Ds2R1bG9zIGRvIHNpc3RlbWEgZW0gdW0gYW1iaWVudGUgcHLDs3hpbW8gYW8gZGUgcHJvZHXDp8Ojby4gVGVzdGEtc2UgbyBmbHV4b1xuICogY29tcGxldG8gZGVzZGUgYSBjcmlhw6fDo28gZG8gcGFnYW1lbnRvIGF0w6kgYSBjb25maXJtYcOnw6NvIGRlIHJlY2ViaW1lbnRvLlxuICpcbiAqIEV4ZWN1w6fDo286IG5wbSBydW4gdGVzdDplMmUgLS0gcGFnYW1lbnRvLWUyZVxuICpcbiAqIEBhdXRob3IgRXF1aXBlIFBHQmVuXG4gKi9cbmRlc2NyaWJlKCdQYWdhbWVudG9Db250cm9sbGVyIChlMmUpJywgKCkgPT4ge1xuICBsZXQgYXBwOiBJTmVzdEFwcGxpY2F0aW9uO1xuICBsZXQgand0U2VydmljZTogSnd0U2VydmljZTtcblxuICAvLyBEYWRvcyBkZSB0ZXN0ZVxuICBjb25zdCB1c3VhcmlvSWQgPSAnZTJlLXVzdWFyaW8tdGVzdGUnO1xuICBjb25zdCBnZXN0b3JJZCA9ICdlMmUtZ2VzdG9yLXRlc3RlJztcbiAgY29uc3QgYWRtaW5JZCA9ICdlMmUtYWRtaW4tdGVzdGUnO1xuICBjb25zdCB1bmlkYWRlSWQgPSAnZTJlLXVuaWRhZGUtdGVzdGUnO1xuICBjb25zdCBzb2xpY2l0YWNhb0lkID0gJ2UyZS1zb2xpY2l0YWNhby10ZXN0ZSc7XG4gIGNvbnN0IGJlbmVmaWNpYXJpb0lkID0gJ2UyZS1iZW5lZmljaWFyaW8tdGVzdGUnO1xuICBjb25zdCBpbmZvQmFuY2FyaWFJZCA9ICdlMmUtaW5mby1iYW5jYXJpYS10ZXN0ZSc7XG5cbiAgLy8gSURzIGdlcmFkb3MgZHVyYW50ZSBvcyB0ZXN0ZXNcbiAgbGV0IHBhZ2FtZW50b0lkOiBzdHJpbmc7XG4gIGxldCBjb21wcm92YW50ZUlkOiBzdHJpbmc7XG4gIGxldCBjb25maXJtYWNhb0lkOiBzdHJpbmc7XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBVc2FyIGJhbmNvIGRlIGRhZG9zIFNRTGl0ZSBlbSBtZW3Ds3JpYSBwYXJhIHRlc3RlcyBFMkVcbiAgICBjb25zdCBtb2R1bGVGaXh0dXJlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIGltcG9ydHM6IFtcbiAgICAgICAgQ29uZmlnTW9kdWxlLmZvclJvb3Qoe1xuICAgICAgICAgIGlzR2xvYmFsOiB0cnVlLFxuICAgICAgICAgIGVudkZpbGVQYXRoOiAnLmVudi50ZXN0JyxcbiAgICAgICAgfSksXG4gICAgICAgIFR5cGVPcm1Nb2R1bGUuZm9yUm9vdEFzeW5jKHtcbiAgICAgICAgICBpbXBvcnRzOiBbQ29uZmlnTW9kdWxlXSxcbiAgICAgICAgICBpbmplY3Q6IFtDb25maWdTZXJ2aWNlXSxcbiAgICAgICAgICB1c2VGYWN0b3J5OiAoY29uZmlnU2VydmljZTogQ29uZmlnU2VydmljZSkgPT4gKHtcbiAgICAgICAgICAgIHR5cGU6ICdzcWxpdGUnLFxuICAgICAgICAgICAgZGF0YWJhc2U6ICc6bWVtb3J5OicsXG4gICAgICAgICAgICBlbnRpdGllczogW19fZGlybmFtZSArICcvLi4vLi4vc3JjLyoqLyouZW50aXR5ey50cywuanN9J10sXG4gICAgICAgICAgICBzeW5jaHJvbml6ZTogdHJ1ZSwgLy8gQXBlbmFzIHBhcmEgdGVzdGVzXG4gICAgICAgICAgICBsb2dnaW5nOiBmYWxzZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICAgIEp3dE1vZHVsZS5yZWdpc3RlckFzeW5jKHtcbiAgICAgICAgICBpbXBvcnRzOiBbQ29uZmlnTW9kdWxlXSxcbiAgICAgICAgICBpbmplY3Q6IFtDb25maWdTZXJ2aWNlXSxcbiAgICAgICAgICB1c2VGYWN0b3J5OiAoY29uZmlnU2VydmljZTogQ29uZmlnU2VydmljZSkgPT4gKHtcbiAgICAgICAgICAgIHNlY3JldDogY29uZmlnU2VydmljZS5nZXQoJ0pXVF9TRUNSRVQnKSB8fCAndGVzdGUtc2VjcmV0JyxcbiAgICAgICAgICAgIHNpZ25PcHRpb25zOiB7IGV4cGlyZXNJbjogJzFoJyB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgQXBwTW9kdWxlLFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBhcHAgPSBtb2R1bGVGaXh0dXJlLmNyZWF0ZU5lc3RBcHBsaWNhdGlvbigpO1xuICAgIGFwcC51c2VHbG9iYWxQaXBlcyhcbiAgICAgIG5ldyBWYWxpZGF0aW9uUGlwZSh7XG4gICAgICAgIHRyYW5zZm9ybTogdHJ1ZSxcbiAgICAgICAgd2hpdGVsaXN0OiB0cnVlLFxuICAgICAgICBmb3JiaWROb25XaGl0ZWxpc3RlZDogdHJ1ZSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBqd3RTZXJ2aWNlID0gbW9kdWxlRml4dHVyZS5nZXQ8Snd0U2VydmljZT4oSnd0U2VydmljZSk7XG5cbiAgICBhd2FpdCBhcHAuaW5pdCgpO1xuXG4gICAgLy8gUHJlcGFyYXIgZGFkb3MgbmVjZXNzw6FyaW9zIHBhcmEgb3MgdGVzdGVzXG4gICAgYXdhaXQgcHJlcGFyYXJEYWRvc1BhcmFUZXN0ZXMoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGFwcC5jbG9zZSgpO1xuICB9KTtcblxuICAvKipcbiAgICogRnVuw6fDo28gYXV4aWxpYXIgcGFyYSBwcmVwYXJhciBkYWRvcyBuZWNlc3PDoXJpb3Mgbm8gYmFuY28gZGUgdGVzdGVzXG4gICAqIENvbW8gZXN0YW1vcyB1c2FuZG8gU1FMaXRlIGVtIG1lbcOzcmlhLCBwcmVjaXNhbW9zIGNyaWFyIG9zIGRhZG9zIGluaWNpYWlzXG4gICAqL1xuICBhc3luYyBmdW5jdGlvbiBwcmVwYXJhckRhZG9zUGFyYVRlc3RlcygpIHtcbiAgICAvLyBFc3RhIGZ1bsOnw6NvIHNlcmlhIGltcGxlbWVudGFkYSBwYXJhIGNyaWFyIGRhZG9zIG5lY2Vzc8OhcmlvcyBubyBiYW5jbyBkZSB0ZXN0ZXNcbiAgICAvLyBDb21vIHVzdcOhcmlvcywgc29saWNpdGHDp8O1ZXMsIGJlbmVmaWNpw6FyaW9zLCBldGMuXG4gICAgLy8gUGFyYSBmaW5zIGRlc3RlIHRlc3RlLCB2YW1vcyB1c2FyIG1vY2tzIGUgc3R1YnMgb25kZSBuZWNlc3PDoXJpb1xuICB9XG5cbiAgLyoqXG4gICAqIEZ1bsOnw6NvIGF1eGlsaWFyIHBhcmEgZ2VyYXIgdG9rZW5zIEpXVCBjb20gZGlmZXJlbnRlcyBwZXJmaXNcbiAgICovXG4gIGNvbnN0IGdlcmFyVG9rZW4gPSAoXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgcGVyZmlzOiBzdHJpbmdbXSA9IFsndXN1YXJpbyddLFxuICAgIHVuaWRhZGVJZDogc3RyaW5nID0gJ2UyZS11bmlkYWRlLXRlc3RlJyxcbiAgKSA9PiB7XG4gICAgcmV0dXJuIGp3dFNlcnZpY2Uuc2lnbih7XG4gICAgICBzdWI6IHVzZXJJZCxcbiAgICAgIHBlcmZpcyxcbiAgICAgIHVuaWRhZGU6IHVuaWRhZGVJZCxcbiAgICB9KTtcbiAgfTtcblxuICBkZXNjcmliZSgnRmx1eG8gQ29tcGxldG8gZGUgUGFnYW1lbnRvJywgKCkgPT4ge1xuICAgIGl0KCcxLiBEZXZlIGNyaWFyIHVtIG5vdm8gcGFnYW1lbnRvIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvcicsICdmaW5hbmNlaXJvJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3Mvc29saWNpdGFjYW8vJHtzb2xpY2l0YWNhb0lkfWApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHZhbG9yOiA3NTAuMCxcbiAgICAgICAgICBtZXRvZG9QYWdhbWVudG86IE1ldG9kb1BhZ2FtZW50b0VudW0uUElYLFxuICAgICAgICAgIGluZm9CYW5jYXJpYUlkLFxuICAgICAgICAgIGRhZG9zQmFuY2FyaW9zOiB7XG4gICAgICAgICAgICBwaXhUaXBvOiAnQ1BGJyxcbiAgICAgICAgICAgIHBpeENoYXZlOiAnMTIzNDU2Nzg5MDAnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YUxpYmVyYWNhbzogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3RhdHVzKS50b0JlKFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8pO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubWV0b2RvUGFnYW1lbnRvKS50b0JlKE1ldG9kb1BhZ2FtZW50b0VudW0uUElYKTtcblxuICAgICAgLy8gR3VhcmRhciBJRCBwYXJhIHByw7N4aW1vcyB0ZXN0ZXNcbiAgICAgIHBhZ2FtZW50b0lkID0gcmVzcG9uc2UuYm9keS5pZDtcbiAgICB9KTtcblxuICAgIGl0KCcyLiBEZXZlIGNvbnN1bHRhciB1bSBwYWdhbWVudG8gZXhpc3RlbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHVsYXIgc2UgbyB0ZXN0ZSBhbnRlcmlvciBmYWxob3VcbiAgICAgIGlmICghcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdQdWxhbmRvIHRlc3RlIC0gcGFnYW1lbnRvSWQgbsOjbyBkaXNwb27DrXZlbCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InXSwgdW5pZGFkZUlkKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5nZXQoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9YClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpZCcsIHBhZ2FtZW50b0lkKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc29saWNpdGFjYW9JZCcsIHNvbGljaXRhY2FvSWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd2YWxvcicsIDc1MCk7XG4gICAgfSk7XG5cbiAgICBpdCgnMy4gRGV2ZSBsaXN0YXIgcGFnYW1lbnRvcyBjb20gcGFnaW5hw6fDo28nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4oZ2VzdG9ySWQsIFsnZ2VzdG9yJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KCcvcGFnYW1lbnRvcycpXG4gICAgICAgIC5xdWVyeSh7IHBhZ2U6IDEsIGxpbWl0OiAxMCB9KVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2l0ZW1zJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ21ldGEnKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3BvbnNlLmJvZHkuaXRlbXMpKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBEZXZlIGVuY29udHJhciBvIHBhZ2FtZW50byBjcmlhZG8gYW50ZXJpb3JtZW50ZVxuICAgICAgaWYgKHBhZ2FtZW50b0lkKSB7XG4gICAgICAgIGNvbnN0IGVuY29udHJhZG8gPSByZXNwb25zZS5ib2R5Lml0ZW1zLnNvbWUoXG4gICAgICAgICAgKGl0ZW0pID0+IGl0ZW0uaWQgPT09IHBhZ2FtZW50b0lkLFxuICAgICAgICApO1xuICAgICAgICBleHBlY3QoZW5jb250cmFkbykudG9CZSh0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCc0LiBEZXZlIGF0dWFsaXphciBvIHN0YXR1cyBkbyBwYWdhbWVudG8gcGFyYSBMSUJFUkFETycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFB1bGFyIHNlIG8gdGVzdGUgZGUgY3JpYcOnw6NvIGZhbGhvdVxuICAgICAgaWYgKCFwYWdhbWVudG9JZCkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1B1bGFuZG8gdGVzdGUgLSBwYWdhbWVudG9JZCBuw6NvIGRpc3BvbsOtdmVsJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvcicsICdmaW5hbmNlaXJvJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucGF0Y2goYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L3N0YXR1c2ApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyxcbiAgICAgICAgICBvYnNlcnZhY29lczogJ1BhZ2FtZW50byBsaWJlcmFkbyBwYXJhIHRyYW5zZmVyw6puY2lhJyxcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN0YXR1cykudG9CZShTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPKTtcbiAgICB9KTtcblxuICAgIGl0KCc1LiBEZXZlIGF0dWFsaXphciBvIHN0YXR1cyBkbyBwYWdhbWVudG8gcGFyYSBQQUdPJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHVsYXIgc2UgbyB0ZXN0ZSBhbnRlcmlvciBmYWxob3VcbiAgICAgIGlmICghcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdQdWxhbmRvIHRlc3RlIC0gcGFnYW1lbnRvSWQgbsOjbyBkaXNwb27DrXZlbCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InLCAnZmluYW5jZWlybyddLCB1bmlkYWRlSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLnBhdGNoKGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9zdGF0dXNgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTyxcbiAgICAgICAgICBvYnNlcnZhY29lczogJ1RyYW5zZmVyw6puY2lhIFBJWCByZWFsaXphZGEnLFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3RhdHVzKS50b0JlKFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTyk7XG4gICAgfSk7XG5cbiAgICBpdCgnNi4gRGV2ZSBmYXplciB1cGxvYWQgZGUgY29tcHJvdmFudGUgZGUgcGFnYW1lbnRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHVsYXIgc2UgbyB0ZXN0ZSBhbnRlcmlvciBmYWxob3VcbiAgICAgIGlmICghcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdQdWxhbmRvIHRlc3RlIC0gcGFnYW1lbnRvSWQgbsOjbyBkaXNwb27DrXZlbCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InLCAnZmluYW5jZWlybyddLCB1bmlkYWRlSWQpO1xuXG4gICAgICAvLyBDcmlhciBidWZmZXIgc2ltdWxhbmRvIHVtIGFycXVpdm8gUERGXG4gICAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShcbiAgICAgICAgJ0NvbnRlw7pkbyBkbyBjb21wcm92YW50ZSBkZSBwYWdhbWVudG8gcGFyYSB0ZXN0ZXMgZTJlJyxcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29tcHJvdmFudGVzYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAuYXR0YWNoKCdhcnF1aXZvJywgYnVmZmVyLCAnY29tcHJvdmFudGUucGRmJyk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgncGFnYW1lbnRvSWQnLCBwYWdhbWVudG9JZCk7XG5cbiAgICAgIC8vIEd1YXJkYXIgSUQgcGFyYSBwcsOzeGltb3MgdGVzdGVzXG4gICAgICBjb21wcm92YW50ZUlkID0gcmVzcG9uc2UuYm9keS5pZDtcbiAgICB9KTtcblxuICAgIGl0KCc3LiBEZXZlIGxpc3RhciBjb21wcm92YW50ZXMgZGUgdW0gcGFnYW1lbnRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHVsYXIgc2Ugb3MgdGVzdGVzIGFudGVyaW9yZXMgZmFsaGFyYW1cbiAgICAgIGlmICghcGFnYW1lbnRvSWQgfHwgIWNvbXByb3ZhbnRlSWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdQdWxhbmRvIHRlc3RlIC0gcGFnYW1lbnRvSWQgb3UgY29tcHJvdmFudGVJZCBuw6NvIGRpc3BvbsOtdmVsJyxcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4oZ2VzdG9ySWQsIFsnZ2VzdG9yJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9jb21wcm92YW50ZXNgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXNwb25zZS5ib2R5KSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgxKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5WzBdKS50b0hhdmVQcm9wZXJ0eSgnaWQnLCBjb21wcm92YW50ZUlkKTtcbiAgICB9KTtcblxuICAgIGl0KCc4LiBEZXZlIHJlZ2lzdHJhciBjb25maXJtYcOnw6NvIGRlIHJlY2ViaW1lbnRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHVsYXIgc2Ugb3MgdGVzdGVzIGFudGVyaW9yZXMgZmFsaGFyYW1cbiAgICAgIGlmICghcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdQdWxhbmRvIHRlc3RlIC0gcGFnYW1lbnRvSWQgbsOjbyBkaXNwb27DrXZlbCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihiZW5lZmljaWFyaW9JZCwgWyd1c3VhcmlvJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29uZmlybWFyYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgb2JzZXJ2YWNvZXM6ICdQYWdhbWVudG8gcmVjZWJpZG8gdmlhIFBJWCBlbSBtaW5oYSBjb250YScsXG4gICAgICAgICAgZGF0YUNvbmZpcm1hY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMSk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3BhZ2FtZW50b0lkJywgcGFnYW1lbnRvSWQpO1xuXG4gICAgICAvLyBHdWFyZGFyIElEIHBhcmEgcHLDs3hpbW9zIHRlc3Rlc1xuICAgICAgY29uZmlybWFjYW9JZCA9IHJlc3BvbnNlLmJvZHkuaWQ7XG4gICAgfSk7XG5cbiAgICBpdCgnOS4gRGV2ZSBjb25zdWx0YXIgY29uZmlybWHDp8OjbyBkZSByZWNlYmltZW50bycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFB1bGFyIHNlIG9zIHRlc3RlcyBhbnRlcmlvcmVzIGZhbGhhcmFtXG4gICAgICBpZiAoIXBhZ2FtZW50b0lkIHx8ICFjb25maXJtYWNhb0lkKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAnUHVsYW5kbyB0ZXN0ZSAtIHBhZ2FtZW50b0lkIG91IGNvbmZpcm1hY2FvSWQgbsOjbyBkaXNwb27DrXZlbCcsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvciddLCB1bmlkYWRlSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29uZmlybWFjYW9gKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2lkJywgY29uZmlybWFjYW9JZCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3BhZ2FtZW50b0lkJywgcGFnYW1lbnRvSWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdkYXRhQ29uZmlybWFjYW8nKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnb2JzZXJ2YWNvZXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCcxMC4gRGV2ZSBmaW5hbGl6YXIgbyBwYWdhbWVudG8gYXDDs3MgY29uZmlybWHDp8OjbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFB1bGFyIHNlIG9zIHRlc3RlcyBhbnRlcmlvcmVzIGZhbGhhcmFtXG4gICAgICBpZiAoIXBhZ2FtZW50b0lkIHx8ICFjb25maXJtYWNhb0lkKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAnUHVsYW5kbyB0ZXN0ZSAtIHBhZ2FtZW50b0lkIG91IGNvbmZpcm1hY2FvSWQgbsOjbyBkaXNwb27DrXZlbCcsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvcicsICdmaW5hbmNlaXJvJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucGF0Y2goYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L3N0YXR1c2ApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5GSU5BTElaQURPLFxuICAgICAgICAgIG9ic2VydmFjb2VzOiAnUGFnYW1lbnRvIGZpbmFsaXphZG8gYXDDs3MgY29uZmlybWHDp8OjbyBkZSByZWNlYmltZW50bycsXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdGF0dXMpLnRvQmUoU3RhdHVzUGFnYW1lbnRvRW51bS5GSU5BTElaQURPKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Rlc3RlcyBkZSBTZWd1cmFuw6dhIEUyRScsICgpID0+IHtcbiAgICBpdCgnRGV2ZSByZWplaXRhciBhY2Vzc28gc2VtIGF1dGVudGljYcOnw6NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpLmdldCgnL3BhZ2FtZW50b3MnKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ0RldmUgcmVqZWl0YXIgdG9rZW4gSldUIGludsOhbGlkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KCcvcGFnYW1lbnRvcycpXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCAnQmVhcmVyIHRva2VuLWludmFsaWRvJyk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAxKTtcbiAgICB9KTtcblxuICAgIGl0KCdEZXZlIHJlamVpdGFyIGFjZXNzbyBhIHJlY3Vyc29zIHJlc3RyaXRvcyBwb3IgcGVyZmlsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKHVzdWFyaW9JZCwgWyd1c3VhcmlvX2Jhc2ljbyddLCB1bmlkYWRlSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLnBhdGNoKGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkIHx8ICdwYWdhbWVudG8taWQnfS9zdGF0dXNgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTyxcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Nhc29zIGRlIEVycm8nLCAoKSA9PiB7XG4gICAgaXQoJ0RldmUgcmV0b3JuYXIgNDA0IHBhcmEgcGFnYW1lbnRvIGluZXhpc3RlbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvciddLCB1bmlkYWRlSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldCgnL3BhZ2FtZW50b3MvcGFnYW1lbnRvLWluZXhpc3RlbnRlJylcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubWVzc2FnZSkudG9Db250YWluKCduw6NvIGVuY29udHJhZG8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdEZXZlIHJlamVpdGFyIHRyYW5zacOnw6NvIGRlIHN0YXR1cyBpbnbDoWxpZGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBQdWxhciBzZSBvIHRlc3RlIGRlIGNyaWHDp8OjbyBmYWxob3VcbiAgICAgIGlmICghcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgLy8gQ3JpYXIgdW0gcGFnYW1lbnRvIGVzcGVjw61maWNvIHBhcmEgZXN0ZSB0ZXN0ZVxuICAgICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4oZ2VzdG9ySWQsIFsnZ2VzdG9yJywgJ2ZpbmFuY2Vpcm8nXSwgdW5pZGFkZUlkKTtcblxuICAgICAgICBjb25zdCBjcmVhdGVSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgICAucG9zdChgL3BhZ2FtZW50b3Mvc29saWNpdGFjYW8vJHtzb2xpY2l0YWNhb0lkfWApXG4gICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAgIC5zZW5kKHtcbiAgICAgICAgICAgIHZhbG9yOiAzMDAuMCxcbiAgICAgICAgICAgIG1ldG9kb1BhZ2FtZW50bzogTWV0b2RvUGFnYW1lbnRvRW51bS5QSVgsXG4gICAgICAgICAgICBpbmZvQmFuY2FyaWFJZCxcbiAgICAgICAgICAgIGRhZG9zQmFuY2FyaW9zOiB7XG4gICAgICAgICAgICAgIHBpeFRpcG86ICdDUEYnLFxuICAgICAgICAgICAgICBwaXhDaGF2ZTogJzEyMzQ1Njc4OTAwJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRhTGliZXJhY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGNyZWF0ZVJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7XG4gICAgICAgICAgcGFnYW1lbnRvSWQgPSBjcmVhdGVSZXNwb25zZS5ib2R5LmlkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybignTsOjbyBmb2kgcG9zc8OtdmVsIGNyaWFyIHBhZ2FtZW50byBwYXJhIHRlc3RlJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InLCAnZmluYW5jZWlybyddLCB1bmlkYWRlSWQpO1xuXG4gICAgICAvLyBUZW50YXIgdW1hIHRyYW5zacOnw6NvIGludsOhbGlkYSAoZGUgQUdFTkRBRE8gcGFyYSBGSU5BTElaQURPIHB1bGFuZG8gZXN0YWRvcylcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucGF0Y2goYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L3N0YXR1c2ApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5GSU5BTElaQURPLFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubWVzc2FnZSkudG9Db250YWluKCdUcmFuc2nDp8OjbyBkZSBzdGF0dXMnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==