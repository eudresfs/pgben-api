ec05cf0482f23234ca094e900e0e1746
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var PermissionScope_1;
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.PermissionScope = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const permission_entity_1 = require("./permission.entity");
const usuario_entity_1 = require("./usuario.entity");
/**
 * Entidade que define regras de escopo padrão para permissões.
 *
 * Esta entidade permite definir o tipo de escopo padrão para cada permissão,
 * facilitando a atribuição de permissões com escopo adequado.
 */
let PermissionScope = PermissionScope_1 = class PermissionScope {
    /**
     * Identificador único do mapeamento
     */
    id;
    /**
     * Referência à permissão
     */
    permissao_id;
    /**
     * Relação com a permissão
     */
    permissao;
    /**
     * Tipo de escopo padrão (GLOBAL, UNIDADE, PROPRIO)
     */
    tipo_escopo_padrao;
    /**
     * Data de criação
     */
    created_at;
    /**
     * Data de última atualização
     */
    updated_at;
    /**
     * Usuário que criou o mapeamento
     */
    criado_por;
    /**
     * Relação com o usuário que criou o mapeamento
     */
    usuario_criador;
    /**
     * Usuário que atualizou o mapeamento por último
     */
    atualizado_por;
    /**
     * Relação com o usuário que atualizou o mapeamento por último
     */
    usuario_atualizador;
    // Getters e setters para compatibilidade com código existente
    get permissionId() {
        return this.permissao_id;
    }
    set permissionId(value) {
        this.permissao_id = value;
    }
    get permission() {
        return this.permissao;
    }
    set permission(value) {
        this.permissao = value;
    }
    get defaultScopeType() {
        return this.tipo_escopo_padrao;
    }
    set defaultScopeType(value) {
        this.tipo_escopo_padrao = value;
    }
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    get creator() {
        return this.usuario_criador;
    }
    set creator(value) {
        this.usuario_criador = value;
    }
    get updatedBy() {
        return this.atualizado_por;
    }
    set updatedBy(value) {
        this.atualizado_por = value;
    }
    get updater() {
        return this.usuario_atualizador;
    }
    set updater(value) {
        this.usuario_atualizador = value;
    }
    /**
     * Verifica se o escopo foi criado por um usuário específico
     * @param usuarioId ID do usuário
     * @returns true se foi criado pelo usuário
     */
    foiCriadoPor(usuarioId) {
        return this.criado_por === usuarioId;
    }
    /**
     * Verifica se o escopo foi atualizado por um usuário específico
     * @param usuarioId ID do usuário
     * @returns true se foi atualizado pelo usuário
     */
    foiAtualizadoPor(usuarioId) {
        return this.atualizado_por === usuarioId;
    }
    /**
     * Verifica se o escopo é global
     * @returns true se o escopo é global
     */
    isGlobal() {
        return this.tipo_escopo_padrao === 'GLOBAL';
    }
    /**
     * Verifica se o escopo é por unidade
     * @returns true se o escopo é por unidade
     */
    isPorUnidade() {
        return this.tipo_escopo_padrao === 'UNIDADE';
    }
    /**
     * Verifica se o escopo é próprio
     * @returns true se o escopo é próprio
     */
    isProprio() {
        return this.tipo_escopo_padrao === 'PROPRIO';
    }
    /**
     * Define o tipo de escopo padrão
     * @param tipo Tipo de escopo
     */
    definirTipoEscopo(tipo) {
        this.tipo_escopo_padrao = tipo;
    }
    /**
     * Atualiza o usuário que modificou o escopo
     * @param usuarioId ID do usuário
     */
    atualizarPor(usuarioId) {
        this.atualizado_por = usuarioId;
    }
    /**
     * Verifica se o escopo pertence a uma permissão específica
     * @param permissaoId ID da permissão
     * @returns true se pertence à permissão
     */
    pertenceAPermissao(permissaoId) {
        return this.permissao_id === permissaoId;
    }
    /**
     * Obtém uma descrição legível do tipo de escopo
     * @returns descrição do escopo
     */
    getDescricaoEscopo() {
        const descricoes = {
            GLOBAL: 'Acesso global ao sistema',
            UNIDADE: 'Acesso restrito à unidade do usuário',
            PROPRIO: 'Acesso apenas aos próprios dados'
        };
        return descricoes[this.tipo_escopo_padrao];
    }
    /**
     * Verifica se o escopo foi criado recentemente (últimas 24 horas)
     * @returns true se foi criado nas últimas 24 horas
     */
    isCriadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.created_at > umDiaAtras;
    }
    /**
     * Calcula a idade do escopo em dias
     * @returns número de dias desde a criação
     */
    getIdadeEmDias() {
        const agora = new Date();
        const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    /**
     * Verifica se tem criador definido
     * @returns true se tem criador
     */
    temCriador() {
        return this.criado_por !== null && this.criado_por !== undefined;
    }
    /**
     * Verifica se foi atualizado recentemente (últimas 24 horas)
     * @returns true se foi atualizado nas últimas 24 horas
     */
    foiAtualizadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.updated_at > umDiaAtras;
    }
    /**
     * Obtém um resumo das informações do escopo
     * @returns objeto com resumo das informações
     */
    getSummary() {
        return {
            id: this.id,
            permissaoId: this.permissao_id,
            tipoEscopo: this.tipo_escopo_padrao,
            descricaoEscopo: this.getDescricaoEscopo(),
            criadoEm: this.created_at,
            atualizadoEm: this.updated_at,
            temCriador: this.temCriador(),
            temAtualizador: this.atualizado_por !== null
        };
    }
    /**
     * Verifica se é compatível com outro escopo (mesmo tipo)
     * @param outroEscopo outro escopo para comparar
     * @returns true se são compatíveis
     */
    isCompatibleWith(outroEscopo) {
        return this.tipo_escopo_padrao === outroEscopo.tipo_escopo_padrao;
    }
    /**
     * Gera uma chave única para o escopo
     * @returns chave única
     */
    getUniqueKey() {
        return `permission_scope_${this.permissao_id}`;
    }
    /**
     * Verifica se o estado do escopo é consistente
     * @returns true se está consistente
     */
    isConsistente() {
        return (this.id !== null &&
            this.permissao_id !== null &&
            this.tipo_escopo_padrao !== null &&
            this.created_at !== null &&
            this.updated_at !== null &&
            this.created_at <= this.updated_at);
    }
    /**
     * Obtém uma descrição completa do escopo
     * @returns descrição completa
     */
    getDescricaoCompleta() {
        const permissaoInfo = this.permissao ? this.permissao.nome : 'Permissão não carregada';
        return `Escopo ${this.tipo_escopo_padrao} para permissão: ${permissaoInfo}`;
    }
    /**
     * Verifica se pode ser removido (não tem dependências críticas)
     * @returns true se pode ser removido
     */
    podeSerRemovido() {
        // Lógica básica - pode ser expandida conforme regras de negócio
        return true;
    }
    /**
     * Clona o escopo (sem ID)
     * @returns nova instância do escopo
     */
    clone() {
        const novoEscopo = new PermissionScope_1();
        novoEscopo.permissao_id = this.permissao_id;
        novoEscopo.tipo_escopo_padrao = this.tipo_escopo_padrao;
        novoEscopo.criado_por = this.criado_por;
        return novoEscopo;
    }
    /**
     * Verifica se é um escopo de alta criticidade (GLOBAL)
     * @returns true se é de alta criticidade
     */
    isAltaCriticidade() {
        return this.tipo_escopo_padrao === 'GLOBAL';
    }
    /**
     * Verifica se é um escopo de média criticidade (UNIDADE)
     * @returns true se é de média criticidade
     */
    isMediaCriticidade() {
        return this.tipo_escopo_padrao === 'UNIDADE';
    }
    /**
     * Verifica se é um escopo de baixa criticidade (PROPRIO)
     * @returns true se é de baixa criticidade
     */
    isBaixaCriticidade() {
        return this.tipo_escopo_padrao === 'PROPRIO';
    }
    /**
     * Obtém o nível de criticidade como número
     * @returns nível de criticidade (1-3)
     */
    getNivelCriticidade() {
        const niveis = {
            PROPRIO: 1,
            UNIDADE: 2,
            GLOBAL: 3
        };
        return niveis[this.tipo_escopo_padrao];
    }
    /**
     * Verifica se o escopo permite acesso amplo
     * @returns true se permite acesso amplo
     */
    permiteAcessoAmplo() {
        return this.tipo_escopo_padrao === 'GLOBAL' || this.tipo_escopo_padrao === 'UNIDADE';
    }
    /**
     * Verifica se o escopo é restritivo
     * @returns true se é restritivo
     */
    isRestritivo() {
        return this.tipo_escopo_padrao === 'PROPRIO';
    }
    /**
     * Formata a data de criação
     * @returns data formatada
     */
    getCriacaoFormatada() {
        return this.created_at.toLocaleString('pt-BR');
    }
    /**
     * Formata a data de atualização
     * @returns data formatada
     */
    getAtualizacaoFormatada() {
        return this.updated_at.toLocaleString('pt-BR');
    }
    /**
     * Remove informações sensíveis para logs
     * @returns versão segura para logs
     */
    toSafeLog() {
        return {
            id: this.id,
            permissaoId: this.permissao_id,
            tipoEscopo: this.tipo_escopo_padrao,
            criadoEm: this.created_at,
            atualizadoEm: this.updated_at,
            temCriador: this.temCriador()
        };
    }
    /**
     * Verifica se o escopo requer aprovação especial para mudanças
     * @returns true se requer aprovação especial
     */
    requerAprovacaoEspecial() {
        return this.tipo_escopo_padrao === 'GLOBAL';
    }
    /**
     * Obtém sugestões de melhoria de segurança
     * @returns array de sugestões
     */
    getSugestoesMelhoria() {
        const sugestoes = [];
        if (this.tipo_escopo_padrao === 'GLOBAL') {
            sugestoes.push('Considere restringir o escopo se possível');
            sugestoes.push('Monitore o uso desta permissão global');
        }
        if (!this.temCriador()) {
            sugestoes.push('Defina um criador para auditoria');
        }
        return sugestoes;
    }
};
exports.PermissionScope = PermissionScope;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], PermissionScope.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', name: 'permissao_id' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID da permissão é obrigatório' }),
    (0, class_validator_1.IsUUID)('4', { message: 'ID da permissão inválido' }),
    __metadata("design:type", String)
], PermissionScope.prototype, "permissao_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => permission_entity_1.Permission, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'permissao_id' }),
    __metadata("design:type", typeof (_a = typeof permission_entity_1.Permission !== "undefined" && permission_entity_1.Permission) === "function" ? _a : Object)
], PermissionScope.prototype, "permissao", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: ['GLOBAL', 'UNIDADE', 'PROPRIO'],
        default: 'PROPRIO',
    }),
    (0, class_validator_1.IsEnum)(['GLOBAL', 'UNIDADE', 'PROPRIO'], {
        message: 'Tipo de escopo deve ser GLOBAL, UNIDADE ou PROPRIO'
    }),
    __metadata("design:type", String)
], PermissionScope.prototype, "tipo_escopo_padrao", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)({ name: 'created_at' }),
    __metadata("design:type", typeof (_b = typeof Date !== "undefined" && Date) === "function" ? _b : Object)
], PermissionScope.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)({ name: 'updated_at' }),
    __metadata("design:type", typeof (_c = typeof Date !== "undefined" && Date) === "function" ? _c : Object)
], PermissionScope.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true, name: 'criado_por' }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do criador inválido' }),
    __metadata("design:type", String)
], PermissionScope.prototype, "criado_por", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { nullable: true }),
    (0, typeorm_1.JoinColumn)({ name: 'criado_por' }),
    __metadata("design:type", Object)
], PermissionScope.prototype, "usuario_criador", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true, name: 'atualizado_por' }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do atualizador inválido' }),
    __metadata("design:type", Object)
], PermissionScope.prototype, "atualizado_por", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { nullable: true }),
    (0, typeorm_1.JoinColumn)({ name: 'atualizado_por' }),
    __metadata("design:type", Object)
], PermissionScope.prototype, "usuario_atualizador", void 0);
exports.PermissionScope = PermissionScope = PermissionScope_1 = __decorate([
    (0, typeorm_1.Entity)('escopo_permissao'),
    (0, typeorm_1.Index)(['permissao_id'], { unique: true }),
    (0, typeorm_1.Index)(['tipo_escopo_padrao']),
    (0, typeorm_1.Index)(['criado_por']),
    (0, typeorm_1.Index)(['created_at'])
], PermissionScope);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxwZXJtaXNzaW9uLXNjb3BlLmVudGl0eS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLHFDQUFtSTtBQUNuSSxxREFBeUU7QUFDekUsMkRBQWlEO0FBQ2pELHFEQUEyQztBQUczQzs7Ozs7R0FLRztBQU1JLElBQU0sZUFBZSx1QkFBckIsTUFBTSxlQUFlO0lBQzFCOztPQUVHO0lBRUgsRUFBRSxDQUFTO0lBRVg7O09BRUc7SUFJSCxZQUFZLENBQVM7SUFFckI7O09BRUc7SUFHSCxTQUFTLENBQWE7SUFFdEI7O09BRUc7SUFTSCxrQkFBa0IsQ0FBbUM7SUFFckQ7O09BRUc7SUFFSCxVQUFVLENBQU87SUFFakI7O09BRUc7SUFFSCxVQUFVLENBQU87SUFFakI7O09BRUc7SUFJSCxVQUFVLENBQVU7SUFFcEI7O09BRUc7SUFHSCxlQUFlLENBQWlCO0lBRWhDOztPQUVHO0lBSUgsY0FBYyxDQUFnQjtJQUU5Qjs7T0FFRztJQUdILG1CQUFtQixDQUFpQjtJQUVwQyw4REFBOEQ7SUFDOUQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQzNCLENBQUM7SUFFRCxJQUFJLFlBQVksQ0FBQyxLQUFhO1FBQzVCLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLFVBQVU7UUFDWixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDeEIsQ0FBQztJQUVELElBQUksVUFBVSxDQUFDLEtBQWlCO1FBQzlCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLGdCQUFnQjtRQUNsQixPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztJQUNqQyxDQUFDO0lBRUQsSUFBSSxnQkFBZ0IsQ0FBQyxLQUF1QztRQUMxRCxJQUFJLENBQUMsa0JB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RUFBRSxDQUFDO0lBQzVDLElBQUEsb0JBQVUsRUFBQyxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxDQUFDOzs0REFDSDswQkEzRXpCLGVBQWU7SUFMM0IsSUFBQSxnQkFBTSxFQUFDLGtCQUFrQixDQUFDO0lBQzFCLElBQUEsZUFBSyxFQUFDLENBQUMsY0FBYyxDQUFDLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDekMsSUFBQSxlQUFLLEVBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQzdCLElBQUEsZUFBSyxFQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDckIsSUFBQSxlQUFLLEVBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQztHQUNULGVBQWUsQ0FrYzNCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxlbnRpdGllc1xccGVybWlzc2lvbi1zY29wZS5lbnRpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29sdW1uLCBDcmVhdGVEYXRlQ29sdW1uLCBFbnRpdHksIEpvaW5Db2x1bW4sIE1hbnlUb09uZSwgUHJpbWFyeUdlbmVyYXRlZENvbHVtbiwgVXBkYXRlRGF0ZUNvbHVtbiwgSW5kZXggfSBmcm9tICd0eXBlb3JtJztcbmltcG9ydCB7IElzTm90RW1wdHksIElzVVVJRCwgSXNFbnVtLCBJc09wdGlvbmFsIH0gZnJvbSAnY2xhc3MtdmFsaWRhdG9yJztcbmltcG9ydCB7IFBlcm1pc3Npb24gfSBmcm9tICcuL3Blcm1pc3Npb24uZW50aXR5JztcbmltcG9ydCB7IFVzdWFyaW8gfSBmcm9tICcuL3VzdWFyaW8uZW50aXR5JztcbmltcG9ydCB7IFRpcG9Fc2NvcG8gfSBmcm9tICcuL3VzZXItcGVybWlzc2lvbi5lbnRpdHknO1xuXG4vKipcbiAqIEVudGlkYWRlIHF1ZSBkZWZpbmUgcmVncmFzIGRlIGVzY29wbyBwYWRyw6NvIHBhcmEgcGVybWlzc8O1ZXMuXG4gKiBcbiAqIEVzdGEgZW50aWRhZGUgcGVybWl0ZSBkZWZpbmlyIG8gdGlwbyBkZSBlc2NvcG8gcGFkcsOjbyBwYXJhIGNhZGEgcGVybWlzc8OjbyxcbiAqIGZhY2lsaXRhbmRvIGEgYXRyaWJ1acOnw6NvIGRlIHBlcm1pc3PDtWVzIGNvbSBlc2NvcG8gYWRlcXVhZG8uXG4gKi9cbkBFbnRpdHkoJ2VzY29wb19wZXJtaXNzYW8nKVxuQEluZGV4KFsncGVybWlzc2FvX2lkJ10sIHsgdW5pcXVlOiB0cnVlIH0pXG5ASW5kZXgoWyd0aXBvX2VzY29wb19wYWRyYW8nXSlcbkBJbmRleChbJ2NyaWFkb19wb3InXSlcbkBJbmRleChbJ2NyZWF0ZWRfYXQnXSlcbmV4cG9ydCBjbGFzcyBQZXJtaXNzaW9uU2NvcGUge1xuICAvKipcbiAgICogSWRlbnRpZmljYWRvciDDum5pY28gZG8gbWFwZWFtZW50b1xuICAgKi9cbiAgQFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4oJ3V1aWQnKVxuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBSZWZlcsOqbmNpYSDDoCBwZXJtaXNzw6NvXG4gICAqL1xuICBAQ29sdW1uKHsgdHlwZTogJ3V1aWQnLCBuYW1lOiAncGVybWlzc2FvX2lkJyB9KVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdJRCBkYSBwZXJtaXNzw6NvIMOpIG9icmlnYXTDs3JpbycgfSlcbiAgQElzVVVJRCgnNCcsIHsgbWVzc2FnZTogJ0lEIGRhIHBlcm1pc3PDo28gaW52w6FsaWRvJyB9KVxuICBwZXJtaXNzYW9faWQ6IHN0cmluZztcblxuICAvKipcbiAgICogUmVsYcOnw6NvIGNvbSBhIHBlcm1pc3PDo29cbiAgICovXG4gIEBNYW55VG9PbmUoKCkgPT4gUGVybWlzc2lvbiwgeyBvbkRlbGV0ZTogJ0NBU0NBREUnIH0pXG4gIEBKb2luQ29sdW1uKHsgbmFtZTogJ3Blcm1pc3Nhb19pZCcgfSlcbiAgcGVybWlzc2FvOiBQZXJtaXNzaW9uO1xuXG4gIC8qKlxuICAgKiBUaXBvIGRlIGVzY29wbyBwYWRyw6NvIChHTE9CQUwsIFVOSURBREUsIFBST1BSSU8pXG4gICAqL1xuICBAQ29sdW1uKHtcbiAgICB0eXBlOiAnZW51bScsXG4gICAgZW51bTogWydHTE9CQUwnLCAnVU5JREFERScsICdQUk9QUklPJ10sXG4gICAgZGVmYXVsdDogJ1BST1BSSU8nLFxuICB9KVxuICBASXNFbnVtKFsnR0xPQkFMJywgJ1VOSURBREUnLCAnUFJPUFJJTyddLCB7IFxuICAgIG1lc3NhZ2U6ICdUaXBvIGRlIGVzY29wbyBkZXZlIHNlciBHTE9CQUwsIFVOSURBREUgb3UgUFJPUFJJTycgXG4gIH0pXG4gIHRpcG9fZXNjb3BvX3BhZHJhbzogJ0dMT0JBTCcgfCAnVU5JREFERScgfCAnUFJPUFJJTyc7XG5cbiAgLyoqXG4gICAqIERhdGEgZGUgY3JpYcOnw6NvXG4gICAqL1xuICBAQ3JlYXRlRGF0ZUNvbHVtbih7IG5hbWU6ICdjcmVhdGVkX2F0JyB9KVxuICBjcmVhdGVkX2F0OiBEYXRlO1xuXG4gIC8qKlxuICAgKiBEYXRhIGRlIMO6bHRpbWEgYXR1YWxpemHDp8Ojb1xuICAgKi9cbiAgQFVwZGF0ZURhdGVDb2x1bW4oeyBuYW1lOiAndXBkYXRlZF9hdCcgfSlcbiAgdXBkYXRlZF9hdDogRGF0ZTtcblxuICAvKipcbiAgICogVXN1w6FyaW8gcXVlIGNyaW91IG8gbWFwZWFtZW50b1xuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUsIG5hbWU6ICdjcmlhZG9fcG9yJyB9KVxuICBASXNPcHRpb25hbCgpXG4gIEBJc1VVSUQoJzQnLCB7IG1lc3NhZ2U6ICdJRCBkbyBjcmlhZG9yIGludsOhbGlkbycgfSlcbiAgY3JpYWRvX3Bvcj86IHN0cmluZztcblxuICAvKipcbiAgICogUmVsYcOnw6NvIGNvbSBvIHVzdcOhcmlvIHF1ZSBjcmlvdSBvIG1hcGVhbWVudG9cbiAgICovXG4gIEBNYW55VG9PbmUoKCkgPT4gVXN1YXJpbywgeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASm9pbkNvbHVtbih7IG5hbWU6ICdjcmlhZG9fcG9yJyB9KVxuICB1c3VhcmlvX2NyaWFkb3I6IFVzdWFyaW8gfCBudWxsO1xuXG4gIC8qKlxuICAgKiBVc3XDoXJpbyBxdWUgYXR1YWxpem91IG8gbWFwZWFtZW50byBwb3Igw7psdGltb1xuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUsIG5hbWU6ICdhdHVhbGl6YWRvX3BvcicgfSlcbiAgQElzT3B0aW9uYWwoKVxuICBASXNVVUlEKCc0JywgeyBtZXNzYWdlOiAnSUQgZG8gYXR1YWxpemFkb3IgaW52w6FsaWRvJyB9KVxuICBhdHVhbGl6YWRvX3Bvcjogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogUmVsYcOnw6NvIGNvbSBvIHVzdcOhcmlvIHF1ZSBhdHVhbGl6b3UgbyBtYXBlYW1lbnRvIHBvciDDumx0aW1vXG4gICAqL1xuICBATWFueVRvT25lKCgpID0+IFVzdWFyaW8sIHsgbnVsbGFibGU6IHRydWUgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAnYXR1YWxpemFkb19wb3InIH0pXG4gIHVzdWFyaW9fYXR1YWxpemFkb3I6IFVzdWFyaW8gfCBudWxsO1xuXG4gIC8vIEdldHRlcnMgZSBzZXR0ZXJzIHBhcmEgY29tcGF0aWJpbGlkYWRlIGNvbSBjw7NkaWdvIGV4aXN0ZW50ZVxuICBnZXQgcGVybWlzc2lvbklkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucGVybWlzc2FvX2lkO1xuICB9XG5cbiAgc2V0IHBlcm1pc3Npb25JZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5wZXJtaXNzYW9faWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBwZXJtaXNzaW9uKCk6IFBlcm1pc3Npb24ge1xuICAgIHJldHVybiB0aGlzLnBlcm1pc3NhbztcbiAgfVxuXG4gIHNldCBwZXJtaXNzaW9uKHZhbHVlOiBQZXJtaXNzaW9uKSB7XG4gICAgdGhpcy5wZXJtaXNzYW8gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBkZWZhdWx0U2NvcGVUeXBlKCk6ICdHTE9CQUwnIHwgJ1VOSURBREUnIHwgJ1BST1BSSU8nIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wb19wYWRyYW87XG4gIH1cblxuICBzZXQgZGVmYXVsdFNjb3BlVHlwZSh2YWx1ZTogJ0dMT0JBTCcgfCAnVU5JREFERScgfCAnUFJPUFJJTycpIHtcbiAgICB0aGlzLnRpcG9fZXNjb3BvX3BhZHJhbyA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGNyZWF0ZWRBdCgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0O1xuICB9XG5cbiAgZ2V0IHVwZGF0ZWRBdCgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0O1xuICB9XG5cbiAgZ2V0IGNyZWF0b3IoKTogVXN1YXJpbyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnVzdWFyaW9fY3JpYWRvcjtcbiAgfVxuXG4gIHNldCBjcmVhdG9yKHZhbHVlOiBVc3VhcmlvIHwgbnVsbCkge1xuICAgIHRoaXMudXN1YXJpb19jcmlhZG9yID0gdmFsdWU7XG4gIH1cblxuICBnZXQgdXBkYXRlZEJ5KCk6IHN0cmluZyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmF0dWFsaXphZG9fcG9yO1xuICB9XG5cbiAgc2V0IHVwZGF0ZWRCeSh2YWx1ZTogc3RyaW5nIHwgbnVsbCkge1xuICAgIHRoaXMuYXR1YWxpemFkb19wb3IgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCB1cGRhdGVyKCk6IFVzdWFyaW8gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy51c3VhcmlvX2F0dWFsaXphZG9yO1xuICB9XG5cbiAgc2V0IHVwZGF0ZXIodmFsdWU6IFVzdWFyaW8gfCBudWxsKSB7XG4gICAgdGhpcy51c3VhcmlvX2F0dWFsaXphZG9yID0gdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBlc2NvcG8gZm9pIGNyaWFkbyBwb3IgdW0gdXN1w6FyaW8gZXNwZWPDrWZpY29cbiAgICogQHBhcmFtIHVzdWFyaW9JZCBJRCBkbyB1c3XDoXJpb1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIGZvaSBjcmlhZG8gcGVsbyB1c3XDoXJpb1xuICAgKi9cbiAgZm9pQ3JpYWRvUG9yKHVzdWFyaW9JZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY3JpYWRvX3BvciA9PT0gdXN1YXJpb0lkO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZXNjb3BvIGZvaSBhdHVhbGl6YWRvIHBvciB1bSB1c3XDoXJpbyBlc3BlY8OtZmljb1xuICAgKiBAcGFyYW0gdXN1YXJpb0lkIElEIGRvIHVzdcOhcmlvXG4gICAqIEByZXR1cm5zIHRydWUgc2UgZm9pIGF0dWFsaXphZG8gcGVsbyB1c3XDoXJpb1xuICAgKi9cbiAgZm9pQXR1YWxpemFkb1Bvcih1c3VhcmlvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmF0dWFsaXphZG9fcG9yID09PSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBlc2NvcG8gw6kgZ2xvYmFsXG4gICAqIEByZXR1cm5zIHRydWUgc2UgbyBlc2NvcG8gw6kgZ2xvYmFsXG4gICAqL1xuICBpc0dsb2JhbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wb19wYWRyYW8gPT09ICdHTE9CQUwnO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZXNjb3BvIMOpIHBvciB1bmlkYWRlXG4gICAqIEByZXR1cm5zIHRydWUgc2UgbyBlc2NvcG8gw6kgcG9yIHVuaWRhZGVcbiAgICovXG4gIGlzUG9yVW5pZGFkZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wb19wYWRyYW8gPT09ICdVTklEQURFJztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBvIGVzY29wbyDDqSBwcsOzcHJpb1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIG8gZXNjb3BvIMOpIHByw7NwcmlvXG4gICAqL1xuICBpc1Byb3ByaW8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSAnUFJPUFJJTyc7XG4gIH1cblxuICAvKipcbiAgICogRGVmaW5lIG8gdGlwbyBkZSBlc2NvcG8gcGFkcsOjb1xuICAgKiBAcGFyYW0gdGlwbyBUaXBvIGRlIGVzY29wb1xuICAgKi9cbiAgZGVmaW5pclRpcG9Fc2NvcG8odGlwbzogJ0dMT0JBTCcgfCAnVU5JREFERScgfCAnUFJPUFJJTycpOiB2b2lkIHtcbiAgICB0aGlzLnRpcG9fZXNjb3BvX3BhZHJhbyA9IHRpcG87XG4gIH1cblxuICAvKipcbiAgICogQXR1YWxpemEgbyB1c3XDoXJpbyBxdWUgbW9kaWZpY291IG8gZXNjb3BvXG4gICAqIEBwYXJhbSB1c3VhcmlvSWQgSUQgZG8gdXN1w6FyaW9cbiAgICovXG4gIGF0dWFsaXphclBvcih1c3VhcmlvSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuYXR1YWxpemFkb19wb3IgPSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBlc2NvcG8gcGVydGVuY2UgYSB1bWEgcGVybWlzc8OjbyBlc3BlY8OtZmljYVxuICAgKiBAcGFyYW0gcGVybWlzc2FvSWQgSUQgZGEgcGVybWlzc8Ojb1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIHBlcnRlbmNlIMOgIHBlcm1pc3PDo29cbiAgICovXG4gIHBlcnRlbmNlQVBlcm1pc3NhbyhwZXJtaXNzYW9JZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucGVybWlzc2FvX2lkID09PSBwZXJtaXNzYW9JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gdW1hIGRlc2NyacOnw6NvIGxlZ8OtdmVsIGRvIHRpcG8gZGUgZXNjb3BvXG4gICAqIEByZXR1cm5zIGRlc2NyacOnw6NvIGRvIGVzY29wb1xuICAgKi9cbiAgZ2V0RGVzY3JpY2FvRXNjb3BvKCk6IHN0cmluZyB7XG4gICAgY29uc3QgZGVzY3JpY29lcyA9IHtcbiAgICAgIEdMT0JBTDogJ0FjZXNzbyBnbG9iYWwgYW8gc2lzdGVtYScsXG4gICAgICBVTklEQURFOiAnQWNlc3NvIHJlc3RyaXRvIMOgIHVuaWRhZGUgZG8gdXN1w6FyaW8nLFxuICAgICAgUFJPUFJJTzogJ0FjZXNzbyBhcGVuYXMgYW9zIHByw7NwcmlvcyBkYWRvcydcbiAgICB9O1xuICAgIHJldHVybiBkZXNjcmljb2VzW3RoaXMudGlwb19lc2NvcG9fcGFkcmFvXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBvIGVzY29wbyBmb2kgY3JpYWRvIHJlY2VudGVtZW50ZSAow7psdGltYXMgMjQgaG9yYXMpXG4gICAqIEByZXR1cm5zIHRydWUgc2UgZm9pIGNyaWFkbyBuYXMgw7psdGltYXMgMjQgaG9yYXNcbiAgICovXG4gIGlzQ3JpYWRvUmVjZW50ZW1lbnRlKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFnb3JhID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCB1bURpYUF0cmFzID0gbmV3IERhdGUoYWdvcmEuZ2V0VGltZSgpIC0gMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlZF9hdCA+IHVtRGlhQXRyYXM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYSBhIGlkYWRlIGRvIGVzY29wbyBlbSBkaWFzXG4gICAqIEByZXR1cm5zIG7Dum1lcm8gZGUgZGlhcyBkZXNkZSBhIGNyaWHDp8Ojb1xuICAgKi9cbiAgZ2V0SWRhZGVFbURpYXMoKTogbnVtYmVyIHtcbiAgICBjb25zdCBhZ29yYSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZGlmZlRpbWUgPSBNYXRoLmFicyhhZ29yYS5nZXRUaW1lKCkgLSB0aGlzLmNyZWF0ZWRfYXQuZ2V0VGltZSgpKTtcbiAgICByZXR1cm4gTWF0aC5jZWlsKGRpZmZUaW1lIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSB0ZW0gY3JpYWRvciBkZWZpbmlkb1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIHRlbSBjcmlhZG9yXG4gICAqL1xuICB0ZW1DcmlhZG9yKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNyaWFkb19wb3IgIT09IG51bGwgJiYgdGhpcy5jcmlhZG9fcG9yICE9PSB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgZm9pIGF0dWFsaXphZG8gcmVjZW50ZW1lbnRlICjDumx0aW1hcyAyNCBob3JhcylcbiAgICogQHJldHVybnMgdHJ1ZSBzZSBmb2kgYXR1YWxpemFkbyBuYXMgw7psdGltYXMgMjQgaG9yYXNcbiAgICovXG4gIGZvaUF0dWFsaXphZG9SZWNlbnRlbWVudGUoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYWdvcmEgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHVtRGlhQXRyYXMgPSBuZXcgRGF0ZShhZ29yYS5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0ID4gdW1EaWFBdHJhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gdW0gcmVzdW1vIGRhcyBpbmZvcm1hw6fDtWVzIGRvIGVzY29wb1xuICAgKiBAcmV0dXJucyBvYmpldG8gY29tIHJlc3VtbyBkYXMgaW5mb3JtYcOnw7Vlc1xuICAgKi9cbiAgZ2V0U3VtbWFyeSgpOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBwZXJtaXNzYW9JZDogc3RyaW5nO1xuICAgIHRpcG9Fc2NvcG86IHN0cmluZztcbiAgICBkZXNjcmljYW9Fc2NvcG86IHN0cmluZztcbiAgICBjcmlhZG9FbTogRGF0ZTtcbiAgICBhdHVhbGl6YWRvRW06IERhdGU7XG4gICAgdGVtQ3JpYWRvcjogYm9vbGVhbjtcbiAgICB0ZW1BdHVhbGl6YWRvcjogYm9vbGVhbjtcbiAgfSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiB0aGlzLmlkLFxuICAgICAgcGVybWlzc2FvSWQ6IHRoaXMucGVybWlzc2FvX2lkLFxuICAgICAgdGlwb0VzY29wbzogdGhpcy50aXBvX2VzY29wb19wYWRyYW8sXG4gICAgICBkZXNjcmljYW9Fc2NvcG86IHRoaXMuZ2V0RGVzY3JpY2FvRXNjb3BvKCksXG4gICAgICBjcmlhZG9FbTogdGhpcy5jcmVhdGVkX2F0LFxuICAgICAgYXR1YWxpemFkb0VtOiB0aGlzLnVwZGF0ZWRfYXQsXG4gICAgICB0ZW1DcmlhZG9yOiB0aGlzLnRlbUNyaWFkb3IoKSxcbiAgICAgIHRlbUF0dWFsaXphZG9yOiB0aGlzLmF0dWFsaXphZG9fcG9yICE9PSBudWxsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSBjb21wYXTDrXZlbCBjb20gb3V0cm8gZXNjb3BvIChtZXNtbyB0aXBvKVxuICAgKiBAcGFyYW0gb3V0cm9Fc2NvcG8gb3V0cm8gZXNjb3BvIHBhcmEgY29tcGFyYXJcbiAgICogQHJldHVybnMgdHJ1ZSBzZSBzw6NvIGNvbXBhdMOtdmVpc1xuICAgKi9cbiAgaXNDb21wYXRpYmxlV2l0aChvdXRyb0VzY29wbzogUGVybWlzc2lvblNjb3BlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSBvdXRyb0VzY29wby50aXBvX2VzY29wb19wYWRyYW87XG4gIH1cblxuICAvKipcbiAgICogR2VyYSB1bWEgY2hhdmUgw7puaWNhIHBhcmEgbyBlc2NvcG9cbiAgICogQHJldHVybnMgY2hhdmUgw7puaWNhXG4gICAqL1xuICBnZXRVbmlxdWVLZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYHBlcm1pc3Npb25fc2NvcGVfJHt0aGlzLnBlcm1pc3Nhb19pZH1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZXN0YWRvIGRvIGVzY29wbyDDqSBjb25zaXN0ZW50ZVxuICAgKiBAcmV0dXJucyB0cnVlIHNlIGVzdMOhIGNvbnNpc3RlbnRlXG4gICAqL1xuICBpc0NvbnNpc3RlbnRlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmlkICE9PSBudWxsICYmXG4gICAgICB0aGlzLnBlcm1pc3Nhb19pZCAhPT0gbnVsbCAmJlxuICAgICAgdGhpcy50aXBvX2VzY29wb19wYWRyYW8gIT09IG51bGwgJiZcbiAgICAgIHRoaXMuY3JlYXRlZF9hdCAhPT0gbnVsbCAmJlxuICAgICAgdGhpcy51cGRhdGVkX2F0ICE9PSBudWxsICYmXG4gICAgICB0aGlzLmNyZWF0ZWRfYXQgPD0gdGhpcy51cGRhdGVkX2F0XG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gdW1hIGRlc2NyacOnw6NvIGNvbXBsZXRhIGRvIGVzY29wb1xuICAgKiBAcmV0dXJucyBkZXNjcmnDp8OjbyBjb21wbGV0YVxuICAgKi9cbiAgZ2V0RGVzY3JpY2FvQ29tcGxldGEoKTogc3RyaW5nIHtcbiAgICBjb25zdCBwZXJtaXNzYW9JbmZvID0gdGhpcy5wZXJtaXNzYW8gPyB0aGlzLnBlcm1pc3Nhby5ub21lIDogJ1Blcm1pc3PDo28gbsOjbyBjYXJyZWdhZGEnO1xuICAgIHJldHVybiBgRXNjb3BvICR7dGhpcy50aXBvX2VzY29wb19wYWRyYW99IHBhcmEgcGVybWlzc8OjbzogJHtwZXJtaXNzYW9JbmZvfWA7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgcG9kZSBzZXIgcmVtb3ZpZG8gKG7Do28gdGVtIGRlcGVuZMOqbmNpYXMgY3LDrXRpY2FzKVxuICAgKiBAcmV0dXJucyB0cnVlIHNlIHBvZGUgc2VyIHJlbW92aWRvXG4gICAqL1xuICBwb2RlU2VyUmVtb3ZpZG8oKTogYm9vbGVhbiB7XG4gICAgLy8gTMOzZ2ljYSBiw6FzaWNhIC0gcG9kZSBzZXIgZXhwYW5kaWRhIGNvbmZvcm1lIHJlZ3JhcyBkZSBuZWfDs2Npb1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb25hIG8gZXNjb3BvIChzZW0gSUQpXG4gICAqIEByZXR1cm5zIG5vdmEgaW5zdMOibmNpYSBkbyBlc2NvcG9cbiAgICovXG4gIGNsb25lKCk6IFBlcm1pc3Npb25TY29wZSB7XG4gICAgY29uc3Qgbm92b0VzY29wbyA9IG5ldyBQZXJtaXNzaW9uU2NvcGUoKTtcbiAgICBub3ZvRXNjb3BvLnBlcm1pc3Nhb19pZCA9IHRoaXMucGVybWlzc2FvX2lkO1xuICAgIG5vdm9Fc2NvcG8udGlwb19lc2NvcG9fcGFkcmFvID0gdGhpcy50aXBvX2VzY29wb19wYWRyYW87XG4gICAgbm92b0VzY29wby5jcmlhZG9fcG9yID0gdGhpcy5jcmlhZG9fcG9yO1xuICAgIHJldHVybiBub3ZvRXNjb3BvO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIHVtIGVzY29wbyBkZSBhbHRhIGNyaXRpY2lkYWRlIChHTE9CQUwpXG4gICAqIEByZXR1cm5zIHRydWUgc2Ugw6kgZGUgYWx0YSBjcml0aWNpZGFkZVxuICAgKi9cbiAgaXNBbHRhQ3JpdGljaWRhZGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSAnR0xPQkFMJztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSB1bSBlc2NvcG8gZGUgbcOpZGlhIGNyaXRpY2lkYWRlIChVTklEQURFKVxuICAgKiBAcmV0dXJucyB0cnVlIHNlIMOpIGRlIG3DqWRpYSBjcml0aWNpZGFkZVxuICAgKi9cbiAgaXNNZWRpYUNyaXRpY2lkYWRlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRpcG9fZXNjb3BvX3BhZHJhbyA9PT0gJ1VOSURBREUnO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIHVtIGVzY29wbyBkZSBiYWl4YSBjcml0aWNpZGFkZSAoUFJPUFJJTylcbiAgICogQHJldHVybnMgdHJ1ZSBzZSDDqSBkZSBiYWl4YSBjcml0aWNpZGFkZVxuICAgKi9cbiAgaXNCYWl4YUNyaXRpY2lkYWRlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRpcG9fZXNjb3BvX3BhZHJhbyA9PT0gJ1BST1BSSU8nO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBvIG7DrXZlbCBkZSBjcml0aWNpZGFkZSBjb21vIG7Dum1lcm9cbiAgICogQHJldHVybnMgbsOtdmVsIGRlIGNyaXRpY2lkYWRlICgxLTMpXG4gICAqL1xuICBnZXROaXZlbENyaXRpY2lkYWRlKCk6IG51bWJlciB7XG4gICAgY29uc3Qgbml2ZWlzID0ge1xuICAgICAgUFJPUFJJTzogMSxcbiAgICAgIFVOSURBREU6IDIsXG4gICAgICBHTE9CQUw6IDNcbiAgICB9O1xuICAgIHJldHVybiBuaXZlaXNbdGhpcy50aXBvX2VzY29wb19wYWRyYW9dO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZXNjb3BvIHBlcm1pdGUgYWNlc3NvIGFtcGxvXG4gICAqIEByZXR1cm5zIHRydWUgc2UgcGVybWl0ZSBhY2Vzc28gYW1wbG9cbiAgICovXG4gIHBlcm1pdGVBY2Vzc29BbXBsbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wb19wYWRyYW8gPT09ICdHTE9CQUwnIHx8IHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSAnVU5JREFERSc7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBlc2NvcG8gw6kgcmVzdHJpdGl2b1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIMOpIHJlc3RyaXRpdm9cbiAgICovXG4gIGlzUmVzdHJpdGl2bygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wb19wYWRyYW8gPT09ICdQUk9QUklPJztcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRhIGEgZGF0YSBkZSBjcmlhw6fDo29cbiAgICogQHJldHVybnMgZGF0YSBmb3JtYXRhZGFcbiAgICovXG4gIGdldENyaWFjYW9Gb3JtYXRhZGEoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0LnRvTG9jYWxlU3RyaW5nKCdwdC1CUicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1hdGEgYSBkYXRhIGRlIGF0dWFsaXphw6fDo29cbiAgICogQHJldHVybnMgZGF0YSBmb3JtYXRhZGFcbiAgICovXG4gIGdldEF0dWFsaXphY2FvRm9ybWF0YWRhKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlZF9hdC50b0xvY2FsZVN0cmluZygncHQtQlInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgaW5mb3JtYcOnw7VlcyBzZW5zw612ZWlzIHBhcmEgbG9nc1xuICAgKiBAcmV0dXJucyB2ZXJzw6NvIHNlZ3VyYSBwYXJhIGxvZ3NcbiAgICovXG4gIHRvU2FmZUxvZygpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCxcbiAgICAgIHBlcm1pc3Nhb0lkOiB0aGlzLnBlcm1pc3Nhb19pZCxcbiAgICAgIHRpcG9Fc2NvcG86IHRoaXMudGlwb19lc2NvcG9fcGFkcmFvLFxuICAgICAgY3JpYWRvRW06IHRoaXMuY3JlYXRlZF9hdCxcbiAgICAgIGF0dWFsaXphZG9FbTogdGhpcy51cGRhdGVkX2F0LFxuICAgICAgdGVtQ3JpYWRvcjogdGhpcy50ZW1DcmlhZG9yKClcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIG8gZXNjb3BvIHJlcXVlciBhcHJvdmHDp8OjbyBlc3BlY2lhbCBwYXJhIG11ZGFuw6dhc1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIHJlcXVlciBhcHJvdmHDp8OjbyBlc3BlY2lhbFxuICAgKi9cbiAgcmVxdWVyQXByb3ZhY2FvRXNwZWNpYWwoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSAnR0xPQkFMJztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gc3VnZXN0w7VlcyBkZSBtZWxob3JpYSBkZSBzZWd1cmFuw6dhXG4gICAqIEByZXR1cm5zIGFycmF5IGRlIHN1Z2VzdMO1ZXNcbiAgICovXG4gIGdldFN1Z2VzdG9lc01lbGhvcmlhKCk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdWdlc3RvZXM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgaWYgKHRoaXMudGlwb19lc2NvcG9fcGFkcmFvID09PSAnR0xPQkFMJykge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ0NvbnNpZGVyZSByZXN0cmluZ2lyIG8gZXNjb3BvIHNlIHBvc3PDrXZlbCcpO1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ01vbml0b3JlIG8gdXNvIGRlc3RhIHBlcm1pc3PDo28gZ2xvYmFsJyk7XG4gICAgfVxuICAgIFxuICAgIGlmICghdGhpcy50ZW1DcmlhZG9yKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdEZWZpbmEgdW0gY3JpYWRvciBwYXJhIGF1ZGl0b3JpYScpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc3VnZXN0b2VzO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=