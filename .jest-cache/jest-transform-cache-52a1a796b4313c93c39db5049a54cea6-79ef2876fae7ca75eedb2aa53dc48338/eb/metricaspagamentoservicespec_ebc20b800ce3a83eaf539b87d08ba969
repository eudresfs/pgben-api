08ab46c843b81ea83b40151bcc83b408
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("@nestjs/typeorm");
const metricas_pagamento_service_1 = require("../../../services/metricas-pagamento.service");
const pagamento_entity_1 = require("../../../entities/pagamento.entity");
const comprovante_pagamento_entity_1 = require("../../../entities/comprovante-pagamento.entity");
const confirmacao_recebimento_entity_1 = require("../../../entities/confirmacao-recebimento.entity");
const status_pagamento_enum_1 = require("../../../enums/status-pagamento.enum");
const metodo_pagamento_enum_1 = require("../../../enums/metodo-pagamento.enum");
/**
 * Testes unitários para MetricasPagamentoService
 *
 * Valida o funcionamento do serviço responsável por coletar
 * e disponibilizar métricas sobre as operações de pagamento.
 *
 * @author Equipe PGBen
 */
describe('MetricasPagamentoService', () => {
    let service;
    let pagamentoRepository;
    let comprovanteRepository;
    let confirmacaoRepository;
    // Mock do QueryBuilder para uso nos testes
    const mockQueryBuilder = {
        select: jest.fn().mockReturnThis(),
        addSelect: jest.fn().mockReturnThis(),
        from: jest.fn().mockReturnThis(),
        where: jest.fn().mockReturnThis(),
        andWhere: jest.fn().mockReturnThis(),
        leftJoin: jest.fn().mockReturnThis(),
        innerJoin: jest.fn().mockReturnThis(),
        groupBy: jest.fn().mockReturnThis(),
        orderBy: jest.fn().mockReturnThis(),
        getRawMany: jest.fn().mockResolvedValue([]),
        getRawOne: jest.fn().mockResolvedValue({}),
        execute: jest.fn().mockResolvedValue([])
    };
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                metricas_pagamento_service_1.MetricasPagamentoService,
                {
                    provide: (0, typeorm_1.getRepositoryToken)(pagamento_entity_1.Pagamento),
                    useValue: {
                        createQueryBuilder: jest.fn().mockReturnValue(mockQueryBuilder),
                        manager: {
                            query: jest.fn().mockResolvedValue([])
                        }
                    },
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(comprovante_pagamento_entity_1.ComprovantePagamento),
                    useValue: {
                        createQueryBuilder: jest.fn().mockReturnValue(mockQueryBuilder),
                        count: jest.fn().mockResolvedValue(0)
                    },
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(confirmacao_recebimento_entity_1.ConfirmacaoRecebimento),
                    useValue: {
                        createQueryBuilder: jest.fn().mockReturnValue(mockQueryBuilder),
                        count: jest.fn().mockResolvedValue(0)
                    },
                },
            ],
        }).compile();
        service = module.get(metricas_pagamento_service_1.MetricasPagamentoService);
        pagamentoRepository = module.get((0, typeorm_1.getRepositoryToken)(pagamento_entity_1.Pagamento));
        comprovanteRepository = module.get((0, typeorm_1.getRepositoryToken)(comprovante_pagamento_entity_1.ComprovantePagamento));
        confirmacaoRepository = module.get((0, typeorm_1.getRepositoryToken)(confirmacao_recebimento_entity_1.ConfirmacaoRecebimento));
    });
    it('deve estar definido', () => {
        expect(service).toBeDefined();
    });
    describe('obterMetricasVolume', () => {
        it('deve retornar métricas de volume de pagamentos', async () => {
            // Arrange
            const mockMetricas = {
                totalPagamentos: 100,
                totalEmProcessamento: 20,
                totalFinalizados: 70,
                totalCancelados: 10,
                totalValorPago: 50000,
                mediaTempoProcessamento: 48 // horas
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalPagamentos: '100',
                totalEmProcessamento: '20',
                totalFinalizados: '70',
                totalCancelados: '10',
                totalValorPago: '50000.00',
                mediaTempoProcessamento: '48.00'
            });
            // Act
            const resultado = await service.obterMetricasVolume();
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(pagamentoRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockQueryBuilder.select).toHaveBeenCalled();
        });
        it('deve filtrar por período quando especificado', async () => {
            // Arrange
            const dataInicio = new Date('2025-01-01');
            const dataFim = new Date('2025-03-31');
            const mockMetricas = {
                totalPagamentos: 50,
                totalEmProcessamento: 10,
                totalFinalizados: 35,
                totalCancelados: 5,
                totalValorPago: 25000,
                mediaTempoProcessamento: 36 // horas
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalPagamentos: '50',
                totalEmProcessamento: '10',
                totalFinalizados: '35',
                totalCancelados: '5',
                totalValorPago: '25000.00',
                mediaTempoProcessamento: '36.00'
            });
            // Act
            const resultado = await service.obterMetricasVolume(dataInicio, dataFim);
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(mockQueryBuilder.where).toHaveBeenCalledWith('pagamento.dataCriacao >= :dataInicio', { dataInicio });
            expect(mockQueryBuilder.andWhere).toHaveBeenCalledWith('pagamento.dataCriacao <= :dataFim', { dataFim });
        });
    });
    describe('obterMetricasEficiencia', () => {
        it('deve retornar métricas de eficiência do processamento de pagamentos', async () => {
            // Arrange
            const mockMetricas = {
                tempoMedioPorStatus: [
                    { status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, tempoMedio: 24 }, // horas
                    { status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, tempoMedio: 48 }, // horas
                    { status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO, tempoMedio: 72 }, // horas
                    { status: status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, tempoMedio: 96 } // horas
                ],
                taxaConclusao: 0.7, // 70% dos pagamentos são concluídos
                taxaCancelamento: 0.1, // 10% dos pagamentos são cancelados
                tempoMedioTotal: 96 // horas do início ao fim do processo
            };
            jest.spyOn(mockQueryBuilder, 'getRawMany')
                .mockResolvedValueOnce([
                { status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, tempoMedio: '24.00' },
                { status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, tempoMedio: '48.00' },
                { status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO, tempoMedio: '72.00' },
                { status: status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, tempoMedio: '96.00' }
            ]);
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                taxaConclusao: '0.70',
                taxaCancelamento: '0.10',
                tempoMedioTotal: '96.00'
            });
            // Act
            const resultado = await service.obterMetricasEficiencia();
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(pagamentoRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockQueryBuilder.select).toHaveBeenCalled();
            expect(mockQueryBuilder.groupBy).toHaveBeenCalled();
        });
        it('deve filtrar por unidade quando especificado', async () => {
            // Arrange
            const unidadeId = 'unidade-id-1';
            const mockTempoMedioPorStatus = [
                { status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, tempoMedio: 24 },
                { status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, tempoMedio: 48 },
            ];
            jest.spyOn(mockQueryBuilder, 'getRawMany')
                .mockResolvedValueOnce(mockTempoMedioPorStatus.map(item => ({
                status: item.status,
                tempoMedio: item.tempoMedio.toString()
            })));
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                taxaConclusao: '0.75',
                taxaCancelamento: '0.05',
                tempoMedioTotal: '72.00'
            });
            // Act
            const resultado = await service.obterMetricasEficiencia(null, null, unidadeId);
            // Assert
            expect(resultado).toBeDefined();
            expect(mockQueryBuilder.andWhere).toHaveBeenCalledWith('pagamento.unidadeId = :unidadeId', { unidadeId });
        });
    });
    describe('obterMetricasComprovantes', () => {
        it('deve retornar métricas sobre os comprovantes de pagamento', async () => {
            // Arrange
            const mockMetricas = {
                totalComprovantes: 80,
                tempoMedioUpload: 36, // horas após pagamento
                percentualPagamentosComComprovante: 0.8, // 80% dos pagamentos têm comprovante
                tamanhoMedioArquivo: 1024 // KB
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalComprovantes: '80',
                tempoMedioUpload: '36.00',
                percentualPagamentosComComprovante: '0.80',
                tamanhoMedioArquivo: '1024.00'
            });
            jest.spyOn(comprovanteRepository, 'count').mockResolvedValueOnce(80);
            // Act
            const resultado = await service.obterMetricasComprovantes();
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(comprovanteRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockQueryBuilder.select).toHaveBeenCalled();
        });
        it('deve filtrar por método de pagamento quando especificado', async () => {
            // Arrange
            const metodoPagamento = metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX;
            const mockMetricas = {
                totalComprovantes: 50,
                tempoMedioUpload: 24, // horas após pagamento
                percentualPagamentosComComprovante: 0.9, // 90% dos pagamentos PIX têm comprovante
                tamanhoMedioArquivo: 800 // KB
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalComprovantes: '50',
                tempoMedioUpload: '24.00',
                percentualPagamentosComComprovante: '0.90',
                tamanhoMedioArquivo: '800.00'
            });
            // Act
            const resultado = await service.obterMetricasComprovantes(null, null, metodoPagamento);
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(mockQueryBuilder.innerJoin).toHaveBeenCalled();
            expect(mockQueryBuilder.andWhere).toHaveBeenCalledWith('p.metodoPagamento = :metodoPagamento', { metodoPagamento });
        });
    });
    describe('obterMetricasConfirmacoes', () => {
        it('deve retornar métricas sobre as confirmações de recebimento', async () => {
            // Arrange
            const mockMetricas = {
                totalConfirmacoes: 70,
                tempoMedioConfirmacao: 72, // horas após pagamento
                percentualPagamentosConfirmados: 0.7, // 70% dos pagamentos são confirmados pelo beneficiário
                taxaConfirmacaoEspontanea: 0.6 // 60% das confirmações são espontâneas
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalConfirmacoes: '70',
                tempoMedioConfirmacao: '72.00',
                percentualPagamentosConfirmados: '0.70',
                taxaConfirmacaoEspontanea: '0.60'
            });
            jest.spyOn(confirmacaoRepository, 'count').mockResolvedValueOnce(70);
            // Act
            const resultado = await service.obterMetricasConfirmacoes();
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(confirmacaoRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockQueryBuilder.select).toHaveBeenCalled();
        });
        it('deve filtrar por unidade quando especificado', async () => {
            // Arrange
            const unidadeId = 'unidade-id-1';
            const mockMetricas = {
                totalConfirmacoes: 40,
                tempoMedioConfirmacao: 48, // horas após pagamento
                percentualPagamentosConfirmados: 0.8, // 80% dos pagamentos da unidade são confirmados
                taxaConfirmacaoEspontanea: 0.7 // 70% das confirmações da unidade são espontâneas
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                totalConfirmacoes: '40',
                tempoMedioConfirmacao: '48.00',
                percentualPagamentosConfirmados: '0.80',
                taxaConfirmacaoEspontanea: '0.70'
            });
            // Act
            const resultado = await service.obterMetricasConfirmacoes(null, null, unidadeId);
            // Assert
            expect(resultado).toEqual(mockMetricas);
            expect(mockQueryBuilder.innerJoin).toHaveBeenCalled();
            expect(mockQueryBuilder.andWhere).toHaveBeenCalledWith('p.unidadeId = :unidadeId', { unidadeId });
        });
    });
    describe('obterMetricasTempoReais', () => {
        it('deve retornar métricas de tempo real sobre pagamentos', async () => {
            // Arrange
            const mockMetricas = {
                pagamentosUltimas24h: 10,
                confirmacoesPendentes: 20,
                valorLiberadoHoje: 5000,
                pagamentosMaisRecentes: [
                    { id: 'pagamento-id-1', valor: 500, status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO, dataAtualizacao: new Date() },
                    { id: 'pagamento-id-2', valor: 300, status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, dataAtualizacao: new Date() }
                ],
                taxaConfirmacaoHoje: 0.8 // 80% dos pagamentos de hoje foram confirmados
            };
            jest.spyOn(mockQueryBuilder, 'getRawOne').mockResolvedValueOnce({
                pagamentosUltimas24h: '10',
                confirmacoesPendentes: '20',
                valorLiberadoHoje: '5000.00',
                taxaConfirmacaoHoje: '0.80'
            });
            jest.spyOn(mockQueryBuilder, 'getRawMany').mockResolvedValueOnce([
                {
                    id: 'pagamento-id-1',
                    valor: '500.00',
                    status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
                    dataAtualizacao: new Date().toISOString()
                },
                {
                    id: 'pagamento-id-2',
                    valor: '300.00',
                    status: status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO,
                    dataAtualizacao: new Date().toISOString()
                }
            ]);
            // Act
            const resultado = await service.obterMetricasTempoReais();
            // Assert
            expect(resultado).toMatchObject({
                pagamentosUltimas24h: 10,
                confirmacoesPendentes: 20,
                valorLiberadoHoje: 5000,
                taxaConfirmacaoHoje: 0.8
            });
            expect(resultado.pagamentosMaisRecentes).toHaveLength(2);
            expect(pagamentoRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockQueryBuilder.select).toHaveBeenCalled();
            expect(mockQueryBuilder.orderBy).toHaveBeenCalled();
        });
    });
    describe('obterDashboard', () => {
        it('deve retornar dados consolidados para dashboard', async () => {
            // Arrange
            const mockVolume = {
                totalPagamentos: 100,
                totalEmProcessamento: 20,
                totalFinalizados: 70,
                totalCancelados: 10,
                totalValorPago: 50000,
                mediaTempoProcessamento: 48
            };
            const mockEficiencia = {
                tempoMedioPorStatus: [
                    { status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, tempoMedio: 24 }
                ],
                taxaConclusao: 0.7,
                taxaCancelamento: 0.1,
                tempoMedioTotal: 96
            };
            const mockTempoReal = {
                pagamentosUltimas24h: 10,
                confirmacoesPendentes: 20,
                valorLiberadoHoje: 5000,
                pagamentosMaisRecentes: [
                    { id: 'pagamento-id-1', valor: 500, status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO, dataAtualizacao: new Date() }
                ],
                taxaConfirmacaoHoje: 0.8
            };
            // Mock dos métodos do serviço
            jest.spyOn(service, 'obterMetricasVolume').mockResolvedValueOnce(mockVolume);
            jest.spyOn(service, 'obterMetricasEficiencia').mockResolvedValueOnce(mockEficiencia);
            jest.spyOn(service, 'obterMetricasTempoReais').mockResolvedValueOnce(mockTempoReal);
            // Act
            const resultado = await service.obterDashboard();
            // Assert
            expect(resultado).toEqual({
                volume: mockVolume,
                eficiencia: mockEficiencia,
                tempoReal: mockTempoReal
            });
            expect(service.obterMetricasVolume).toHaveBeenCalled();
            expect(service.obterMetricasEficiencia).toHaveBeenCalled();
            expect(service.obterMetricasTempoReais).toHaveBeenCalled();
        });
        it('deve aplicar filtros a todos os métodos quando especificados', async () => {
            // Arrange
            const dataInicio = new Date('2025-01-01');
            const dataFim = new Date('2025-03-31');
            const unidadeId = 'unidade-id-1';
            // Mock dos métodos do serviço
            jest.spyOn(service, 'obterMetricasVolume').mockResolvedValueOnce({});
            jest.spyOn(service, 'obterMetricasEficiencia').mockResolvedValueOnce({});
            jest.spyOn(service, 'obterMetricasTempoReais').mockResolvedValueOnce({});
            // Act
            await service.obterDashboard(dataInicio, dataFim, unidadeId);
            // Assert
            expect(service.obterMetricasVolume).toHaveBeenCalledWith(dataInicio, dataFim, unidadeId);
            expect(service.obterMetricasEficiencia).toHaveBeenCalledWith(dataInicio, dataFim, unidadeId);
            expect(service.obterMetricasTempoReais).toHaveBeenCalledWith(unidadeId);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXHVuaXRcXHNlcnZpY2VzXFxtZXRyaWNhcy1wYWdhbWVudG8uc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELDZDQUFxRDtBQUdyRCw2RkFBd0Y7QUFDeEYseUVBQStEO0FBQy9ELGlHQUFzRjtBQUN0RixxR0FBMEY7QUFDMUYsZ0ZBQTJFO0FBQzNFLGdGQUEyRTtBQUUzRTs7Ozs7OztHQU9HO0FBQ0gsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxJQUFJLE9BQWlDLENBQUM7SUFDdEMsSUFBSSxtQkFBMEMsQ0FBQztJQUMvQyxJQUFJLHFCQUF1RCxDQUFDO0lBQzVELElBQUkscUJBQXlELENBQUM7SUFFOUQsMkNBQTJDO0lBQzNDLE1BQU0sZ0JBQWdCLEdBQUc7UUFDdkIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDbEMsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDckMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDaEMsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDakMsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDcEMsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDcEMsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDckMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDbkMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVB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QUFDLENBQUMscUJBQXFCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFDaEYsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUseUJBQXlCLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUVoRixNQUFNO1lBQ04sTUFBTSxPQUFPLENBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFN0QsU0FBUztZQUNULE1BQU0sQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ3pGLE1BQU0sQ0FBQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQzdGLE1BQU0sQ0FBQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMxRSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXHVuaXRcXHNlcnZpY2VzXFxtZXRyaWNhcy1wYWdhbWVudG8uc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgZ2V0UmVwb3NpdG9yeVRva2VuIH0gZnJvbSAnQG5lc3Rqcy90eXBlb3JtJztcbmltcG9ydCB7IFJlcG9zaXRvcnkgfSBmcm9tICd0eXBlb3JtJztcblxuaW1wb3J0IHsgTWV0cmljYXNQYWdhbWVudG9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvbWV0cmljYXMtcGFnYW1lbnRvLnNlcnZpY2UnO1xuaW1wb3J0IHsgUGFnYW1lbnRvIH0gZnJvbSAnLi4vLi4vLi4vZW50aXRpZXMvcGFnYW1lbnRvLmVudGl0eSc7XG5pbXBvcnQgeyBDb21wcm92YW50ZVBhZ2FtZW50byB9IGZyb20gJy4uLy4uLy4uL2VudGl0aWVzL2NvbXByb3ZhbnRlLXBhZ2FtZW50by5lbnRpdHknO1xuaW1wb3J0IHsgQ29uZmlybWFjYW9SZWNlYmltZW50byB9IGZyb20gJy4uLy4uLy4uL2VudGl0aWVzL2NvbmZpcm1hY2FvLXJlY2ViaW1lbnRvLmVudGl0eSc7XG5pbXBvcnQgeyBTdGF0dXNQYWdhbWVudG9FbnVtIH0gZnJvbSAnLi4vLi4vLi4vZW51bXMvc3RhdHVzLXBhZ2FtZW50by5lbnVtJztcbmltcG9ydCB7IE1ldG9kb1BhZ2FtZW50b0VudW0gfSBmcm9tICcuLi8uLi8uLi9lbnVtcy9tZXRvZG8tcGFnYW1lbnRvLmVudW0nO1xuXG4vKipcbiAqIFRlc3RlcyB1bml0w6FyaW9zIHBhcmEgTWV0cmljYXNQYWdhbWVudG9TZXJ2aWNlXG4gKiBcbiAqIFZhbGlkYSBvIGZ1bmNpb25hbWVudG8gZG8gc2VydmnDp28gcmVzcG9uc8OhdmVsIHBvciBjb2xldGFyXG4gKiBlIGRpc3BvbmliaWxpemFyIG3DqXRyaWNhcyBzb2JyZSBhcyBvcGVyYcOnw7VlcyBkZSBwYWdhbWVudG8uXG4gKiBcbiAqIEBhdXRob3IgRXF1aXBlIFBHQmVuXG4gKi9cbmRlc2NyaWJlKCdNZXRyaWNhc1BhZ2FtZW50b1NlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBzZXJ2aWNlOiBNZXRyaWNhc1BhZ2FtZW50b1NlcnZpY2U7XG4gIGxldCBwYWdhbWVudG9SZXBvc2l0b3J5OiBSZXBvc2l0b3J5PFBhZ2FtZW50bz47XG4gIGxldCBjb21wcm92YW50ZVJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8Q29tcHJvdmFudGVQYWdhbWVudG8+O1xuICBsZXQgY29uZmlybWFjYW9SZXBvc2l0b3J5OiBSZXBvc2l0b3J5PENvbmZpcm1hY2FvUmVjZWJpbWVudG8+O1xuXG4gIC8vIE1vY2sgZG8gUXVlcnlCdWlsZGVyIHBhcmEgdXNvIG5vcyB0ZXN0ZXNcbiAgY29uc3QgbW9ja1F1ZXJ5QnVpbGRlciA9IHtcbiAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgIGFkZFNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgZnJvbTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgd2hlcmU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgIGFuZFdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBsZWZ0Sm9pbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgaW5uZXJKb2luOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBncm91cEJ5OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBvcmRlckJ5OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBnZXRSYXdNYW55OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pLFxuICAgIGdldFJhd09uZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHt9KSxcbiAgICBleGVjdXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBNZXRyaWNhc1BhZ2FtZW50b1NlcnZpY2UsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oUGFnYW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgY3JlYXRlUXVlcnlCdWlsZGVyOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG1vY2tRdWVyeUJ1aWxkZXIpLFxuICAgICAgICAgICAgbWFuYWdlcjoge1xuICAgICAgICAgICAgICBxdWVyeTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oQ29tcHJvdmFudGVQYWdhbWVudG8pLFxuICAgICAgICAgIHVzZVZhbHVlOiB7XG4gICAgICAgICAgICBjcmVhdGVRdWVyeUJ1aWxkZXI6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobW9ja1F1ZXJ5QnVpbGRlciksXG4gICAgICAgICAgICBjb3VudDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKDApXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IGdldFJlcG9zaXRvcnlUb2tlbihDb25maXJtYWNhb1JlY2ViaW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgY3JlYXRlUXVlcnlCdWlsZGVyOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG1vY2tRdWVyeUJ1aWxkZXIpLFxuICAgICAgICAgICAgY291bnQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwKVxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHNlcnZpY2UgPSBtb2R1bGUuZ2V0PE1ldHJpY2FzUGFnYW1lbnRvU2VydmljZT4oTWV0cmljYXNQYWdhbWVudG9TZXJ2aWNlKTtcbiAgICBwYWdhbWVudG9SZXBvc2l0b3J5ID0gbW9kdWxlLmdldDxSZXBvc2l0b3J5PFBhZ2FtZW50bz4+KGdldFJlcG9zaXRvcnlUb2tlbihQYWdhbWVudG8pKTtcbiAgICBjb21wcm92YW50ZVJlcG9zaXRvcnkgPSBtb2R1bGUuZ2V0PFJlcG9zaXRvcnk8Q29tcHJvdmFudGVQYWdhbWVudG8+PihnZXRSZXBvc2l0b3J5VG9rZW4oQ29tcHJvdmFudGVQYWdhbWVudG8pKTtcbiAgICBjb25maXJtYWNhb1JlcG9zaXRvcnkgPSBtb2R1bGUuZ2V0PFJlcG9zaXRvcnk8Q29uZmlybWFjYW9SZWNlYmltZW50bz4+KGdldFJlcG9zaXRvcnlUb2tlbihDb25maXJtYWNhb1JlY2ViaW1lbnRvKSk7XG4gIH0pO1xuXG4gIGl0KCdkZXZlIGVzdGFyIGRlZmluaWRvJywgKCkgPT4ge1xuICAgIGV4cGVjdChzZXJ2aWNlKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnb2J0ZXJNZXRyaWNhc1ZvbHVtZScsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBtw6l0cmljYXMgZGUgdm9sdW1lIGRlIHBhZ2FtZW50b3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrTWV0cmljYXMgPSB7XG4gICAgICAgIHRvdGFsUGFnYW1lbnRvczogMTAwLFxuICAgICAgICB0b3RhbEVtUHJvY2Vzc2FtZW50bzogMjAsXG4gICAgICAgIHRvdGFsRmluYWxpemFkb3M6IDcwLFxuICAgICAgICB0b3RhbENhbmNlbGFkb3M6IDEwLFxuICAgICAgICB0b3RhbFZhbG9yUGFnbzogNTAwMDAsXG4gICAgICAgIG1lZGlhVGVtcG9Qcm9jZXNzYW1lbnRvOiA0OCAvLyBob3Jhc1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihtb2NrUXVlcnlCdWlsZGVyLCAnZ2V0UmF3T25lJykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgdG90YWxQYWdhbWVudG9zOiAnMTAwJyxcbiAgICAgICAgdG90YWxFbVByb2Nlc3NhbWVudG86ICcyMCcsXG4gICAgICAgIHRvdGFsRmluYWxpemFkb3M6ICc3MCcsXG4gICAgICAgIHRvdGFsQ2FuY2VsYWRvczogJzEwJyxcbiAgICAgICAgdG90YWxWYWxvclBhZ286ICc1MDAwMC4wMCcsXG4gICAgICAgIG1lZGlhVGVtcG9Qcm9jZXNzYW1lbnRvOiAnNDguMDAnXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyTWV0cmljYXNWb2x1bWUoKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKG1vY2tNZXRyaWNhcyk7XG4gICAgICBleHBlY3QocGFnYW1lbnRvUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgZmlsdHJhciBwb3IgcGVyw61vZG8gcXVhbmRvIGVzcGVjaWZpY2FkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGRhdGFJbmljaW8gPSBuZXcgRGF0ZSgnMjAyNS0wMS0wMScpO1xuICAgICAgY29uc3QgZGF0YUZpbSA9IG5ldyBEYXRlKCcyMDI1LTAzLTMxJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNhcyA9IHtcbiAgICAgICAgdG90YWxQYWdhbWVudG9zOiA1MCxcbiAgICAgICAgdG90YWxFbVByb2Nlc3NhbWVudG86IDEwLFxuICAgICAgICB0b3RhbEZpbmFsaXphZG9zOiAzNSxcbiAgICAgICAgdG90YWxDYW5jZWxhZG9zOiA1LFxuICAgICAgICB0b3RhbFZhbG9yUGFnbzogMjUwMDAsXG4gICAgICAgIG1lZGlhVGVtcG9Qcm9jZXNzYW1lbnRvOiAzNiAvLyBob3Jhc1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihtb2NrUXVlcnlCdWlsZGVyLCAnZ2V0UmF3T25lJykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgdG90YWxQYWdhbWVudG9zOiAnNTAnLFxuICAgICAgICB0b3RhbEVtUHJvY2Vzc2FtZW50bzogJzEwJyxcbiAgICAgICAgdG90YWxGaW5hbGl6YWRvczogJzM1JyxcbiAgICAgICAgdG90YWxDYW5jZWxhZG9zOiAnNScsXG4gICAgICAgIHRvdGFsVmFsb3JQYWdvOiAnMjUwMDAuMDAnLFxuICAgICAgICBtZWRpYVRlbXBvUHJvY2Vzc2FtZW50bzogJzM2LjAwJ1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5vYnRlck1ldHJpY2FzVm9sdW1lKGRhdGFJbmljaW8sIGRhdGFGaW0pO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwobW9ja01ldHJpY2FzKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLndoZXJlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncGFnYW1lbnRvLmRhdGFDcmlhY2FvID49IDpkYXRhSW5pY2lvJywgeyBkYXRhSW5pY2lvIH0pO1xuICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuYW5kV2hlcmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdwYWdhbWVudG8uZGF0YUNyaWFjYW8gPD0gOmRhdGFGaW0nLCB7IGRhdGFGaW0gfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdvYnRlck1ldHJpY2FzRWZpY2llbmNpYScsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBtw6l0cmljYXMgZGUgZWZpY2nDqm5jaWEgZG8gcHJvY2Vzc2FtZW50byBkZSBwYWdhbWVudG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja01ldHJpY2FzID0ge1xuICAgICAgICB0ZW1wb01lZGlvUG9yU3RhdHVzOiBbXG4gICAgICAgICAgeyBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sIHRlbXBvTWVkaW86IDI0IH0sIC8vIGhvcmFzXG4gICAgICAgICAgeyBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sIHRlbXBvTWVkaW86IDQ4IH0sIC8vIGhvcmFzXG4gICAgICAgICAgeyBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTywgdGVtcG9NZWRpbzogNzIgfSwgLy8gaG9yYXNcbiAgICAgICAgICB7IHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPLCB0ZW1wb01lZGlvOiA5NiB9IC8vIGhvcmFzXG4gICAgICAgIF0sXG4gICAgICAgIHRheGFDb25jbHVzYW86IDAuNywgLy8gNzAlIGRvcyBwYWdhbWVudG9zIHPDo28gY29uY2x1w61kb3NcbiAgICAgICAgdGF4YUNhbmNlbGFtZW50bzogMC4xLCAvLyAxMCUgZG9zIHBhZ2FtZW50b3Mgc8OjbyBjYW5jZWxhZG9zXG4gICAgICAgIHRlbXBvTWVkaW9Ub3RhbDogOTYgLy8gaG9yYXMgZG8gaW7DrWNpbyBhbyBmaW0gZG8gcHJvY2Vzc29cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24obW9ja1F1ZXJ5QnVpbGRlciwgJ2dldFJhd01hbnknKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFtcbiAgICAgICAgICB7IHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETywgdGVtcG9NZWRpbzogJzI0LjAwJyB9LCBcbiAgICAgICAgICB7IHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETywgdGVtcG9NZWRpbzogJzQ4LjAwJyB9LCBcbiAgICAgICAgICB7IHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5QQUdPLCB0ZW1wb01lZGlvOiAnNzIuMDAnIH0sIFxuICAgICAgICAgIHsgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8sIHRlbXBvTWVkaW86ICc5Ni4wMCcgfVxuICAgICAgICBdKTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihtb2NrUXVlcnlCdWlsZGVyLCAnZ2V0UmF3T25lJykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgdGF4YUNvbmNsdXNhbzogJzAuNzAnLFxuICAgICAgICB0YXhhQ2FuY2VsYW1lbnRvOiAnMC4xMCcsXG4gICAgICAgIHRlbXBvTWVkaW9Ub3RhbDogJzk2LjAwJ1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5vYnRlck1ldHJpY2FzRWZpY2llbmNpYSgpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwobW9ja01ldHJpY2FzKTtcbiAgICAgIGV4cGVjdChwYWdhbWVudG9SZXBvc2l0b3J5LmNyZWF0ZVF1ZXJ5QnVpbGRlcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuc2VsZWN0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5ncm91cEJ5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBmaWx0cmFyIHBvciB1bmlkYWRlIHF1YW5kbyBlc3BlY2lmaWNhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1bmlkYWRlSWQgPSAndW5pZGFkZS1pZC0xJztcbiAgICAgIFxuICAgICAgY29uc3QgbW9ja1RlbXBvTWVkaW9Qb3JTdGF0dXMgPSBbXG4gICAgICAgIHsgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLCB0ZW1wb01lZGlvOiAyNCB9LCBcbiAgICAgICAgeyBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sIHRlbXBvTWVkaW86IDQ4IH0sIFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihtb2NrUXVlcnlCdWlsZGVyLCAnZ2V0UmF3TWFueScpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1RlbXBvTWVkaW9Qb3JTdGF0dXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICBzdGF0dXM6IGl0ZW0uc3RhdHVzLFxuICAgICAgICAgIHRlbXBvTWVkaW86IGl0ZW0udGVtcG9NZWRpby50b1N0cmluZygpXG4gICAgICAgIH0pKSk7XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24obW9ja1F1ZXJ5QnVpbGRlciwgJ2dldFJhd09uZScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIHRheGFDb25jbHVzYW86ICcwLjc1JyxcbiAgICAgICAgdGF4YUNhbmNlbGFtZW50bzogJzAuMDUnLFxuICAgICAgICB0ZW1wb01lZGlvVG90YWw6ICc3Mi4wMCdcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2Uub2J0ZXJNZXRyaWNhc0VmaWNpZW5jaWEobnVsbCwgbnVsbCwgdW5pZGFkZUlkKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuYW5kV2hlcmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdwYWdhbWVudG8udW5pZGFkZUlkID0gOnVuaWRhZGVJZCcsIHsgdW5pZGFkZUlkIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnb2J0ZXJNZXRyaWNhc0NvbXByb3ZhbnRlcycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBtw6l0cmljYXMgc29icmUgb3MgY29tcHJvdmFudGVzIGRlIHBhZ2FtZW50bycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNhcyA9IHtcbiAgICAgICAgdG90YWxDb21wcm92YW50ZXM6IDgwLFxuICAgICAgICB0ZW1wb01lZGlvVXBsb2FkOiAzNiwgLy8gaG9yYXMgYXDDs3MgcGFnYW1lbnRvXG4gICAgICAgIHBlcmNlbnR1YWxQYWdhbWVudG9zQ29tQ29tcHJvdmFudGU6IDAuOCwgLy8gODAlIGRvcyBwYWdhbWVudG9zIHTDqm0gY29tcHJvdmFudGVcbiAgICAgICAgdGFtYW5ob01lZGlvQXJxdWl2bzogMTAyNCAvLyBLQlxuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihtb2NrUXVlcnlCdWlsZGVyLCAnZ2V0UmF3T25lJykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgdG90YWxDb21wcm92YW50ZXM6ICc4MCcsXG4gICAgICAgIHRlbXBvTWVkaW9VcGxvYWQ6ICczNi4wMCcsXG4gICAgICAgIHBlcmNlbnR1YWxQYWdhbWVudG9zQ29tQ29tcHJvdmFudGU6ICcwLjgwJyxcbiAgICAgICAgdGFtYW5ob01lZGlvQXJxdWl2bzogJzEwMjQuMDAnXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihjb21wcm92YW50ZVJlcG9zaXRvcnksICdjb3VudCcpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSg4MCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5vYnRlck1ldHJpY2FzQ29tcHJvdmFudGVzKCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbChtb2NrTWV0cmljYXMpO1xuICAgICAgZXhwZWN0KGNvbXByb3ZhbnRlUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgZmlsdHJhciBwb3IgbcOpdG9kbyBkZSBwYWdhbWVudG8gcXVhbmRvIGVzcGVjaWZpY2FkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1ldG9kb1BhZ2FtZW50byA9IE1ldG9kb1BhZ2FtZW50b0VudW0uUElYO1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrTWV0cmljYXMgPSB7XG4gICAgICAgIHRvdGFsQ29tcHJvdmFudGVzOiA1MCxcbiAgICAgICAgdGVtcG9NZWRpb1VwbG9hZDogMjQsIC8vIGhvcmFzIGFww7NzIHBhZ2FtZW50b1xuICAgICAgICBwZXJjZW50dWFsUGFnYW1lbnRvc0NvbUNvbXByb3ZhbnRlOiAwLjksIC8vIDkwJSBkb3MgcGFnYW1lbnRvcyBQSVggdMOqbSBjb21wcm92YW50ZVxuICAgICAgICB0YW1hbmhvTWVkaW9BcnF1aXZvOiA4MDAgLy8gS0JcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24obW9ja1F1ZXJ5QnVpbGRlciwgJ2dldFJhd09uZScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIHRvdGFsQ29tcHJvdmFudGVzOiAnNTAnLFxuICAgICAgICB0ZW1wb01lZGlvVXBsb2FkOiAnMjQuMDAnLFxuICAgICAgICBwZXJjZW50dWFsUGFnYW1lbnRvc0NvbUNvbXByb3ZhbnRlOiAnMC45MCcsXG4gICAgICAgIHRhbWFuaG9NZWRpb0FycXVpdm86ICc4MDAuMDAnXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyTWV0cmljYXNDb21wcm92YW50ZXMobnVsbCwgbnVsbCwgbWV0b2RvUGFnYW1lbnRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKG1vY2tNZXRyaWNhcyk7XG4gICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5pbm5lckpvaW4pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmFuZFdoZXJlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncC5tZXRvZG9QYWdhbWVudG8gPSA6bWV0b2RvUGFnYW1lbnRvJywgeyBtZXRvZG9QYWdhbWVudG8gfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdvYnRlck1ldHJpY2FzQ29uZmlybWFjb2VzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIG3DqXRyaWNhcyBzb2JyZSBhcyBjb25maXJtYcOnw7VlcyBkZSByZWNlYmltZW50bycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNhcyA9IHtcbiAgICAgICAgdG90YWxDb25maXJtYWNvZXM6IDcwLFxuICAgICAgICB0ZW1wb01lZGlvQ29uZmlybWFjYW86IDcyLCAvLyBob3JhcyBhcMOzcyBwYWdhbWVudG9cbiAgICAgICAgcGVyY2VudHVhbFBhZ2FtZW50b3NDb25maXJtYWRvczogMC43LCAvLyA3MCUgZG9zIHBhZ2FtZW50b3Mgc8OjbyBjb25maXJtYWRvcyBwZWxvIGJlbmVmaWNpw6FyaW9cbiAgICAgICAgdGF4YUNvbmZpcm1hY2FvRXNwb250YW5lYTogMC42IC8vIDYwJSBkYXMgY29uZmlybWHDp8O1ZXMgc8OjbyBlc3BvbnTDom5lYXNcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24obW9ja1F1ZXJ5QnVpbGRlciwgJ2dldFJhd09uZScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIHRvdGFsQ29uZmlybWFjb2VzOiAnNzAnLFxuICAgICAgICB0ZW1wb01lZGlvQ29uZmlybWFjYW86ICc3Mi4wMCcsXG4gICAgICAgIHBlcmNlbnR1YWxQYWdhbWVudG9zQ29uZmlybWFkb3M6ICcwLjcwJyxcbiAgICAgICAgdGF4YUNvbmZpcm1hY2FvRXNwb250YW5lYTogJzAuNjAnXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihjb25maXJtYWNhb1JlcG9zaXRvcnksICdjb3VudCcpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSg3MCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5vYnRlck1ldHJpY2FzQ29uZmlybWFjb2VzKCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbChtb2NrTWV0cmljYXMpO1xuICAgICAgZXhwZWN0KGNvbmZpcm1hY2FvUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgZmlsdHJhciBwb3IgdW5pZGFkZSBxdWFuZG8gZXNwZWNpZmljYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdW5pZGFkZUlkID0gJ3VuaWRhZGUtaWQtMSc7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNhcyA9IHtcbiAgICAgICAgdG90YWxDb25maXJtYWNvZXM6IDQwLFxuICAgICAgICB0ZW1wb01lZGlvQ29uZmlybWFjYW86IDQ4LCAvLyBob3JhcyBhcMOzcyBwYWdhbWVudG9cbiAgICAgICAgcGVyY2VudHVhbFBhZ2FtZW50b3NDb25maXJtYWRvczogMC44LCAvLyA4MCUgZG9zIHBhZ2FtZW50b3MgZGEgdW5pZGFkZSBzw6NvIGNvbmZpcm1hZG9zXG4gICAgICAgIHRheGFDb25maXJtYWNhb0VzcG9udGFuZWE6IDAuNyAvLyA3MCUgZGFzIGNvbmZpcm1hw6fDtWVzIGRhIHVuaWRhZGUgc8OjbyBlc3BvbnTDom5lYXNcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24obW9ja1F1ZXJ5QnVpbGRlciwgJ2dldFJhd09uZScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIHRvdGFsQ29uZmlybWFjb2VzOiAnNDAnLFxuICAgICAgICB0ZW1wb01lZGlvQ29uZmlybWFjYW86ICc0OC4wMCcsXG4gICAgICAgIHBlcmNlbnR1YWxQYWdhbWVudG9zQ29uZmlybWFkb3M6ICcwLjgwJyxcbiAgICAgICAgdGF4YUNvbmZpcm1hY2FvRXNwb250YW5lYTogJzAuNzAnXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyTWV0cmljYXNDb25maXJtYWNvZXMobnVsbCwgbnVsbCwgdW5pZGFkZUlkKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKG1vY2tNZXRyaWNhcyk7XG4gICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5pbm5lckpvaW4pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmFuZFdoZXJlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncC51bmlkYWRlSWQgPSA6dW5pZGFkZUlkJywgeyB1bmlkYWRlSWQgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdvYnRlck1ldHJpY2FzVGVtcG9SZWFpcycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBtw6l0cmljYXMgZGUgdGVtcG8gcmVhbCBzb2JyZSBwYWdhbWVudG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja01ldHJpY2FzID0ge1xuICAgICAgICBwYWdhbWVudG9zVWx0aW1hczI0aDogMTAsXG4gICAgICAgIGNvbmZpcm1hY29lc1BlbmRlbnRlczogMjAsXG4gICAgICAgIHZhbG9yTGliZXJhZG9Ib2plOiA1MDAwLFxuICAgICAgICBwYWdhbWVudG9zTWFpc1JlY2VudGVzOiBbXG4gICAgICAgICAgeyBpZDogJ3BhZ2FtZW50by1pZC0xJywgdmFsb3I6IDUwMCwgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLlBBR08sIGRhdGFBdHVhbGl6YWNhbzogbmV3IERhdGUoKSB9LFxuICAgICAgICAgIHsgaWQ6ICdwYWdhbWVudG8taWQtMicsIHZhbG9yOiAzMDAsIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETywgZGF0YUF0dWFsaXphY2FvOiBuZXcgRGF0ZSgpIH1cbiAgICAgICAgXSxcbiAgICAgICAgdGF4YUNvbmZpcm1hY2FvSG9qZTogMC44IC8vIDgwJSBkb3MgcGFnYW1lbnRvcyBkZSBob2plIGZvcmFtIGNvbmZpcm1hZG9zXG4gICAgICB9O1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKG1vY2tRdWVyeUJ1aWxkZXIsICdnZXRSYXdPbmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBwYWdhbWVudG9zVWx0aW1hczI0aDogJzEwJyxcbiAgICAgICAgY29uZmlybWFjb2VzUGVuZGVudGVzOiAnMjAnLFxuICAgICAgICB2YWxvckxpYmVyYWRvSG9qZTogJzUwMDAuMDAnLFxuICAgICAgICB0YXhhQ29uZmlybWFjYW9Ib2plOiAnMC44MCdcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKG1vY2tRdWVyeUJ1aWxkZXIsICdnZXRSYXdNYW55JykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFtcbiAgICAgICAgeyBcbiAgICAgICAgICBpZDogJ3BhZ2FtZW50by1pZC0xJywgXG4gICAgICAgICAgdmFsb3I6ICc1MDAuMDAnLCBcbiAgICAgICAgICBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTywgXG4gICAgICAgICAgZGF0YUF0dWFsaXphY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgaWQ6ICdwYWdhbWVudG8taWQtMicsIFxuICAgICAgICAgIHZhbG9yOiAnMzAwLjAwJywgXG4gICAgICAgICAgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPLCBcbiAgICAgICAgICBkYXRhQXR1YWxpemFjYW86IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSBcbiAgICAgICAgfVxuICAgICAgXSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0YWRvID0gYXdhaXQgc2VydmljZS5vYnRlck1ldHJpY2FzVGVtcG9SZWFpcygpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgICBwYWdhbWVudG9zVWx0aW1hczI0aDogMTAsXG4gICAgICAgIGNvbmZpcm1hY29lc1BlbmRlbnRlczogMjAsXG4gICAgICAgIHZhbG9yTGliZXJhZG9Ib2plOiA1MDAwLFxuICAgICAgICB0YXhhQ29uZmlybWFjYW9Ib2plOiAwLjhcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdGFkby5wYWdhbWVudG9zTWFpc1JlY2VudGVzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QocGFnYW1lbnRvUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIub3JkZXJCeSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnb2J0ZXJEYXNoYm9hcmQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgZGFkb3MgY29uc29saWRhZG9zIHBhcmEgZGFzaGJvYXJkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja1ZvbHVtZSA9IHtcbiAgICAgICAgdG90YWxQYWdhbWVudG9zOiAxMDAsXG4gICAgICAgIHRvdGFsRW1Qcm9jZXNzYW1lbnRvOiAyMCxcbiAgICAgICAgdG90YWxGaW5hbGl6YWRvczogNzAsXG4gICAgICAgIHRvdGFsQ2FuY2VsYWRvczogMTAsXG4gICAgICAgIHRvdGFsVmFsb3JQYWdvOiA1MDAwMCxcbiAgICAgICAgbWVkaWFUZW1wb1Byb2Nlc3NhbWVudG86IDQ4XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrRWZpY2llbmNpYSA9IHtcbiAgICAgICAgdGVtcG9NZWRpb1BvclN0YXR1czogW1xuICAgICAgICAgIHsgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLCB0ZW1wb01lZGlvOiAyNCB9XG4gICAgICAgIF0sXG4gICAgICAgIHRheGFDb25jbHVzYW86IDAuNyxcbiAgICAgICAgdGF4YUNhbmNlbGFtZW50bzogMC4xLFxuICAgICAgICB0ZW1wb01lZGlvVG90YWw6IDk2XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrVGVtcG9SZWFsID0ge1xuICAgICAgICBwYWdhbWVudG9zVWx0aW1hczI0aDogMTAsXG4gICAgICAgIGNvbmZpcm1hY29lc1BlbmRlbnRlczogMjAsXG4gICAgICAgIHZhbG9yTGliZXJhZG9Ib2plOiA1MDAwLFxuICAgICAgICBwYWdhbWVudG9zTWFpc1JlY2VudGVzOiBbXG4gICAgICAgICAgeyBpZDogJ3BhZ2FtZW50by1pZC0xJywgdmFsb3I6IDUwMCwgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLlBBR08sIGRhdGFBdHVhbGl6YWNhbzogbmV3IERhdGUoKSB9XG4gICAgICAgIF0sXG4gICAgICAgIHRheGFDb25maXJtYWNhb0hvamU6IDAuOFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBkb3MgbcOpdG9kb3MgZG8gc2VydmnDp29cbiAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ29idGVyTWV0cmljYXNWb2x1bWUnKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1ZvbHVtZSk7XG4gICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdvYnRlck1ldHJpY2FzRWZpY2llbmNpYScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZShtb2NrRWZpY2llbmNpYSk7XG4gICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdvYnRlck1ldHJpY2FzVGVtcG9SZWFpcycpLm1vY2tSZXNvbHZlZFZhbHVlT25jZShtb2NrVGVtcG9SZWFsKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyRGFzaGJvYXJkKCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbCh7XG4gICAgICAgIHZvbHVtZTogbW9ja1ZvbHVtZSxcbiAgICAgICAgZWZpY2llbmNpYTogbW9ja0VmaWNpZW5jaWEsXG4gICAgICAgIHRlbXBvUmVhbDogbW9ja1RlbXBvUmVhbFxuICAgICAgfSk7XG4gICAgICBleHBlY3Qoc2VydmljZS5vYnRlck1ldHJpY2FzVm9sdW1lKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3Qoc2VydmljZS5vYnRlck1ldHJpY2FzRWZpY2llbmNpYSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHNlcnZpY2Uub2J0ZXJNZXRyaWNhc1RlbXBvUmVhaXMpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGFwbGljYXIgZmlsdHJvcyBhIHRvZG9zIG9zIG3DqXRvZG9zIHF1YW5kbyBlc3BlY2lmaWNhZG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZGF0YUluaWNpbyA9IG5ldyBEYXRlKCcyMDI1LTAxLTAxJyk7XG4gICAgICBjb25zdCBkYXRhRmltID0gbmV3IERhdGUoJzIwMjUtMDMtMzEnKTtcbiAgICAgIGNvbnN0IHVuaWRhZGVJZCA9ICd1bmlkYWRlLWlkLTEnO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGRvcyBtw6l0b2RvcyBkbyBzZXJ2acOnb1xuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnb2J0ZXJNZXRyaWNhc1ZvbHVtZScpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7fSBhcyBhbnkpO1xuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnb2J0ZXJNZXRyaWNhc0VmaWNpZW5jaWEnKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe30gYXMgYW55KTtcbiAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ29idGVyTWV0cmljYXNUZW1wb1JlYWlzJykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHt9IGFzIGFueSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgc2VydmljZS5vYnRlckRhc2hib2FyZChkYXRhSW5pY2lvLCBkYXRhRmltLCB1bmlkYWRlSWQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzZXJ2aWNlLm9idGVyTWV0cmljYXNWb2x1bWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGRhdGFJbmljaW8sIGRhdGFGaW0sIHVuaWRhZGVJZCk7XG4gICAgICBleHBlY3Qoc2VydmljZS5vYnRlck1ldHJpY2FzRWZpY2llbmNpYSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZGF0YUluaWNpbywgZGF0YUZpbSwgdW5pZGFkZUlkKTtcbiAgICAgIGV4cGVjdChzZXJ2aWNlLm9idGVyTWV0cmljYXNUZW1wb1JlYWlzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1bmlkYWRlSWQpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9