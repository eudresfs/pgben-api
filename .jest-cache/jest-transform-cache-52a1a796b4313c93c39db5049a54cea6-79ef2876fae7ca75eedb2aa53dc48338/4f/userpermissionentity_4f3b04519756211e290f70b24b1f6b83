826d1877fe8a100bd9f125e01258e5b0
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e, _f, _g;
Object.defineProperty(exports, "__esModule", { value: true });
exports.UserPermission = exports.ScopeType = exports.TipoEscopo = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const permission_entity_1 = require("./permission.entity");
const usuario_entity_1 = require("./usuario.entity");
/**
 * Enum que define os tipos de escopo para permissões
 */
var TipoEscopo;
(function (TipoEscopo) {
    /**
     * Escopo global (acesso a todos os recursos)
     */
    TipoEscopo["GLOBAL"] = "global";
    /**
     * Escopo limitado a uma unidade específica
     */
    TipoEscopo["UNIDADE"] = "unidade";
    /**
     * Escopo limitado ao próprio usuário
     */
    TipoEscopo["PROPRIO"] = "proprio";
})(TipoEscopo || (exports.TipoEscopo = TipoEscopo = {}));
// Mapeamento para compatibilidade com código existente
exports.ScopeType = {
    GLOBAL: TipoEscopo.GLOBAL,
    UNIT: TipoEscopo.UNIDADE,
    SELF: TipoEscopo.PROPRIO,
};
/**
 * Entidade que representa permissões atribuídas diretamente a usuários.
 *
 * Estas permissões podem sobrepor-se às permissões da role do usuário,
 * permitindo conceder ou revogar permissões específicas.
 */
let UserPermission = class UserPermission {
    /**
     * Identificador único do mapeamento
     */
    id;
    /**
     * Referência ao usuário
     */
    usuario_id;
    /**
     * Relação com o usuário
     */
    usuario;
    /**
     * Referência à permissão
     */
    permissao_id;
    /**
     * Relação com a permissão
     */
    permissao;
    /**
     * Se a permissão é concedida (true) ou revogada (false)
     */
    concedida;
    /**
     * Tipo de escopo (GLOBAL, UNIDADE, PROPRIO)
     */
    tipo_escopo;
    /**
     * ID do escopo (ex: ID da unidade)
     */
    escopo_id;
    /**
     * Data de validade (para permissões temporárias)
     */
    valido_ate;
    /**
     * Data de criação
     */
    created_at;
    /**
     * Data de última atualização
     */
    updated_at;
    /**
     * Usuário que criou o mapeamento
     */
    criado_por;
    /**
     * Relação com o usuário que criou o mapeamento
     */
    usuario_criador;
    /**
     * Usuário que atualizou o mapeamento por último
     */
    atualizado_por;
    /**
     * Relação com o usuário que atualizou o mapeamento por último
     */
    usuario_atualizador;
    // Getters e setters para compatibilidade com código existente
    get userId() {
        return this.usuario_id;
    }
    set userId(value) {
        this.usuario_id = value;
    }
    get user() {
        return this.usuario;
    }
    set user(value) {
        this.usuario = value;
    }
    get permissionId() {
        return this.permissao_id;
    }
    set permissionId(value) {
        this.permissao_id = value;
    }
    get permission() {
        return this.permissao;
    }
    set permission(value) {
        this.permissao = value;
    }
    get granted() {
        return this.concedida;
    }
    set granted(value) {
        this.concedida = value;
    }
    get scopeType() {
        return this.tipo_escopo;
    }
    set scopeType(value) {
        this.tipo_escopo = value;
    }
    get scopeId() {
        return this.escopo_id;
    }
    set scopeId(value) {
        this.escopo_id = value;
    }
    get validUntil() {
        return this.valido_ate;
    }
    set validUntil(value) {
        this.valido_ate = value;
    }
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    get createdBy() {
        return this.criado_por;
    }
    set createdBy(value) {
        this.criado_por = value;
    }
    get creator() {
        return this.usuario_criador;
    }
    set creator(value) {
        this.usuario_criador = value;
    }
    get updatedBy() {
        return this.atualizado_por;
    }
    set updatedBy(value) {
        this.atualizado_por = value;
    }
    get updater() {
        return this.usuario_atualizador;
    }
    set updater(value) {
        this.usuario_atualizador = value;
    }
    /**
     * Verifica se a permissão foi criada por um usuário específico
     * @param usuarioId ID do usuário
     * @returns true se foi criada pelo usuário
     */
    foiCriadaPor(usuarioId) {
        return this.criado_por === usuarioId;
    }
    /**
     * Verifica se a permissão foi atualizada por um usuário específico
     * @param usuarioId ID do usuário
     * @returns true se foi atualizada pelo usuário
     */
    foiAtualizadaPor(usuarioId) {
        return this.atualizado_por === usuarioId;
    }
    /**
     * Verifica se a permissão ainda é válida (não expirou)
     * @returns true se ainda é válida
     */
    isValida() {
        if (!this.valido_ate)
            return true;
        return new Date() <= this.valido_ate;
    }
    /**
     * Verifica se a permissão expirou
     * @returns true se expirou
     */
    isExpirada() {
        return !this.isValida();
    }
    /**
     * Verifica se a permissão tem escopo global
     * @returns true se é global
     */
    isGlobal() {
        return this.tipo_escopo === TipoEscopo.GLOBAL;
    }
    /**
     * Verifica se a permissão tem escopo de unidade
     * @returns true se é por unidade
     */
    isPorUnidade() {
        return this.tipo_escopo === TipoEscopo.UNIDADE;
    }
    /**
     * Verifica se a permissão tem escopo próprio
     * @returns true se é própria
     */
    isPropria() {
        return this.tipo_escopo === TipoEscopo.PROPRIO;
    }
    /**
     * Verifica se a permissão pertence a um usuário específico
     * @param usuarioId ID do usuário
     * @returns true se pertence ao usuário
     */
    pertenceAoUsuario(usuarioId) {
        return this.usuario_id === usuarioId;
    }
    /**
     * Verifica se a permissão é para uma permissão específica
     * @param permissaoId ID da permissão
     * @returns true se é para a permissão
     */
    isParaPermissao(permissaoId) {
        return this.permissao_id === permissaoId;
    }
    /**
     * Verifica se a permissão tem escopo específico
     * @param escopoId ID do escopo
     * @returns true se tem o escopo
     */
    temEscopo(escopoId) {
        return this.escopo_id === escopoId;
    }
    /**
     * Define a data de validade da permissão
     * @param data Data de validade
     */
    definirValidade(data) {
        this.valido_ate = data;
    }
    /**
     * Remove a data de validade (torna permanente)
     */
    tornarPermanente() {
        this.valido_ate = null;
    }
    /**
     * Atualiza o usuário que modificou a permissão
     * @param usuarioId ID do usuário
     */
    atualizarPor(usuarioId) {
        this.atualizado_por = usuarioId;
    }
    /**
     * Obtém uma chave única para a permissão
     * @returns chave única baseada em usuário e permissão
     */
    getUniqueKey() {
        return `${this.usuario_id}:${this.permissao_id}`;
    }
    /**
     * Obtém o tempo restante até a expiração em dias
     * @returns dias até expiração ou null se permanente
     */
    getDiasAteExpiracao() {
        if (!this.valido_ate)
            return null;
        const now = new Date();
        const diffMs = this.valido_ate.getTime() - now.getTime();
        return Math.max(0, Math.ceil(diffMs / (1000 * 60 * 60 * 24)));
    }
    /**
     * Verifica se a permissão expira em breve
     * @param dias Número de dias para considerar "em breve"
     * @returns true se expira em breve
     */
    expiraEmBreve(dias = 7) {
        const diasRestantes = this.getDiasAteExpiracao();
        return diasRestantes !== null && diasRestantes <= dias;
    }
};
exports.UserPermission = UserPermission;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], UserPermission.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', name: 'usuario_id' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID do usuário é obrigatório' }),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do usuário inválido' }),
    __metadata("design:type", String)
], UserPermission.prototype, "usuario_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'usuario_id' }),
    __metadata("design:type", typeof (_a = typeof usuario_entity_1.Usuario !== "undefined" && usuario_entity_1.Usuario) === "function" ? _a : Object)
], UserPermission.prototype, "usuario", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', name: 'permissao_id' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID da permissão é obrigatório' }),
    (0, class_validator_1.IsUUID)('4', { message: 'ID da permissão inválido' }),
    __metadata("design:type", String)
], UserPermission.prototype, "permissao_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => permission_entity_1.Permission, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'permissao_id' }),
    __metadata("design:type", typeof (_b = typeof permission_entity_1.Permission !== "undefined" && permission_entity_1.Permission) === "function" ? _b : Object)
], UserPermission.prototype, "permissao", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'boolean', default: true, name: 'concedida' }),
    __metadata("design:type", Boolean)
], UserPermission.prototype, "concedida", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'varchar',
        length: 20,
        name: 'tipo_escopo',
        default: TipoEscopo.GLOBAL,
    }),
    (0, class_validator_1.IsEnum)(TipoEscopo, { message: 'Tipo de escopo inválido' }),
    __metadata("design:type", String)
], UserPermission.prototype, "tipo_escopo", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true, name: 'escopo_id' }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do escopo inválido' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "escopo_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'timestamp', nullable: true, name: 'valido_ate' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "valido_ate", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)({ name: 'created_at' }),
    __metadata("design:type", typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object)
], UserPermission.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)({ name: 'updated_at' }),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], UserPermission.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true, name: 'criado_por' }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do criador inválido' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "criado_por", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { nullable: true }),
    (0, typeorm_1.JoinColumn)({ name: 'criado_por' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "usuario_criador", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'uuid', nullable: true, name: 'atualizado_por' }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do atualizador inválido' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "atualizado_por", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => usuario_entity_1.Usuario, { nullable: true }),
    (0, typeorm_1.JoinColumn)({ name: 'atualizado_por' }),
    __metadata("design:type", Object)
], UserPermission.prototype, "usuario_atualizador", void 0);
exports.UserPermission = UserPermission = __decorate([
    (0, typeorm_1.Entity)('usuario_permissao'),
    (0, typeorm_1.Index)(['usuario_id', 'permissao_id'], { unique: true }),
    (0, typeorm_1.Index)(['usuario_id']),
    (0, typeorm_1.Index)(['permissao_id']),
    (0, typeorm_1.Index)(['tipo_escopo']),
    (0, typeorm_1.Index)(['escopo_id']),
    (0, typeorm_1.Index)(['criado_por']),
    (0, typeorm_1.Index)(['created_at'])
], UserPermission);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFx1c2VyLXBlcm1pc3Npb24uZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FTaUI7QUFDakIscURBT3lCO0FBQ3pCLDJEQUFpRDtBQUNqRCxxREFBMkM7QUFFM0M7O0dBRUc7QUFDSCxJQUFZLFVBZVg7QUFmRCxXQUFZLFVBQVU7SUFDcEI7O09BRUc7SUFDSCwrQkFBaUIsQ0FBQTtJQUVqQjs7T0FFRztJQUNILGlDQUFtQixDQUFBO0lBRW5COztPQUVHO0lBQ0gsaUNBQW1CLENBQUE7QUFDckIsQ0FBQyxFQWZXLFVBQVUsMEJBQVYsVUFBVSxRQWVyQjtBQUVELHVEQUF1RDtBQUMxQyxRQUFBLFNBQVMsR0FBRztJQUN2QixNQUFNLEVBQUUsVUFBVSxDQUFDLE1BQU07SUFDekIsSUFBSSxFQUFFLFVBQVUsQ0FBQyxPQUFPO0lBQ3hCLElBQUksRUFBRSxVQUFVLENBQUMsT0FBTztDQUN6QixDQUFDO0FBRUY7Ozs7O0dBS0c7QUFTSSxJQUFNLGNBQWMsR0FBcEIsTUFBTSxjQUFjO0lBQ3pCOztPQUVHO0lBRUgsRUFBRSxDQUFTO0lBRVg7O09BRUc7SUFJSCxVQUFVLENBQVM7SUFFbkI7O09BRUc7SUFHSCxPQUFPLENBQVU7SUFFakI7O09BRUc7SUFJSCxZQUFZLENBQVM7SUFFckI7O09BRUc7SUFHSCxTQUFTLENBQWE7SUFFdEI7O09BRUc7SUFFSCxTQUFTLENBQVU7SUFFbkI7O09BRUc7SUFRSCxXQUFXLENBQWE7SUFFeEI7O09BRUc7SUFJSCxTQUFTLENBQWdCO0lBRXpCOztPQUVHO0lBRUgsVUFBVSxDQUFjO0lBRXhCOztPQUVHO0lBRUgsVUFBVSxDQUFPO0lBRWpCOztPQUVHO0lBRUgsVUFBVSxDQUFPO0lBRWpCOztPQUVHO0lBSUgsVUFBVSxDQUFnQjtJQUUxQjs7T0FFRztJQUdILGVBQWUsQ0FBaUI7SUFF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SUFBSSxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxDQUFDO0lBQ2hFLElBQUEsNEJBQVUsR0FBRTtJQUNaLElBQUEsd0JBQU0sRUFBQyxHQUFHLEVBQUUsRUFBRSxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsQ0FBQzs7c0RBQ3pCO0FBTzlCO0lBRkMsSUFBQSxtQkFBUyxFQUFDLEdBQUcsRUFBRSxDQUFDLHdCQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDNUMsSUFBQSxvQkFBVSxFQUFDLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLENBQUM7OzJEQUNIO3lCQTdHekIsY0FBYztJQVIxQixJQUFBLGdCQUFNLEVBQUMsbUJBQW1CLENBQUM7SUFDM0IsSUFBQSxlQUFLLEVBQUMsQ0FBQyxZQUFZLEVBQUUsY0FBYyxDQUFDLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDdkQsSUFBQSxlQUFLLEVBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNyQixJQUFBLGVBQUssRUFBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQ3ZCLElBQUEsZUFBSyxFQUFDLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDdEIsSUFBQSxlQUFLLEVBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNwQixJQUFBLGVBQUssRUFBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3JCLElBQUEsZUFBSyxFQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7R0FDVCxjQUFjLENBaVcxQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcZW50aXRpZXNcXHVzZXItcGVybWlzc2lvbi5lbnRpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29sdW1uLFxuICBDcmVhdGVEYXRlQ29sdW1uLFxuICBFbnRpdHksXG4gIEpvaW5Db2x1bW4sXG4gIE1hbnlUb09uZSxcbiAgUHJpbWFyeUdlbmVyYXRlZENvbHVtbixcbiAgVXBkYXRlRGF0ZUNvbHVtbixcbiAgSW5kZXgsXG59IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHtcbiAgSXNOb3RFbXB0eSxcbiAgSXNVVUlELFxuICBJc0VudW0sXG4gIElzT3B0aW9uYWwsXG4gIElzU3RyaW5nLFxuICBMZW5ndGgsXG59IGZyb20gJ2NsYXNzLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBQZXJtaXNzaW9uIH0gZnJvbSAnLi9wZXJtaXNzaW9uLmVudGl0eSc7XG5pbXBvcnQgeyBVc3VhcmlvIH0gZnJvbSAnLi91c3VhcmlvLmVudGl0eSc7XG5cbi8qKlxuICogRW51bSBxdWUgZGVmaW5lIG9zIHRpcG9zIGRlIGVzY29wbyBwYXJhIHBlcm1pc3PDtWVzXG4gKi9cbmV4cG9ydCBlbnVtIFRpcG9Fc2NvcG8ge1xuICAvKipcbiAgICogRXNjb3BvIGdsb2JhbCAoYWNlc3NvIGEgdG9kb3Mgb3MgcmVjdXJzb3MpXG4gICAqL1xuICBHTE9CQUwgPSAnZ2xvYmFsJyxcblxuICAvKipcbiAgICogRXNjb3BvIGxpbWl0YWRvIGEgdW1hIHVuaWRhZGUgZXNwZWPDrWZpY2FcbiAgICovXG4gIFVOSURBREUgPSAndW5pZGFkZScsXG5cbiAgLyoqXG4gICAqIEVzY29wbyBsaW1pdGFkbyBhbyBwcsOzcHJpbyB1c3XDoXJpb1xuICAgKi9cbiAgUFJPUFJJTyA9ICdwcm9wcmlvJyxcbn1cblxuLy8gTWFwZWFtZW50byBwYXJhIGNvbXBhdGliaWxpZGFkZSBjb20gY8OzZGlnbyBleGlzdGVudGVcbmV4cG9ydCBjb25zdCBTY29wZVR5cGUgPSB7XG4gIEdMT0JBTDogVGlwb0VzY29wby5HTE9CQUwsXG4gIFVOSVQ6IFRpcG9Fc2NvcG8uVU5JREFERSxcbiAgU0VMRjogVGlwb0VzY29wby5QUk9QUklPLFxufTtcblxuLyoqXG4gKiBFbnRpZGFkZSBxdWUgcmVwcmVzZW50YSBwZXJtaXNzw7VlcyBhdHJpYnXDrWRhcyBkaXJldGFtZW50ZSBhIHVzdcOhcmlvcy5cbiAqXG4gKiBFc3RhcyBwZXJtaXNzw7VlcyBwb2RlbSBzb2JyZXBvci1zZSDDoHMgcGVybWlzc8O1ZXMgZGEgcm9sZSBkbyB1c3XDoXJpbyxcbiAqIHBlcm1pdGluZG8gY29uY2VkZXIgb3UgcmV2b2dhciBwZXJtaXNzw7VlcyBlc3BlY8OtZmljYXMuXG4gKi9cbkBFbnRpdHkoJ3VzdWFyaW9fcGVybWlzc2FvJylcbkBJbmRleChbJ3VzdWFyaW9faWQnLCAncGVybWlzc2FvX2lkJ10sIHsgdW5pcXVlOiB0cnVlIH0pXG5ASW5kZXgoWyd1c3VhcmlvX2lkJ10pXG5ASW5kZXgoWydwZXJtaXNzYW9faWQnXSlcbkBJbmRleChbJ3RpcG9fZXNjb3BvJ10pXG5ASW5kZXgoWydlc2NvcG9faWQnXSlcbkBJbmRleChbJ2NyaWFkb19wb3InXSlcbkBJbmRleChbJ2NyZWF0ZWRfYXQnXSlcbmV4cG9ydCBjbGFzcyBVc2VyUGVybWlzc2lvbiB7XG4gIC8qKlxuICAgKiBJZGVudGlmaWNhZG9yIMO6bmljbyBkbyBtYXBlYW1lbnRvXG4gICAqL1xuICBAUHJpbWFyeUdlbmVyYXRlZENvbHVtbigndXVpZCcpXG4gIGlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFJlZmVyw6puY2lhIGFvIHVzdcOhcmlvXG4gICAqL1xuICBAQ29sdW1uKHsgdHlwZTogJ3V1aWQnLCBuYW1lOiAndXN1YXJpb19pZCcgfSlcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnSUQgZG8gdXN1w6FyaW8gw6kgb2JyaWdhdMOzcmlvJyB9KVxuICBASXNVVUlEKCc0JywgeyBtZXNzYWdlOiAnSUQgZG8gdXN1w6FyaW8gaW52w6FsaWRvJyB9KVxuICB1c3VhcmlvX2lkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFJlbGHDp8OjbyBjb20gbyB1c3XDoXJpb1xuICAgKi9cbiAgQE1hbnlUb09uZSgoKSA9PiBVc3VhcmlvLCB7IG9uRGVsZXRlOiAnQ0FTQ0FERScgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAndXN1YXJpb19pZCcgfSlcbiAgdXN1YXJpbzogVXN1YXJpbztcblxuICAvKipcbiAgICogUmVmZXLDqm5jaWEgw6AgcGVybWlzc8Ojb1xuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbmFtZTogJ3Blcm1pc3Nhb19pZCcgfSlcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnSUQgZGEgcGVybWlzc8OjbyDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc1VVSUQoJzQnLCB7IG1lc3NhZ2U6ICdJRCBkYSBwZXJtaXNzw6NvIGludsOhbGlkbycgfSlcbiAgcGVybWlzc2FvX2lkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFJlbGHDp8OjbyBjb20gYSBwZXJtaXNzw6NvXG4gICAqL1xuICBATWFueVRvT25lKCgpID0+IFBlcm1pc3Npb24sIHsgb25EZWxldGU6ICdDQVNDQURFJyB9KVxuICBASm9pbkNvbHVtbih7IG5hbWU6ICdwZXJtaXNzYW9faWQnIH0pXG4gIHBlcm1pc3NhbzogUGVybWlzc2lvbjtcblxuICAvKipcbiAgICogU2UgYSBwZXJtaXNzw6NvIMOpIGNvbmNlZGlkYSAodHJ1ZSkgb3UgcmV2b2dhZGEgKGZhbHNlKVxuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICdib29sZWFuJywgZGVmYXVsdDogdHJ1ZSwgbmFtZTogJ2NvbmNlZGlkYScgfSlcbiAgY29uY2VkaWRhOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaXBvIGRlIGVzY29wbyAoR0xPQkFMLCBVTklEQURFLCBQUk9QUklPKVxuICAgKi9cbiAgQENvbHVtbih7XG4gICAgdHlwZTogJ3ZhcmNoYXInLFxuICAgIGxlbmd0aDogMjAsXG4gICAgbmFtZTogJ3RpcG9fZXNjb3BvJyxcbiAgICBkZWZhdWx0OiBUaXBvRXNjb3BvLkdMT0JBTCxcbiAgfSlcbiAgQElzRW51bShUaXBvRXNjb3BvLCB7IG1lc3NhZ2U6ICdUaXBvIGRlIGVzY29wbyBpbnbDoWxpZG8nIH0pXG4gIHRpcG9fZXNjb3BvOiBUaXBvRXNjb3BvO1xuXG4gIC8qKlxuICAgKiBJRCBkbyBlc2NvcG8gKGV4OiBJRCBkYSB1bmlkYWRlKVxuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUsIG5hbWU6ICdlc2NvcG9faWQnIH0pXG4gIEBJc09wdGlvbmFsKClcbiAgQElzVVVJRCgnNCcsIHsgbWVzc2FnZTogJ0lEIGRvIGVzY29wbyBpbnbDoWxpZG8nIH0pXG4gIGVzY29wb19pZDogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogRGF0YSBkZSB2YWxpZGFkZSAocGFyYSBwZXJtaXNzw7VlcyB0ZW1wb3LDoXJpYXMpXG4gICAqL1xuICBAQ29sdW1uKHsgdHlwZTogJ3RpbWVzdGFtcCcsIG51bGxhYmxlOiB0cnVlLCBuYW1lOiAndmFsaWRvX2F0ZScgfSlcbiAgdmFsaWRvX2F0ZTogRGF0ZSB8IG51bGw7XG5cbiAgLyoqXG4gICAqIERhdGEgZGUgY3JpYcOnw6NvXG4gICAqL1xuICBAQ3JlYXRlRGF0ZUNvbHVtbih7IG5hbWU6ICdjcmVhdGVkX2F0JyB9KVxuICBjcmVhdGVkX2F0OiBEYXRlO1xuXG4gIC8qKlxuICAgKiBEYXRhIGRlIMO6bHRpbWEgYXR1YWxpemHDp8Ojb1xuICAgKi9cbiAgQFVwZGF0ZURhdGVDb2x1bW4oeyBuYW1lOiAndXBkYXRlZF9hdCcgfSlcbiAgdXBkYXRlZF9hdDogRGF0ZTtcblxuICAvKipcbiAgICogVXN1w6FyaW8gcXVlIGNyaW91IG8gbWFwZWFtZW50b1xuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUsIG5hbWU6ICdjcmlhZG9fcG9yJyB9KVxuICBASXNPcHRpb25hbCgpXG4gIEBJc1VVSUQoJzQnLCB7IG1lc3NhZ2U6ICdJRCBkbyBjcmlhZG9yIGludsOhbGlkbycgfSlcbiAgY3JpYWRvX3Bvcjogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogUmVsYcOnw6NvIGNvbSBvIHVzdcOhcmlvIHF1ZSBjcmlvdSBvIG1hcGVhbWVudG9cbiAgICovXG4gIEBNYW55VG9PbmUoKCkgPT4gVXN1YXJpbywgeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASm9pbkNvbHVtbih7IG5hbWU6ICdjcmlhZG9fcG9yJyB9KVxuICB1c3VhcmlvX2NyaWFkb3I6IFVzdWFyaW8gfCBudWxsO1xuXG4gIC8qKlxuICAgKiBVc3XDoXJpbyBxdWUgYXR1YWxpem91IG8gbWFwZWFtZW50byBwb3Igw7psdGltb1xuICAgKi9cbiAgQENvbHVtbih7IHR5cGU6ICd1dWlkJywgbnVsbGFibGU6IHRydWUsIG5hbWU6ICdhdHVhbGl6YWRvX3BvcicgfSlcbiAgQElzT3B0aW9uYWwoKVxuICBASXNVVUlEKCc0JywgeyBtZXNzYWdlOiAnSUQgZG8gYXR1YWxpemFkb3IgaW52w6FsaWRvJyB9KVxuICBhdHVhbGl6YWRvX3Bvcjogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogUmVsYcOnw6NvIGNvbSBvIHVzdcOhcmlvIHF1ZSBhdHVhbGl6b3UgbyBtYXBlYW1lbnRvIHBvciDDumx0aW1vXG4gICAqL1xuICBATWFueVRvT25lKCgpID0+IFVzdWFyaW8sIHsgbnVsbGFibGU6IHRydWUgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAnYXR1YWxpemFkb19wb3InIH0pXG4gIHVzdWFyaW9fYXR1YWxpemFkb3I6IFVzdWFyaW8gfCBudWxsO1xuXG4gIC8vIEdldHRlcnMgZSBzZXR0ZXJzIHBhcmEgY29tcGF0aWJpbGlkYWRlIGNvbSBjw7NkaWdvIGV4aXN0ZW50ZVxuICBnZXQgdXNlcklkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMudXN1YXJpb19pZDtcbiAgfVxuXG4gIHNldCB1c2VySWQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMudXN1YXJpb19pZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHVzZXIoKTogVXN1YXJpbyB7XG4gICAgcmV0dXJuIHRoaXMudXN1YXJpbztcbiAgfVxuXG4gIHNldCB1c2VyKHZhbHVlOiBVc3VhcmlvKSB7XG4gICAgdGhpcy51c3VhcmlvID0gdmFsdWU7XG4gIH1cblxuICBnZXQgcGVybWlzc2lvbklkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucGVybWlzc2FvX2lkO1xuICB9XG5cbiAgc2V0IHBlcm1pc3Npb25JZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5wZXJtaXNzYW9faWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBwZXJtaXNzaW9uKCk6IFBlcm1pc3Npb24ge1xuICAgIHJldHVybiB0aGlzLnBlcm1pc3NhbztcbiAgfVxuXG4gIHNldCBwZXJtaXNzaW9uKHZhbHVlOiBQZXJtaXNzaW9uKSB7XG4gICAgdGhpcy5wZXJtaXNzYW8gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBncmFudGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNvbmNlZGlkYTtcbiAgfVxuXG4gIHNldCBncmFudGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5jb25jZWRpZGEgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBzY29wZVR5cGUoKTogVGlwb0VzY29wbyB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19lc2NvcG87XG4gIH1cblxuICBzZXQgc2NvcGVUeXBlKHZhbHVlOiBUaXBvRXNjb3BvKSB7XG4gICAgdGhpcy50aXBvX2VzY29wbyA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHNjb3BlSWQoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZXNjb3BvX2lkO1xuICB9XG5cbiAgc2V0IHNjb3BlSWQodmFsdWU6IHN0cmluZyB8IG51bGwpIHtcbiAgICB0aGlzLmVzY29wb19pZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHZhbGlkVW50aWwoKTogRGF0ZSB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnZhbGlkb19hdGU7XG4gIH1cblxuICBzZXQgdmFsaWRVbnRpbCh2YWx1ZTogRGF0ZSB8IG51bGwpIHtcbiAgICB0aGlzLnZhbGlkb19hdGUgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBjcmVhdGVkQXQoKTogRGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlZF9hdDtcbiAgfVxuXG4gIGdldCB1cGRhdGVkQXQoKTogRGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlZF9hdDtcbiAgfVxuXG4gIGdldCBjcmVhdGVkQnkoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuY3JpYWRvX3BvcjtcbiAgfVxuXG4gIHNldCBjcmVhdGVkQnkodmFsdWU6IHN0cmluZyB8IG51bGwpIHtcbiAgICB0aGlzLmNyaWFkb19wb3IgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBjcmVhdG9yKCk6IFVzdWFyaW8gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy51c3VhcmlvX2NyaWFkb3I7XG4gIH1cblxuICBzZXQgY3JlYXRvcih2YWx1ZTogVXN1YXJpbyB8IG51bGwpIHtcbiAgICB0aGlzLnVzdWFyaW9fY3JpYWRvciA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHVwZGF0ZWRCeSgpOiBzdHJpbmcgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5hdHVhbGl6YWRvX3BvcjtcbiAgfVxuXG4gIHNldCB1cGRhdGVkQnkodmFsdWU6IHN0cmluZyB8IG51bGwpIHtcbiAgICB0aGlzLmF0dWFsaXphZG9fcG9yID0gdmFsdWU7XG4gIH1cblxuICBnZXQgdXBkYXRlcigpOiBVc3VhcmlvIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMudXN1YXJpb19hdHVhbGl6YWRvcjtcbiAgfVxuXG4gIHNldCB1cGRhdGVyKHZhbHVlOiBVc3VhcmlvIHwgbnVsbCkge1xuICAgIHRoaXMudXN1YXJpb19hdHVhbGl6YWRvciA9IHZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgcGVybWlzc8OjbyBmb2kgY3JpYWRhIHBvciB1bSB1c3XDoXJpbyBlc3BlY8OtZmljb1xuICAgKiBAcGFyYW0gdXN1YXJpb0lkIElEIGRvIHVzdcOhcmlvXG4gICAqIEByZXR1cm5zIHRydWUgc2UgZm9pIGNyaWFkYSBwZWxvIHVzdcOhcmlvXG4gICAqL1xuICBmb2lDcmlhZGFQb3IodXN1YXJpb0lkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jcmlhZG9fcG9yID09PSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBwZXJtaXNzw6NvIGZvaSBhdHVhbGl6YWRhIHBvciB1bSB1c3XDoXJpbyBlc3BlY8OtZmljb1xuICAgKiBAcGFyYW0gdXN1YXJpb0lkIElEIGRvIHVzdcOhcmlvXG4gICAqIEByZXR1cm5zIHRydWUgc2UgZm9pIGF0dWFsaXphZGEgcGVsbyB1c3XDoXJpb1xuICAgKi9cbiAgZm9pQXR1YWxpemFkYVBvcih1c3VhcmlvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmF0dWFsaXphZG9fcG9yID09PSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBwZXJtaXNzw6NvIGFpbmRhIMOpIHbDoWxpZGEgKG7Do28gZXhwaXJvdSlcbiAgICogQHJldHVybnMgdHJ1ZSBzZSBhaW5kYSDDqSB2w6FsaWRhXG4gICAqL1xuICBpc1ZhbGlkYSgpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMudmFsaWRvX2F0ZSkgcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIG5ldyBEYXRlKCkgPD0gdGhpcy52YWxpZG9fYXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgcGVybWlzc8OjbyBleHBpcm91XG4gICAqIEByZXR1cm5zIHRydWUgc2UgZXhwaXJvdVxuICAgKi9cbiAgaXNFeHBpcmFkYSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMuaXNWYWxpZGEoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIHBlcm1pc3PDo28gdGVtIGVzY29wbyBnbG9iYWxcbiAgICogQHJldHVybnMgdHJ1ZSBzZSDDqSBnbG9iYWxcbiAgICovXG4gIGlzR2xvYmFsKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRpcG9fZXNjb3BvID09PSBUaXBvRXNjb3BvLkdMT0JBTDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIHBlcm1pc3PDo28gdGVtIGVzY29wbyBkZSB1bmlkYWRlXG4gICAqIEByZXR1cm5zIHRydWUgc2Ugw6kgcG9yIHVuaWRhZGVcbiAgICovXG4gIGlzUG9yVW5pZGFkZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wbyA9PT0gVGlwb0VzY29wby5VTklEQURFO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgcGVybWlzc8OjbyB0ZW0gZXNjb3BvIHByw7NwcmlvXG4gICAqIEByZXR1cm5zIHRydWUgc2Ugw6kgcHLDs3ByaWFcbiAgICovXG4gIGlzUHJvcHJpYSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2VzY29wbyA9PT0gVGlwb0VzY29wby5QUk9QUklPO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgcGVybWlzc8OjbyBwZXJ0ZW5jZSBhIHVtIHVzdcOhcmlvIGVzcGVjw61maWNvXG4gICAqIEBwYXJhbSB1c3VhcmlvSWQgSUQgZG8gdXN1w6FyaW9cbiAgICogQHJldHVybnMgdHJ1ZSBzZSBwZXJ0ZW5jZSBhbyB1c3XDoXJpb1xuICAgKi9cbiAgcGVydGVuY2VBb1VzdWFyaW8odXN1YXJpb0lkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy51c3VhcmlvX2lkID09PSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBwZXJtaXNzw6NvIMOpIHBhcmEgdW1hIHBlcm1pc3PDo28gZXNwZWPDrWZpY2FcbiAgICogQHBhcmFtIHBlcm1pc3Nhb0lkIElEIGRhIHBlcm1pc3PDo29cbiAgICogQHJldHVybnMgdHJ1ZSBzZSDDqSBwYXJhIGEgcGVybWlzc8Ojb1xuICAgKi9cbiAgaXNQYXJhUGVybWlzc2FvKHBlcm1pc3Nhb0lkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5wZXJtaXNzYW9faWQgPT09IHBlcm1pc3Nhb0lkO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgcGVybWlzc8OjbyB0ZW0gZXNjb3BvIGVzcGVjw61maWNvXG4gICAqIEBwYXJhbSBlc2NvcG9JZCBJRCBkbyBlc2NvcG9cbiAgICogQHJldHVybnMgdHJ1ZSBzZSB0ZW0gbyBlc2NvcG9cbiAgICovXG4gIHRlbUVzY29wbyhlc2NvcG9JZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZXNjb3BvX2lkID09PSBlc2NvcG9JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWZpbmUgYSBkYXRhIGRlIHZhbGlkYWRlIGRhIHBlcm1pc3PDo29cbiAgICogQHBhcmFtIGRhdGEgRGF0YSBkZSB2YWxpZGFkZVxuICAgKi9cbiAgZGVmaW5pclZhbGlkYWRlKGRhdGE6IERhdGUpOiB2b2lkIHtcbiAgICB0aGlzLnZhbGlkb19hdGUgPSBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGRhdGEgZGUgdmFsaWRhZGUgKHRvcm5hIHBlcm1hbmVudGUpXG4gICAqL1xuICB0b3JuYXJQZXJtYW5lbnRlKCk6IHZvaWQge1xuICAgIHRoaXMudmFsaWRvX2F0ZSA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQXR1YWxpemEgbyB1c3XDoXJpbyBxdWUgbW9kaWZpY291IGEgcGVybWlzc8Ojb1xuICAgKiBAcGFyYW0gdXN1YXJpb0lkIElEIGRvIHVzdcOhcmlvXG4gICAqL1xuICBhdHVhbGl6YXJQb3IodXN1YXJpb0lkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmF0dWFsaXphZG9fcG9yID0gdXN1YXJpb0lkO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSB1bWEgY2hhdmUgw7puaWNhIHBhcmEgYSBwZXJtaXNzw6NvXG4gICAqIEByZXR1cm5zIGNoYXZlIMO6bmljYSBiYXNlYWRhIGVtIHVzdcOhcmlvIGUgcGVybWlzc8Ojb1xuICAgKi9cbiAgZ2V0VW5pcXVlS2V5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke3RoaXMudXN1YXJpb19pZH06JHt0aGlzLnBlcm1pc3Nhb19pZH1gO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBvIHRlbXBvIHJlc3RhbnRlIGF0w6kgYSBleHBpcmHDp8OjbyBlbSBkaWFzXG4gICAqIEByZXR1cm5zIGRpYXMgYXTDqSBleHBpcmHDp8OjbyBvdSBudWxsIHNlIHBlcm1hbmVudGVcbiAgICovXG4gIGdldERpYXNBdGVFeHBpcmFjYW8oKTogbnVtYmVyIHwgbnVsbCB7XG4gICAgaWYgKCF0aGlzLnZhbGlkb19hdGUpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZGlmZk1zID0gdGhpcy52YWxpZG9fYXRlLmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCk7XG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGguY2VpbChkaWZmTXMgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIHBlcm1pc3PDo28gZXhwaXJhIGVtIGJyZXZlXG4gICAqIEBwYXJhbSBkaWFzIE7Dum1lcm8gZGUgZGlhcyBwYXJhIGNvbnNpZGVyYXIgXCJlbSBicmV2ZVwiXG4gICAqIEByZXR1cm5zIHRydWUgc2UgZXhwaXJhIGVtIGJyZXZlXG4gICAqL1xuICBleHBpcmFFbUJyZXZlKGRpYXM6IG51bWJlciA9IDcpOiBib29sZWFuIHtcbiAgICBjb25zdCBkaWFzUmVzdGFudGVzID0gdGhpcy5nZXREaWFzQXRlRXhwaXJhY2FvKCk7XG4gICAgcmV0dXJuIGRpYXNSZXN0YW50ZXMgIT09IG51bGwgJiYgZGlhc1Jlc3RhbnRlcyA8PSBkaWFzO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=