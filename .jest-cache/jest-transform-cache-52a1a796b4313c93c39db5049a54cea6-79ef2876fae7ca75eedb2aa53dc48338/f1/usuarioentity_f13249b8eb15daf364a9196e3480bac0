613baeda484e41575952a4a11e9f0dac
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e, _f, _g, _h;
Object.defineProperty(exports, "__esModule", { value: true });
exports.Usuario = void 0;
const typeorm_1 = require("typeorm");
const class_transformer_1 = require("class-transformer");
const refresh_token_entity_1 = require("./refresh-token.entity");
const unidade_entity_1 = require("./unidade.entity");
const setor_entity_1 = require("./setor.entity");
const br_validators_1 = require("../shared/validators/br-validators");
const class_validator_1 = require("class-validator");
const strong_password_validator_1 = require("../shared/validators/strong-password.validator");
const role_entity_1 = require("./role.entity");
const status_enum_1 = require("../enums/status.enum");
/**
 * Entidade de Usuário
 *
 * Representa um usuário do sistema com suas informações básicas,
 * credenciais de acesso e relacionamentos com outras entidades.
 */
let Usuario = class Usuario {
    id;
    nome;
    email;
    senhaHash;
    cpf;
    telefone;
    matricula;
    role_id;
    role;
    unidade_id;
    unidade;
    setor_id;
    setor;
    status;
    primeiro_acesso;
    tentativas_login;
    ultimo_login;
    refreshTokens;
    created_at;
    updated_at;
    removed_at;
    /**
     * Verifica se o usuário está ativo
     * @returns true se o usuário estiver ativo
     */
    isAtivo() {
        return this.status === status_enum_1.Status.ATIVO;
    }
    /**
     * Ativa o usuário
     */
    ativar() {
        this.status = status_enum_1.Status.ATIVO;
    }
    /**
     * Desativa o usuário
     */
    desativar() {
        this.status = status_enum_1.Status.INATIVO;
    }
    /**
     * Verifica se é o primeiro acesso do usuário
     * @returns true se for o primeiro acesso
     */
    isPrimeiroAcesso() {
        return this.primeiro_acesso;
    }
    /**
     * Marca que o usuário já fez o primeiro acesso
     */
    marcarPrimeiroAcessoRealizado() {
        this.primeiro_acesso = false;
    }
    /**
     * Obtém o nome completo formatado
     * @returns nome formatado
     */
    getNomeFormatado() {
        return this.nome.trim();
    }
    /**
     * Verifica se o usuário pode ser deletado
     * @returns true se pode ser deletado
     */
    podeSerDeletado() {
        return this.status === status_enum_1.Status.INATIVO;
    }
};
exports.Usuario = Usuario;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], Usuario.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ length: 255 }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Nome é obrigatório' }),
    (0, class_validator_1.IsString)({ message: 'Nome deve ser uma string' }),
    (0, class_validator_1.MinLength)(2, { message: 'Nome deve ter no mínimo 2 caracteres' }),
    (0, class_validator_1.MaxLength)(255, { message: 'Nome deve ter no máximo 255 caracteres' }),
    __metadata("design:type", String)
], Usuario.prototype, "nome", void 0);
__decorate([
    (0, typeorm_1.Column)({ unique: true, length: 255 }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Email é obrigatório' }),
    (0, class_validator_1.IsEmail)({}, { message: 'Email deve ter um formato válido' }),
    (0, class_validator_1.MaxLength)(255, { message: 'Email deve ter no máximo 255 caracteres' }),
    __metadata("design:type", String)
], Usuario.prototype, "email", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'senha_hash' }),
    (0, class_transformer_1.Exclude)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'Senha é obrigatória' }),
    (0, class_validator_1.IsString)({ message: 'Senha deve ser uma string' }),
    (0, class_validator_1.Validate)(strong_password_validator_1.IsStrongPassword, {
        message: 'Senha deve ter no mínimo 8 caracteres, incluindo maiúscula, minúscula, número e caractere especial'
    }),
    __metadata("design:type", String)
], Usuario.prototype, "senhaHash", void 0);
__decorate([
    (0, typeorm_1.Column)({ unique: true, length: 11 }),
    (0, class_validator_1.IsNotEmpty)({ message: 'CPF é obrigatório' }),
    (0, class_validator_1.IsString)({ message: 'CPF deve ser uma string' }),
    (0, class_validator_1.Length)(11, 11, { message: 'CPF deve ter exatamente 11 caracteres' }),
    (0, class_validator_1.Validate)(br_validators_1.IsCPF, { message: 'CPF inválido' }),
    __metadata("design:type", String)
], Usuario.prototype, "cpf", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true, length: 15 }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsString)({ message: 'Telefone deve ser uma string' }),
    (0, class_validator_1.MaxLength)(15, { message: 'Telefone deve ter no máximo 15 caracteres' }),
    (0, class_validator_1.Validate)(br_validators_1.IsTelefone, { message: 'Telefone inválido' }),
    __metadata("design:type", String)
], Usuario.prototype, "telefone", void 0);
__decorate([
    (0, typeorm_1.Column)({ unique: true, length: 20 }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Matrícula é obrigatória' }),
    (0, class_validator_1.IsString)({ message: 'Matrícula deve ser uma string' }),
    (0, class_validator_1.MinLength)(3, { message: 'Matrícula deve ter no mínimo 3 caracteres' }),
    (0, class_validator_1.MaxLength)(20, { message: 'Matrícula deve ter no máximo 20 caracteres' }),
    __metadata("design:type", String)
], Usuario.prototype, "matricula", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'role_id', nullable: true }),
    __metadata("design:type", String)
], Usuario.prototype, "role_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => role_entity_1.Role, (role) => role.usuarios, {
        nullable: false,
        eager: false
    }),
    (0, typeorm_1.JoinColumn)({ name: 'role_id' }),
    __metadata("design:type", typeof (_a = typeof role_entity_1.Role !== "undefined" && role_entity_1.Role) === "function" ? _a : Object)
], Usuario.prototype, "role", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'unidade_id', nullable: true }),
    __metadata("design:type", String)
], Usuario.prototype, "unidade_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => unidade_entity_1.Unidade, (unidade) => unidade.usuarios, {
        nullable: true,
        eager: false
    }),
    (0, typeorm_1.JoinColumn)({ name: 'unidade_id' }),
    __metadata("design:type", typeof (_b = typeof unidade_entity_1.Unidade !== "undefined" && unidade_entity_1.Unidade) === "function" ? _b : Object)
], Usuario.prototype, "unidade", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'setor_id', nullable: true }),
    __metadata("design:type", String)
], Usuario.prototype, "setor_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => setor_entity_1.Setor, (setor) => setor.usuarios, {
        nullable: true,
        eager: false
    }),
    (0, typeorm_1.JoinColumn)({ name: 'setor_id' }),
    __metadata("design:type", typeof (_c = typeof setor_entity_1.Setor !== "undefined" && setor_entity_1.Setor) === "function" ? _c : Object)
], Usuario.prototype, "setor", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: status_enum_1.Status,
        default: status_enum_1.Status.ATIVO,
        enumName: 'status_usuario'
    }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsEnum)(status_enum_1.Status, { message: 'Status deve ser ATIVO ou INATIVO' }),
    __metadata("design:type", typeof (_d = typeof status_enum_1.Status !== "undefined" && status_enum_1.Status) === "function" ? _d : Object)
], Usuario.prototype, "status", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'primeiro_acesso', default: true }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsBoolean)({ message: 'Primeiro acesso deve ser um valor booleano' }),
    __metadata("design:type", Boolean)
], Usuario.prototype, "primeiro_acesso", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'tentativas_login', default: 0 }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", Number)
], Usuario.prototype, "tentativas_login", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'ultimo_login', nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], Usuario.prototype, "ultimo_login", void 0);
__decorate([
    (0, typeorm_1.OneToMany)(() => refresh_token_entity_1.RefreshToken, (refreshToken) => refreshToken.usuario, {
        cascade: ['remove'],
        lazy: true
    }),
    __metadata("design:type", Array)
], Usuario.prototype, "refreshTokens", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)({ name: 'created_at' }),
    __metadata("design:type", typeof (_f = typeof Date !== "undefined" && Date) === "function" ? _f : Object)
], Usuario.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)({ name: 'updated_at' }),
    __metadata("design:type", typeof (_g = typeof Date !== "undefined" && Date) === "function" ? _g : Object)
], Usuario.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.DeleteDateColumn)({ name: 'removed_at' }),
    __metadata("design:type", typeof (_h = typeof Date !== "undefined" && Date) === "function" ? _h : Object)
], Usuario.prototype, "removed_at", void 0);
exports.Usuario = Usuario = __decorate([
    (0, typeorm_1.Entity)('usuario'),
    (0, typeorm_1.Index)(['email'], { unique: true }),
    (0, typeorm_1.Index)(['cpf'], { unique: true }),
    (0, typeorm_1.Index)(['matricula'], { unique: true }),
    (0, typeorm_1.Index)(['status']),
    (0, typeorm_1.Index)(['role_id']),
    (0, typeorm_1.Index)(['unidade_id'])
], Usuario);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFx1c3VhcmlvLmVudGl0eS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEscUNBV2lCO0FBQ2pCLHlEQUE0QztBQUM1QyxpRUFBc0Q7QUFDdEQscURBQTJDO0FBQzNDLGlEQUF1QztBQUN2QyxzRUFBdUU7QUFDdkUscURBQXVJO0FBQ3ZJLDhGQUFrRjtBQUNsRiwrQ0FBcUM7QUFDckMsc0RBQThDO0FBRTlDOzs7OztHQUtHO0FBUUksSUFBTSxPQUFPLEdBQWIsTUFBTSxPQUFPO0lBRWxCLEVBQUUsQ0FBUztJQU9YLElBQUksQ0FBUztJQU1iLEtBQUssQ0FBUztJQVNkLFNBQVMsQ0FBUztJQU9sQixHQUFHLENBQVM7SUFPWixRQUFRLENBQVU7SUFPbEIsU0FBUyxDQUFTO0lBR2xCLE9BQU8sQ0FBUztJQU9oQixJQUFJLENBQU87SUFHWCxVQUFVLENBQVM7SUFPbkIsT0FBTyxDQUFVO0lBR2pCLFFBQVEsQ0FBUztJQU9qQixLQUFLLENBQVE7SUFVYixNQUFNLENBQVM7SUFLZixlQUFlLENBQVU7SUFJekIsZ0JBQWdCLENBQVM7SUFJekIsWUFBWSxDQUFPO0lBTW5CLGFBQWEsQ0FBaUI7SUFHOUIsVUFBVSxDQUFPO0lBR2pCLFVBQVUsQ0FBTztJQUdqQixVQUFVLENBQU87SUFFakI7OztPQUdHO0lBQ0gsT0FBTztRQUNMLE9BQU8sSUFBSSxDQUFDLE1BQU0sS0FBSyxvQkFBTSxDQUFDLEtBQUssQ0FBQztJQUN0QyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNO1FBQ0osSUFBSSxDQUFDLE1BQU0sR0FBRyxvQkFBTSxDQUFDLEtBQUssQ0FBQztJQUM3QixDQUFDO0lBRUQ7O09BRUc7SUFDSCxTQUFTO1FBQ1AsSUFBSSxDQUFDLE1BQU0sR0FBRyxvQkFBTSxDQUFDLE9BQU8sQ0FBQztJQUMvQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gs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LFlBQVksQ0FBQyxDQUFDO0dBQ1QsT0FBTyxDQXVLbkIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFx1c3VhcmlvLmVudGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbnRpdHksXG4gIFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4sXG4gIENvbHVtbixcbiAgQ3JlYXRlRGF0ZUNvbHVtbixcbiAgVXBkYXRlRGF0ZUNvbHVtbixcbiAgRGVsZXRlRGF0ZUNvbHVtbixcbiAgT25lVG9NYW55LFxuICBNYW55VG9PbmUsXG4gIEpvaW5Db2x1bW4sXG4gIEluZGV4LFxufSBmcm9tICd0eXBlb3JtJztcbmltcG9ydCB7IEV4Y2x1ZGUgfSBmcm9tICdjbGFzcy10cmFuc2Zvcm1lcic7XG5pbXBvcnQgeyBSZWZyZXNoVG9rZW4gfSBmcm9tICcuL3JlZnJlc2gtdG9rZW4uZW50aXR5JztcbmltcG9ydCB7IFVuaWRhZGUgfSBmcm9tICcuL3VuaWRhZGUuZW50aXR5JztcbmltcG9ydCB7IFNldG9yIH0gZnJvbSAnLi9zZXRvci5lbnRpdHknO1xuaW1wb3J0IHsgSXNDUEYsIElzVGVsZWZvbmUgfSBmcm9tICcuLi9zaGFyZWQvdmFsaWRhdG9ycy9ici12YWxpZGF0b3JzJztcbmltcG9ydCB7IElzTm90RW1wdHksIElzU3RyaW5nLCBMZW5ndGgsIE1heExlbmd0aCwgTWluTGVuZ3RoLCBWYWxpZGF0ZSwgSXNFbWFpbCwgSXNFbnVtLCBJc09wdGlvbmFsLCBJc0Jvb2xlYW4gfSBmcm9tICdjbGFzcy12YWxpZGF0b3InO1xuaW1wb3J0IHsgSXNTdHJvbmdQYXNzd29yZCB9IGZyb20gJy4uL3NoYXJlZC92YWxpZGF0b3JzL3N0cm9uZy1wYXNzd29yZC52YWxpZGF0b3InO1xuaW1wb3J0IHsgUm9sZSB9IGZyb20gJy4vcm9sZS5lbnRpdHknO1xuaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSAnLi4vZW51bXMvc3RhdHVzLmVudW0nO1xuXG4vKipcbiAqIEVudGlkYWRlIGRlIFVzdcOhcmlvXG4gKlxuICogUmVwcmVzZW50YSB1bSB1c3XDoXJpbyBkbyBzaXN0ZW1hIGNvbSBzdWFzIGluZm9ybWHDp8O1ZXMgYsOhc2ljYXMsXG4gKiBjcmVkZW5jaWFpcyBkZSBhY2Vzc28gZSByZWxhY2lvbmFtZW50b3MgY29tIG91dHJhcyBlbnRpZGFkZXMuXG4gKi9cbkBFbnRpdHkoJ3VzdWFyaW8nKVxuQEluZGV4KFsnZW1haWwnXSwgeyB1bmlxdWU6IHRydWUgfSlcbkBJbmRleChbJ2NwZiddLCB7IHVuaXF1ZTogdHJ1ZSB9KVxuQEluZGV4KFsnbWF0cmljdWxhJ10sIHsgdW5pcXVlOiB0cnVlIH0pXG5ASW5kZXgoWydzdGF0dXMnXSlcbkBJbmRleChbJ3JvbGVfaWQnXSlcbkBJbmRleChbJ3VuaWRhZGVfaWQnXSlcbmV4cG9ydCBjbGFzcyBVc3VhcmlvIHtcbiAgQFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4oJ3V1aWQnKVxuICBpZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyBsZW5ndGg6IDI1NSB9KVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdOb21lIMOpIG9icmlnYXTDs3JpbycgfSlcbiAgQElzU3RyaW5nKHsgbWVzc2FnZTogJ05vbWUgZGV2ZSBzZXIgdW1hIHN0cmluZycgfSlcbiAgQE1pbkxlbmd0aCgyLCB7IG1lc3NhZ2U6ICdOb21lIGRldmUgdGVyIG5vIG3DrW5pbW8gMiBjYXJhY3RlcmVzJyB9KVxuICBATWF4TGVuZ3RoKDI1NSwgeyBtZXNzYWdlOiAnTm9tZSBkZXZlIHRlciBubyBtw6F4aW1vIDI1NSBjYXJhY3RlcmVzJyB9KVxuICBub21lOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHVuaXF1ZTogdHJ1ZSwgbGVuZ3RoOiAyNTUgfSlcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnRW1haWwgw6kgb2JyaWdhdMOzcmlvJyB9KVxuICBASXNFbWFpbCh7fSwgeyBtZXNzYWdlOiAnRW1haWwgZGV2ZSB0ZXIgdW0gZm9ybWF0byB2w6FsaWRvJyB9KVxuICBATWF4TGVuZ3RoKDI1NSwgeyBtZXNzYWdlOiAnRW1haWwgZGV2ZSB0ZXIgbm8gbcOheGltbyAyNTUgY2FyYWN0ZXJlcycgfSlcbiAgZW1haWw6IHN0cmluZztcblxuICBAQ29sdW1uKHsgbmFtZTogJ3NlbmhhX2hhc2gnIH0pXG4gIEBFeGNsdWRlKClcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnU2VuaGEgw6kgb2JyaWdhdMOzcmlhJyB9KVxuICBASXNTdHJpbmcoeyBtZXNzYWdlOiAnU2VuaGEgZGV2ZSBzZXIgdW1hIHN0cmluZycgfSlcbiAgQFZhbGlkYXRlKElzU3Ryb25nUGFzc3dvcmQsIHtcbiAgICBtZXNzYWdlOiAnU2VuaGEgZGV2ZSB0ZXIgbm8gbcOtbmltbyA4IGNhcmFjdGVyZXMsIGluY2x1aW5kbyBtYWnDunNjdWxhLCBtaW7DunNjdWxhLCBuw7ptZXJvIGUgY2FyYWN0ZXJlIGVzcGVjaWFsJ1xuICB9KVxuICBzZW5oYUhhc2g6IHN0cmluZztcblxuICBAQ29sdW1uKHsgdW5pcXVlOiB0cnVlLCBsZW5ndGg6IDExIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ0NQRiDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc1N0cmluZyh7IG1lc3NhZ2U6ICdDUEYgZGV2ZSBzZXIgdW1hIHN0cmluZycgfSlcbiAgQExlbmd0aCgxMSwgMTEsIHsgbWVzc2FnZTogJ0NQRiBkZXZlIHRlciBleGF0YW1lbnRlIDExIGNhcmFjdGVyZXMnIH0pXG4gIEBWYWxpZGF0ZShJc0NQRiwgeyBtZXNzYWdlOiAnQ1BGIGludsOhbGlkbycgfSlcbiAgY3BmOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IG51bGxhYmxlOiB0cnVlLCBsZW5ndGg6IDE1IH0pXG4gIEBJc09wdGlvbmFsKClcbiAgQElzU3RyaW5nKHsgbWVzc2FnZTogJ1RlbGVmb25lIGRldmUgc2VyIHVtYSBzdHJpbmcnIH0pXG4gIEBNYXhMZW5ndGgoMTUsIHsgbWVzc2FnZTogJ1RlbGVmb25lIGRldmUgdGVyIG5vIG3DoXhpbW8gMTUgY2FyYWN0ZXJlcycgfSlcbiAgQFZhbGlkYXRlKElzVGVsZWZvbmUsIHsgbWVzc2FnZTogJ1RlbGVmb25lIGludsOhbGlkbycgfSlcbiAgdGVsZWZvbmU/OiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHVuaXF1ZTogdHJ1ZSwgbGVuZ3RoOiAyMCB9KVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdNYXRyw61jdWxhIMOpIG9icmlnYXTDs3JpYScgfSlcbiAgQElzU3RyaW5nKHsgbWVzc2FnZTogJ01hdHLDrWN1bGEgZGV2ZSBzZXIgdW1hIHN0cmluZycgfSlcbiAgQE1pbkxlbmd0aCgzLCB7IG1lc3NhZ2U6ICdNYXRyw61jdWxhIGRldmUgdGVyIG5vIG3DrW5pbW8gMyBjYXJhY3RlcmVzJyB9KVxuICBATWF4TGVuZ3RoKDIwLCB7IG1lc3NhZ2U6ICdNYXRyw61jdWxhIGRldmUgdGVyIG5vIG3DoXhpbW8gMjAgY2FyYWN0ZXJlcycgfSlcbiAgbWF0cmljdWxhOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IG5hbWU6ICdyb2xlX2lkJywgbnVsbGFibGU6IHRydWUgfSlcbiAgcm9sZV9pZDogc3RyaW5nO1xuXG4gIEBNYW55VG9PbmUoKCkgPT4gUm9sZSwgKHJvbGUpID0+IHJvbGUudXN1YXJpb3MsIHtcbiAgICBudWxsYWJsZTogZmFsc2UsXG4gICAgZWFnZXI6IGZhbHNlXG4gIH0pXG4gIEBKb2luQ29sdW1uKHsgbmFtZTogJ3JvbGVfaWQnIH0pXG4gIHJvbGU6IFJvbGU7XG5cbiAgQENvbHVtbih7IG5hbWU6ICd1bmlkYWRlX2lkJywgbnVsbGFibGU6IHRydWUgfSlcbiAgdW5pZGFkZV9pZDogc3RyaW5nO1xuXG4gIEBNYW55VG9PbmUoKCkgPT4gVW5pZGFkZSwgKHVuaWRhZGUpID0+IHVuaWRhZGUudXN1YXJpb3MsIHtcbiAgICBudWxsYWJsZTogdHJ1ZSxcbiAgICBlYWdlcjogZmFsc2VcbiAgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAndW5pZGFkZV9pZCcgfSlcbiAgdW5pZGFkZTogVW5pZGFkZTtcblxuICBAQ29sdW1uKHsgbmFtZTogJ3NldG9yX2lkJywgbnVsbGFibGU6IHRydWUgfSlcbiAgc2V0b3JfaWQ6IHN0cmluZztcblxuICBATWFueVRvT25lKCgpID0+IFNldG9yLCAoc2V0b3IpID0+IHNldG9yLnVzdWFyaW9zLCB7XG4gICAgbnVsbGFibGU6IHRydWUsXG4gICAgZWFnZXI6IGZhbHNlXG4gIH0pXG4gIEBKb2luQ29sdW1uKHsgbmFtZTogJ3NldG9yX2lkJyB9KVxuICBzZXRvcjogU2V0b3I7XG5cbiAgQENvbHVtbih7XG4gICAgdHlwZTogJ2VudW0nLFxuICAgIGVudW06IFN0YXR1cyxcbiAgICBkZWZhdWx0OiBTdGF0dXMuQVRJVk8sXG4gICAgZW51bU5hbWU6ICdzdGF0dXNfdXN1YXJpbydcbiAgfSlcbiAgQElzT3B0aW9uYWwoKVxuICBASXNFbnVtKFN0YXR1cywgeyBtZXNzYWdlOiAnU3RhdHVzIGRldmUgc2VyIEFUSVZPIG91IElOQVRJVk8nIH0pXG4gIHN0YXR1czogU3RhdHVzO1xuXG4gIEBDb2x1bW4oeyBuYW1lOiAncHJpbWVpcm9fYWNlc3NvJywgZGVmYXVsdDogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIEBJc0Jvb2xlYW4oeyBtZXNzYWdlOiAnUHJpbWVpcm8gYWNlc3NvIGRldmUgc2VyIHVtIHZhbG9yIGJvb2xlYW5vJyB9KVxuICBwcmltZWlyb19hY2Vzc286IGJvb2xlYW47XG5cbiAgQENvbHVtbih7IG5hbWU6ICd0ZW50YXRpdmFzX2xvZ2luJywgZGVmYXVsdDogMCB9KVxuICBASXNPcHRpb25hbCgpXG4gIHRlbnRhdGl2YXNfbG9naW46IG51bWJlcjtcblxuICBAQ29sdW1uKHsgbmFtZTogJ3VsdGltb19sb2dpbicsIG51bGxhYmxlOiB0cnVlIH0pXG4gIEBJc09wdGlvbmFsKClcbiAgdWx0aW1vX2xvZ2luOiBEYXRlO1xuXG4gIEBPbmVUb01hbnkoKCkgPT4gUmVmcmVzaFRva2VuLCAocmVmcmVzaFRva2VuKSA9PiByZWZyZXNoVG9rZW4udXN1YXJpbywge1xuICAgIGNhc2NhZGU6IFsncmVtb3ZlJ10sXG4gICAgbGF6eTogdHJ1ZVxuICB9KVxuICByZWZyZXNoVG9rZW5zOiBSZWZyZXNoVG9rZW5bXTtcblxuICBAQ3JlYXRlRGF0ZUNvbHVtbih7IG5hbWU6ICdjcmVhdGVkX2F0JyB9KVxuICBjcmVhdGVkX2F0OiBEYXRlO1xuXG4gIEBVcGRhdGVEYXRlQ29sdW1uKHsgbmFtZTogJ3VwZGF0ZWRfYXQnIH0pXG4gIHVwZGF0ZWRfYXQ6IERhdGU7XG5cbiAgQERlbGV0ZURhdGVDb2x1bW4oeyBuYW1lOiAncmVtb3ZlZF9hdCcgfSlcbiAgcmVtb3ZlZF9hdDogRGF0ZTtcblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyB1c3XDoXJpbyBlc3TDoSBhdGl2b1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIG8gdXN1w6FyaW8gZXN0aXZlciBhdGl2b1xuICAgKi9cbiAgaXNBdGl2bygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFN0YXR1cy5BVElWTztcbiAgfVxuXG4gIC8qKlxuICAgKiBBdGl2YSBvIHVzdcOhcmlvXG4gICAqL1xuICBhdGl2YXIoKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0dXMgPSBTdGF0dXMuQVRJVk87XG4gIH1cblxuICAvKipcbiAgICogRGVzYXRpdmEgbyB1c3XDoXJpb1xuICAgKi9cbiAgZGVzYXRpdmFyKCk6IHZvaWQge1xuICAgIHRoaXMuc3RhdHVzID0gU3RhdHVzLklOQVRJVk87XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgbyBwcmltZWlybyBhY2Vzc28gZG8gdXN1w6FyaW9cbiAgICogQHJldHVybnMgdHJ1ZSBzZSBmb3IgbyBwcmltZWlybyBhY2Vzc29cbiAgICovXG4gIGlzUHJpbWVpcm9BY2Vzc28oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucHJpbWVpcm9fYWNlc3NvO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hcmNhIHF1ZSBvIHVzdcOhcmlvIGrDoSBmZXogbyBwcmltZWlybyBhY2Vzc29cbiAgICovXG4gIG1hcmNhclByaW1laXJvQWNlc3NvUmVhbGl6YWRvKCk6IHZvaWQge1xuICAgIHRoaXMucHJpbWVpcm9fYWNlc3NvID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIG8gbm9tZSBjb21wbGV0byBmb3JtYXRhZG9cbiAgICogQHJldHVybnMgbm9tZSBmb3JtYXRhZG9cbiAgICovXG4gIGdldE5vbWVGb3JtYXRhZG8oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5ub21lLnRyaW0oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBvIHVzdcOhcmlvIHBvZGUgc2VyIGRlbGV0YWRvXG4gICAqIEByZXR1cm5zIHRydWUgc2UgcG9kZSBzZXIgZGVsZXRhZG9cbiAgICovXG4gIHBvZGVTZXJEZWxldGFkbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFN0YXR1cy5JTkFUSVZPO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=