90946378e99ffc96b3459d83c580d014
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const logging_service_1 = require("../logging.service");
const nest_winston_1 = require("nest-winston");
/**
 * Testes unitários para o serviço de logging
 *
 * Verifica o funcionamento dos métodos de log em diferentes níveis
 * e com diferentes tipos de informações
 */
describe('LoggingService', () => {
    let service;
    // Mock do logger Winston
    const mockLogger = {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn(),
        debug: jest.fn(),
        verbose: jest.fn(),
    };
    beforeEach(async () => {
        jest.clearAllMocks();
        jest.spyOn(global, 'Date').mockImplementation(() => {
            return {
                toISOString: () => '2025-05-13T18:00:00.000Z',
            };
        });
        const module = await testing_1.Test.createTestingModule({
            providers: [
                logging_service_1.LoggingService,
                {
                    provide: nest_winston_1.WINSTON_MODULE_PROVIDER,
                    useValue: mockLogger,
                },
            ],
        }).compile();
        service = module.get(logging_service_1.LoggingService);
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
    it('deve ser definido', () => {
        expect(service).toBeDefined();
    });
    describe('info', () => {
        it('deve registrar uma mensagem de nível info', () => {
            const message = 'Mensagem de informação';
            const context = 'TestContext';
            const meta = { key: 'value' };
            service.info(message, context, meta);
            expect(mockLogger.info).toHaveBeenCalledWith(message, {
                context,
                key: 'value',
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
        it('deve lidar com chamadas sem contexto ou meta', () => {
            const message = 'Mensagem de informação';
            service.info(message);
            expect(mockLogger.info).toHaveBeenCalledWith(message, {
                context: undefined,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('error', () => {
        it('deve registrar uma mensagem de nível error com trace', () => {
            const message = 'Mensagem de erro';
            const trace = 'Stack trace';
            const context = 'TestContext';
            const meta = { key: 'value' };
            service.error(message, trace, context, meta);
            expect(mockLogger.error).toHaveBeenCalledWith(message, {
                trace,
                context,
                key: 'value',
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
        it('deve lidar com chamadas sem trace, contexto ou meta', () => {
            const message = 'Mensagem de erro';
            service.error(message);
            expect(mockLogger.error).toHaveBeenCalledWith(message, {
                trace: undefined,
                context: undefined,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('warn', () => {
        it('deve registrar uma mensagem de nível warn', () => {
            const message = 'Mensagem de aviso';
            const context = 'TestContext';
            const meta = { key: 'value' };
            service.warn(message, context, meta);
            expect(mockLogger.warn).toHaveBeenCalledWith(message, {
                context,
                key: 'value',
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('debug', () => {
        it('deve registrar uma mensagem de nível debug', () => {
            const message = 'Mensagem de debug';
            const context = 'TestContext';
            const meta = { key: 'value' };
            service.debug(message, context, meta);
            expect(mockLogger.debug).toHaveBeenCalledWith(message, {
                context,
                key: 'value',
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('verbose', () => {
        it('deve registrar uma mensagem de nível verbose', () => {
            const message = 'Mensagem verbose';
            const context = 'TestContext';
            const meta = { key: 'value' };
            service.verbose(message, context, meta);
            expect(mockLogger.verbose).toHaveBeenCalledWith(message, {
                context,
                key: 'value',
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('logDatabase', () => {
        it('deve registrar uma operação de banco de dados', () => {
            const operation = 'INSERT';
            const entity = 'Usuario';
            const duration = 150;
            const query = 'INSERT INTO usuarios (nome, email) VALUES (?, ?)';
            service.logDatabase(operation, entity, duration, query);
            expect(mockLogger.debug).toHaveBeenCalledWith(`DB: ${operation} ${entity} - ${duration}ms`, {
                context: 'Database',
                operation,
                entity,
                duration,
                query,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
        it('deve lidar com chamadas sem query', () => {
            const operation = 'SELECT';
            const entity = 'Usuario';
            const duration = 50;
            service.logDatabase(operation, entity, duration);
            expect(mockLogger.debug).toHaveBeenCalledWith(`DB: ${operation} ${entity} - ${duration}ms`, {
                context: 'Database',
                operation,
                entity,
                duration,
                query: undefined,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('logAuth', () => {
        it('deve registrar uma operação de autenticação bem-sucedida', () => {
            const operation = 'LOGIN';
            const userId = 'user-123';
            const success = true;
            const ip = '192.168.1.1';
            const userAgent = 'Mozilla/5.0';
            service.logAuth(operation, userId, success, ip, userAgent);
            expect(mockLogger.info).toHaveBeenCalledWith(`Auth: ${operation} - Usuário: ${userId} - Sucesso: ${success}`, {
                context: 'Authentication',
                operation,
                userId,
                success,
                ip,
                userAgent,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
        it('deve registrar uma operação de autenticação sem sucesso', () => {
            const operation = 'LOGIN';
            const userId = 'user-123';
            const success = false;
            service.logAuth(operation, userId, success);
            expect(mockLogger.info).toHaveBeenCalledWith(`Auth: ${operation} - Usuário: ${userId} - Sucesso: ${success}`, {
                context: 'Authentication',
                operation,
                userId,
                success,
                ip: undefined,
                userAgent: undefined,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
    describe('logBusiness', () => {
        it('deve registrar uma operação de negócio com detalhes', () => {
            const operation = 'APROVAR';
            const entity = 'Solicitacao';
            const entityId = 'solicitacao-123';
            const userId = 'user-123';
            const details = { motivo: 'Documentação completa', status: 'APROVADO' };
            service.logBusiness(operation, entity, entityId, userId, details);
            expect(mockLogger.info).toHaveBeenCalledWith(`Business: ${operation} ${entity} ${entityId} - Usuário: ${userId}`, {
                context: 'Business',
                operation,
                entity,
                entityId,
                userId,
                details,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
        it('deve registrar uma operação de negócio sem detalhes', () => {
            const operation = 'VISUALIZAR';
            const entity = 'Beneficio';
            const entityId = 'beneficio-123';
            const userId = 'user-123';
            service.logBusiness(operation, entity, entityId, userId);
            expect(mockLogger.info).toHaveBeenCalledWith(`Business: ${operation} ${entity} ${entityId} - Usuário: ${userId}`, {
                context: 'Business',
                operation,
                entity,
                entityId,
                userId,
                details: undefined,
                timestamp: '2025-05-13T18:00:00.000Z',
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxcbG9nZ2luZ1xcdGVzdHNcXGxvZ2dpbmcuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELHdEQUFvRDtBQUNwRCwrQ0FBdUQ7QUFFdkQ7Ozs7O0dBS0c7QUFDSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUksT0FBdUIsQ0FBQztJQUU1Qix5QkFBeUI7SUFDekIsTUFBTSxVQUFVLEdBQUc7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ25CLENBQUM7SUFFRixVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRTtZQUNqRCxPQUFPO2dCQUNMLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQywwQkFBMEI7YUFDM0IsQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sTUFBTSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUMzRCxTQUFTLEVBQUU7Z0JBQ1QsZ0NBQWM7Z0JBQ2Q7b0JBQ0UsT0FBTyxFQUFFLHNDQUF1QjtvQkFDaEMsUUFBUSxFQUFFLFVBQVU7aUJBQ3JCO2FBQ0Y7U0FDRixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixPQUFPLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBaUIs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Q1AsU0FBUyxFQUFFLDBCQUEwQjthQUN0QyxDQUNGLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRSxHQUFHLEVBQUU7WUFDN0QsTUFBTSxTQUFTLEdBQUcsWUFBWSxDQUFDO1lBQy9CLE1BQU0sTUFBTSxHQUFHLFdBQVcsQ0FBQztZQUMzQixNQUFNLFFBQVEsR0FBRyxlQUFlLENBQUM7WUFDakMsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDO1lBRTFCLE9BQU8sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFFekQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FDMUMsYUFBYSxTQUFTLElBQUksTUFBTSxJQUFJLFFBQVEsZUFBZSxNQUFNLEVBQUUsRUFDbkU7Z0JBQ0UsT0FBTyxFQUFFLFVBQVU7Z0JBQ25CLFNBQVM7Z0JBQ1QsTUFBTTtnQkFDTixRQUFRO2dCQUNSLE1BQU07Z0JBQ04sT0FBTyxFQUFFLFNBQVM7Z0JBQ2xCLFNBQVMsRUFBRSwwQkFBMEI7YUFDdEMsQ0FDRixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxzaGFyZWRcXGxvZ2dpbmdcXHRlc3RzXFxsb2dnaW5nLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IExvZ2dpbmdTZXJ2aWNlIH0gZnJvbSAnLi4vbG9nZ2luZy5zZXJ2aWNlJztcbmltcG9ydCB7IFdJTlNUT05fTU9EVUxFX1BST1ZJREVSIH0gZnJvbSAnbmVzdC13aW5zdG9uJztcblxuLyoqXG4gKiBUZXN0ZXMgdW5pdMOhcmlvcyBwYXJhIG8gc2VydmnDp28gZGUgbG9nZ2luZ1xuICpcbiAqIFZlcmlmaWNhIG8gZnVuY2lvbmFtZW50byBkb3MgbcOpdG9kb3MgZGUgbG9nIGVtIGRpZmVyZW50ZXMgbsOtdmVpc1xuICogZSBjb20gZGlmZXJlbnRlcyB0aXBvcyBkZSBpbmZvcm1hw6fDtWVzXG4gKi9cbmRlc2NyaWJlKCdMb2dnaW5nU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IExvZ2dpbmdTZXJ2aWNlO1xuXG4gIC8vIE1vY2sgZG8gbG9nZ2VyIFdpbnN0b25cbiAgY29uc3QgbW9ja0xvZ2dlciA9IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKSxcbiAgICB2ZXJib3NlOiBqZXN0LmZuKCksXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgamVzdC5zcHlPbihnbG9iYWwsICdEYXRlJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvSVNPU3RyaW5nOiAoKSA9PiAnMjAyNS0wNS0xM1QxODowMDowMC4wMDBaJyxcbiAgICAgIH0gYXMgdW5rbm93biBhcyBEYXRlO1xuICAgIH0pO1xuXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBMb2dnaW5nU2VydmljZSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFdJTlNUT05fTU9EVUxFX1BST1ZJREVSLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrTG9nZ2VyLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxMb2dnaW5nU2VydmljZT4oTG9nZ2luZ1NlcnZpY2UpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdkZXZlIHNlciBkZWZpbmlkbycsICgpID0+IHtcbiAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2luZm8nLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVnaXN0cmFyIHVtYSBtZW5zYWdlbSBkZSBuw612ZWwgaW5mbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSAnTWVuc2FnZW0gZGUgaW5mb3JtYcOnw6NvJztcbiAgICAgIGNvbnN0IGNvbnRleHQgPSAnVGVzdENvbnRleHQnO1xuICAgICAgY29uc3QgbWV0YSA9IHsga2V5OiAndmFsdWUnIH07XG5cbiAgICAgIHNlcnZpY2UuaW5mbyhtZXNzYWdlLCBjb250ZXh0LCBtZXRhKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgobWVzc2FnZSwge1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBrZXk6ICd2YWx1ZScsXG4gICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxpZGFyIGNvbSBjaGFtYWRhcyBzZW0gY29udGV4dG8gb3UgbWV0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSAnTWVuc2FnZW0gZGUgaW5mb3JtYcOnw6NvJztcblxuICAgICAgc2VydmljZS5pbmZvKG1lc3NhZ2UpO1xuXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5pbmZvKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtZXNzYWdlLCB7XG4gICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgdGltZXN0YW1wOiAnMjAyNS0wNS0xM1QxODowMDowMC4wMDBaJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVnaXN0cmFyIHVtYSBtZW5zYWdlbSBkZSBuw612ZWwgZXJyb3IgY29tIHRyYWNlJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9ICdNZW5zYWdlbSBkZSBlcnJvJztcbiAgICAgIGNvbnN0IHRyYWNlID0gJ1N0YWNrIHRyYWNlJztcbiAgICAgIGNvbnN0IGNvbnRleHQgPSAnVGVzdENvbnRleHQnO1xuICAgICAgY29uc3QgbWV0YSA9IHsga2V5OiAndmFsdWUnIH07XG5cbiAgICAgIHNlcnZpY2UuZXJyb3IobWVzc2FnZSwgdHJhY2UsIGNvbnRleHQsIG1ldGEpO1xuXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgobWVzc2FnZSwge1xuICAgICAgICB0cmFjZSxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAga2V5OiAndmFsdWUnLFxuICAgICAgICB0aW1lc3RhbXA6ICcyMDI1LTA1LTEzVDE4OjAwOjAwLjAwMFonLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsaWRhciBjb20gY2hhbWFkYXMgc2VtIHRyYWNlLCBjb250ZXh0byBvdSBtZXRhJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9ICdNZW5zYWdlbSBkZSBlcnJvJztcblxuICAgICAgc2VydmljZS5lcnJvcihtZXNzYWdlKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1lc3NhZ2UsIHtcbiAgICAgICAgdHJhY2U6IHVuZGVmaW5lZCxcbiAgICAgICAgY29udGV4dDogdW5kZWZpbmVkLFxuICAgICAgICB0aW1lc3RhbXA6ICcyMDI1LTA1LTEzVDE4OjAwOjAwLjAwMFonLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd3YXJuJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJlZ2lzdHJhciB1bWEgbWVuc2FnZW0gZGUgbsOtdmVsIHdhcm4nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gJ01lbnNhZ2VtIGRlIGF2aXNvJztcbiAgICAgIGNvbnN0IGNvbnRleHQgPSAnVGVzdENvbnRleHQnO1xuICAgICAgY29uc3QgbWV0YSA9IHsga2V5OiAndmFsdWUnIH07XG5cbiAgICAgIHNlcnZpY2Uud2FybihtZXNzYWdlLCBjb250ZXh0LCBtZXRhKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIud2FybikudG9IYXZlQmVlbkNhbGxlZFdpdGgobWVzc2FnZSwge1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBrZXk6ICd2YWx1ZScsXG4gICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2RlYnVnJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJlZ2lzdHJhciB1bWEgbWVuc2FnZW0gZGUgbsOtdmVsIGRlYnVnJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9ICdNZW5zYWdlbSBkZSBkZWJ1Zyc7XG4gICAgICBjb25zdCBjb250ZXh0ID0gJ1Rlc3RDb250ZXh0JztcbiAgICAgIGNvbnN0IG1ldGEgPSB7IGtleTogJ3ZhbHVlJyB9O1xuXG4gICAgICBzZXJ2aWNlLmRlYnVnKG1lc3NhZ2UsIGNvbnRleHQsIG1ldGEpO1xuXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5kZWJ1ZykudG9IYXZlQmVlbkNhbGxlZFdpdGgobWVzc2FnZSwge1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBrZXk6ICd2YWx1ZScsXG4gICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZlcmJvc2UnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVnaXN0cmFyIHVtYSBtZW5zYWdlbSBkZSBuw612ZWwgdmVyYm9zZScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSAnTWVuc2FnZW0gdmVyYm9zZSc7XG4gICAgICBjb25zdCBjb250ZXh0ID0gJ1Rlc3RDb250ZXh0JztcbiAgICAgIGNvbnN0IG1ldGEgPSB7IGtleTogJ3ZhbHVlJyB9O1xuXG4gICAgICBzZXJ2aWNlLnZlcmJvc2UobWVzc2FnZSwgY29udGV4dCwgbWV0YSk7XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLnZlcmJvc2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1lc3NhZ2UsIHtcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAga2V5OiAndmFsdWUnLFxuICAgICAgICB0aW1lc3RhbXA6ICcyMDI1LTA1LTEzVDE4OjAwOjAwLjAwMFonLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdsb2dEYXRhYmFzZScsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZWdpc3RyYXIgdW1hIG9wZXJhw6fDo28gZGUgYmFuY28gZGUgZGFkb3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVyYXRpb24gPSAnSU5TRVJUJztcbiAgICAgIGNvbnN0IGVudGl0eSA9ICdVc3VhcmlvJztcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gMTUwO1xuICAgICAgY29uc3QgcXVlcnkgPSAnSU5TRVJUIElOVE8gdXN1YXJpb3MgKG5vbWUsIGVtYWlsKSBWQUxVRVMgKD8sID8pJztcblxuICAgICAgc2VydmljZS5sb2dEYXRhYmFzZShvcGVyYXRpb24sIGVudGl0eSwgZHVyYXRpb24sIHF1ZXJ5KTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZGVidWcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgREI6ICR7b3BlcmF0aW9ufSAke2VudGl0eX0gLSAke2R1cmF0aW9ufW1zYCxcbiAgICAgICAge1xuICAgICAgICAgIGNvbnRleHQ6ICdEYXRhYmFzZScsXG4gICAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICAgIGVudGl0eSxcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICB0aW1lc3RhbXA6ICcyMDI1LTA1LTEzVDE4OjAwOjAwLjAwMFonLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxpZGFyIGNvbSBjaGFtYWRhcyBzZW0gcXVlcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVyYXRpb24gPSAnU0VMRUNUJztcbiAgICAgIGNvbnN0IGVudGl0eSA9ICdVc3VhcmlvJztcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gNTA7XG5cbiAgICAgIHNlcnZpY2UubG9nRGF0YWJhc2Uob3BlcmF0aW9uLCBlbnRpdHksIGR1cmF0aW9uKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZGVidWcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgREI6ICR7b3BlcmF0aW9ufSAke2VudGl0eX0gLSAke2R1cmF0aW9ufW1zYCxcbiAgICAgICAge1xuICAgICAgICAgIGNvbnRleHQ6ICdEYXRhYmFzZScsXG4gICAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICAgIGVudGl0eSxcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBxdWVyeTogdW5kZWZpbmVkLFxuICAgICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbG9nQXV0aCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZWdpc3RyYXIgdW1hIG9wZXJhw6fDo28gZGUgYXV0ZW50aWNhw6fDo28gYmVtLXN1Y2VkaWRhJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3BlcmF0aW9uID0gJ0xPR0lOJztcbiAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyLTEyMyc7XG4gICAgICBjb25zdCBzdWNjZXNzID0gdHJ1ZTtcbiAgICAgIGNvbnN0IGlwID0gJzE5Mi4xNjguMS4xJztcbiAgICAgIGNvbnN0IHVzZXJBZ2VudCA9ICdNb3ppbGxhLzUuMCc7XG5cbiAgICAgIHNlcnZpY2UubG9nQXV0aChvcGVyYXRpb24sIHVzZXJJZCwgc3VjY2VzcywgaXAsIHVzZXJBZ2VudCk7XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgQXV0aDogJHtvcGVyYXRpb259IC0gVXN1w6FyaW86ICR7dXNlcklkfSAtIFN1Y2Vzc286ICR7c3VjY2Vzc31gLFxuICAgICAgICB7XG4gICAgICAgICAgY29udGV4dDogJ0F1dGhlbnRpY2F0aW9uJyxcbiAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHN1Y2Nlc3MsXG4gICAgICAgICAgaXAsXG4gICAgICAgICAgdXNlckFnZW50LFxuICAgICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVnaXN0cmFyIHVtYSBvcGVyYcOnw6NvIGRlIGF1dGVudGljYcOnw6NvIHNlbSBzdWNlc3NvJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3BlcmF0aW9uID0gJ0xPR0lOJztcbiAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyLTEyMyc7XG4gICAgICBjb25zdCBzdWNjZXNzID0gZmFsc2U7XG5cbiAgICAgIHNlcnZpY2UubG9nQXV0aChvcGVyYXRpb24sIHVzZXJJZCwgc3VjY2Vzcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgQXV0aDogJHtvcGVyYXRpb259IC0gVXN1w6FyaW86ICR7dXNlcklkfSAtIFN1Y2Vzc286ICR7c3VjY2Vzc31gLFxuICAgICAgICB7XG4gICAgICAgICAgY29udGV4dDogJ0F1dGhlbnRpY2F0aW9uJyxcbiAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHN1Y2Nlc3MsXG4gICAgICAgICAgaXA6IHVuZGVmaW5lZCxcbiAgICAgICAgICB1c2VyQWdlbnQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICB0aW1lc3RhbXA6ICcyMDI1LTA1LTEzVDE4OjAwOjAwLjAwMFonLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvZ0J1c2luZXNzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJlZ2lzdHJhciB1bWEgb3BlcmHDp8OjbyBkZSBuZWfDs2NpbyBjb20gZGV0YWxoZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVyYXRpb24gPSAnQVBST1ZBUic7XG4gICAgICBjb25zdCBlbnRpdHkgPSAnU29saWNpdGFjYW8nO1xuICAgICAgY29uc3QgZW50aXR5SWQgPSAnc29saWNpdGFjYW8tMTIzJztcbiAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyLTEyMyc7XG4gICAgICBjb25zdCBkZXRhaWxzID0geyBtb3Rpdm86ICdEb2N1bWVudGHDp8OjbyBjb21wbGV0YScsIHN0YXR1czogJ0FQUk9WQURPJyB9O1xuXG4gICAgICBzZXJ2aWNlLmxvZ0J1c2luZXNzKG9wZXJhdGlvbiwgZW50aXR5LCBlbnRpdHlJZCwgdXNlcklkLCBkZXRhaWxzKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBCdXNpbmVzczogJHtvcGVyYXRpb259ICR7ZW50aXR5fSAke2VudGl0eUlkfSAtIFVzdcOhcmlvOiAke3VzZXJJZH1gLFxuICAgICAgICB7XG4gICAgICAgICAgY29udGV4dDogJ0J1c2luZXNzJyxcbiAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgZW50aXR5LFxuICAgICAgICAgIGVudGl0eUlkLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBkZXRhaWxzLFxuICAgICAgICAgIHRpbWVzdGFtcDogJzIwMjUtMDUtMTNUMTg6MDA6MDAuMDAwWicsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVnaXN0cmFyIHVtYSBvcGVyYcOnw6NvIGRlIG5lZ8OzY2lvIHNlbSBkZXRhbGhlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG9wZXJhdGlvbiA9ICdWSVNVQUxJWkFSJztcbiAgICAgIGNvbnN0IGVudGl0eSA9ICdCZW5lZmljaW8nO1xuICAgICAgY29uc3QgZW50aXR5SWQgPSAnYmVuZWZpY2lvLTEyMyc7XG4gICAgICBjb25zdCB1c2VySWQgPSAndXNlci0xMjMnO1xuXG4gICAgICBzZXJ2aWNlLmxvZ0J1c2luZXNzKG9wZXJhdGlvbiwgZW50aXR5LCBlbnRpdHlJZCwgdXNlcklkKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBCdXNpbmVzczogJHtvcGVyYXRpb259ICR7ZW50aXR5fSAke2VudGl0eUlkfSAtIFVzdcOhcmlvOiAke3VzZXJJZH1gLFxuICAgICAgICB7XG4gICAgICAgICAgY29udGV4dDogJ0J1c2luZXNzJyxcbiAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgZW50aXR5LFxuICAgICAgICAgIGVudGl0eUlkLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBkZXRhaWxzOiB1bmRlZmluZWQsXG4gICAgICAgICAgdGltZXN0YW1wOiAnMjAyNS0wNS0xM1QxODowMDowMC4wMDBaJyxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=