5ade63ce94ff208b78a20461bfa610d5
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ParametroConverter = void 0;
const enums_1 = require("../../../enums");
const exceptions_1 = require("../exceptions");
/**
 * Classe utilitária que fornece métodos para converter valores de parâmetros
 * entre string e seus tipos nativos correspondentes.
 */
class ParametroConverter {
    /**
     * Converte um valor de string para o tipo especificado.
     *
     * @param chave - Chave do parâmetro (usado para mensagens de erro)
     * @param valor - Valor em formato string
     * @param tipo - Tipo para o qual converter
     * @returns O valor convertido para o tipo especificado
     * @throws ParametroTipoInvalidoException se a conversão falhar
     */
    static paraValorTipado(chave, valor, tipo) {
        try {
            switch (tipo) {
                case enums_1.ParametroTipoEnum.STRING:
                    return valor;
                case enums_1.ParametroTipoEnum.NUMBER:
                    const numero = Number(valor);
                    if (isNaN(numero)) {
                        throw new exceptions_1.ParametroTipoInvalidoException(chave, valor, tipo);
                    }
                    return numero;
                case enums_1.ParametroTipoEnum.BOOLEAN:
                    if (valor.toLowerCase() === 'true') {
                        return true;
                    }
                    if (valor.toLowerCase() === 'false') {
                        return false;
                    }
                    if (valor === '1') {
                        return true;
                    }
                    if (valor === '0') {
                        return false;
                    }
                    throw new exceptions_1.ParametroTipoInvalidoException(chave, valor, tipo);
                case enums_1.ParametroTipoEnum.JSON:
                    return JSON.parse(valor);
                case enums_1.ParametroTipoEnum.DATE:
                    const data = new Date(valor);
                    if (isNaN(data.getTime())) {
                        throw new exceptions_1.ParametroTipoInvalidoException(chave, valor, tipo);
                    }
                    return data;
                default:
                    throw new exceptions_1.ParametroTipoInvalidoException(chave, valor, tipo);
            }
        }
        catch (error) {
            throw new exceptions_1.ParametroTipoInvalidoException(chave, valor, tipo);
        }
    }
    /**
     * Converte um valor de qualquer tipo para string para armazenamento.
     *
     * @param valor - Valor a ser convertido
     * @param tipo - Tipo original do valor
     * @returns O valor convertido para string
     */
    static paraString(valor, tipo) {
        if (valor === null || valor === undefined) {
            return '';
        }
        switch (tipo) {
            case enums_1.ParametroTipoEnum.STRING:
                return String(valor);
            case enums_1.ParametroTipoEnum.NUMBER:
                return String(valor);
            case enums_1.ParametroTipoEnum.BOOLEAN:
                return valor ? 'true' : 'false';
            case enums_1.ParametroTipoEnum.JSON:
                return JSON.stringify(valor);
            case enums_1.ParametroTipoEnum.DATE:
                if (valor instanceof Date) {
                    return valor.toISOString();
                }
                // Tenta converter para Date se não for uma instância
                const data = new Date(valor);
                if (isNaN(data.getTime())) {
                    return String(valor); // Fallback
                }
                return data.toISOString();
            default:
                return String(valor);
        }
    }
    /**
     * Verifica se um valor string pode ser convertido para o tipo especificado.
     *
     * @param valor - Valor em formato string
     * @param tipo - Tipo para o qual verificar a conversão
     * @returns true se o valor pode ser convertido, false caso contrário
     */
    static podeConverterPara(valor, tipo) {
        try {
            this.paraValorTipado('validação', valor, tipo);
            return true;
        }
        catch (error) {
            return false;
        }
    }
    /**
     * Formata um valor para exibição amigável, conforme seu tipo.
     *
     * @param valor - Valor a ser formatado
     * @param tipo - Tipo do valor
     * @returns String formatada para exibição
     */
    static formatarParaExibicao(valor, tipo) {
        if (valor === null || valor === undefined) {
            return '';
        }
        switch (tipo) {
            case enums_1.ParametroTipoEnum.DATE:
                if (valor instanceof Date) {
                    // Formato: DD/MM/YYYY HH:MM
                    return `${valor.getDate().toString().padStart(2, '0')}/${(valor.getMonth() + 1).toString().padStart(2, '0')}/${valor.getFullYear()} ${valor.getHours().toString().padStart(2, '0')}:${valor.getMinutes().toString().padStart(2, '0')}`;
                }
                return String(valor);
            case enums_1.ParametroTipoEnum.JSON:
                if (typeof valor === 'object') {
                    return JSON.stringify(valor, null, 2);
                }
                return String(valor);
            default:
                return String(valor);
        }
    }
}
exports.ParametroConverter = ParametroConverter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNvbmZpZ3VyYWNhb1xcdXRpbFxcY29udmVydGVycy50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSwwQ0FBbUQ7QUFDbkQsOENBQStEO0FBRS9EOzs7R0FHRztBQUNILE1BQWEsa0JBQWtCO0lBQzdCOzs7Ozs7OztPQVFHO0lBQ0gsTUFBTSxDQUFDLGVBQWUsQ0FDcEIsS0FBYSxFQUNiLEtBQWEsRUFDYixJQUF1QjtRQUV2QixJQUFJLENBQUM7WUFDSCxRQUFRLElBQUksRUFBRSxDQUFDO2dCQUNiLEtBQUsseUJBQWlCLENBQUMsTUFBTTtvQkFDM0IsT0FBTyxLQUFLLENBQUM7Z0JBRWYsS0FBSyx5QkFBaUIsQ0FBQyxNQUFNO29CQUMzQixNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQzdCLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7d0JBQ2xCLE1BQU0sSUFBSSwyQ0FBOEIsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUMvRCxDQUFDO29CQUNELE9BQU8sTUFBTSxDQUFDO2dCQUVoQixLQUFLLHlCQUFpQixDQUFDLE9BQU87b0JBQzVCLElBQUksS0FBSyxDQUFDLFdBQVcsRUFBRSxLQUFLLE1BQU0sRUFBRSxDQUFDO3dCQUNuQyxPQUFPLElBQUksQ0FBQztvQkFDZCxDQUFDO29CQUNELElBQUksS0FBSyxDQUFDLFdBQVcsRUFBRSxLQUFLLE9BQU8sRUFBRSxDQUFDO3dCQUNwQyxPQUFPLEtBQUssQ0FBQztvQkFDZixDQUFDO29CQUNELElBQUksS0FBSyxLQUFLLEdBQUcsRUFBRSxDQUFDO3dCQUNsQixPQUFPLElBQUksQ0FBQztvQkFDZCxDQUFDO29CQUNELElBQUksS0FBSyxLQUFLLEdBQUcsRUFBRSxDQUFDO3dCQUNsQixPQUFPLEtBQUssQ0FBQztvQkFD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UUFDWixDQUFDO1FBRUQsUUFBUSxJQUFJLEVBQUUsQ0FBQztZQUNiLEtBQUsseUJBQWlCLENBQUMsSUFBSTtnQkFDekIsSUFBSSxLQUFLLFlBQVksSUFBSSxFQUFFLENBQUM7b0JBQzFCLDRCQUE0QjtvQkFDNUIsT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLElBQUksS0FBSyxDQUFDLFdBQVcsRUFBRSxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUM7Z0JBQ3pPLENBQUM7Z0JBQ0QsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFdkIsS0FBSyx5QkFBaUIsQ0FBQyxJQUFJO2dCQUN6QixJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO29CQUM5QixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDeEMsQ0FBQztnQkFDRCxPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV2QjtnQkFDRSxPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN6QixDQUFDO0lBQ0gsQ0FBQztDQUNGO0FBcEpELGdEQW9KQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcY29uZmlndXJhY2FvXFx1dGlsXFxjb252ZXJ0ZXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhcmFtZXRyb1RpcG9FbnVtIH0gZnJvbSAnLi4vLi4vLi4vZW51bXMnO1xuaW1wb3J0IHsgUGFyYW1ldHJvVGlwb0ludmFsaWRvRXhjZXB0aW9uIH0gZnJvbSAnLi4vZXhjZXB0aW9ucyc7XG5cbi8qKlxuICogQ2xhc3NlIHV0aWxpdMOhcmlhIHF1ZSBmb3JuZWNlIG3DqXRvZG9zIHBhcmEgY29udmVydGVyIHZhbG9yZXMgZGUgcGFyw6JtZXRyb3NcbiAqIGVudHJlIHN0cmluZyBlIHNldXMgdGlwb3MgbmF0aXZvcyBjb3JyZXNwb25kZW50ZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBQYXJhbWV0cm9Db252ZXJ0ZXIge1xuICAvKipcbiAgICogQ29udmVydGUgdW0gdmFsb3IgZGUgc3RyaW5nIHBhcmEgbyB0aXBvIGVzcGVjaWZpY2Fkby5cbiAgICpcbiAgICogQHBhcmFtIGNoYXZlIC0gQ2hhdmUgZG8gcGFyw6JtZXRybyAodXNhZG8gcGFyYSBtZW5zYWdlbnMgZGUgZXJybylcbiAgICogQHBhcmFtIHZhbG9yIC0gVmFsb3IgZW0gZm9ybWF0byBzdHJpbmdcbiAgICogQHBhcmFtIHRpcG8gLSBUaXBvIHBhcmEgbyBxdWFsIGNvbnZlcnRlclxuICAgKiBAcmV0dXJucyBPIHZhbG9yIGNvbnZlcnRpZG8gcGFyYSBvIHRpcG8gZXNwZWNpZmljYWRvXG4gICAqIEB0aHJvd3MgUGFyYW1ldHJvVGlwb0ludmFsaWRvRXhjZXB0aW9uIHNlIGEgY29udmVyc8OjbyBmYWxoYXJcbiAgICovXG4gIHN0YXRpYyBwYXJhVmFsb3JUaXBhZG8oXG4gICAgY2hhdmU6IHN0cmluZyxcbiAgICB2YWxvcjogc3RyaW5nLFxuICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLFxuICApOiBhbnkge1xuICAgIHRyeSB7XG4gICAgICBzd2l0Y2ggKHRpcG8pIHtcbiAgICAgICAgY2FzZSBQYXJhbWV0cm9UaXBvRW51bS5TVFJJTkc6XG4gICAgICAgICAgcmV0dXJuIHZhbG9yO1xuXG4gICAgICAgIGNhc2UgUGFyYW1ldHJvVGlwb0VudW0uTlVNQkVSOlxuICAgICAgICAgIGNvbnN0IG51bWVybyA9IE51bWJlcih2YWxvcik7XG4gICAgICAgICAgaWYgKGlzTmFOKG51bWVybykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0cm9UaXBvSW52YWxpZG9FeGNlcHRpb24oY2hhdmUsIHZhbG9yLCB0aXBvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bWVybztcblxuICAgICAgICBjYXNlIFBhcmFtZXRyb1RpcG9FbnVtLkJPT0xFQU46XG4gICAgICAgICAgaWYgKHZhbG9yLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2YWxvci50b0xvd2VyQ2FzZSgpID09PSAnZmFsc2UnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2YWxvciA9PT0gJzEnKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZhbG9yID09PSAnMCcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRyb1RpcG9JbnZhbGlkb0V4Y2VwdGlvbihjaGF2ZSwgdmFsb3IsIHRpcG8pO1xuXG4gICAgICAgIGNhc2UgUGFyYW1ldHJvVGlwb0VudW0uSlNPTjpcbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh2YWxvcik7XG5cbiAgICAgICAgY2FzZSBQYXJhbWV0cm9UaXBvRW51bS5EQVRFOlxuICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgRGF0ZSh2YWxvcik7XG4gICAgICAgICAgaWYgKGlzTmFOKGRhdGEuZ2V0VGltZSgpKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRyb1RpcG9JbnZhbGlkb0V4Y2VwdGlvbihjaGF2ZSwgdmFsb3IsIHRpcG8pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0cm9UaXBvSW52YWxpZG9FeGNlcHRpb24oY2hhdmUsIHZhbG9yLCB0aXBvKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBhcmFtZXRyb1RpcG9JbnZhbGlkb0V4Y2VwdGlvbihjaGF2ZSwgdmFsb3IsIHRpcG8pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0ZSB1bSB2YWxvciBkZSBxdWFscXVlciB0aXBvIHBhcmEgc3RyaW5nIHBhcmEgYXJtYXplbmFtZW50by5cbiAgICpcbiAgICogQHBhcmFtIHZhbG9yIC0gVmFsb3IgYSBzZXIgY29udmVydGlkb1xuICAgKiBAcGFyYW0gdGlwbyAtIFRpcG8gb3JpZ2luYWwgZG8gdmFsb3JcbiAgICogQHJldHVybnMgTyB2YWxvciBjb252ZXJ0aWRvIHBhcmEgc3RyaW5nXG4gICAqL1xuICBzdGF0aWMgcGFyYVN0cmluZyh2YWxvcjogYW55LCB0aXBvOiBQYXJhbWV0cm9UaXBvRW51bSk6IHN0cmluZyB7XG4gICAgaWYgKHZhbG9yID09PSBudWxsIHx8IHZhbG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHRpcG8pIHtcbiAgICAgIGNhc2UgUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HOlxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbG9yKTtcblxuICAgICAgY2FzZSBQYXJhbWV0cm9UaXBvRW51bS5OVU1CRVI6XG4gICAgICAgIHJldHVybiBTdHJpbmcodmFsb3IpO1xuXG4gICAgICBjYXNlIFBhcmFtZXRyb1RpcG9FbnVtLkJPT0xFQU46XG4gICAgICAgIHJldHVybiB2YWxvciA/ICd0cnVlJyA6ICdmYWxzZSc7XG5cbiAgICAgIGNhc2UgUGFyYW1ldHJvVGlwb0VudW0uSlNPTjpcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbG9yKTtcblxuICAgICAgY2FzZSBQYXJhbWV0cm9UaXBvRW51bS5EQVRFOlxuICAgICAgICBpZiAodmFsb3IgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbG9yLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUZW50YSBjb252ZXJ0ZXIgcGFyYSBEYXRlIHNlIG7Do28gZm9yIHVtYSBpbnN0w6JuY2lhXG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgRGF0ZSh2YWxvcik7XG4gICAgICAgIGlmIChpc05hTihkYXRhLmdldFRpbWUoKSkpIHtcbiAgICAgICAgICByZXR1cm4gU3RyaW5nKHZhbG9yKTsgLy8gRmFsbGJhY2tcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YS50b0lTT1N0cmluZygpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbG9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgdW0gdmFsb3Igc3RyaW5nIHBvZGUgc2VyIGNvbnZlcnRpZG8gcGFyYSBvIHRpcG8gZXNwZWNpZmljYWRvLlxuICAgKlxuICAgKiBAcGFyYW0gdmFsb3IgLSBWYWxvciBlbSBmb3JtYXRvIHN0cmluZ1xuICAgKiBAcGFyYW0gdGlwbyAtIFRpcG8gcGFyYSBvIHF1YWwgdmVyaWZpY2FyIGEgY29udmVyc8Ojb1xuICAgKiBAcmV0dXJucyB0cnVlIHNlIG8gdmFsb3IgcG9kZSBzZXIgY29udmVydGlkbywgZmFsc2UgY2FzbyBjb250csOhcmlvXG4gICAqL1xuICBzdGF0aWMgcG9kZUNvbnZlcnRlclBhcmEodmFsb3I6IHN0cmluZywgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0pOiBib29sZWFuIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5wYXJhVmFsb3JUaXBhZG8oJ3ZhbGlkYcOnw6NvJywgdmFsb3IsIHRpcG8pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0YSB1bSB2YWxvciBwYXJhIGV4aWJpw6fDo28gYW1pZ8OhdmVsLCBjb25mb3JtZSBzZXUgdGlwby5cbiAgICpcbiAgICogQHBhcmFtIHZhbG9yIC0gVmFsb3IgYSBzZXIgZm9ybWF0YWRvXG4gICAqIEBwYXJhbSB0aXBvIC0gVGlwbyBkbyB2YWxvclxuICAgKiBAcmV0dXJucyBTdHJpbmcgZm9ybWF0YWRhIHBhcmEgZXhpYmnDp8Ojb1xuICAgKi9cbiAgc3RhdGljIGZvcm1hdGFyUGFyYUV4aWJpY2FvKHZhbG9yOiBhbnksIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtKTogc3RyaW5nIHtcbiAgICBpZiAodmFsb3IgPT09IG51bGwgfHwgdmFsb3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIHN3aXRjaCAodGlwbykge1xuICAgICAgY2FzZSBQYXJhbWV0cm9UaXBvRW51bS5EQVRFOlxuICAgICAgICBpZiAodmFsb3IgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgLy8gRm9ybWF0bzogREQvTU0vWVlZWSBISDpNTVxuICAgICAgICAgIHJldHVybiBgJHt2YWxvci5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfS8keyh2YWxvci5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfS8ke3ZhbG9yLmdldEZ1bGxZZWFyKCl9ICR7dmFsb3IuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7dmFsb3IuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBTdHJpbmcodmFsb3IpO1xuXG4gICAgICBjYXNlIFBhcmFtZXRyb1RpcG9FbnVtLkpTT046XG4gICAgICAgIGlmICh0eXBlb2YgdmFsb3IgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbG9yLCBudWxsLCAyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbG9yKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIFN0cmluZyh2YWxvcik7XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=