2f83bcd7c99620b616794fa84550c30f
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.DadosFuneralService = void 0;
const common_1 = require("@nestjs/common");
const typeorm_1 = require("@nestjs/typeorm");
const typeorm_2 = require("typeorm");
const dados_funeral_entity_1 = require("../../../entities/dados-funeral.entity");
/**
 * Serviço para gerenciar dados específicos de Auxílio Funeral
 */
let DadosFuneralService = class DadosFuneralService {
    dadosFuneralRepository;
    constructor(dadosFuneralRepository) {
        this.dadosFuneralRepository = dadosFuneralRepository;
    }
    /**
     * Criar dados de funeral para uma solicitação
     */
    async create(createDto) {
        // Verificar se já existem dados para esta solicitação
        const existingData = await this.dadosFuneralRepository.findOne({
            where: { solicitacao_id: createDto.solicitacao_id },
        });
        if (existingData) {
            throw new Error('Já existem dados de funeral para esta solicitação');
        }
        const dadosFuneral = this.dadosFuneralRepository.create(createDto);
        return this.dadosFuneralRepository.save(dadosFuneral);
    }
    /**
     * Buscar dados de funeral por ID
     */
    async findOne(id) {
        const dadosFuneral = await this.dadosFuneralRepository.findOne({
            where: { id },
            relations: ['solicitacao'],
        });
        if (!dadosFuneral) {
            throw new common_1.NotFoundException('Dados de funeral não encontrados');
        }
        return dadosFuneral;
    }
    /**
     * Buscar dados de funeral por solicitação
     */
    async findBySolicitacao(solicitacaoId) {
        const dadosFuneral = await this.dadosFuneralRepository.findOne({
            where: { solicitacao_id: solicitacaoId },
            relations: ['solicitacao'],
        });
        if (!dadosFuneral) {
            throw new common_1.NotFoundException('Dados de funeral não encontrados para esta solicitação');
        }
        return dadosFuneral;
    }
    /**
     * Atualizar dados de funeral
     */
    async update(id, updateDto) {
        const dadosFuneral = await this.findOne(id);
        // Atualizar apenas os campos fornecidos
        Object.assign(dadosFuneral, updateDto);
        return this.dadosFuneralRepository.save(dadosFuneral);
    }
    /**
     * Remover dados de funeral
     */
    async remove(id) {
        const dadosFuneral = await this.findOne(id);
        await this.dadosFuneralRepository.remove(dadosFuneral);
    }
    /**
     * Verificar se existem dados de funeral para uma solicitação
     */
    async existsBySolicitacao(solicitacaoId) {
        const count = await this.dadosFuneralRepository.count({
            where: { solicitacao_id: solicitacaoId },
        });
        return count > 0;
    }
    /**
     * Buscar todos os dados de funeral com paginação
     */
    async findAll(page = 1, limit = 10) {
        const [data, total] = await this.dadosFuneralRepository.findAndCount({
            relations: ['solicitacao'],
            skip: (page - 1) * limit,
            take: limit,
            order: { created_at: 'DESC' },
        });
        return {
            data,
            total,
            page,
            limit,
        };
    }
    /**
     * Buscar dados por grau de parentesco
     */
    async findByGrauParentesco(grauParentesco, page = 1, limit = 10) {
        const [data, total] = await this.dadosFuneralRepository.findAndCount({
            where: { grau_parentesco_requerente: grauParentesco },
            relations: ['solicitacao'],
            skip: (page - 1) * limit,
            take: limit,
            order: { created_at: 'DESC' },
        });
        return {
            data,
            total,
            page,
            limit,
        };
    }
    /**
     * Buscar dados por período de óbito
     */
    async findByPeriodoObito(dataInicio, dataFim, page = 1, limit = 10) {
        const [data, total] = await this.dadosFuneralRepository.findAndCount({
            where: {
                data_obito: {
                    gte: dataInicio,
                    lte: dataFim,
                },
            },
            relations: ['solicitacao'],
            skip: (page - 1) * limit,
            take: limit,
            order: { data_obito: 'DESC' },
        });
        return {
            data,
            total,
            page,
            limit,
        };
    }
};
exports.DadosFuneralService = DadosFuneralService;
exports.DadosFuneralService = DadosFuneralService = __decorate([
    (0, common_1.Injectable)(),
    __param(0, (0, typeorm_1.InjectRepository)(dados_funeral_entity_1.DadosFuneral)),
    __metadata("design:paramtypes", [typeof (_a = typeof typeorm_2.Repository !== "undefined" && typeorm_2.Repository) === "function" ? _a : Object])
], DadosFuneralService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGJlbmVmaWNpb1xcc2VydmljZXNcXGRhZG9zLWZ1bmVyYWwuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQStEO0FBQy9ELDZDQUFtRDtBQUNuRCxxQ0FBcUM7QUFDckMsaUZBQXNFO0FBTXRFOztHQUVHO0FBRUksSUFBTSxtQkFBbUIsR0FBekIsTUFBTSxtQkFBbUI7SUFHWDtJQUZuQixZQUVtQixzQkFBZ0Q7UUFBaEQsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUEwQjtJQUNoRSxDQUFDO0lBRUo7O09BRUc7SUFDSCxLQUFLLENBQUMsTUFBTSxDQUFDLFNBQWdDO1FBQzNDLHNEQUFzRDtRQUN0RCxNQUFNLFlBQVksR0FBRyxNQUFNLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxPQUFPLENBQUM7WUFDN0QsS0FBSyxFQUFFLEVBQUUsY0FBYyxFQUFFLFNBQVMsQ0FBQyxjQUFjLEVBQUU7U0FDcEQsQ0FBQyxDQUFDO1FBRUgsSUFBSSxZQUFZLEVBQUUsQ0FBQztZQUNqQixNQUFNLElBQUksS0FBSyxDQUFDLG1EQUFtRCxDQUFDLENBQUM7UUFDdkUsQ0FBQztRQUVELE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDbkUsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRDs7T0FFRztJQUNILEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBVTtRQUN0QixNQUFNLFlBQVksR0FBRyxNQUFNLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxPQUFPLENBQUM7WUFDN0QsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFO1lBQ2IsU0FBUyxFQUFFLENBQUMsYUFBYSxDQUFDO1NBQzNCLENBQUMsQ0FB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QUs7WUFDTCxJQUFJO1lBQ0osS0FBSztTQUNOLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsa0JBQWtCLENBQ3RCLFVBQWdCLEVBQ2hCLE9BQWEsRUFDYixPQUFlLENBQUMsRUFDaEIsUUFBZ0IsRUFBRTtRQU9sQixNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxHQUFHLE1BQU0sSUFBSSxDQUFDLHNCQUFzQixDQUFDLFlBQVksQ0FBQztZQUNuRSxLQUFLLEVBQUU7Z0JBQ0wsVUFBVSxFQUFFO29CQUNWLEdBQUcsRUFBRSxVQUFVO29CQUNmLEdBQUcsRUFBRSxPQUFPO2lCQUNOO2FBQ1Q7WUFDRCxTQUFTLEVBQUUsQ0FBQyxhQUFhLENBQUM7WUFDMUIsSUFBSSxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUs7WUFDeEIsSUFBSSxFQUFFLEtBQUs7WUFDWCxLQUFLLEVBQUUsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFO1NBQzlCLENBQUMsQ0FBQztRQUVILE9BQU87WUFDTCxJQUFJO1lBQ0osS0FBSztZQUNMLElBQUk7WUFDSixLQUFLO1NBQ04sQ0FBQztJQUNKLENBQUM7Q0FDRixDQUFBO0FBcExZLGtEQUFtQjs4QkFBbkIsbUJBQW1CO0lBRC9CLElBQUEsbUJBQVUsR0FBRTtJQUdSLFdBQUEsSUFBQSwwQkFBZ0IsRUFBQyxtQ0FBWSxDQUFDLENBQUE7eURBQ1Usb0JBQVUsb0JBQVYsb0JBQVU7R0FIMUMsbUJBQW1CLENBb0wvQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcYmVuZWZpY2lvXFxzZXJ2aWNlc1xcZGFkb3MtZnVuZXJhbC5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIE5vdEZvdW5kRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgSW5qZWN0UmVwb3NpdG9yeSB9IGZyb20gJ0BuZXN0anMvdHlwZW9ybSc7XG5pbXBvcnQgeyBSZXBvc2l0b3J5IH0gZnJvbSAndHlwZW9ybSc7XG5pbXBvcnQgeyBEYWRvc0Z1bmVyYWwgfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9kYWRvcy1mdW5lcmFsLmVudGl0eSc7XG5pbXBvcnQge1xuICBDcmVhdGVEYWRvc0Z1bmVyYWxEdG8sXG4gIFVwZGF0ZURhZG9zRnVuZXJhbER0byxcbn0gZnJvbSAnLi4vZHRvL2NyZWF0ZS1kYWRvcy1mdW5lcmFsLmR0byc7XG5cbi8qKlxuICogU2VydmnDp28gcGFyYSBnZXJlbmNpYXIgZGFkb3MgZXNwZWPDrWZpY29zIGRlIEF1eMOtbGlvIEZ1bmVyYWxcbiAqL1xuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIERhZG9zRnVuZXJhbFNlcnZpY2Uge1xuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0UmVwb3NpdG9yeShEYWRvc0Z1bmVyYWwpXG4gICAgcHJpdmF0ZSByZWFkb25seSBkYWRvc0Z1bmVyYWxSZXBvc2l0b3J5OiBSZXBvc2l0b3J5PERhZG9zRnVuZXJhbD4sXG4gICkge31cblxuICAvKipcbiAgICogQ3JpYXIgZGFkb3MgZGUgZnVuZXJhbCBwYXJhIHVtYSBzb2xpY2l0YcOnw6NvXG4gICAqL1xuICBhc3luYyBjcmVhdGUoY3JlYXRlRHRvOiBDcmVhdGVEYWRvc0Z1bmVyYWxEdG8pOiBQcm9taXNlPERhZG9zRnVuZXJhbD4ge1xuICAgIC8vIFZlcmlmaWNhciBzZSBqw6EgZXhpc3RlbSBkYWRvcyBwYXJhIGVzdGEgc29saWNpdGHDp8Ojb1xuICAgIGNvbnN0IGV4aXN0aW5nRGF0YSA9IGF3YWl0IHRoaXMuZGFkb3NGdW5lcmFsUmVwb3NpdG9yeS5maW5kT25lKHtcbiAgICAgIHdoZXJlOiB7IHNvbGljaXRhY2FvX2lkOiBjcmVhdGVEdG8uc29saWNpdGFjYW9faWQgfSxcbiAgICB9KTtcblxuICAgIGlmIChleGlzdGluZ0RhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSsOhIGV4aXN0ZW0gZGFkb3MgZGUgZnVuZXJhbCBwYXJhIGVzdGEgc29saWNpdGHDp8OjbycpO1xuICAgIH1cblxuICAgIGNvbnN0IGRhZG9zRnVuZXJhbCA9IHRoaXMuZGFkb3NGdW5lcmFsUmVwb3NpdG9yeS5jcmVhdGUoY3JlYXRlRHRvKTtcbiAgICByZXR1cm4gdGhpcy5kYWRvc0Z1bmVyYWxSZXBvc2l0b3J5LnNhdmUoZGFkb3NGdW5lcmFsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgZGUgZnVuZXJhbCBwb3IgSURcbiAgICovXG4gIGFzeW5jIGZpbmRPbmUoaWQ6IHN0cmluZyk6IFByb21pc2U8RGFkb3NGdW5lcmFsPiB7XG4gICAgY29uc3QgZGFkb3NGdW5lcmFsID0gYXdhaXQgdGhpcy5kYWRvc0Z1bmVyYWxSZXBvc2l0b3J5LmZpbmRPbmUoe1xuICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICAgIHJlbGF0aW9uczogWydzb2xpY2l0YWNhbyddLFxuICAgIH0pO1xuXG4gICAgaWYgKCFkYWRvc0Z1bmVyYWwpIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignRGFkb3MgZGUgZnVuZXJhbCBuw6NvIGVuY29udHJhZG9zJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhZG9zRnVuZXJhbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgZGUgZnVuZXJhbCBwb3Igc29saWNpdGHDp8Ojb1xuICAgKi9cbiAgYXN5bmMgZmluZEJ5U29saWNpdGFjYW8oc29saWNpdGFjYW9JZDogc3RyaW5nKTogUHJvbWlzZTxEYWRvc0Z1bmVyYWw+IHtcbiAgICBjb25zdCBkYWRvc0Z1bmVyYWwgPSBhd2FpdCB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuZmluZE9uZSh7XG4gICAgICB3aGVyZTogeyBzb2xpY2l0YWNhb19pZDogc29saWNpdGFjYW9JZCB9LFxuICAgICAgcmVsYXRpb25zOiBbJ3NvbGljaXRhY2FvJ10sXG4gICAgfSk7XG5cbiAgICBpZiAoIWRhZG9zRnVuZXJhbCkge1xuICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uKFxuICAgICAgICAnRGFkb3MgZGUgZnVuZXJhbCBuw6NvIGVuY29udHJhZG9zIHBhcmEgZXN0YSBzb2xpY2l0YcOnw6NvJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhZG9zRnVuZXJhbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHVhbGl6YXIgZGFkb3MgZGUgZnVuZXJhbFxuICAgKi9cbiAgYXN5bmMgdXBkYXRlKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgdXBkYXRlRHRvOiBVcGRhdGVEYWRvc0Z1bmVyYWxEdG8sXG4gICk6IFByb21pc2U8RGFkb3NGdW5lcmFsPiB7XG4gICAgY29uc3QgZGFkb3NGdW5lcmFsID0gYXdhaXQgdGhpcy5maW5kT25lKGlkKTtcblxuICAgIC8vIEF0dWFsaXphciBhcGVuYXMgb3MgY2FtcG9zIGZvcm5lY2lkb3NcbiAgICBPYmplY3QuYXNzaWduKGRhZG9zRnVuZXJhbCwgdXBkYXRlRHRvKTtcblxuICAgIHJldHVybiB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuc2F2ZShkYWRvc0Z1bmVyYWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXIgZGFkb3MgZGUgZnVuZXJhbFxuICAgKi9cbiAgYXN5bmMgcmVtb3ZlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkYWRvc0Z1bmVyYWwgPSBhd2FpdCB0aGlzLmZpbmRPbmUoaWQpO1xuICAgIGF3YWl0IHRoaXMuZGFkb3NGdW5lcmFsUmVwb3NpdG9yeS5yZW1vdmUoZGFkb3NGdW5lcmFsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYXIgc2UgZXhpc3RlbSBkYWRvcyBkZSBmdW5lcmFsIHBhcmEgdW1hIHNvbGljaXRhw6fDo29cbiAgICovXG4gIGFzeW5jIGV4aXN0c0J5U29saWNpdGFjYW8oc29saWNpdGFjYW9JZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgY291bnQgPSBhd2FpdCB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuY291bnQoe1xuICAgICAgd2hlcmU6IHsgc29saWNpdGFjYW9faWQ6IHNvbGljaXRhY2FvSWQgfSxcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnQgPiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1c2NhciB0b2RvcyBvcyBkYWRvcyBkZSBmdW5lcmFsIGNvbSBwYWdpbmHDp8Ojb1xuICAgKi9cbiAgYXN5bmMgZmluZEFsbChcbiAgICBwYWdlOiBudW1iZXIgPSAxLFxuICAgIGxpbWl0OiBudW1iZXIgPSAxMCxcbiAgKTogUHJvbWlzZTx7XG4gICAgZGF0YTogRGFkb3NGdW5lcmFsW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgbGltaXQ6IG51bWJlcjtcbiAgfT4ge1xuICAgIGNvbnN0IFtkYXRhLCB0b3RhbF0gPSBhd2FpdCB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuZmluZEFuZENvdW50KHtcbiAgICAgIHJlbGF0aW9uczogWydzb2xpY2l0YWNhbyddLFxuICAgICAgc2tpcDogKHBhZ2UgLSAxKSAqIGxpbWl0LFxuICAgICAgdGFrZTogbGltaXQsXG4gICAgICBvcmRlcjogeyBjcmVhdGVkX2F0OiAnREVTQycgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhLFxuICAgICAgdG90YWwsXG4gICAgICBwYWdlLFxuICAgICAgbGltaXQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgcG9yIGdyYXUgZGUgcGFyZW50ZXNjb1xuICAgKi9cbiAgYXN5bmMgZmluZEJ5R3JhdVBhcmVudGVzY28oXG4gICAgZ3JhdVBhcmVudGVzY286IHN0cmluZyxcbiAgICBwYWdlOiBudW1iZXIgPSAxLFxuICAgIGxpbWl0OiBudW1iZXIgPSAxMCxcbiAgKTogUHJvbWlzZTx7XG4gICAgZGF0YTogRGFkb3NGdW5lcmFsW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgbGltaXQ6IG51bWJlcjtcbiAgfT4ge1xuICAgIGNvbnN0IFtkYXRhLCB0b3RhbF0gPSBhd2FpdCB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuZmluZEFuZENvdW50KHtcbiAgICAgIHdoZXJlOiB7IGdyYXVfcGFyZW50ZXNjb19yZXF1ZXJlbnRlOiBncmF1UGFyZW50ZXNjbyBhcyBhbnkgfSxcbiAgICAgIHJlbGF0aW9uczogWydzb2xpY2l0YWNhbyddLFxuICAgICAgc2tpcDogKHBhZ2UgLSAxKSAqIGxpbWl0LFxuICAgICAgdGFrZTogbGltaXQsXG4gICAgICBvcmRlcjogeyBjcmVhdGVkX2F0OiAnREVTQycgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhLFxuICAgICAgdG90YWwsXG4gICAgICBwYWdlLFxuICAgICAgbGltaXQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgZGFkb3MgcG9yIHBlcsOtb2RvIGRlIMOzYml0b1xuICAgKi9cbiAgYXN5bmMgZmluZEJ5UGVyaW9kb09iaXRvKFxuICAgIGRhdGFJbmljaW86IERhdGUsXG4gICAgZGF0YUZpbTogRGF0ZSxcbiAgICBwYWdlOiBudW1iZXIgPSAxLFxuICAgIGxpbWl0OiBudW1iZXIgPSAxMCxcbiAgKTogUHJvbWlzZTx7XG4gICAgZGF0YTogRGFkb3NGdW5lcmFsW107XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgbGltaXQ6IG51bWJlcjtcbiAgfT4ge1xuICAgIGNvbnN0IFtkYXRhLCB0b3RhbF0gPSBhd2FpdCB0aGlzLmRhZG9zRnVuZXJhbFJlcG9zaXRvcnkuZmluZEFuZENvdW50KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGRhdGFfb2JpdG86IHtcbiAgICAgICAgICBndGU6IGRhdGFJbmljaW8sXG4gICAgICAgICAgbHRlOiBkYXRhRmltLFxuICAgICAgICB9IGFzIGFueSxcbiAgICAgIH0sXG4gICAgICByZWxhdGlvbnM6IFsnc29saWNpdGFjYW8nXSxcbiAgICAgIHNraXA6IChwYWdlIC0gMSkgKiBsaW1pdCxcbiAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgb3JkZXI6IHsgZGF0YV9vYml0bzogJ0RFU0MnIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YSxcbiAgICAgIHRvdGFsLFxuICAgICAgcGFnZSxcbiAgICAgIGxpbWl0LFxuICAgIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==