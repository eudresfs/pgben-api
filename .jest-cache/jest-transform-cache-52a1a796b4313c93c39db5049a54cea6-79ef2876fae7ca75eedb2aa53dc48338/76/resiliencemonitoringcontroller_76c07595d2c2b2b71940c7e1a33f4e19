89c44b90914acd3b479cb496b0c08cec
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ResilienceMonitoringController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const resilient_auditoria_service_1 = require("../services/resilient-auditoria.service");
const hybrid_cache_service_1 = require("../services/hybrid-cache.service");
const health_check_service_1 = require("../services/health-check.service");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const roles_guard_1 = require("../../auth/guards/roles.guard");
const role_decorator_1 = require("../../auth/decorators/role.decorator");
const roles_constants_1 = require("../constants/roles.constants");
/**
 * Controller de Monitoramento de Resiliência
 *
 * Fornece endpoints para monitorar o status e métricas dos serviços resilientes:
 * - Status geral do sistema
 * - Métricas detalhadas de cache
 * - Métricas de auditoria
 * - Health checks de serviços externos
 * - Alertas e notificações
 *
 * Acesso restrito a administradores do sistema
 */
let ResilienceMonitoringController = class ResilienceMonitoringController {
    resilientAuditoriaService;
    hybridCacheService;
    healthCheckService;
    constructor(resilientAuditoriaService, hybridCacheService, healthCheckService) {
        this.resilientAuditoriaService = resilientAuditoriaService;
        this.hybridCacheService = hybridCacheService;
        this.healthCheckService = healthCheckService;
    }
    /**
     * Obtém status geral de resiliência do sistema
     */
    async getResilienceStatus() {
        const timestamp = new Date().toISOString();
        // Obter status dos serviços
        // Verificar status dos serviços
        const redisAvailable = await this.healthCheckService.isRedisAvailable();
        const servicesStatus = {
            redis: {
                status: redisAvailable ? 'up' : 'down',
                lastCheck: new Date().toISOString(),
                latency: redisAvailable ? 5 : undefined
            },
            database: {
                status: 'up', // Assumindo que o banco está sempre disponível se a aplicação está rodando
                lastCheck: new Date().toISOString(),
                latency: 10
            }
        };
        const cacheMetrics = this.hybridCacheService.getMetrics();
        const auditoriaMetrics = this.resilientAuditoriaService.getMetrics();
        // Avaliar status do cache
        const cacheStatus = this.evaluateCacheStatus(cacheMetrics, servicesStatus.redis?.status === 'up');
        // Avaliar status da auditoria
        const auditoriaStatus = this.evaluateAuditoriaStatus(auditoriaMetrics, servicesStatus.redis?.status === 'up');
        // Gerar alertas
        const alerts = this.generateAlerts(cacheMetrics, auditoriaMetrics, servicesStatus);
        // Determinar status geral
        const overall = this.determineOverallStatus(cacheStatus.status, auditoriaStatus.status, servicesStatus);
        return {
            timestamp,
            overall,
            services: {
                cache: cacheStatus,
                auditoria: auditoriaStatus,
                redis: {
                    status: servicesStatus.redis?.status || 'down',
                    latency: servicesStatus.redis?.latency,
                    lastCheck: servicesStatus.redis?.lastCheck || timestamp
                },
                database: {
                    status: servicesStatus.database?.status || 'down',
                    latency: servicesStatus.database?.latency,
                    lastCheck: servicesStatus.database?.lastCheck || timestamp
                }
            },
            alerts
        };
    }
    /**
     * Obtém métricas detalhadas do cache híbrido
     */
    async getCacheMetrics() {
        const metrics = this.hybridCacheService.getMetrics();
        // Verificar status dos serviços
        const redisAvailable = await this.healthCheckService.isRedisAvailable();
        const servicesStatus = {
            redis: {
                status: redisAvailable ? 'up' : 'down',
                lastCheck: new Date().toISOString(),
                latency: redisAvailable ? 5 : undefined
            },
            database: {
                status: 'up', // Assumindo que o banco está sempre disponível se a aplicação está rodando
                lastCheck: new Date().toISOString(),
                latency: 10
            }
        };
        return {
            timestamp: new Date().toISOString(),
            l1Cache: {
                size: metrics.l1Size,
                maxSize: metrics.l1MaxSize,
                utilizationRate: (metrics.l1Size / metrics.l1MaxSize) * 100,
                hitRate: metrics.l1HitRate,
                hits: metrics.l1Hits,
                misses: metrics.l1Misses
            },
            l2Cache: {
                available: servicesStatus.redis?.status === 'up',
                hitRate: metrics.l2HitRate,
                hits: metrics.l2Hits,
                misses: metrics.l2Misses,
                failovers: metrics.failovers
            },
            overall: {
                hitRate: metrics.overallHitRate,
                evictions: metrics.evictions,
                warmingOperations: metrics.warmingOperations,
                criticalKeysCount: metrics.criticalKeysCount,
                pendingOperations: metrics.pendingOperations
            },
            performance: {
                l1ResponseTime: '< 1ms',
                l2ResponseTime: servicesStatus.redis?.latency ? `${servicesStatus.redis.latency}ms` : 'N/A'
            }
        };
    }
    /**
     * Obtém métricas detalhadas da auditoria resiliente
     */
    async getAuditoriaMetrics() {
        const metrics = this.resilientAuditoriaService.getMetrics();
        // Verificar status dos serviços
        const redisAvailable = await this.healthCheckService.isRedisAvailable();
        const servicesStatus = {
            redis: {
                status: redisAvailable ? 'up' : 'down',
                lastCheck: new Date().toISOString(),
                latency: redisAvailable ? 5 : undefined
            },
            database: {
                status: 'up', // Assumindo que o banco está sempre disponível se a aplicação está rodando
                lastCheck: new Date().toISOString(),
                latency: 10
            }
        };
        const totalOperations = metrics.queueSuccesses + metrics.queueFailures;
        return {
            timestamp: new Date().toISOString(),
            queue: {
                available: servicesStatus.redis?.status === 'up',
                successRate: metrics.queueSuccessRate,
                successes: metrics.queueSuccesses,
                failures: metrics.queueFailures,
                totalOperations
            },
            fallbacks: {
                syncFallbackUsage: metrics.fallbackUsageRate,
                syncFallbacks: metrics.syncFallbacks,
                fileBackupUsage: metrics.backupUsageRate,
                fileBackups: metrics.fileBackups
            },
            recovery: {
                recoveredLogs: metrics.recoveredLogs,
                lastRecoveryRun: 'Informação não disponível' // Implementar se necessário
            },
            reliability: {
                dataLossRisk: this.calculateDataLossRisk(metrics),
                systemResilience: this.calculateSystemResilience(metrics, servicesStatus.redis?.status === 'up')
            }
        };
    }
    /**
     * Força execução de cache warming
     */
    async forceCacheWarming() {
        await this.hybridCacheService.performCacheWarming();
        return {
            message: 'Cache warming executado com sucesso',
            timestamp: new Date().toISOString()
        };
    }
    /**
     * Força execução de recuperação de logs de auditoria
     */
    async forceAuditoriaRecovery() {
        await this.resilientAuditoriaService.processBackupAuditLogs();
        return {
            message: 'Recuperação de logs de auditoria executada com sucesso',
            timestamp: new Date().toISOString()
        };
    }
    /**
     * Reseta métricas (útil para testes e manutenção)
     */
    async resetMetrics() {
        this.hybridCacheService.resetMetrics();
        this.resilientAuditoriaService.resetMetrics();
        return {
            message: 'Métricas de resiliência resetadas com sucesso',
            timestamp: new Date().toISOString()
        };
    }
    // Métodos privados para avaliação de status
    evaluateCacheStatus(metrics, redisAvailable) {
        let status;
        if (metrics.overallHitRate >= 80 && redisAvailable) {
            status = 'healthy';
        }
        else if (metrics.overallHitRate >= 60 || !redisAvailable) {
            status = 'degraded';
        }
        else {
            status = 'critical';
        }
        return {
            status,
            l1Available: true, // L1 sempre disponível
            l2Available: redisAvailable,
            metrics
        };
    }
    evaluateAuditoriaStatus(metrics, redisAvailable) {
        let status;
        if (metrics.queueSuccessRate >= 95 && redisAvailable) {
            status = 'healthy';
        }
        else if (metrics.queueSuccessRate >= 80 || metrics.fallbackUsageRate < 20) {
            status = 'degraded';
        }
        else {
            status = 'critical';
        }
        return {
            status,
            queueAvailable: redisAvailable,
            syncFallbackActive: metrics.syncFallbacks > 0,
            fileBackupActive: metrics.fileBackups > 0,
            metrics
        };
    }
    determineOverallStatus(cacheStatus, auditoriaStatus, servicesStatus) {
        const statuses = [cacheStatus, auditoriaStatus];
        // Se algum serviço crítico está down
        if (servicesStatus.database?.status === 'down') {
            return 'critical';
        }
        // Se algum componente está crítico
        if (statuses.includes('critical')) {
            return 'critical';
        }
        // Se algum componente está degradado
        if (statuses.includes('degraded') || servicesStatus.redis?.status === 'down') {
            return 'degraded';
        }
        return 'healthy';
    }
    generateAlerts(cacheMetrics, auditoriaMetrics, servicesStatus) {
        const alerts = [];
        const timestamp = new Date().toISOString();
        // Alertas de cache
        if (cacheMetrics.overallHitRate < 60) {
            alerts.push({
                severity: 'warning',
                service: 'cache',
                message: `Taxa de hit do cache baixa: ${cacheMetrics.overallHitRate.toFixed(1)}%`,
                timestamp
            });
        }
        if (cacheMetrics.failovers > 10) {
            alerts.push({
                severity: 'critical',
                service: 'cache',
                message: `Muitos failovers do cache L2: ${cacheMetrics.failovers}`,
                timestamp
            });
        }
        // Alertas de auditoria
        if (auditoriaMetrics.queueSuccessRate < 90) {
            alerts.push({
                severity: 'warning',
                service: 'auditoria',
                message: `Taxa de sucesso da fila de auditoria baixa: ${auditoriaMetrics.queueSuccessRate.toFixed(1)}%`,
                timestamp
            });
        }
        if (auditoriaMetrics.fileBackups > 0) {
            alerts.push({
                severity: 'critical',
                service: 'auditoria',
                message: `Logs de auditoria sendo salvos em backup: ${auditoriaMetrics.fileBackups}`,
                timestamp
            });
        }
        // Alertas de serviços externos
        if (servicesStatus.redis?.status === 'down') {
            alerts.push({
                severity: 'critical',
                service: 'redis',
                message: 'Redis indisponível - sistema operando em modo degradado',
                timestamp
            });
        }
        if (servicesStatus.database?.status === 'down') {
            alerts.push({
                severity: 'critical',
                service: 'database',
                message: 'Banco de dados indisponível',
                timestamp
            });
        }
        return alerts;
    }
    calculateDataLossRisk(metrics) {
        if (metrics.fileBackups > 0) {
            return 'high';
        }
        if (metrics.queueSuccessRate < 95) {
            return 'medium';
        }
        return 'low';
    }
    calculateSystemResilience(metrics, redisAvailable) {
        let score = 100;
        // Penalizar por falhas na fila
        if (metrics.queueSuccessRate < 100) {
            score -= (100 - metrics.queueSuccessRate) * 0.5;
        }
        // Penalizar por uso de fallbacks
        score -= metrics.fallbackUsageRate * 0.3;
        // Penalizar por backups em arquivo
        score -= metrics.backupUsageRate * 0.8;
        // Penalizar por Redis indisponível
        if (!redisAvailable) {
            score -= 20;
        }
        return Math.max(0, Math.min(100, score));
    }
};
exports.ResilienceMonitoringController = ResilienceMonitoringController;
__decorate([
    (0, common_1.Get)('status'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR),
    (0, swagger_1.ApiOperation)({
        summary: 'Status geral de resiliência',
        description: 'Retorna o status consolidado de todos os serviços resilientes do sistema'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Status de resiliência obtido com sucesso',
        schema: {
            type: 'object',
            properties: {
                timestamp: { type: 'string', format: 'date-time' },
                overall: { type: 'string', enum: ['healthy', 'degraded', 'critical'] },
                services: { type: 'object' },
                alerts: { type: 'array' }
            }
        }
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", typeof (_d = typeof Promise !== "undefined" && Promise) === "function" ? _d : Object)
], ResilienceMonitoringController.prototype, "getResilienceStatus", null);
__decorate([
    (0, common_1.Get)('cache/metrics'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR),
    (0, swagger_1.ApiOperation)({
        summary: 'Métricas do cache híbrido',
        description: 'Retorna métricas detalhadas do sistema de cache em múltiplas camadas'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Métricas do cache obtidas com sucesso'
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], ResilienceMonitoringController.prototype, "getCacheMetrics", null);
__decorate([
    (0, common_1.Get)('auditoria/metrics'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR),
    (0, swagger_1.ApiOperation)({
        summary: 'Métricas da auditoria resiliente',
        description: 'Retorna métricas detalhadas do sistema de auditoria com fallbacks'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Métricas da auditoria obtidas com sucesso'
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], ResilienceMonitoringController.prototype, "getAuditoriaMetrics", null);
__decorate([
    (0, common_1.Post)('cache/warm'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN),
    (0, swagger_1.ApiOperation)({
        summary: 'Força cache warming',
        description: 'Executa manualmente o processo de aquecimento do cache para chaves críticas'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Cache warming executado com sucesso'
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], ResilienceMonitoringController.prototype, "forceCacheWarming", null);
__decorate([
    (0, common_1.Post)('auditoria/recover'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN),
    (0, swagger_1.ApiOperation)({
        summary: 'Força recuperação de logs',
        description: 'Executa manualmente o processo de recuperação de logs de auditoria em backup'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Recuperação de logs executada com sucesso'
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], ResilienceMonitoringController.prototype, "forceAuditoriaRecovery", null);
__decorate([
    (0, common_1.Post)('metrics/reset'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN),
    (0, swagger_1.ApiOperation)({
        summary: 'Reseta métricas',
        description: 'Reseta todas as métricas de resiliência (use com cuidado)'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Métricas resetadas com sucesso'
    }),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], ResilienceMonitoringController.prototype, "resetMetrics", null);
exports.ResilienceMonitoringController = ResilienceMonitoringController = __decorate([
    (0, swagger_1.ApiTags)('Monitoramento de Resiliência'),
    (0, common_1.Controller)('api/resilience'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, roles_guard_1.RolesGuard),
    (0, swagger_1.ApiBearerAuth)(),
    __metadata("design:paramtypes", [typeof (_a = typeof resilient_auditoria_service_1.ResilientAuditoriaService !== "undefined" && resilient_auditoria_service_1.ResilientAuditoriaService) === "function" ? _a : Object, typeof (_b = typeof hybrid_cache_service_1.HybridCacheService !== "undefined" && hybrid_cache_service_1.HybridCacheService) === "function" ? _b : Object, typeof (_c = typeof health_check_service_1.HealthCheckService !== "undefined" && health_check_service_1.HealthCheckService) === "function" ? _c : Object])
], ResilienceMonitoringController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxcY29udHJvbGxlcnNcXHJlc2lsaWVuY2UtbW9uaXRvcmluZy5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FBd0Y7QUFDeEYsNkNBQW9GO0FBQ3BGLHlGQUFvRjtBQUNwRiwyRUFBc0U7QUFDdEUsMkVBQXNFO0FBQ3RFLHFFQUFnRTtBQUNoRSwrREFBMkQ7QUFDM0QseUVBQTZEO0FBQzdELGtFQUFxRDtBQXVDckQ7Ozs7Ozs7Ozs7O0dBV0c7QUFLSSxJQUFNLDhCQUE4QixHQUFwQyxNQUFNLDhCQUE4QjtJQUV0QjtJQUNBO0lBQ0E7SUFIbkIsWUFDbUIseUJBQW9ELEVBQ3BELGtCQUFzQyxFQUN0QyxrQkFBc0M7UUFGdEMsOEJBQXlCLEdBQXpCLHlCQUF5QixDQUEyQjtRQUNwRCx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBQ3RDLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7SUFDdEQsQ0FBQztJQUVKOztPQUVHO0lBb0JHLEFBQU4sS0FBSyxDQUFDLG1CQUFtQjtRQUN2QixNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRTNDLDRCQUE0QjtRQUM1QixnQ0FBZ0M7UUFDaEMsTUFBTSxjQUFjLEdBQUcsTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4RSxNQUFNLGNBQWMsR0FBRztZQUNyQixLQUFLLEVBQUU7Z0JBQ0wsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFlO2dCQUN4RCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7Z0JBQ25DLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUzth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NUIsSUFBQSxrQkFBUyxFQUFDLDZCQUFZLEVBQUUsd0JBQVUsQ0FBQztJQUNuQyxJQUFBLHVCQUFhLEdBQUU7eURBR2dDLHVEQUF5QixvQkFBekIsdURBQXlCLG9EQUNoQyx5Q0FBa0Isb0JBQWxCLHlDQUFrQixvREFDbEIseUNBQWtCLG9CQUFsQix5Q0FBa0I7R0FKOUMsOEJBQThCLENBbWIxQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcc2hhcmVkXFxjb250cm9sbGVyc1xccmVzaWxpZW5jZS1tb25pdG9yaW5nLmNvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29udHJvbGxlciwgR2V0LCBQb3N0LCBIdHRwQ29kZSwgSHR0cFN0YXR1cywgVXNlR3VhcmRzIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQXBpVGFncywgQXBpT3BlcmF0aW9uLCBBcGlSZXNwb25zZSwgQXBpQmVhcmVyQXV0aCB9IGZyb20gJ0BuZXN0anMvc3dhZ2dlcic7XG5pbXBvcnQgeyBSZXNpbGllbnRBdWRpdG9yaWFTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcmVzaWxpZW50LWF1ZGl0b3JpYS5zZXJ2aWNlJztcbmltcG9ydCB7IEh5YnJpZENhY2hlU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2h5YnJpZC1jYWNoZS5zZXJ2aWNlJztcbmltcG9ydCB7IEhlYWx0aENoZWNrU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2hlYWx0aC1jaGVjay5zZXJ2aWNlJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uLy4uL2F1dGgvZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IFJvbGVzR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9yb2xlcy5ndWFyZCc7XG5pbXBvcnQgeyBSb2xlcyB9IGZyb20gJy4uLy4uL2F1dGgvZGVjb3JhdG9ycy9yb2xlLmRlY29yYXRvcic7XG5pbXBvcnQgeyBST0xFUyB9IGZyb20gJy4uL2NvbnN0YW50cy9yb2xlcy5jb25zdGFudHMnO1xuaW1wb3J0IHR5cGUgeyBSb2xlVHlwZSB9IGZyb20gJy4uL2NvbnN0YW50cy9yb2xlcy5jb25zdGFudHMnO1xuXG5pbnRlcmZhY2UgUmVzaWxpZW5jZVN0YXR1cyB7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBvdmVyYWxsOiAnaGVhbHRoeScgfCAnZGVncmFkZWQnIHwgJ2NyaXRpY2FsJztcbiAgc2VydmljZXM6IHtcbiAgICBjYWNoZToge1xuICAgICAgc3RhdHVzOiAnaGVhbHRoeScgfCAnZGVncmFkZWQnIHwgJ2NyaXRpY2FsJztcbiAgICAgIGwxQXZhaWxhYmxlOiBib29sZWFuO1xuICAgICAgbDJBdmFpbGFibGU6IGJvb2xlYW47XG4gICAgICBtZXRyaWNzOiBhbnk7XG4gICAgfTtcbiAgICBhdWRpdG9yaWE6IHtcbiAgICAgIHN0YXR1czogJ2hlYWx0aHknIHwgJ2RlZ3JhZGVkJyB8ICdjcml0aWNhbCc7XG4gICAgICBxdWV1ZUF2YWlsYWJsZTogYm9vbGVhbjtcbiAgICAgIHN5bmNGYWxsYmFja0FjdGl2ZTogYm9vbGVhbjtcbiAgICAgIGZpbGVCYWNrdXBBY3RpdmU6IGJvb2xlYW47XG4gICAgICBtZXRyaWNzOiBhbnk7XG4gICAgfTtcbiAgICByZWRpczoge1xuICAgICAgc3RhdHVzOiAndXAnIHwgJ2Rvd24nIHwgJ2RlZ3JhZGVkJztcbiAgICAgIGxhdGVuY3k/OiBudW1iZXI7XG4gICAgICBsYXN0Q2hlY2s6IHN0cmluZztcbiAgICB9O1xuICAgIGRhdGFiYXNlOiB7XG4gICAgICBzdGF0dXM6ICd1cCcgfCAnZG93bicgfCAnZGVncmFkZWQnO1xuICAgICAgbGF0ZW5jeT86IG51bWJlcjtcbiAgICAgIGxhc3RDaGVjazogc3RyaW5nO1xuICAgIH07XG4gIH07XG4gIGFsZXJ0czogQXJyYXk8e1xuICAgIHNldmVyaXR5OiAnd2FybmluZycgfCAnY3JpdGljYWwnO1xuICAgIHNlcnZpY2U6IHN0cmluZztcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBzdHJpbmc7XG4gIH0+O1xufVxuXG4vKipcbiAqIENvbnRyb2xsZXIgZGUgTW9uaXRvcmFtZW50byBkZSBSZXNpbGnDqm5jaWFcbiAqIFxuICogRm9ybmVjZSBlbmRwb2ludHMgcGFyYSBtb25pdG9yYXIgbyBzdGF0dXMgZSBtw6l0cmljYXMgZG9zIHNlcnZpw6dvcyByZXNpbGllbnRlczpcbiAqIC0gU3RhdHVzIGdlcmFsIGRvIHNpc3RlbWFcbiAqIC0gTcOpdHJpY2FzIGRldGFsaGFkYXMgZGUgY2FjaGVcbiAqIC0gTcOpdHJpY2FzIGRlIGF1ZGl0b3JpYVxuICogLSBIZWFsdGggY2hlY2tzIGRlIHNlcnZpw6dvcyBleHRlcm5vc1xuICogLSBBbGVydGFzIGUgbm90aWZpY2HDp8O1ZXNcbiAqIFxuICogQWNlc3NvIHJlc3RyaXRvIGEgYWRtaW5pc3RyYWRvcmVzIGRvIHNpc3RlbWFcbiAqL1xuQEFwaVRhZ3MoJ01vbml0b3JhbWVudG8gZGUgUmVzaWxpw6puY2lhJylcbkBDb250cm9sbGVyKCdhcGkvcmVzaWxpZW5jZScpXG5AVXNlR3VhcmRzKEp3dEF1dGhHdWFyZCwgUm9sZXNHdWFyZClcbkBBcGlCZWFyZXJBdXRoKClcbmV4cG9ydCBjbGFzcyBSZXNpbGllbmNlTW9uaXRvcmluZ0NvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IHJlc2lsaWVudEF1ZGl0b3JpYVNlcnZpY2U6IFJlc2lsaWVudEF1ZGl0b3JpYVNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBoeWJyaWRDYWNoZVNlcnZpY2U6IEh5YnJpZENhY2hlU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhlYWx0aENoZWNrU2VydmljZTogSGVhbHRoQ2hlY2tTZXJ2aWNlXG4gICkge31cblxuICAvKipcbiAgICogT2J0w6ltIHN0YXR1cyBnZXJhbCBkZSByZXNpbGnDqm5jaWEgZG8gc2lzdGVtYVxuICAgKi9cbiAgQEdldCgnc3RhdHVzJylcbiAgQFJvbGVzKFJPTEVTLkFETUlOLCBST0xFUy5HRVNUT1IpXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnU3RhdHVzIGdlcmFsIGRlIHJlc2lsacOqbmNpYScsXG4gICAgZGVzY3JpcHRpb246ICdSZXRvcm5hIG8gc3RhdHVzIGNvbnNvbGlkYWRvIGRlIHRvZG9zIG9zIHNlcnZpw6dvcyByZXNpbGllbnRlcyBkbyBzaXN0ZW1hJ1xuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDIwMCwgXG4gICAgZGVzY3JpcHRpb246ICdTdGF0dXMgZGUgcmVzaWxpw6puY2lhIG9idGlkbyBjb20gc3VjZXNzbycsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdGltZXN0YW1wOiB7IHR5cGU6ICdzdHJpbmcnLCBmb3JtYXQ6ICdkYXRlLXRpbWUnIH0sXG4gICAgICAgIG92ZXJhbGw6IHsgdHlwZTogJ3N0cmluZycsIGVudW06IFsnaGVhbHRoeScsICdkZWdyYWRlZCcsICdjcml0aWNhbCddIH0sXG4gICAgICAgIHNlcnZpY2VzOiB7IHR5cGU6ICdvYmplY3QnIH0sXG4gICAgICAgIGFsZXJ0czogeyB0eXBlOiAnYXJyYXknIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIGFzeW5jIGdldFJlc2lsaWVuY2VTdGF0dXMoKTogUHJvbWlzZTxSZXNpbGllbmNlU3RhdHVzPiB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIFxuICAgIC8vIE9idGVyIHN0YXR1cyBkb3Mgc2VydmnDp29zXG4gICAgLy8gVmVyaWZpY2FyIHN0YXR1cyBkb3Mgc2VydmnDp29zXG4gICAgY29uc3QgcmVkaXNBdmFpbGFibGUgPSBhd2FpdCB0aGlzLmhlYWx0aENoZWNrU2VydmljZS5pc1JlZGlzQXZhaWxhYmxlKCk7XG4gICAgY29uc3Qgc2VydmljZXNTdGF0dXMgPSB7XG4gICAgICByZWRpczoge1xuICAgICAgICBzdGF0dXM6IHJlZGlzQXZhaWxhYmxlID8gJ3VwJyBhcyBjb25zdCA6ICdkb3duJyBhcyBjb25zdCxcbiAgICAgICAgbGFzdENoZWNrOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGxhdGVuY3k6IHJlZGlzQXZhaWxhYmxlID8gNSA6IHVuZGVmaW5lZFxuICAgICAgfSxcbiAgICAgIGRhdGFiYXNlOiB7XG4gICAgICAgIHN0YXR1czogJ3VwJyBhcyBjb25zdCwgLy8gQXNzdW1pbmRvIHF1ZSBvIGJhbmNvIGVzdMOhIHNlbXByZSBkaXNwb27DrXZlbCBzZSBhIGFwbGljYcOnw6NvIGVzdMOhIHJvZGFuZG9cbiAgICAgICAgbGFzdENoZWNrOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGxhdGVuY3k6IDEwXG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBjYWNoZU1ldHJpY3MgPSB0aGlzLmh5YnJpZENhY2hlU2VydmljZS5nZXRNZXRyaWNzKCk7XG4gICAgY29uc3QgYXVkaXRvcmlhTWV0cmljcyA9IHRoaXMucmVzaWxpZW50QXVkaXRvcmlhU2VydmljZS5nZXRNZXRyaWNzKCk7XG4gICAgXG4gICAgLy8gQXZhbGlhciBzdGF0dXMgZG8gY2FjaGVcbiAgICBjb25zdCBjYWNoZVN0YXR1cyA9IHRoaXMuZXZhbHVhdGVDYWNoZVN0YXR1cyhjYWNoZU1ldHJpY3MsIHNlcnZpY2VzU3RhdHVzLnJlZGlzPy5zdGF0dXMgPT09ICd1cCcpO1xuICAgIFxuICAgIC8vIEF2YWxpYXIgc3RhdHVzIGRhIGF1ZGl0b3JpYVxuICAgIGNvbnN0IGF1ZGl0b3JpYVN0YXR1cyA9IHRoaXMuZXZhbHVhdGVBdWRpdG9yaWFTdGF0dXMoYXVkaXRvcmlhTWV0cmljcywgc2VydmljZXNTdGF0dXMucmVkaXM/LnN0YXR1cyA9PT0gJ3VwJyk7XG4gICAgXG4gICAgLy8gR2VyYXIgYWxlcnRhc1xuICAgIGNvbnN0IGFsZXJ0cyA9IHRoaXMuZ2VuZXJhdGVBbGVydHMoY2FjaGVNZXRyaWNzLCBhdWRpdG9yaWFNZXRyaWNzLCBzZXJ2aWNlc1N0YXR1cyk7XG4gICAgXG4gICAgLy8gRGV0ZXJtaW5hciBzdGF0dXMgZ2VyYWxcbiAgICBjb25zdCBvdmVyYWxsID0gdGhpcy5kZXRlcm1pbmVPdmVyYWxsU3RhdHVzKGNhY2hlU3RhdHVzLnN0YXR1cywgYXVkaXRvcmlhU3RhdHVzLnN0YXR1cywgc2VydmljZXNTdGF0dXMpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICB0aW1lc3RhbXAsXG4gICAgICBvdmVyYWxsLFxuICAgICAgc2VydmljZXM6IHtcbiAgICAgICAgY2FjaGU6IGNhY2hlU3RhdHVzLFxuICAgICAgICBhdWRpdG9yaWE6IGF1ZGl0b3JpYVN0YXR1cyxcbiAgICAgICAgcmVkaXM6IHtcbiAgICAgICAgICBzdGF0dXM6IHNlcnZpY2VzU3RhdHVzLnJlZGlzPy5zdGF0dXMgfHwgJ2Rvd24nLFxuICAgICAgICAgIGxhdGVuY3k6IHNlcnZpY2VzU3RhdHVzLnJlZGlzPy5sYXRlbmN5LFxuICAgICAgICAgIGxhc3RDaGVjazogc2VydmljZXNTdGF0dXMucmVkaXM/Lmxhc3RDaGVjayB8fCB0aW1lc3RhbXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YWJhc2U6IHtcbiAgICAgICAgICBzdGF0dXM6IHNlcnZpY2VzU3RhdHVzLmRhdGFiYXNlPy5zdGF0dXMgfHwgJ2Rvd24nLFxuICAgICAgICAgIGxhdGVuY3k6IHNlcnZpY2VzU3RhdHVzLmRhdGFiYXNlPy5sYXRlbmN5LFxuICAgICAgICAgIGxhc3RDaGVjazogc2VydmljZXNTdGF0dXMuZGF0YWJhc2U/Lmxhc3RDaGVjayB8fCB0aW1lc3RhbXBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGFsZXJ0c1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIG3DqXRyaWNhcyBkZXRhbGhhZGFzIGRvIGNhY2hlIGjDrWJyaWRvXG4gICAqL1xuICBAR2V0KCdjYWNoZS9tZXRyaWNzJylcbiAgQFJvbGVzKFJPTEVTLkFETUlOLCBST0xFUy5HRVNUT1IpXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnTcOpdHJpY2FzIGRvIGNhY2hlIGjDrWJyaWRvJyxcbiAgICBkZXNjcmlwdGlvbjogJ1JldG9ybmEgbcOpdHJpY2FzIGRldGFsaGFkYXMgZG8gc2lzdGVtYSBkZSBjYWNoZSBlbSBtw7psdGlwbGFzIGNhbWFkYXMnXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogMjAwLCBcbiAgICBkZXNjcmlwdGlvbjogJ03DqXRyaWNhcyBkbyBjYWNoZSBvYnRpZGFzIGNvbSBzdWNlc3NvJ1xuICB9KVxuICBhc3luYyBnZXRDYWNoZU1ldHJpY3MoKSB7XG4gICAgY29uc3QgbWV0cmljcyA9IHRoaXMuaHlicmlkQ2FjaGVTZXJ2aWNlLmdldE1ldHJpY3MoKTtcbiAgICAvLyBWZXJpZmljYXIgc3RhdHVzIGRvcyBzZXJ2acOnb3NcbiAgICBjb25zdCByZWRpc0F2YWlsYWJsZSA9IGF3YWl0IHRoaXMuaGVhbHRoQ2hlY2tTZXJ2aWNlLmlzUmVkaXNBdmFpbGFibGUoKTtcbiAgICBjb25zdCBzZXJ2aWNlc1N0YXR1cyA9IHtcbiAgICAgIHJlZGlzOiB7XG4gICAgICAgIHN0YXR1czogcmVkaXNBdmFpbGFibGUgPyAndXAnIGFzIGNvbnN0IDogJ2Rvd24nIGFzIGNvbnN0LFxuICAgICAgICBsYXN0Q2hlY2s6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbGF0ZW5jeTogcmVkaXNBdmFpbGFibGUgPyA1IDogdW5kZWZpbmVkXG4gICAgICB9LFxuICAgICAgZGF0YWJhc2U6IHtcbiAgICAgICAgc3RhdHVzOiAndXAnIGFzIGNvbnN0LCAvLyBBc3N1bWluZG8gcXVlIG8gYmFuY28gZXN0w6Egc2VtcHJlIGRpc3BvbsOtdmVsIHNlIGEgYXBsaWNhw6fDo28gZXN0w6Egcm9kYW5kb1xuICAgICAgICBsYXN0Q2hlY2s6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbGF0ZW5jeTogMTBcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGwxQ2FjaGU6IHtcbiAgICAgICAgc2l6ZTogbWV0cmljcy5sMVNpemUsXG4gICAgICAgIG1heFNpemU6IG1ldHJpY3MubDFNYXhTaXplLFxuICAgICAgICB1dGlsaXphdGlvblJhdGU6IChtZXRyaWNzLmwxU2l6ZSAvIG1ldHJpY3MubDFNYXhTaXplKSAqIDEwMCxcbiAgICAgICAgaGl0UmF0ZTogbWV0cmljcy5sMUhpdFJhdGUsXG4gICAgICAgIGhpdHM6IG1ldHJpY3MubDFIaXRzLFxuICAgICAgICBtaXNzZXM6IG1ldHJpY3MubDFNaXNzZXNcbiAgICAgIH0sXG4gICAgICBsMkNhY2hlOiB7XG4gICAgICAgIGF2YWlsYWJsZTogc2VydmljZXNTdGF0dXMucmVkaXM/LnN0YXR1cyA9PT0gJ3VwJyxcbiAgICAgICAgaGl0UmF0ZTogbWV0cmljcy5sMkhpdFJhdGUsXG4gICAgICAgIGhpdHM6IG1ldHJpY3MubDJIaXRzLFxuICAgICAgICBtaXNzZXM6IG1ldHJpY3MubDJNaXNzZXMsXG4gICAgICAgIGZhaWxvdmVyczogbWV0cmljcy5mYWlsb3ZlcnNcbiAgICAgIH0sXG4gICAgICBvdmVyYWxsOiB7XG4gICAgICAgIGhpdFJhdGU6IG1ldHJpY3Mub3ZlcmFsbEhpdFJhdGUsXG4gICAgICAgIGV2aWN0aW9uczogbWV0cmljcy5ldmljdGlvbnMsXG4gICAgICAgIHdhcm1pbmdPcGVyYXRpb25zOiBtZXRyaWNzLndhcm1pbmdPcGVyYXRpb25zLFxuICAgICAgICBjcml0aWNhbEtleXNDb3VudDogbWV0cmljcy5jcml0aWNhbEtleXNDb3VudCxcbiAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IG1ldHJpY3MucGVuZGluZ09wZXJhdGlvbnNcbiAgICAgIH0sXG4gICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICBsMVJlc3BvbnNlVGltZTogJzwgMW1zJyxcbiAgICAgICAgbDJSZXNwb25zZVRpbWU6IHNlcnZpY2VzU3RhdHVzLnJlZGlzPy5sYXRlbmN5ID8gYCR7c2VydmljZXNTdGF0dXMucmVkaXMubGF0ZW5jeX1tc2AgOiAnTi9BJ1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIG3DqXRyaWNhcyBkZXRhbGhhZGFzIGRhIGF1ZGl0b3JpYSByZXNpbGllbnRlXG4gICAqL1xuICBAR2V0KCdhdWRpdG9yaWEvbWV0cmljcycpXG4gIEBSb2xlcyhST0xFUy5BRE1JTiwgUk9MRVMuR0VTVE9SKVxuICBAQXBpT3BlcmF0aW9uKHsgXG4gICAgc3VtbWFyeTogJ03DqXRyaWNhcyBkYSBhdWRpdG9yaWEgcmVzaWxpZW50ZScsXG4gICAgZGVzY3JpcHRpb246ICdSZXRvcm5hIG3DqXRyaWNhcyBkZXRhbGhhZGFzIGRvIHNpc3RlbWEgZGUgYXVkaXRvcmlhIGNvbSBmYWxsYmFja3MnXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogMjAwLCBcbiAgICBkZXNjcmlwdGlvbjogJ03DqXRyaWNhcyBkYSBhdWRpdG9yaWEgb2J0aWRhcyBjb20gc3VjZXNzbydcbiAgfSlcbiAgYXN5bmMgZ2V0QXVkaXRvcmlhTWV0cmljcygpIHtcbiAgICBjb25zdCBtZXRyaWNzID0gdGhpcy5yZXNpbGllbnRBdWRpdG9yaWFTZXJ2aWNlLmdldE1ldHJpY3MoKTtcbiAgICAvLyBWZXJpZmljYXIgc3RhdHVzIGRvcyBzZXJ2acOnb3NcbiAgICBjb25zdCByZWRpc0F2YWlsYWJsZSA9IGF3YWl0IHRoaXMuaGVhbHRoQ2hlY2tTZXJ2aWNlLmlzUmVkaXNBdmFpbGFibGUoKTtcbiAgICBjb25zdCBzZXJ2aWNlc1N0YXR1cyA9IHtcbiAgICAgIHJlZGlzOiB7XG4gICAgICAgIHN0YXR1czogcmVkaXNBdmFpbGFibGUgPyAndXAnIGFzIGNvbnN0IDogJ2Rvd24nIGFzIGNvbnN0LFxuICAgICAgICBsYXN0Q2hlY2s6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbGF0ZW5jeTogcmVkaXNBdmFpbGFibGUgPyA1IDogdW5kZWZpbmVkXG4gICAgICB9LFxuICAgICAgZGF0YWJhc2U6IHtcbiAgICAgICAgc3RhdHVzOiAndXAnIGFzIGNvbnN0LCAvLyBBc3N1bWluZG8gcXVlIG8gYmFuY28gZXN0w6Egc2VtcHJlIGRpc3BvbsOtdmVsIHNlIGEgYXBsaWNhw6fDo28gZXN0w6Egcm9kYW5kb1xuICAgICAgICBsYXN0Q2hlY2s6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbGF0ZW5jeTogMTBcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IHRvdGFsT3BlcmF0aW9ucyA9IG1ldHJpY3MucXVldWVTdWNjZXNzZXMgKyBtZXRyaWNzLnF1ZXVlRmFpbHVyZXM7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgcXVldWU6IHtcbiAgICAgICAgYXZhaWxhYmxlOiBzZXJ2aWNlc1N0YXR1cy5yZWRpcz8uc3RhdHVzID09PSAndXAnLFxuICAgICAgICBzdWNjZXNzUmF0ZTogbWV0cmljcy5xdWV1ZVN1Y2Nlc3NSYXRlLFxuICAgICAgICBzdWNjZXNzZXM6IG1ldHJpY3MucXVldWVTdWNjZXNzZXMsXG4gICAgICAgIGZhaWx1cmVzOiBtZXRyaWNzLnF1ZXVlRmFpbHVyZXMsXG4gICAgICAgIHRvdGFsT3BlcmF0aW9uc1xuICAgICAgfSxcbiAgICAgIGZhbGxiYWNrczoge1xuICAgICAgICBzeW5jRmFsbGJhY2tVc2FnZTogbWV0cmljcy5mYWxsYmFja1VzYWdlUmF0ZSxcbiAgICAgICAgc3luY0ZhbGxiYWNrczogbWV0cmljcy5zeW5jRmFsbGJhY2tzLFxuICAgICAgICBmaWxlQmFja3VwVXNhZ2U6IG1ldHJpY3MuYmFja3VwVXNhZ2VSYXRlLFxuICAgICAgICBmaWxlQmFja3VwczogbWV0cmljcy5maWxlQmFja3Vwc1xuICAgICAgfSxcbiAgICAgIHJlY292ZXJ5OiB7XG4gICAgICAgIHJlY292ZXJlZExvZ3M6IG1ldHJpY3MucmVjb3ZlcmVkTG9ncyxcbiAgICAgICAgbGFzdFJlY292ZXJ5UnVuOiAnSW5mb3JtYcOnw6NvIG7Do28gZGlzcG9uw612ZWwnIC8vIEltcGxlbWVudGFyIHNlIG5lY2Vzc8OhcmlvXG4gICAgICB9LFxuICAgICAgcmVsaWFiaWxpdHk6IHtcbiAgICAgICAgZGF0YUxvc3NSaXNrOiB0aGlzLmNhbGN1bGF0ZURhdGFMb3NzUmlzayhtZXRyaWNzKSxcbiAgICAgICAgc3lzdGVtUmVzaWxpZW5jZTogdGhpcy5jYWxjdWxhdGVTeXN0ZW1SZXNpbGllbmNlKG1ldHJpY3MsIHNlcnZpY2VzU3RhdHVzLnJlZGlzPy5zdGF0dXMgPT09ICd1cCcpXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3LDp2EgZXhlY3XDp8OjbyBkZSBjYWNoZSB3YXJtaW5nXG4gICAqL1xuICBAUG9zdCgnY2FjaGUvd2FybScpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBAUm9sZXMoUk9MRVMuQURNSU4pXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnRm9yw6dhIGNhY2hlIHdhcm1pbmcnLFxuICAgIGRlc2NyaXB0aW9uOiAnRXhlY3V0YSBtYW51YWxtZW50ZSBvIHByb2Nlc3NvIGRlIGFxdWVjaW1lbnRvIGRvIGNhY2hlIHBhcmEgY2hhdmVzIGNyw610aWNhcydcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDAsIFxuICAgIGRlc2NyaXB0aW9uOiAnQ2FjaGUgd2FybWluZyBleGVjdXRhZG8gY29tIHN1Y2Vzc28nXG4gIH0pXG4gIGFzeW5jIGZvcmNlQ2FjaGVXYXJtaW5nKCkge1xuICAgIGF3YWl0IHRoaXMuaHlicmlkQ2FjaGVTZXJ2aWNlLnBlcmZvcm1DYWNoZVdhcm1pbmcoKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogJ0NhY2hlIHdhcm1pbmcgZXhlY3V0YWRvIGNvbSBzdWNlc3NvJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3LDp2EgZXhlY3XDp8OjbyBkZSByZWN1cGVyYcOnw6NvIGRlIGxvZ3MgZGUgYXVkaXRvcmlhXG4gICAqL1xuICBAUG9zdCgnYXVkaXRvcmlhL3JlY292ZXInKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgQFJvbGVzKFJPTEVTLkFETUlOKVxuICBAQXBpT3BlcmF0aW9uKHsgXG4gICAgc3VtbWFyeTogJ0ZvcsOnYSByZWN1cGVyYcOnw6NvIGRlIGxvZ3MnLFxuICAgIGRlc2NyaXB0aW9uOiAnRXhlY3V0YSBtYW51YWxtZW50ZSBvIHByb2Nlc3NvIGRlIHJlY3VwZXJhw6fDo28gZGUgbG9ncyBkZSBhdWRpdG9yaWEgZW0gYmFja3VwJ1xuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDIwMCwgXG4gICAgZGVzY3JpcHRpb246ICdSZWN1cGVyYcOnw6NvIGRlIGxvZ3MgZXhlY3V0YWRhIGNvbSBzdWNlc3NvJ1xuICB9KVxuICBhc3luYyBmb3JjZUF1ZGl0b3JpYVJlY292ZXJ5KCkge1xuICAgIGF3YWl0IHRoaXMucmVzaWxpZW50QXVkaXRvcmlhU2VydmljZS5wcm9jZXNzQmFja3VwQXVkaXRMb2dzKCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6ICdSZWN1cGVyYcOnw6NvIGRlIGxvZ3MgZGUgYXVkaXRvcmlhIGV4ZWN1dGFkYSBjb20gc3VjZXNzbycsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVzZXRhIG3DqXRyaWNhcyAow7p0aWwgcGFyYSB0ZXN0ZXMgZSBtYW51dGVuw6fDo28pXG4gICAqL1xuICBAUG9zdCgnbWV0cmljcy9yZXNldCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBAUm9sZXMoUk9MRVMuQURNSU4pXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnUmVzZXRhIG3DqXRyaWNhcycsXG4gICAgZGVzY3JpcHRpb246ICdSZXNldGEgdG9kYXMgYXMgbcOpdHJpY2FzIGRlIHJlc2lsacOqbmNpYSAodXNlIGNvbSBjdWlkYWRvKSdcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDAsIFxuICAgIGRlc2NyaXB0aW9uOiAnTcOpdHJpY2FzIHJlc2V0YWRhcyBjb20gc3VjZXNzbydcbiAgfSlcbiAgYXN5bmMgcmVzZXRNZXRyaWNzKCkge1xuICAgIHRoaXMuaHlicmlkQ2FjaGVTZXJ2aWNlLnJlc2V0TWV0cmljcygpO1xuICAgIHRoaXMucmVzaWxpZW50QXVkaXRvcmlhU2VydmljZS5yZXNldE1ldHJpY3MoKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogJ03DqXRyaWNhcyBkZSByZXNpbGnDqm5jaWEgcmVzZXRhZGFzIGNvbSBzdWNlc3NvJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgfVxuXG4gIC8vIE3DqXRvZG9zIHByaXZhZG9zIHBhcmEgYXZhbGlhw6fDo28gZGUgc3RhdHVzXG5cbiAgcHJpdmF0ZSBldmFsdWF0ZUNhY2hlU3RhdHVzKG1ldHJpY3M6IGFueSwgcmVkaXNBdmFpbGFibGU6IGJvb2xlYW4pIHtcbiAgICBsZXQgc3RhdHVzOiAnaGVhbHRoeScgfCAnZGVncmFkZWQnIHwgJ2NyaXRpY2FsJztcbiAgICBcbiAgICBpZiAobWV0cmljcy5vdmVyYWxsSGl0UmF0ZSA+PSA4MCAmJiByZWRpc0F2YWlsYWJsZSkge1xuICAgICAgc3RhdHVzID0gJ2hlYWx0aHknO1xuICAgIH0gZWxzZSBpZiAobWV0cmljcy5vdmVyYWxsSGl0UmF0ZSA+PSA2MCB8fCAhcmVkaXNBdmFpbGFibGUpIHtcbiAgICAgIHN0YXR1cyA9ICdkZWdyYWRlZCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXR1cyA9ICdjcml0aWNhbCc7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXMsXG4gICAgICBsMUF2YWlsYWJsZTogdHJ1ZSwgLy8gTDEgc2VtcHJlIGRpc3BvbsOtdmVsXG4gICAgICBsMkF2YWlsYWJsZTogcmVkaXNBdmFpbGFibGUsXG4gICAgICBtZXRyaWNzXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZXZhbHVhdGVBdWRpdG9yaWFTdGF0dXMobWV0cmljczogYW55LCByZWRpc0F2YWlsYWJsZTogYm9vbGVhbikge1xuICAgIGxldCBzdGF0dXM6ICdoZWFsdGh5JyB8ICdkZWdyYWRlZCcgfCAnY3JpdGljYWwnO1xuICAgIFxuICAgIGlmIChtZXRyaWNzLnF1ZXVlU3VjY2Vzc1JhdGUgPj0gOTUgJiYgcmVkaXNBdmFpbGFibGUpIHtcbiAgICAgIHN0YXR1cyA9ICdoZWFsdGh5JztcbiAgICB9IGVsc2UgaWYgKG1ldHJpY3MucXVldWVTdWNjZXNzUmF0ZSA+PSA4MCB8fCBtZXRyaWNzLmZhbGxiYWNrVXNhZ2VSYXRlIDwgMjApIHtcbiAgICAgIHN0YXR1cyA9ICdkZWdyYWRlZCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXR1cyA9ICdjcml0aWNhbCc7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXMsXG4gICAgICBxdWV1ZUF2YWlsYWJsZTogcmVkaXNBdmFpbGFibGUsXG4gICAgICBzeW5jRmFsbGJhY2tBY3RpdmU6IG1ldHJpY3Muc3luY0ZhbGxiYWNrcyA+IDAsXG4gICAgICBmaWxlQmFja3VwQWN0aXZlOiBtZXRyaWNzLmZpbGVCYWNrdXBzID4gMCxcbiAgICAgIG1ldHJpY3NcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVPdmVyYWxsU3RhdHVzKFxuICAgIGNhY2hlU3RhdHVzOiBzdHJpbmcsXG4gICAgYXVkaXRvcmlhU3RhdHVzOiBzdHJpbmcsXG4gICAgc2VydmljZXNTdGF0dXM6IGFueVxuICApOiAnaGVhbHRoeScgfCAnZGVncmFkZWQnIHwgJ2NyaXRpY2FsJyB7XG4gICAgY29uc3Qgc3RhdHVzZXMgPSBbY2FjaGVTdGF0dXMsIGF1ZGl0b3JpYVN0YXR1c107XG4gICAgXG4gICAgLy8gU2UgYWxndW0gc2VydmnDp28gY3LDrXRpY28gZXN0w6EgZG93blxuICAgIGlmIChzZXJ2aWNlc1N0YXR1cy5kYXRhYmFzZT8uc3RhdHVzID09PSAnZG93bicpIHtcbiAgICAgIHJldHVybiAnY3JpdGljYWwnO1xuICAgIH1cbiAgICBcbiAgICAvLyBTZSBhbGd1bSBjb21wb25lbnRlIGVzdMOhIGNyw610aWNvXG4gICAgaWYgKHN0YXR1c2VzLmluY2x1ZGVzKCdjcml0aWNhbCcpKSB7XG4gICAgICByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICB9XG4gICAgXG4gICAgLy8gU2UgYWxndW0gY29tcG9uZW50ZSBlc3TDoSBkZWdyYWRhZG9cbiAgICBpZiAoc3RhdHVzZXMuaW5jbHVkZXMoJ2RlZ3JhZGVkJykgfHwgc2VydmljZXNTdGF0dXMucmVkaXM/LnN0YXR1cyA9PT0gJ2Rvd24nKSB7XG4gICAgICByZXR1cm4gJ2RlZ3JhZGVkJztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICdoZWFsdGh5JztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVBbGVydHMoY2FjaGVNZXRyaWNzOiBhbnksIGF1ZGl0b3JpYU1ldHJpY3M6IGFueSwgc2VydmljZXNTdGF0dXM6IGFueSkge1xuICAgIGNvbnN0IGFsZXJ0czogYW55W10gPSBbXTtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgXG4gICAgLy8gQWxlcnRhcyBkZSBjYWNoZVxuICAgIGlmIChjYWNoZU1ldHJpY3Mub3ZlcmFsbEhpdFJhdGUgPCA2MCkge1xuICAgICAgYWxlcnRzLnB1c2goe1xuICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxuICAgICAgICBzZXJ2aWNlOiAnY2FjaGUnLFxuICAgICAgICBtZXNzYWdlOiBgVGF4YSBkZSBoaXQgZG8gY2FjaGUgYmFpeGE6ICR7Y2FjaGVNZXRyaWNzLm92ZXJhbGxIaXRSYXRlLnRvRml4ZWQoMSl9JWAsXG4gICAgICAgIHRpbWVzdGFtcFxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGlmIChjYWNoZU1ldHJpY3MuZmFpbG92ZXJzID4gMTApIHtcbiAgICAgIGFsZXJ0cy5wdXNoKHtcbiAgICAgICAgc2V2ZXJpdHk6ICdjcml0aWNhbCcsXG4gICAgICAgIHNlcnZpY2U6ICdjYWNoZScsXG4gICAgICAgIG1lc3NhZ2U6IGBNdWl0b3MgZmFpbG92ZXJzIGRvIGNhY2hlIEwyOiAke2NhY2hlTWV0cmljcy5mYWlsb3ZlcnN9YCxcbiAgICAgICAgdGltZXN0YW1wXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxlcnRhcyBkZSBhdWRpdG9yaWFcbiAgICBpZiAoYXVkaXRvcmlhTWV0cmljcy5xdWV1ZVN1Y2Nlc3NSYXRlIDwgOTApIHtcbiAgICAgIGFsZXJ0cy5wdXNoKHtcbiAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcbiAgICAgICAgc2VydmljZTogJ2F1ZGl0b3JpYScsXG4gICAgICAgIG1lc3NhZ2U6IGBUYXhhIGRlIHN1Y2Vzc28gZGEgZmlsYSBkZSBhdWRpdG9yaWEgYmFpeGE6ICR7YXVkaXRvcmlhTWV0cmljcy5xdWV1ZVN1Y2Nlc3NSYXRlLnRvRml4ZWQoMSl9JWAsXG4gICAgICAgIHRpbWVzdGFtcFxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGlmIChhdWRpdG9yaWFNZXRyaWNzLmZpbGVCYWNrdXBzID4gMCkge1xuICAgICAgYWxlcnRzLnB1c2goe1xuICAgICAgICBzZXZlcml0eTogJ2NyaXRpY2FsJyxcbiAgICAgICAgc2VydmljZTogJ2F1ZGl0b3JpYScsXG4gICAgICAgIG1lc3NhZ2U6IGBMb2dzIGRlIGF1ZGl0b3JpYSBzZW5kbyBzYWx2b3MgZW0gYmFja3VwOiAke2F1ZGl0b3JpYU1ldHJpY3MuZmlsZUJhY2t1cHN9YCxcbiAgICAgICAgdGltZXN0YW1wXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxlcnRhcyBkZSBzZXJ2acOnb3MgZXh0ZXJub3NcbiAgICBpZiAoc2VydmljZXNTdGF0dXMucmVkaXM/LnN0YXR1cyA9PT0gJ2Rvd24nKSB7XG4gICAgICBhbGVydHMucHVzaCh7XG4gICAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnLFxuICAgICAgICBzZXJ2aWNlOiAncmVkaXMnLFxuICAgICAgICBtZXNzYWdlOiAnUmVkaXMgaW5kaXNwb27DrXZlbCAtIHNpc3RlbWEgb3BlcmFuZG8gZW0gbW9kbyBkZWdyYWRhZG8nLFxuICAgICAgICB0aW1lc3RhbXBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBpZiAoc2VydmljZXNTdGF0dXMuZGF0YWJhc2U/LnN0YXR1cyA9PT0gJ2Rvd24nKSB7XG4gICAgICBhbGVydHMucHVzaCh7XG4gICAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnLFxuICAgICAgICBzZXJ2aWNlOiAnZGF0YWJhc2UnLFxuICAgICAgICBtZXNzYWdlOiAnQmFuY28gZGUgZGFkb3MgaW5kaXNwb27DrXZlbCcsXG4gICAgICAgIHRpbWVzdGFtcFxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBhbGVydHM7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZURhdGFMb3NzUmlzayhtZXRyaWNzOiBhbnkpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICBpZiAobWV0cmljcy5maWxlQmFja3VwcyA+IDApIHtcbiAgICAgIHJldHVybiAnaGlnaCc7XG4gICAgfVxuICAgIFxuICAgIGlmIChtZXRyaWNzLnF1ZXVlU3VjY2Vzc1JhdGUgPCA5NSkge1xuICAgICAgcmV0dXJuICdtZWRpdW0nO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gJ2xvdyc7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVN5c3RlbVJlc2lsaWVuY2UobWV0cmljczogYW55LCByZWRpc0F2YWlsYWJsZTogYm9vbGVhbik6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gMTAwO1xuICAgIFxuICAgIC8vIFBlbmFsaXphciBwb3IgZmFsaGFzIG5hIGZpbGFcbiAgICBpZiAobWV0cmljcy5xdWV1ZVN1Y2Nlc3NSYXRlIDwgMTAwKSB7XG4gICAgICBzY29yZSAtPSAoMTAwIC0gbWV0cmljcy5xdWV1ZVN1Y2Nlc3NSYXRlKSAqIDAuNTtcbiAgICB9XG4gICAgXG4gICAgLy8gUGVuYWxpemFyIHBvciB1c28gZGUgZmFsbGJhY2tzXG4gICAgc2NvcmUgLT0gbWV0cmljcy5mYWxsYmFja1VzYWdlUmF0ZSAqIDAuMztcbiAgICBcbiAgICAvLyBQZW5hbGl6YXIgcG9yIGJhY2t1cHMgZW0gYXJxdWl2b1xuICAgIHNjb3JlIC09IG1ldHJpY3MuYmFja3VwVXNhZ2VSYXRlICogMC44O1xuICAgIFxuICAgIC8vIFBlbmFsaXphciBwb3IgUmVkaXMgaW5kaXNwb27DrXZlbFxuICAgIGlmICghcmVkaXNBdmFpbGFibGUpIHtcbiAgICAgIHNjb3JlIC09IDIwO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpO1xuICB9XG59Il0sInZlcnNpb24iOjN9