0901c2030f53ae4a1c9beb1a7c08188f
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f;
Object.defineProperty(exports, "__esModule", { value: true });
exports.MetricasAnaliseController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const jwt_auth_guard_1 = require("../../../shared/guards/jwt-auth.guard");
const roles_guard_1 = require("../../../auth/guards/roles.guard");
const role_decorator_1 = require("../../../auth/decorators/role.decorator");
const roles_constants_1 = require("../../../shared/constants/roles.constants");
const metricas_service_1 = require("../services/metricas.service");
const metricas_anomalia_service_1 = require("../services/metricas-anomalia.service");
/**
 * Controlador para análise de métricas
 *
 * Este controlador fornece endpoints para:
 * 1. Analisar tendências de métricas
 * 2. Detectar anomalias em séries históricas
 * 3. Gerar previsões baseadas em dados históricos
 */
let MetricasAnaliseController = class MetricasAnaliseController {
    metricasService;
    metricasAnomaliasService;
    constructor(metricasService, metricasAnomaliasService) {
        this.metricasService = metricasService;
        this.metricasAnomaliasService = metricasAnomaliasService;
    }
    /**
     * Analisa a tendência de uma métrica específica
     */
    async analisarTendencia(codigo, dataInicio, dataFim, granularidade) {
        return this.metricasAnomaliasService.analisarTendencias(codigo, dataInicio, dataFim, { granularidade: granularidade || 'diaria' });
    }
    /**
     * Detecta anomalias em uma série histórica de métrica
     */
    async detectarAnomalias(codigo, dataInicio, dataFim, sensibilidade) {
        return this.metricasAnomaliasService.detectarAnomaliasPorCodigo(codigo, dataInicio, dataFim);
    }
    /**
     * Gera previsão baseada em dados históricos de uma métrica
     */
    async gerarPrevisao(codigo, horizonte, intervaloConfianca, modelo) {
        // Implementação temporária até que o método seja adicionado ao serviço
        return {
            codigo,
            horizonte,
            intervaloConfianca,
            modelo,
            previsao: [{ data: new Date(), valor: 0 }],
            mensagem: 'Funcionalidade em desenvolvimento',
        };
    }
};
exports.MetricasAnaliseController = MetricasAnaliseController;
__decorate([
    (0, common_1.Get)(':codigo/tendencia'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR, roles_constants_1.ROLES.TECNICO),
    (0, swagger_1.ApiOperation)({ summary: 'Analisa tendência de uma métrica' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Análise de tendência realizada com sucesso',
    }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Métrica não encontrada' }),
    __param(0, (0, common_1.Param)('codigo')),
    __param(1, (0, common_1.Query)('dataInicio')),
    __param(2, (0, common_1.Query)('dataFim')),
    __param(3, (0, common_1.Query)('granularidade')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_c = typeof Date !== "undefined" && Date) === "function" ? _c : Object, typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object, String]),
    __metadata("design:returntype", Promise)
], MetricasAnaliseController.prototype, "analisarTendencia", null);
__decorate([
    (0, common_1.Get)(':codigo/anomalias'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR, roles_constants_1.ROLES.TECNICO),
    (0, swagger_1.ApiOperation)({ summary: 'Detecta anomalias em série histórica de métrica' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Detecção de anomalias realizada com sucesso',
    }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Métrica não encontrada' }),
    __param(0, (0, common_1.Param)('codigo')),
    __param(1, (0, common_1.Query)('dataInicio')),
    __param(2, (0, common_1.Query)('dataFim')),
    __param(3, (0, common_1.Query)('sensibilidade')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object, typeof (_f = typeof Date !== "undefined" && Date) === "function" ? _f : Object, Number]),
    __metadata("design:returntype", Promise)
], MetricasAnaliseController.prototype, "detectarAnomalias", null);
__decorate([
    (0, common_1.Get)(':codigo/previsao'),
    (0, role_decorator_1.Roles)(roles_constants_1.ROLES.ADMIN, roles_constants_1.ROLES.GESTOR, roles_constants_1.ROLES.TECNICO),
    (0, swagger_1.ApiOperation)({ summary: 'Gera previsão baseada em dados históricos' }),
    (0, swagger_1.ApiResponse)({ status: 200, description: 'Previsão gerada com sucesso' }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Métrica não encontrada' }),
    __param(0, (0, common_1.Param)('codigo')),
    __param(1, (0, common_1.Query)('horizonte')),
    __param(2, (0, common_1.Query)('intervaloConfianca')),
    __param(3, (0, common_1.Query)('modelo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Number, Number, String]),
    __metadata("design:returntype", Promise)
], MetricasAnaliseController.prototype, "gerarPrevisao", null);
exports.MetricasAnaliseController = MetricasAnaliseController = __decorate([
    (0, swagger_1.ApiTags)('Métricas e Dashboard'),
    (0, swagger_1.ApiBearerAuth)(),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, roles_guard_1.RolesGuard),
    (0, common_1.Controller)('metricas/analise'),
    __metadata("design:paramtypes", [typeof (_a = typeof metricas_service_1.MetricasService !== "undefined" && metricas_service_1.MetricasService) === "function" ? _a : Object, typeof (_b = typeof metricas_anomalia_service_1.MetricasAnomaliasService !== "undefined" && metricas_anomalia_service_1.MetricasAnomaliasService) === "function" ? _b : Object])
], MetricasAnaliseController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXG1ldHJpY2FzXFxjb250cm9sbGVyc1xcbWV0cmljYXMtYW5hbGlzZS5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FBMEU7QUFDMUUsNkNBS3lCO0FBQ3pCLDBFQUFxRTtBQUNyRSxrRUFBOEQ7QUFDOUQsNEVBQWdFO0FBQ2hFLCtFQUFrRTtBQUVsRSxtRUFBK0Q7QUFDL0QscUZBQWlGO0FBRWpGOzs7Ozs7O0dBT0c7QUFLSSxJQUFNLHlCQUF5QixHQUEvQixNQUFNLHlCQUF5QjtJQUVqQjtJQUNBO0lBRm5CLFlBQ21CLGVBQWdDLEVBQ2hDLHdCQUFrRDtRQURsRCxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDaEMsNkJBQXdCLEdBQXhCLHdCQUF3QixDQUEwQjtJQUNsRSxDQUFDO0lBRUo7O09BRUc7SUFTRyxBQUFOLEtBQUssQ0FBQyxpQkFBaUIsQ0FDSixNQUFjLEVBQ1YsVUFBZ0IsRUFDbkIsT0FBYSxFQUNQLGFBQXFCO1FBRTdDLE9BQU8sSUFBSSxDQUFDLHdCQUF3QixDQUFDLGtCQUFrQixDQUNyRCxNQUFNLEVBQ04sVUFBVSxFQUNWLE9BQU8sRUFDUCxFQUFFLGFBQWEsRUFBRSxhQUFhLElBQUksUUFBUSxFQUFFLENBQzdDLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFTRyxBQUFOLEtBQUssQ0FBQyxpQkFBaUIsQ0FDSixNQUFjLEVBQ1YsVUFBZ0IsRUFDbkIsT0FBYSxFQUNQLGFBQXFCO1FBRTdDLE9BQU8sSUFBSSxDQUFDLHdCQUF3QixDQUFDLDBCQUEwQixDQUM3RCxNQUFNLEVBQ04sVUFBVSxFQUNWLE9BQU8sQ0FDUixDQUFDO0lBQ0osQ0FBQztJQUVEOztPQUVHO0lBTUcsQUFBTixLQUFLLENBQUMsYUFBYSxDQUNBLE1BQWMsRUFDWCxTQUFpQixFQUNSLGtCQUEwQixFQUN0QyxNQUFjO1FBRS9CLHVFQUF1RTtRQUN2RSxPQUFPO1lBQ0wsTUFBTTtZQUNOLFNBQVM7WUFDVCxrQkFBa0I7WUFDbEIsTUFBTTtZQUNOLFFBQVEsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQzFDLFFBQVEsRUFBRSxtQ0FBbUM7U0FDOUMsQ0FBQztJQUNKLENBQUM7Q0FDRixDQUFBO0FBL0VZLDhEQUF5QjtBQWlCOUI7SUFSTCxJQUFBLFlBQUcsRUFBQyxtQkFBbUIsQ0FBQztJQUN4QixJQUFBLHNCQUFLLEVBQUMsdUJBQUssQ0FBQyxLQUFLLEVBQUUsdUJBQUssQ0FBQyxNQUFNLEVBQUUsdUJBQUssQ0FBQyxPQUFPLENBQUM7SUFDL0MsSUFBQSxzQkFBWSxFQUFDLEVBQUUsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLENBQUM7SUFDN0QsSUFBQSxxQkFBVyxFQUFDO1FBQ1gsTUFBTSxFQUFFLEdBQUc7UUFDWCxXQUFXLEVBQUUsNENBQTRDO0tBQzFELENBQUM7SUFDRCxJQUFBLHFCQUFXLEVBQUMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSx3QkFBd0IsRUFBRSxDQUFDO0lBRWpFLFdBQUEsSUFBQSxjQUFLLEVBQUMsUUFBUSxDQUFDLENBQUE7SUFDZixXQUFBLElBQUEsY0FBSyxFQUFDLFlBQVksQ0FBQyxDQUFBO0lBQ25CLFdBQUEsSUFBQSxjQUFLLEVBQUMsU0FBUyxDQUFDLENBQUE7SUFDaEIsV0FBQSxJQUFBLGNBQUssRUFBQyxlQUFlLENBQUMsQ0FBQTs7aUVBRlUsSUFBSSxvQkFBSixJQUFJLG9EQUNWLElBQUksb0JBQUosSUFBSTs7a0VBU2hDO0FBYUs7SUFSTCxJQUFBLFlBQUcsRUFBQyxtQkFBbUIsQ0FBQztJQUN4QixJQUFBLHNCQUFLLEVBQUMsdUJBQUssQ0FBQyxLQUFLLEVBQUUsdUJBQUssQ0FBQyxNQUFNLEVBQUUsdUJBQUssQ0FBQyxPQUFPLENBQUM7SUFDL0MsSUFBQSxzQkFBWSxFQUFDLEVBQUUsT0FBTyxFQUFFLGlEQUFpRCxFQUFFLENBQUM7SUFDNUUsSUFBQSxxQkFBVyxFQUFDO1FBQ1gsTUFBTSxFQUFFLEdBQUc7UUFDWCxXQUFXLEVBQUUsNkNBQTZDO0tBQzNELENBQUM7SUFDRCxJQUFBLHFCQUFXLEVBQUMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSx3QkFBd0IsRUFBRSxDQUFDO0lBRWpFLFdBQUEsSUFBQSxjQUFLLEVBQUMsUUFBUSxDQUFDLENBQUE7SUFDZixXQUFBLElBQUEsY0FBSyxFQUFDLFlBQVksQ0FBQyxDQUFBO0lBQ25CLFdBQUEsSUFBQSxjQUFLLEVBQUMsU0FBUyxDQUFDLENBQUE7SUFDaEIsV0FBQSxJQUFBLGNBQUssRUFBQyxlQUFlLENBQUMsQ0FBQTs7aUVBRlUsSUFBSSxvQkFBSixJQUFJLG9EQUNWLElBQUksb0JBQUosSUFBSTs7a0VBUWhDO0FBVUs7SUFMTCxJQUFBLFlBQUcsRUFBQyxrQkFBa0IsQ0FBQztJQUN2QixJQUFBLHNCQUFLLEVBQUMsdUJBQUssQ0FBQyxLQUFLLEVBQUUsdUJBQUssQ0FBQyxNQUFNLEVBQUUsdUJBQUssQ0FBQyxPQUFPLENBQUM7SUFDL0MsSUFBQSxzQkFBWSxFQUFDLEVBQUUsT0FBTyxFQUFFLDJDQUEyQyxFQUFFLENBQUM7SUFDdEUsSUFBQSxxQkFBVyxFQUFDLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsNkJBQTZCLEVBQUUsQ0FBQztJQUN4RSxJQUFBLHFCQUFXLEVBQUMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSx3QkFBd0IsRUFBRSxDQUFDO0lBRWpFLFdBQUEsSUFBQSxjQUFLLEVBQUMsUUFBUSxDQUFDLENBQUE7SUFDZixXQUFBLElBQUEsY0FBSyxFQUFDLFdBQVcsQ0FBQyxDQUFBO0lBQ2xCLFdBQUEsSUFBQSxjQUFLLEVBQUMsb0JBQW9CLENBQUMsQ0FBQTtJQUMzQixXQUFBLElBQUEsY0FBSyxFQUFDLFFBQVEsQ0FBQyxDQUFBOzs7OzhEQVdqQjtvQ0E5RVUseUJBQXlCO0lBSnJDLElBQUEsaUJBQU8sRUFBQyxzQkFBc0IsQ0FBQztJQUMvQixJQUFBLHVCQUFhLEdBQUU7SUFDZixJQUFBLGtCQUFTLEVBQUMsNkJBQVksRUFBRSx3QkFBVSxDQUFDO0lBQ25DLElBQUEsbUJBQVUsRUFBQyxrQkFBa0IsQ0FBQzt5REFHTyxrQ0FBZSxvQkFBZixrQ0FBZSxvREFDTixvREFBd0Isb0JBQXhCLG9EQUF3QjtHQUgxRCx5QkFBeUIsQ0ErRXJDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxtZXRyaWNhc1xcY29udHJvbGxlcnNcXG1ldHJpY2FzLWFuYWxpc2UuY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250cm9sbGVyLCBHZXQsIFBhcmFtLCBRdWVyeSwgVXNlR3VhcmRzIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQmVhcmVyQXV0aCxcbn0gZnJvbSAnQG5lc3Rqcy9zd2FnZ2VyJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgUm9sZXNHdWFyZCB9IGZyb20gJy4uLy4uLy4uL2F1dGgvZ3VhcmRzL3JvbGVzLmd1YXJkJztcbmltcG9ydCB7IFJvbGVzIH0gZnJvbSAnLi4vLi4vLi4vYXV0aC9kZWNvcmF0b3JzL3JvbGUuZGVjb3JhdG9yJztcbmltcG9ydCB7IFJPTEVTIH0gZnJvbSAnLi4vLi4vLi4vc2hhcmVkL2NvbnN0YW50cy9yb2xlcy5jb25zdGFudHMnO1xuXG5pbXBvcnQgeyBNZXRyaWNhc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9tZXRyaWNhcy5zZXJ2aWNlJztcbmltcG9ydCB7IE1ldHJpY2FzQW5vbWFsaWFzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL21ldHJpY2FzLWFub21hbGlhLnNlcnZpY2UnO1xuXG4vKipcbiAqIENvbnRyb2xhZG9yIHBhcmEgYW7DoWxpc2UgZGUgbcOpdHJpY2FzXG4gKlxuICogRXN0ZSBjb250cm9sYWRvciBmb3JuZWNlIGVuZHBvaW50cyBwYXJhOlxuICogMS4gQW5hbGlzYXIgdGVuZMOqbmNpYXMgZGUgbcOpdHJpY2FzXG4gKiAyLiBEZXRlY3RhciBhbm9tYWxpYXMgZW0gc8OpcmllcyBoaXN0w7NyaWNhc1xuICogMy4gR2VyYXIgcHJldmlzw7VlcyBiYXNlYWRhcyBlbSBkYWRvcyBoaXN0w7NyaWNvc1xuICovXG5AQXBpVGFncygnTcOpdHJpY2FzIGUgRGFzaGJvYXJkJylcbkBBcGlCZWFyZXJBdXRoKClcbkBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkLCBSb2xlc0d1YXJkKVxuQENvbnRyb2xsZXIoJ21ldHJpY2FzL2FuYWxpc2UnKVxuZXhwb3J0IGNsYXNzIE1ldHJpY2FzQW5hbGlzZUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1ldHJpY2FzU2VydmljZTogTWV0cmljYXNTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbWV0cmljYXNBbm9tYWxpYXNTZXJ2aWNlOiBNZXRyaWNhc0Fub21hbGlhc1NlcnZpY2UsXG4gICkge31cblxuICAvKipcbiAgICogQW5hbGlzYSBhIHRlbmTDqm5jaWEgZGUgdW1hIG3DqXRyaWNhIGVzcGVjw61maWNhXG4gICAqL1xuICBAR2V0KCc6Y29kaWdvL3RlbmRlbmNpYScpXG4gIEBSb2xlcyhST0xFUy5BRE1JTiwgUk9MRVMuR0VTVE9SLCBST0xFUy5URUNOSUNPKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ0FuYWxpc2EgdGVuZMOqbmNpYSBkZSB1bWEgbcOpdHJpY2EnIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdBbsOhbGlzZSBkZSB0ZW5kw6puY2lhIHJlYWxpemFkYSBjb20gc3VjZXNzbycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDA0LCBkZXNjcmlwdGlvbjogJ03DqXRyaWNhIG7Do28gZW5jb250cmFkYScgfSlcbiAgYXN5bmMgYW5hbGlzYXJUZW5kZW5jaWEoXG4gICAgQFBhcmFtKCdjb2RpZ28nKSBjb2RpZ286IHN0cmluZyxcbiAgICBAUXVlcnkoJ2RhdGFJbmljaW8nKSBkYXRhSW5pY2lvOiBEYXRlLFxuICAgIEBRdWVyeSgnZGF0YUZpbScpIGRhdGFGaW06IERhdGUsXG4gICAgQFF1ZXJ5KCdncmFudWxhcmlkYWRlJykgZ3JhbnVsYXJpZGFkZTogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNhc0Fub21hbGlhc1NlcnZpY2UuYW5hbGlzYXJUZW5kZW5jaWFzKFxuICAgICAgY29kaWdvLFxuICAgICAgZGF0YUluaWNpbyxcbiAgICAgIGRhdGFGaW0sXG4gICAgICB7IGdyYW51bGFyaWRhZGU6IGdyYW51bGFyaWRhZGUgfHwgJ2RpYXJpYScgfSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVjdGEgYW5vbWFsaWFzIGVtIHVtYSBzw6lyaWUgaGlzdMOzcmljYSBkZSBtw6l0cmljYVxuICAgKi9cbiAgQEdldCgnOmNvZGlnby9hbm9tYWxpYXMnKVxuICBAUm9sZXMoUk9MRVMuQURNSU4sIFJPTEVTLkdFU1RPUiwgUk9MRVMuVEVDTklDTylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdEZXRlY3RhIGFub21hbGlhcyBlbSBzw6lyaWUgaGlzdMOzcmljYSBkZSBtw6l0cmljYScgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ0RldGVjw6fDo28gZGUgYW5vbWFsaWFzIHJlYWxpemFkYSBjb20gc3VjZXNzbycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDA0LCBkZXNjcmlwdGlvbjogJ03DqXRyaWNhIG7Do28gZW5jb250cmFkYScgfSlcbiAgYXN5bmMgZGV0ZWN0YXJBbm9tYWxpYXMoXG4gICAgQFBhcmFtKCdjb2RpZ28nKSBjb2RpZ286IHN0cmluZyxcbiAgICBAUXVlcnkoJ2RhdGFJbmljaW8nKSBkYXRhSW5pY2lvOiBEYXRlLFxuICAgIEBRdWVyeSgnZGF0YUZpbScpIGRhdGFGaW06IERhdGUsXG4gICAgQFF1ZXJ5KCdzZW5zaWJpbGlkYWRlJykgc2Vuc2liaWxpZGFkZTogbnVtYmVyLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNhc0Fub21hbGlhc1NlcnZpY2UuZGV0ZWN0YXJBbm9tYWxpYXNQb3JDb2RpZ28oXG4gICAgICBjb2RpZ28sXG4gICAgICBkYXRhSW5pY2lvLFxuICAgICAgZGF0YUZpbSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlcmEgcHJldmlzw6NvIGJhc2VhZGEgZW0gZGFkb3MgaGlzdMOzcmljb3MgZGUgdW1hIG3DqXRyaWNhXG4gICAqL1xuICBAR2V0KCc6Y29kaWdvL3ByZXZpc2FvJylcbiAgQFJvbGVzKFJPTEVTLkFETUlOLCBST0xFUy5HRVNUT1IsIFJPTEVTLlRFQ05JQ08pXG4gIEBBcGlPcGVyYXRpb24oeyBzdW1tYXJ5OiAnR2VyYSBwcmV2aXPDo28gYmFzZWFkYSBlbSBkYWRvcyBoaXN0w7NyaWNvcycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiAyMDAsIGRlc2NyaXB0aW9uOiAnUHJldmlzw6NvIGdlcmFkYSBjb20gc3VjZXNzbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDQsIGRlc2NyaXB0aW9uOiAnTcOpdHJpY2EgbsOjbyBlbmNvbnRyYWRhJyB9KVxuICBhc3luYyBnZXJhclByZXZpc2FvKFxuICAgIEBQYXJhbSgnY29kaWdvJykgY29kaWdvOiBzdHJpbmcsXG4gICAgQFF1ZXJ5KCdob3Jpem9udGUnKSBob3Jpem9udGU6IG51bWJlcixcbiAgICBAUXVlcnkoJ2ludGVydmFsb0NvbmZpYW5jYScpIGludGVydmFsb0NvbmZpYW5jYTogbnVtYmVyLFxuICAgIEBRdWVyeSgnbW9kZWxvJykgbW9kZWxvOiBzdHJpbmcsXG4gICkge1xuICAgIC8vIEltcGxlbWVudGHDp8OjbyB0ZW1wb3LDoXJpYSBhdMOpIHF1ZSBvIG3DqXRvZG8gc2VqYSBhZGljaW9uYWRvIGFvIHNlcnZpw6dvXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvZGlnbyxcbiAgICAgIGhvcml6b250ZSxcbiAgICAgIGludGVydmFsb0NvbmZpYW5jYSxcbiAgICAgIG1vZGVsbyxcbiAgICAgIHByZXZpc2FvOiBbeyBkYXRhOiBuZXcgRGF0ZSgpLCB2YWxvcjogMCB9XSxcbiAgICAgIG1lbnNhZ2VtOiAnRnVuY2lvbmFsaWRhZGUgZW0gZGVzZW52b2x2aW1lbnRvJyxcbiAgICB9O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=