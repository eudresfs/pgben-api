{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\modules\\recurso\\controllers\\recurso.controller.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\modules\\recurso\\controllers\\recurso.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Body,\n  Param,\n  ParseUUIDPipe,\n  Put,\n  Query,\n  UseGuards,\n  Req,\n  NotFoundException,\n  BadRequestException,\n  UnauthorizedException,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiQuery,\n  ApiBody,\n} from '@nestjs/swagger';\nimport { RecursoService } from '../services/recurso.service';\nimport { CreateRecursoDto } from '../dto/create-recurso.dto';\nimport { AnalisarRecursoDto } from '../dto/analisar-recurso.dto';\nimport { JwtAuthGuard } from '../../../auth/guards/jwt-auth.guard';\nimport { PermissionGuard } from '../../../auth/guards/permission.guard';\nimport { RequiresPermission } from '../../../auth/decorators/requires-permission.decorator';\nimport { ScopeType } from '../../../entities/user-permission.entity';\nimport { StatusRecurso } from '../../../entities/recurso.entity';\nimport { Request } from 'express';\n\n/**\n * Controlador de Recursos de Primeira Instância\n *\n * Responsável por gerenciar as rotas relacionadas aos recursos de primeira instância\n * para solicitações de benefícios indeferidas\n */\n@ApiTags('Recursos')\n@Controller('recursos')\n@UseGuards(JwtAuthGuard, PermissionGuard)\n@ApiBearerAuth()\nexport class RecursoController {\n  constructor(private readonly recursoService: RecursoService) {}\n\n  /**\n   * Lista todos os recursos com filtros e paginação\n   */\n  @Get()\n  @RequiresPermission({\n    permissionName: 'recurso.listar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'query.setor_id',\n  })\n  @ApiOperation({ summary: 'Listar recursos' })\n  @ApiResponse({\n    status: 200,\n    description: 'Lista de recursos retornada com sucesso',\n  })\n  @ApiQuery({\n    name: 'page',\n    required: false,\n    type: Number,\n    description: 'Página atual',\n  })\n  @ApiQuery({\n    name: 'limit',\n    required: false,\n    type: Number,\n    description: 'Itens por página',\n  })\n  @ApiQuery({\n    name: 'status',\n    required: false,\n    enum: StatusRecurso,\n    description: 'Filtro por status',\n  })\n  @ApiQuery({\n    name: 'solicitacao_id',\n    required: false,\n    type: String,\n    description: 'Filtro por solicitação',\n  })\n  @ApiQuery({\n    name: 'setor_id',\n    required: false,\n    type: String,\n    description: 'Filtro por setor responsável',\n  })\n  @ApiQuery({\n    name: 'data_inicio',\n    required: false,\n    type: String,\n    description: 'Data inicial (formato: YYYY-MM-DD)',\n  })\n  @ApiQuery({\n    name: 'data_fim',\n    required: false,\n    type: String,\n    description: 'Data final (formato: YYYY-MM-DD)',\n  })\n  async findAll(\n    @Req() req: Request,\n    @Query('page') page?: number,\n    @Query('limit') limit?: number,\n    @Query('status') status?: StatusRecurso,\n    @Query('solicitacao_id') solicitacao_id?: string,\n    @Query('setor_id') setor_id?: string,\n    @Query('data_inicio') data_inicio?: string,\n    @Query('data_fim') data_fim?: string,\n  ) {\n    const user = req.user;\n\n    return this.recursoService.findAll({\n      page: page ? +page : undefined,\n      limit: limit ? +limit : undefined,\n      status,\n      solicitacao_id,\n      setor_id,\n      data_inicio,\n      data_fim,\n      user,\n    });\n  }\n\n  /**\n   * Obtém detalhes de um recurso específico\n   */\n  @Get(':id')\n  @RequiresPermission({\n    permissionName: 'recurso.visualizar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @ApiOperation({ summary: 'Obter detalhes de um recurso' })\n  @ApiResponse({\n    status: 200,\n    description: 'Recurso encontrado com sucesso',\n  })\n  @ApiResponse({ status: 404, description: 'Recurso não encontrado' })\n  async findOne(@Param('id', ParseUUIDPipe) id: string) {\n    return this.recursoService.findById(id);\n  }\n\n  /**\n   * Cria um novo recurso\n   */\n  @Post()\n  @RequiresPermission({\n    permissionName: 'recurso.criar',\n    scopeType: ScopeType.GLOBAL,\n  })\n  @ApiOperation({ summary: 'Criar novo recurso' })\n  @ApiResponse({ status: 201, description: 'Recurso criado com sucesso' })\n  @ApiResponse({\n    status: 400,\n    description: 'Dados inválidos para criação do recurso',\n  })\n  @ApiBody({ type: CreateRecursoDto })\n  async create(\n    @Body() createRecursoDto: CreateRecursoDto,\n    @Req() req: Request,\n  ) {\n    const user = req.user;\n    return this.recursoService.create(createRecursoDto, user);\n  }\n\n  /**\n   * Lista recursos de uma solicitação específica\n   */\n  @Get('solicitacao/:solicitacaoId')\n  @RequiresPermission({\n    permissionName: 'recurso.listar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'solicitacao.unidadeId',\n  })\n  @ApiOperation({ summary: 'Listar recursos de uma solicitação' })\n  @ApiResponse({\n    status: 200,\n    description: 'Lista de recursos retornada com sucesso',\n  })\n  @ApiResponse({ status: 404, description: 'Solicitação não encontrada' })\n  async findBySolicitacao(\n    @Param('solicitacaoId') solicitacaoId: string,\n    @Req() req: Request,\n  ) {\n    const user = req.user;\n\n    return this.recursoService.findAll({\n      solicitacao_id: solicitacaoId,\n      user,\n    });\n  }\n\n  /**\n   * Inicia a análise de um recurso\n   */\n  @Put(':id/iniciar-analise')\n  @RequiresPermission({\n    permissionName: 'recurso.analisar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @ApiOperation({ summary: 'Iniciar análise de um recurso' })\n  @ApiResponse({\n    status: 200,\n    description: 'Análise iniciada com sucesso',\n  })\n  @ApiResponse({\n    status: 400,\n    description: 'Recurso não pode ser analisado',\n  })\n  @ApiResponse({ status: 404, description: 'Recurso não encontrado' })\n  async iniciarAnalise(\n    @Param('id', ParseUUIDPipe) id: string,\n    @Req() req: Request,\n  ) {\n    const user = req.user;\n    return this.recursoService.iniciarAnalise(id, user);\n  }\n\n  /**\n   * Analisa um recurso (deferir/indeferir)\n   */\n  @Put(':id/analisar')\n  @RequiresPermission({\n    permissionName: 'recurso.analisar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @ApiOperation({ summary: 'Analisar um recurso' })\n  @ApiResponse({ status: 200, description: 'Recurso analisado com sucesso' })\n  @ApiResponse({\n    status: 400,\n    description: 'Recurso não pode ser analisado',\n  })\n  @ApiResponse({ status: 404, description: 'Recurso não encontrado' })\n  @ApiBody({ type: AnalisarRecursoDto })\n  async analisarRecurso(\n    @Param('id', ParseUUIDPipe) id: string,\n    @Body() analisarRecursoDto: AnalisarRecursoDto,\n    @Req() req: Request,\n  ) {\n    const user = req.user;\n    return this.recursoService.analisarRecurso(id, analisarRecursoDto, user);\n  }\n\n  /**\n   * Cancela um recurso\n   */\n  @Put(':id/cancelar')\n  @RequiresPermission({\n    permissionName: 'recurso.cancelar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @ApiOperation({ summary: 'Cancelar recurso' })\n  @ApiResponse({ status: 200, description: 'Recurso cancelado com sucesso' })\n  @ApiResponse({\n    status: 400,\n    description: 'Recurso não pode ser cancelado',\n  })\n  @ApiResponse({ status: 404, description: 'Recurso não encontrado' })\n  async cancelarRecurso(\n    @Param('id', ParseUUIDPipe) id: string,\n    @Req() req: Request,\n  ) {\n    const user = req.user;\n    return this.recursoService.cancelarRecurso(id, user);\n  }\n\n  /**\n   * Lista o histórico de um recurso\n   */\n  @Get(':id/historico')\n  @RequiresPermission({\n    permissionName: 'recurso.visualizar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @RequiresPermission({\n    permissionName: 'recurso.historico.visualizar',\n    scopeType: ScopeType.UNIT,\n    scopeIdExpression: 'recurso.setorResponsavelId',\n  })\n  @ApiOperation({ summary: 'Listar histórico de um recurso' })\n  @ApiResponse({ status: 200, description: 'Histórico retornado com sucesso' })\n  @ApiResponse({ status: 404, description: 'Recurso não encontrado' })\n  async getHistorico(@Param('id', ParseUUIDPipe) id: string) {\n    return this.recursoService.getHistorico(id);\n  }\n}\n"],"version":3}