262ef81d9d0530933a06089ceaa65b19
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const status_transition_validator_1 = require("../../../validators/status-transition-validator");
const status_pagamento_enum_1 = require("../../../enums/status-pagamento.enum");
describe('StatusTransitionValidator', () => {
    let validator;
    beforeEach(() => {
        validator = new status_transition_validator_1.StatusTransitionValidator();
    });
    describe('canTransition', () => {
        it('deve permitir transição de AGENDADO para LIBERADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de LIBERADO para CONFIRMADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de AGENDADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de LIBERADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve rejeitar transição de CONFIRMADO para LIBERADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('não permitida');
        });
        it('deve rejeitar transição de CANCELADO para qualquer outro status', () => {
            const resultParaLiberado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            const resultParaConfirmado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            const resultParaAgendado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(resultParaLiberado.allowed).toBeFalsy();
            expect(resultParaConfirmado.allowed).toBeFalsy();
            expect(resultParaAgendado.allowed).toBeFalsy();
        });
        it('deve rejeitar transição para o mesmo status', () => {
            const resultAgendado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            const resultLiberado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(resultAgendado.allowed).toBeFalsy();
            expect(resultLiberado.allowed).toBeFalsy();
            expect(resultAgendado.message).toContain('mesmo status');
            expect(resultLiberado.message).toContain('mesmo status');
        });
        it('deve rejeitar transição para status inválido', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, 'STATUS_INEXISTENTE');
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('inválido');
        });
        it('deve rejeitar transição de CONFIRMADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('não permitida');
        });
    });
    describe('getValidTransitions', () => {
        it('deve retornar as transições válidas para AGENDADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(2);
        });
        it('deve retornar as transições válidas para LIBERADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(2);
        });
        it('deve retornar lista vazia para CONFIRMADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(transitions.length).toBe(0);
        });
        it('deve retornar lista vazia para CANCELADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(0);
        });
        it('deve retornar lista vazia para status inválido', () => {
            const transitions = validator.getValidTransitions('STATUS_INEXISTENTE');
            expect(transitions.length).toBe(0);
        });
    });
    describe('getTransitionMatrix', () => {
        it('deve retornar a matriz de transição completa', () => {
            const matrix = validator.getTransitionMatrix();
            // Verifica se a matriz tem a estrutura esperada
            expect(matrix).toBeDefined();
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            // Verifica transições específicas
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO]).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO]).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO].length).toBe(0);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO].length).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXHVuaXRcXHZhbGlkYXRvcnNcXHN0YXR1cy10cmFuc2l0aW9uLXZhbGlkYXRvci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsaUdBQTRGO0FBQzVGLGdGQUEyRTtBQUUzRSxRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLElBQUksU0FBb0MsQ0FBQztJQUV6QyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsU0FBUyxHQUFHLElBQUksdURBQXlCLEVBQUUsQ0FBQztJQUM5QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxHQUFHLEVBQUU7WUFDM0QsTUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLGFBQWEsQ0FDcEMsMkNBQW1CLENBQUMsUUFBUSxFQUM1QiwyQ0FBbUIsQ0FBQyxRQUFRLENBQzdCLENBQUM7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1lBQzdELE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQ3BDLDJDQUFtQixDQUFDLFFBQVEsRUFDNUIsMkNBQW1CLENBQUMsVUFBVSxDQUMvQixDQUFDO1lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNwQyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIs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Q0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUQsTUFBTSxDQUFDLE1BQU0sQ0FBQywyQ0FBbUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxwYWdhbWVudG9cXHRlc3RzXFx1bml0XFx2YWxpZGF0b3JzXFxzdGF0dXMtdHJhbnNpdGlvbi12YWxpZGF0b3Iuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yIH0gZnJvbSAnLi4vLi4vLi4vdmFsaWRhdG9ycy9zdGF0dXMtdHJhbnNpdGlvbi12YWxpZGF0b3InO1xuaW1wb3J0IHsgU3RhdHVzUGFnYW1lbnRvRW51bSB9IGZyb20gJy4uLy4uLy4uL2VudW1zL3N0YXR1cy1wYWdhbWVudG8uZW51bSc7XG5cbmRlc2NyaWJlKCdTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yJywgKCkgPT4ge1xuICBsZXQgdmFsaWRhdG9yOiBTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHZhbGlkYXRvciA9IG5ldyBTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjYW5UcmFuc2l0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHBlcm1pdGlyIHRyYW5zacOnw6NvIGRlIEFHRU5EQURPIHBhcmEgTElCRVJBRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETywgXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZVRydXRoeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdUcmFuc2nDp8OjbyBwZXJtaXRpZGEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHBlcm1pdGlyIHRyYW5zacOnw6NvIGRlIExJQkVSQURPIHBhcmEgQ09ORklSTUFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPLCBcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVHJhbnNpw6fDo28gcGVybWl0aWRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBBR0VOREFETyBwYXJhIENBTkNFTEFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLCBcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE9cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZVRydXRoeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdUcmFuc2nDp8OjbyBwZXJtaXRpZGEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHBlcm1pdGlyIHRyYW5zacOnw6NvIGRlIExJQkVSQURPIHBhcmEgQ0FOQ0VMQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sIFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFET1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxvd2VkKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1RyYW5zacOnw6NvIHBlcm1pdGlkYScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgdHJhbnNpw6fDo28gZGUgQ09ORklSTUFETyBwYXJhIExJQkVSQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETywgXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQ29udGFpbignbsOjbyBwZXJtaXRpZGEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIHRyYW5zacOnw6NvIGRlIENBTkNFTEFETyBwYXJhIHF1YWxxdWVyIG91dHJvIHN0YXR1cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdFBhcmFMaWJlcmFkbyA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETywgXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdFBhcmFDb25maXJtYWRvID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPLCBcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHRQYXJhQWdlbmRhZG8gPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8sIFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0UGFyYUxpYmVyYWRvLmFsbG93ZWQpLnRvQmVGYWxzeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdFBhcmFDb25maXJtYWRvLmFsbG93ZWQpLnRvQmVGYWxzeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdFBhcmFBZ2VuZGFkby5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIHRyYW5zacOnw6NvIHBhcmEgbyBtZXNtbyBzdGF0dXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRBZ2VuZGFkbyA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLCBcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFET1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0TGliZXJhZG8gPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETywgXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRBZ2VuZGFkby5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICAgIGV4cGVjdChyZXN1bHRMaWJlcmFkby5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICAgIGV4cGVjdChyZXN1bHRBZ2VuZGFkby5tZXNzYWdlKS50b0NvbnRhaW4oJ21lc21vIHN0YXR1cycpO1xuICAgICAgZXhwZWN0KHJlc3VsdExpYmVyYWRvLm1lc3NhZ2UpLnRvQ29udGFpbignbWVzbW8gc3RhdHVzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciB0cmFuc2nDp8OjbyBwYXJhIHN0YXR1cyBpbnbDoWxpZG8nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETywgXG4gICAgICAgICdTVEFUVVNfSU5FWElTVEVOVEUnIGFzIFN0YXR1c1BhZ2FtZW50b0VudW1cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQ29udGFpbignaW52w6FsaWRvJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciB0cmFuc2nDp8OjbyBkZSBDT05GSVJNQURPIHBhcmEgQ0FOQ0VMQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETywgXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVGYWxzeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0NvbnRhaW4oJ27Do28gcGVybWl0aWRhJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRWYWxpZFRyYW5zaXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIGFzIHRyYW5zacOnw7VlcyB2w6FsaWRhcyBwYXJhIEFHRU5EQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNpdGlvbnMgPSB2YWxpZGF0b3IuZ2V0VmFsaWRUcmFuc2l0aW9ucyhTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyk7XG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyk7XG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMubGVuZ3RoKS50b0JlKDIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgYXMgdHJhbnNpw6fDtWVzIHbDoWxpZGFzIHBhcmEgTElCRVJBRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2l0aW9ucyA9IHZhbGlkYXRvci5nZXRWYWxpZFRyYW5zaXRpb25zKFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8pO1xuICAgICAgXG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8pO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGxpc3RhIHZhemlhIHBhcmEgQ09ORklSTUFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGxpc3RhIHZhemlhIHBhcmEgQ0FOQ0VMQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNpdGlvbnMgPSB2YWxpZGF0b3IuZ2V0VmFsaWRUcmFuc2l0aW9ucyhTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh0cmFuc2l0aW9ucy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBsaXN0YSB2YXppYSBwYXJhIHN0YXR1cyBpbnbDoWxpZG8nLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2l0aW9ucyA9IHZhbGlkYXRvci5nZXRWYWxpZFRyYW5zaXRpb25zKCdTVEFUVVNfSU5FWElTVEVOVEUnIGFzIFN0YXR1c1BhZ2FtZW50b0VudW0pO1xuICAgICAgXG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0VHJhbnNpdGlvbk1hdHJpeCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBhIG1hdHJpeiBkZSB0cmFuc2nDp8OjbyBjb21wbGV0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1hdHJpeCA9IHZhbGlkYXRvci5nZXRUcmFuc2l0aW9uTWF0cml4KCk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmaWNhIHNlIGEgbWF0cml6IHRlbSBhIGVzdHJ1dHVyYSBlc3BlcmFkYVxuICAgICAgZXhwZWN0KG1hdHJpeCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChPYmplY3Qua2V5cyhtYXRyaXgpKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyk7XG4gICAgICBleHBlY3QoT2JqZWN0LmtleXMobWF0cml4KSkudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8pO1xuICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKG1hdHJpeCkpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKG1hdHJpeCkpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmaWNhIHRyYW5zacOnw7VlcyBlc3BlY8OtZmljYXNcbiAgICAgIGV4cGVjdChtYXRyaXhbU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFET10pLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPKTtcbiAgICAgIGV4cGVjdChtYXRyaXhbU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFET10pLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KG1hdHJpeFtTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE9dLmxlbmd0aCkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChtYXRyaXhbU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE9dLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==