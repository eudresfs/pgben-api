7f5ab655465a231ca87b15d7457a5c4f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const parametro_service_1 = require("../services/parametro.service");
const parametro_repository_1 = require("../repositories/parametro.repository");
const parametro_tipo_enum_1 = require("../enums/parametro-tipo.enum");
const common_1 = require("@nestjs/common");
const cache_manager_1 = require("@nestjs/cache-manager");
// Mock do Cache Manager
const mockCacheManager = {
    get: jest.fn(),
    set: jest.fn(),
    del: jest.fn(),
};
// Mock do Repositório
const mockParametroRepository = {
    findByChave: jest.fn(),
    findAll: jest.fn(),
    findByCategoria: jest.fn(),
    save: jest.fn(),
    remove: jest.fn(),
};
describe('ParametroService', () => {
    let service;
    let repository;
    let cacheManager;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                parametro_service_1.ParametroService,
                {
                    provide: parametro_repository_1.ParametroRepository,
                    useValue: mockParametroRepository,
                },
                {
                    provide: cache_manager_1.CACHE_MANAGER,
                    useValue: mockCacheManager,
                },
            ],
        }).compile();
        service = module.get(parametro_service_1.ParametroService);
        repository = module.get(parametro_repository_1.ParametroRepository);
        cacheManager = module.get(cache_manager_1.CACHE_MANAGER);
        // Limpar todos os mocks antes de cada teste
        jest.clearAllMocks();
    });
    it('deve ser definido', () => {
        expect(service).toBeDefined();
        expect(repository).toBeDefined();
        expect(cacheManager).toBeDefined();
    });
    describe('buscarPorChave', () => {
        it('deve retornar um parâmetro pelo cache quando disponível', async () => {
            // Arrange
            const parametroMock = {
                id: '1',
                chave: 'sistema.nome',
                valor: 'PGBen',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Nome do sistema',
                categoria: 'sistema',
            };
            jest.spyOn(cacheManager, 'get').mockResolvedValue(parametroMock);
            // Act
            const resultado = await service.buscarPorChave('sistema.nome');
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:sistema.nome');
            expect(repository.findByChave).not.toHaveBeenCalled();
        });
        it('deve retornar um parâmetro do repositório quando não estiver no cache', async () => {
            // Arrange
            const parametroMock = {
                id: '1',
                chave: 'sistema.nome',
                valor: 'PGBen',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Nome do sistema',
                categoria: 'sistema',
            };
            jest.spyOn(cacheManager, 'get').mockResolvedValue(null);
            jest.spyOn(repository, 'findByChave').mockResolvedValue(parametroMock);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.buscarPorChave('sistema.nome');
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:sistema.nome');
            expect(repository.findByChave).toHaveBeenCalledWith('sistema.nome');
            expect(cacheManager.set).toHaveBeenCalledWith('parametro:sistema.nome', parametroMock, { ttl: 3600 });
        });
        it('deve lançar NotFoundException quando o parâmetro não for encontrado', async () => {
            // Arrange
            jest.spyOn(cacheManager, 'get').mockResolvedValue(null);
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.buscarPorChave('parametro.inexistente'))
                .rejects
                .toThrow(common_1.NotFoundException);
            expect(cacheManager.get).toHaveBeenCalledWith('parametro:parametro.inexistente');
            expect(repository.findByChave).toHaveBeenCalledWith('parametro.inexistente');
        });
    });
    describe('buscarTodos', () => {
        it('deve retornar todos os parâmetros', async () => {
            // Arrange
            const parametrosMock = [
                {
                    id: '1',
                    chave: 'sistema.nome',
                    valor: 'PGBen',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Nome do sistema',
                    categoria: 'sistema',
                },
                {
                    id: '2',
                    chave: 'sistema.versao',
                    valor: '1.0.0',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Versão do sistema',
                    categoria: 'sistema',
                },
            ];
            jest.spyOn(repository, 'findAll').mockResolvedValue(parametrosMock);
            // Act
            const resultado = await service.buscarTodos();
            // Assert
            expect(resultado).toEqual(parametrosMock);
            expect(repository.findAll).toHaveBeenCalled();
        });
    });
    describe('buscarPorCategoria', () => {
        it('deve retornar parâmetros filtrados por categoria', async () => {
            // Arrange
            const parametrosMock = [
                {
                    id: '1',
                    chave: 'sistema.nome',
                    valor: 'PGBen',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Nome do sistema',
                    categoria: 'sistema',
                },
                {
                    id: '2',
                    chave: 'sistema.versao',
                    valor: '1.0.0',
                    tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                    descricao: 'Versão do sistema',
                    categoria: 'sistema',
                },
            ];
            jest.spyOn(repository, 'findByCategoria').mockResolvedValue(parametrosMock);
            // Act
            const resultado = await service.buscarPorCategoria('sistema');
            // Assert
            expect(resultado).toEqual(parametrosMock);
            expect(repository.findByCategoria).toHaveBeenCalledWith('sistema');
        });
    });
    describe('criar', () => {
        it('deve criar um novo parâmetro com sucesso', async () => {
            // Arrange
            const dto = {
                chave: 'novo.parametro',
                valor: 'Valor do novo parâmetro',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição do novo parâmetro',
                categoria: 'novo',
            };
            const parametroMock = {
                id: '3',
                ...dto,
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            jest.spyOn(repository, 'save').mockResolvedValue(parametroMock);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.criar(dto);
            // Assert
            expect(resultado).toEqual(parametroMock);
            expect(repository.findByChave).toHaveBeenCalledWith('novo.parametro');
            expect(repository.save).toHaveBeenCalledWith(expect.objectContaining(dto));
            expect(cacheManager.set).toHaveBeenCalledWith('parametro:novo.parametro', parametroMock, { ttl: 3600 });
        });
        it('deve lançar BadRequestException ao tentar criar um parâmetro com chave existente', async () => {
            // Arrange
            const dto = {
                chave: 'parametro.existente',
                valor: 'Valor do parâmetro',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição do parâmetro',
                categoria: 'existente',
            };
            const parametroExistente = {
                id: '4',
                ...dto,
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(parametroExistente);
            // Act & Assert
            await expect(service.criar(dto))
                .rejects
                .toThrow(common_1.BadRequestException);
            expect(repository.findByChave).toHaveBeenCalledWith('parametro.existente');
            expect(repository.save).not.toHaveBeenCalled();
        });
    });
    describe('atualizar', () => {
        it('deve atualizar um parâmetro existente com sucesso', async () => {
            // Arrange
            const chave = 'parametro.existente';
            const dto = {
                valor: 'Novo valor',
                descricao: 'Nova descrição',
                categoria: 'categoria-atualizada',
            };
            const parametroExistente = {
                id: '5',
                chave,
                valor: 'Valor antigo',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição antiga',
                categoria: 'categoria-antiga',
            };
            const parametroAtualizado = {
                ...parametroExistente,
                ...dto,
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(parametroExistente);
            jest.spyOn(repository, 'save').mockResolvedValue(parametroAtualizado);
            jest.spyOn(cacheManager, 'set').mockResolvedValue(undefined);
            // Act
            const resultado = await service.atualizar(chave, dto);
            // Assert
            expect(resultado).toEqual(parametroAtualizado);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.save).toHaveBeenCalledWith(expect.objectContaining({
                ...parametroExistente,
                ...dto,
            }));
            expect(cacheManager.set).toHaveBeenCalledWith(`parametro:${chave}`, parametroAtualizado, { ttl: 3600 });
        });
        it('deve lançar NotFoundException ao tentar atualizar um parâmetro inexistente', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            const dto = {
                valor: 'Novo valor',
                descricao: 'Nova descrição',
                categoria: 'nova-categoria',
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.atualizar(chave, dto))
                .rejects
                .toThrow(common_1.NotFoundException);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.save).not.toHaveBeenCalled();
        });
    });
    describe('remover', () => {
        it('deve remover um parâmetro existente com sucesso', async () => {
            // Arrange
            const chave = 'parametro.existente';
            const parametroExistente = {
                id: '6',
                chave,
                valor: 'Valor',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.STRING,
                descricao: 'Descrição',
                categoria: 'categoria',
            };
            jest.spyOn(repository, 'findByChave').mockResolvedValue(parametroExistente);
            jest.spyOn(repository, 'remove').mockResolvedValue(undefined);
            jest.spyOn(cacheManager, 'del').mockResolvedValue(undefined);
            // Act
            await service.remover(chave);
            // Assert
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.remove).toHaveBeenCalledWith(parametroExistente);
            expect(cacheManager.del).toHaveBeenCalledWith(`parametro:${chave}`);
        });
        it('deve lançar NotFoundException ao tentar remover um parâmetro inexistente', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            jest.spyOn(repository, 'findByChave').mockResolvedValue(null);
            // Act & Assert
            await expect(service.remover(chave))
                .rejects
                .toThrow(common_1.NotFoundException);
            expect(repository.findByChave).toHaveBeenCalledWith(chave);
            expect(repository.remove).not.toHaveBeenCalled();
            expect(cacheManager.del).not.toHaveBeenCalled();
        });
    });
    describe('obterValorTipado', () => {
        it('deve retornar o valor tipado para um parâmetro existente', async () => {
            // Arrange
            const chave = 'numero.parametro';
            const parametroMock = {
                id: '7',
                chave,
                valor: '123',
                tipo: parametro_tipo_enum_1.ParametroTipoEnum.NUMBER,
                descricao: 'Parâmetro numérico',
                categoria: 'numeros',
            };
            jest.spyOn(service, 'buscarPorChave').mockResolvedValue(parametroMock);
            // Act
            const resultado = await service.obterValorTipado(chave);
            // Assert
            expect(resultado).toBe(123);
            expect(service.buscarPorChave).toHaveBeenCalledWith(chave);
        });
        it('deve retornar o valor padrão quando o parâmetro não existir', async () => {
            // Arrange
            const chave = 'parametro.inexistente';
            const valorPadrao = 'valor padrão';
            jest.spyOn(service, 'buscarPorChave').mockImplementation(() => {
                throw new common_1.NotFoundException(`Parâmetro com chave '${chave}' não encontrado`);
            });
            // Act
            const resultado = await service.obterValorTipado(chave, valorPadrao);
            // Assert
            expect(resultado).toBe(valorPadrao);
            expect(service.buscarPorChave).toHaveBeenCalledWith(chave);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNvbmZpZ3VyYWNhb1xcdGVzdHNcXHBhcmFtZXRyby5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQscUVBQWlFO0FBQ2pFLCtFQUEyRTtBQUczRSxzRUFBaUU7QUFDakUsMkNBQXdFO0FBQ3hFLHlEQUFzRDtBQUd0RCx3QkFBd0I7QUFDeEIsTUFBTSxnQkFBZ0IsR0FBRztJQUN2QixHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNkLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2QsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDZixDQUFDO0FBRUYsc0JBQXNCO0FBQ3RCLE1BQU0sdUJBQXVCLEdBQUc7SUFDOUIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdEIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDbEIsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDMUIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNsQixDQUFDO0FBRUYsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLE9BQXlCLENBQUM7SUFDOUIsSUFBSSxVQUErQixDQUFDO0lBQ3BDLElBQUksWUFBbUIsQ0FBQztJQUV4QixVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsTUFBTSxNQUFNLEdBQWtCLE1BQU0sY0FBSSxDQUFDLG1CQUFtQixDQUFDO1lBQzNELFNBQVMsRUFBRTtnQkFDVCxvQ0FBZ0I7Z0JBQ2hCO29CQUNFLE9BQU8sRUFBRSwwQ0FBbUI7b0JBQzVCLFFBQVEsRUFBRSx1QkFBdUI7aUJBQ2xDO2dCQUNEO29CQUNFLE9BQU8sRUFB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OlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcY29uZmlndXJhY2FvXFx0ZXN0c1xccGFyYW1ldHJvLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IFBhcmFtZXRyb1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9wYXJhbWV0cm8uc2VydmljZSc7XG5pbXBvcnQgeyBQYXJhbWV0cm9SZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL3BhcmFtZXRyby5yZXBvc2l0b3J5JztcbmltcG9ydCB7IFBhcmFtZXRyb0NyZWF0ZUR0byB9IGZyb20gJy4uL2R0b3MvcGFyYW1ldHJvL3BhcmFtZXRyby1jcmVhdGUuZHRvJztcbmltcG9ydCB7IFBhcmFtZXRyb1VwZGF0ZUR0byB9IGZyb20gJy4uL2R0b3MvcGFyYW1ldHJvL3BhcmFtZXRyby11cGRhdGUuZHRvJztcbmltcG9ydCB7IFBhcmFtZXRyb1RpcG9FbnVtIH0gZnJvbSAnLi4vZW51bXMvcGFyYW1ldHJvLXRpcG8uZW51bSc7XG5pbXBvcnQgeyBOb3RGb3VuZEV4Y2VwdGlvbiwgQmFkUmVxdWVzdEV4Y2VwdGlvbiB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IENBQ0hFX01BTkFHRVIgfSBmcm9tICdAbmVzdGpzL2NhY2hlLW1hbmFnZXInO1xuaW1wb3J0IHsgQ2FjaGUgfSBmcm9tICdjYWNoZS1tYW5hZ2VyJztcblxuLy8gTW9jayBkbyBDYWNoZSBNYW5hZ2VyXG5jb25zdCBtb2NrQ2FjaGVNYW5hZ2VyID0ge1xuICBnZXQ6IGplc3QuZm4oKSxcbiAgc2V0OiBqZXN0LmZuKCksXG4gIGRlbDogamVzdC5mbigpLFxufTtcblxuLy8gTW9jayBkbyBSZXBvc2l0w7NyaW9cbmNvbnN0IG1vY2tQYXJhbWV0cm9SZXBvc2l0b3J5ID0ge1xuICBmaW5kQnlDaGF2ZTogamVzdC5mbigpLFxuICBmaW5kQWxsOiBqZXN0LmZuKCksXG4gIGZpbmRCeUNhdGVnb3JpYTogamVzdC5mbigpLFxuICBzYXZlOiBqZXN0LmZuKCksXG4gIHJlbW92ZTogamVzdC5mbigpLFxufTtcblxuZGVzY3JpYmUoJ1BhcmFtZXRyb1NlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBzZXJ2aWNlOiBQYXJhbWV0cm9TZXJ2aWNlO1xuICBsZXQgcmVwb3NpdG9yeTogUGFyYW1ldHJvUmVwb3NpdG9yeTtcbiAgbGV0IGNhY2hlTWFuYWdlcjogQ2FjaGU7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBQYXJhbWV0cm9TZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUGFyYW1ldHJvUmVwb3NpdG9yeSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1BhcmFtZXRyb1JlcG9zaXRvcnksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBDQUNIRV9NQU5BR0VSLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrQ2FjaGVNYW5hZ2VyLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxQYXJhbWV0cm9TZXJ2aWNlPihQYXJhbWV0cm9TZXJ2aWNlKTtcbiAgICByZXBvc2l0b3J5ID0gbW9kdWxlLmdldDxQYXJhbWV0cm9SZXBvc2l0b3J5PihQYXJhbWV0cm9SZXBvc2l0b3J5KTtcbiAgICBjYWNoZU1hbmFnZXIgPSBtb2R1bGUuZ2V0PENhY2hlPihDQUNIRV9NQU5BR0VSKTtcblxuICAgIC8vIExpbXBhciB0b2RvcyBvcyBtb2NrcyBhbnRlcyBkZSBjYWRhIHRlc3RlXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdkZXZlIHNlciBkZWZpbmlkbycsICgpID0+IHtcbiAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocmVwb3NpdG9yeSkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QoY2FjaGVNYW5hZ2VyKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnYnVzY2FyUG9yQ2hhdmUnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdW0gcGFyw6JtZXRybyBwZWxvIGNhY2hlIHF1YW5kbyBkaXNwb27DrXZlbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBhcmFtZXRyb01vY2sgPSB7XG4gICAgICAgIGlkOiAnMScsXG4gICAgICAgIGNoYXZlOiAnc2lzdGVtYS5ub21lJyxcbiAgICAgICAgdmFsb3I6ICdQR0JlbicsXG4gICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgZGVzY3JpY2FvOiAnTm9tZSBkbyBzaXN0ZW1hJyxcbiAgICAgICAgY2F0ZWdvcmlhOiAnc2lzdGVtYScsXG4gICAgICB9O1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKGNhY2hlTWFuYWdlciwgJ2dldCcpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb01vY2spO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUoJ3Npc3RlbWEubm9tZScpO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvTW9jayk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3BhcmFtZXRybzpzaXN0ZW1hLm5vbWUnKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdW0gcGFyw6JtZXRybyBkbyByZXBvc2l0w7NyaW8gcXVhbmRvIG7Do28gZXN0aXZlciBubyBjYWNoZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBhcmFtZXRyb01vY2sgPSB7XG4gICAgICAgIGlkOiAnMScsXG4gICAgICAgIGNoYXZlOiAnc2lzdGVtYS5ub21lJyxcbiAgICAgICAgdmFsb3I6ICdQR0JlbicsXG4gICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgZGVzY3JpY2FvOiAnTm9tZSBkbyBzaXN0ZW1hJyxcbiAgICAgICAgY2F0ZWdvcmlhOiAnc2lzdGVtYScsXG4gICAgICB9O1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKGNhY2hlTWFuYWdlciwgJ2dldCcpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2hhdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9Nb2NrKTtcbiAgICAgIGplc3Quc3B5T24oY2FjaGVNYW5hZ2VyLCAnc2V0JykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLmJ1c2NhclBvckNoYXZlKCdzaXN0ZW1hLm5vbWUnKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKHBhcmFtZXRyb01vY2spO1xuICAgICAgZXhwZWN0KGNhY2hlTWFuYWdlci5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdwYXJhbWV0cm86c2lzdGVtYS5ub21lJyk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5maW5kQnlDaGF2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Npc3RlbWEubm9tZScpO1xuICAgICAgZXhwZWN0KGNhY2hlTWFuYWdlci5zZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAncGFyYW1ldHJvOnNpc3RlbWEubm9tZScsXG4gICAgICAgIHBhcmFtZXRyb01vY2ssXG4gICAgICAgIHsgdHRsOiAzNjAwIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIHF1YW5kbyBvIHBhcsOibWV0cm8gbsOjbyBmb3IgZW5jb250cmFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24oY2FjaGVNYW5hZ2VyLCAnZ2V0JykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmJ1c2NhclBvckNoYXZlKCdwYXJhbWV0cm8uaW5leGlzdGVudGUnKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3BhcmFtZXRybzpwYXJhbWV0cm8uaW5leGlzdGVudGUnKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncGFyYW1ldHJvLmluZXhpc3RlbnRlJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdidXNjYXJUb2RvcycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciB0b2RvcyBvcyBwYXLDom1ldHJvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBhcmFtZXRyb3NNb2NrID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICcxJyxcbiAgICAgICAgICBjaGF2ZTogJ3Npc3RlbWEubm9tZScsXG4gICAgICAgICAgdmFsb3I6ICdQR0JlbicsXG4gICAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICAgIGRlc2NyaWNhbzogJ05vbWUgZG8gc2lzdGVtYScsXG4gICAgICAgICAgY2F0ZWdvcmlhOiAnc2lzdGVtYScsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJzInLFxuICAgICAgICAgIGNoYXZlOiAnc2lzdGVtYS52ZXJzYW8nLFxuICAgICAgICAgIHZhbG9yOiAnMS4wLjAnLFxuICAgICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgICBkZXNjcmljYW86ICdWZXJzw6NvIGRvIHNpc3RlbWEnLFxuICAgICAgICAgIGNhdGVnb3JpYTogJ3Npc3RlbWEnLFxuICAgICAgICB9LFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEFsbCcpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb3NNb2NrKTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLmJ1c2NhclRvZG9zKCk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9FcXVhbChwYXJhbWV0cm9zTW9jayk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5maW5kQWxsKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdidXNjYXJQb3JDYXRlZ29yaWEnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgcGFyw6JtZXRyb3MgZmlsdHJhZG9zIHBvciBjYXRlZ29yaWEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBwYXJhbWV0cm9zTW9jayA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMScsXG4gICAgICAgICAgY2hhdmU6ICdzaXN0ZW1hLm5vbWUnLFxuICAgICAgICAgIHZhbG9yOiAnUEdCZW4nLFxuICAgICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgICBkZXNjcmljYW86ICdOb21lIGRvIHNpc3RlbWEnLFxuICAgICAgICAgIGNhdGVnb3JpYTogJ3Npc3RlbWEnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICcyJyxcbiAgICAgICAgICBjaGF2ZTogJ3Npc3RlbWEudmVyc2FvJyxcbiAgICAgICAgICB2YWxvcjogJzEuMC4wJyxcbiAgICAgICAgICB0aXBvOiBQYXJhbWV0cm9UaXBvRW51bS5TVFJJTkcsXG4gICAgICAgICAgZGVzY3JpY2FvOiAnVmVyc8OjbyBkbyBzaXN0ZW1hJyxcbiAgICAgICAgICBjYXRlZ29yaWE6ICdzaXN0ZW1hJyxcbiAgICAgICAgfSxcbiAgICAgIF07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24ocmVwb3NpdG9yeSwgJ2ZpbmRCeUNhdGVnb3JpYScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb3NNb2NrKTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLmJ1c2NhclBvckNhdGVnb3JpYSgnc2lzdGVtYScpO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvc01vY2spO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2F0ZWdvcmlhKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc2lzdGVtYScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JpYXInLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgdW0gbm92byBwYXLDom1ldHJvIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZHRvOiBQYXJhbWV0cm9DcmVhdGVEdG8gPSB7XG4gICAgICAgIGNoYXZlOiAnbm92by5wYXJhbWV0cm8nLFxuICAgICAgICB2YWxvcjogJ1ZhbG9yIGRvIG5vdm8gcGFyw6JtZXRybycsXG4gICAgICAgIHRpcG86IFBhcmFtZXRyb1RpcG9FbnVtLlNUUklORyxcbiAgICAgICAgZGVzY3JpY2FvOiAnRGVzY3Jpw6fDo28gZG8gbm92byBwYXLDom1ldHJvJyxcbiAgICAgICAgY2F0ZWdvcmlhOiAnbm92bycsXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBwYXJhbWV0cm9Nb2NrID0ge1xuICAgICAgICBpZDogJzMnLFxuICAgICAgICAuLi5kdG8sXG4gICAgICB9O1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnc2F2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb01vY2spO1xuICAgICAgamVzdC5zcHlPbihjYWNoZU1hbmFnZXIsICdzZXQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2UuY3JpYXIoZHRvKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0YWRvKS50b0VxdWFsKHBhcmFtZXRyb01vY2spO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdub3ZvLnBhcmFtZXRybycpO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuc2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoZHRvKSk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLnNldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdwYXJhbWV0cm86bm92by5wYXJhbWV0cm8nLFxuICAgICAgICBwYXJhbWV0cm9Nb2NrLFxuICAgICAgICB7IHR0bDogMzYwMCB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBCYWRSZXF1ZXN0RXhjZXB0aW9uIGFvIHRlbnRhciBjcmlhciB1bSBwYXLDom1ldHJvIGNvbSBjaGF2ZSBleGlzdGVudGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBkdG86IFBhcmFtZXRyb0NyZWF0ZUR0byA9IHtcbiAgICAgICAgY2hhdmU6ICdwYXJhbWV0cm8uZXhpc3RlbnRlJyxcbiAgICAgICAgdmFsb3I6ICdWYWxvciBkbyBwYXLDom1ldHJvJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdEZXNjcmnDp8OjbyBkbyBwYXLDom1ldHJvJyxcbiAgICAgICAgY2F0ZWdvcmlhOiAnZXhpc3RlbnRlJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHBhcmFtZXRyb0V4aXN0ZW50ZSA9IHtcbiAgICAgICAgaWQ6ICc0JyxcbiAgICAgICAgLi4uZHRvLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2hhdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9FeGlzdGVudGUpO1xuICAgICAgXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyaWFyKGR0bykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5maW5kQnlDaGF2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3BhcmFtZXRyby5leGlzdGVudGUnKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LnNhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhdHVhbGl6YXInLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYXR1YWxpemFyIHVtIHBhcsOibWV0cm8gZXhpc3RlbnRlIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY2hhdmUgPSAncGFyYW1ldHJvLmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBkdG86IFBhcmFtZXRyb1VwZGF0ZUR0byA9IHtcbiAgICAgICAgdmFsb3I6ICdOb3ZvIHZhbG9yJyxcbiAgICAgICAgZGVzY3JpY2FvOiAnTm92YSBkZXNjcmnDp8OjbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ2NhdGVnb3JpYS1hdHVhbGl6YWRhJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHBhcmFtZXRyb0V4aXN0ZW50ZSA9IHtcbiAgICAgICAgaWQ6ICc1JyxcbiAgICAgICAgY2hhdmUsXG4gICAgICAgIHZhbG9yOiAnVmFsb3IgYW50aWdvJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdEZXNjcmnDp8OjbyBhbnRpZ2EnLFxuICAgICAgICBjYXRlZ29yaWE6ICdjYXRlZ29yaWEtYW50aWdhJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHBhcmFtZXRyb0F0dWFsaXphZG8gPSB7XG4gICAgICAgIC4uLnBhcmFtZXRyb0V4aXN0ZW50ZSxcbiAgICAgICAgLi4uZHRvLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnZmluZEJ5Q2hhdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9FeGlzdGVudGUpO1xuICAgICAgamVzdC5zcHlPbihyZXBvc2l0b3J5LCAnc2F2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb0F0dWFsaXphZG8pO1xuICAgICAgamVzdC5zcHlPbihjYWNoZU1hbmFnZXIsICdzZXQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHNlcnZpY2UuYXR1YWxpemFyKGNoYXZlLCBkdG8pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvRXF1YWwocGFyYW1ldHJvQXR1YWxpemFkbyk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5maW5kQnlDaGF2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoY2hhdmUpO1xuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuc2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAuLi5wYXJhbWV0cm9FeGlzdGVudGUsXG4gICAgICAgIC4uLmR0byxcbiAgICAgIH0pKTtcbiAgICAgIGV4cGVjdChjYWNoZU1hbmFnZXIuc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYHBhcmFtZXRybzoke2NoYXZlfWAsXG4gICAgICAgIHBhcmFtZXRyb0F0dWFsaXphZG8sXG4gICAgICAgIHsgdHRsOiAzNjAwIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIGFvIHRlbnRhciBhdHVhbGl6YXIgdW0gcGFyw6JtZXRybyBpbmV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ3BhcmFtZXRyby5pbmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBkdG86IFBhcmFtZXRyb1VwZGF0ZUR0byA9IHtcbiAgICAgICAgdmFsb3I6ICdOb3ZvIHZhbG9yJyxcbiAgICAgICAgZGVzY3JpY2FvOiAnTm92YSBkZXNjcmnDp8OjbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ25vdmEtY2F0ZWdvcmlhJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGplc3Quc3B5T24ocmVwb3NpdG9yeSwgJ2ZpbmRCeUNoYXZlJykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuYXR1YWxpemFyKGNoYXZlLCBkdG8pKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaGF2ZSk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5zYXZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlcicsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZW1vdmVyIHVtIHBhcsOibWV0cm8gZXhpc3RlbnRlIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY2hhdmUgPSAncGFyYW1ldHJvLmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBwYXJhbWV0cm9FeGlzdGVudGUgPSB7XG4gICAgICAgIGlkOiAnNicsXG4gICAgICAgIGNoYXZlLFxuICAgICAgICB2YWxvcjogJ1ZhbG9yJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uU1RSSU5HLFxuICAgICAgICBkZXNjcmljYW86ICdEZXNjcmnDp8OjbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ2NhdGVnb3JpYScsXG4gICAgICB9O1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHBhcmFtZXRyb0V4aXN0ZW50ZSk7XG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdyZW1vdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgamVzdC5zcHlPbihjYWNoZU1hbmFnZXIsICdkZWwnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IHNlcnZpY2UucmVtb3ZlcihjaGF2ZSk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlcG9zaXRvcnkuZmluZEJ5Q2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNoYXZlKTtcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LnJlbW92ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgocGFyYW1ldHJvRXhpc3RlbnRlKTtcbiAgICAgIGV4cGVjdChjYWNoZU1hbmFnZXIuZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChgcGFyYW1ldHJvOiR7Y2hhdmV9YCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIGFvIHRlbnRhciByZW1vdmVyIHVtIHBhcsOibWV0cm8gaW5leGlzdGVudGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBjaGF2ZSA9ICdwYXJhbWV0cm8uaW5leGlzdGVudGUnO1xuICAgICAgXG4gICAgICBqZXN0LnNweU9uKHJlcG9zaXRvcnksICdmaW5kQnlDaGF2ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnJlbW92ZXIoY2hhdmUpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUNoYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaGF2ZSk7XG4gICAgICBleHBlY3QocmVwb3NpdG9yeS5yZW1vdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoY2FjaGVNYW5hZ2VyLmRlbCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29idGVyVmFsb3JUaXBhZG8nLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgbyB2YWxvciB0aXBhZG8gcGFyYSB1bSBwYXLDom1ldHJvIGV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ251bWVyby5wYXJhbWV0cm8nO1xuICAgICAgY29uc3QgcGFyYW1ldHJvTW9jayA9IHtcbiAgICAgICAgaWQ6ICc3JyxcbiAgICAgICAgY2hhdmUsXG4gICAgICAgIHZhbG9yOiAnMTIzJyxcbiAgICAgICAgdGlwbzogUGFyYW1ldHJvVGlwb0VudW0uTlVNQkVSLFxuICAgICAgICBkZXNjcmljYW86ICdQYXLDom1ldHJvIG51bcOpcmljbycsXG4gICAgICAgIGNhdGVnb3JpYTogJ251bWVyb3MnLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnYnVzY2FyUG9yQ2hhdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXJhbWV0cm9Nb2NrKTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyVmFsb3JUaXBhZG88bnVtYmVyPihjaGF2ZSk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdGFkbykudG9CZSgxMjMpO1xuICAgICAgZXhwZWN0KHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNoYXZlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIG8gdmFsb3IgcGFkcsOjbyBxdWFuZG8gbyBwYXLDom1ldHJvIG7Do28gZXhpc3RpcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNoYXZlID0gJ3BhcmFtZXRyby5pbmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCB2YWxvclBhZHJhbyA9ICd2YWxvciBwYWRyw6NvJztcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnYnVzY2FyUG9yQ2hhdmUnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb24oYFBhcsOibWV0cm8gY29tIGNoYXZlICcke2NoYXZlfScgbsOjbyBlbmNvbnRyYWRvYCk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHRhZG8gPSBhd2FpdCBzZXJ2aWNlLm9idGVyVmFsb3JUaXBhZG88c3RyaW5nPihjaGF2ZSwgdmFsb3JQYWRyYW8pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRhZG8pLnRvQmUodmFsb3JQYWRyYW8pO1xuICAgICAgZXhwZWN0KHNlcnZpY2UuYnVzY2FyUG9yQ2hhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNoYXZlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==