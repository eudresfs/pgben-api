5859500a78690a7745e4a78f9d4d2132
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const rxjs_1 = require("rxjs");
const validation_error_interceptor_1 = require("./validation-error.interceptor");
describe('ValidationErrorInterceptor', () => {
    let interceptor;
    let mockExecutionContext;
    let mockCallHandler;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [validation_error_interceptor_1.ValidationErrorInterceptor],
        }).compile();
        interceptor = module.get(validation_error_interceptor_1.ValidationErrorInterceptor);
        mockExecutionContext = {
            switchToHttp: jest.fn(),
            getClass: jest.fn(),
            getHandler: jest.fn(),
            getArgs: jest.fn(),
            getArgByIndex: jest.fn(),
            switchToRpc: jest.fn(),
            switchToWs: jest.fn(),
            getType: jest.fn(),
        };
        mockCallHandler = {
            handle: jest.fn(),
        };
    });
    describe('intercept', () => {
        it('deve passar erros não relacionados à validação sem modificação', (done) => {
            const nonValidationError = new Error('Erro genérico');
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => nonValidationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    expect(error).toBe(nonValidationError);
                    done();
                },
            });
        });
        it('deve passar BadRequestException não relacionado à validação', (done) => {
            const nonValidationBadRequest = new common_1.BadRequestException('Erro customizado');
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => nonValidationBadRequest));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    expect(error).toBeInstanceOf(common_1.BadRequestException);
                    expect(error.getResponse()).toBe('Erro customizado');
                    done();
                },
            });
        });
        it('deve melhorar erros de validação do class-validator', (done) => {
            const validationError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be a string',
                    'email must be an email',
                    'idade must not be less than 18',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => validationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    try {
                        expect(error).toBeInstanceOf(common_1.BadRequestException);
                        const response = error.getResponse();
                        expect(response).toHaveProperty('error', 'Erro de Validação');
                        expect(response).toHaveProperty('message', 'Os dados fornecidos contêm erros de validação');
                        expect(response).toHaveProperty('details');
                        expect(response).toHaveProperty('timestamp');
                        expect(response).toHaveProperty('statusCode', 400);
                        done();
                    }
                    catch (e) {
                        done(e);
                    }
                },
            });
        });
        it('deve agrupar erros por campo', (done) => {
            const validationError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be a string',
                    'nome must be longer than 2 characters',
                    'email must be an email',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => validationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    try {
                        const response = error.getResponse();
                        const details = response.details;
                        expect(details).toHaveProperty('nome');
                        expect(details).toHaveProperty('email');
                        expect(details.nome).toHaveLength(2); // Dois erros para o campo nome
                        expect(details.email).toHaveLength(1); // Um erro para o campo email
                        done();
                    }
                    catch (e) {
                        done(e);
                    }
                },
            });
        });
        it('deve melhorar mensagens de erro de enum', async () => {
            const enumError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'status must be one of the following values [ATIVO, INATIVO, PENDENTE]',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => enumError));
            try {
                await interceptor.intercept(mockExecutionContext, mockCallHandler).toPromise();
            }
            catch (error) {
                const response = error.getResponse();
                expect(response).toHaveProperty('details');
                const details = response.details;
                // Verifica se o campo status existe e tem pelo menos um erro
                expect(details).toHaveProperty('status');
                expect(Array.isArray(details.status)).toBe(true);
                expect(details.status.length).toBeGreaterThan(0);
                expect(details.status[0]).toContain('deve ser um dos seguintes valores');
                expect(details.status[0]).toContain('ATIVO, INATIVO, PENDENTE');
            }
        });
        it('deve melhorar mensagens de erro de tipo', async () => {
            const typeError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'idade must be a number',
                    'ativo must be a boolean',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => typeError));
            try {
                await interceptor.intercept(mockExecutionContext, mockCallHandler).toPromise();
            }
            catch (error) {
                const response = error.getResponse();
                expect(response).toHaveProperty('details');
                const details = response.details;
                // Verifica se os campos existem e têm pelo menos um erro
                expect(details).toHaveProperty('idade');
                expect(Array.isArray(details.idade)).toBe(true);
                expect(details.idade.length).toBeGreaterThan(0);
                expect(details).toHaveProperty('ativo');
                expect(Array.isArray(details.ativo)).toBe(true);
                expect(details.ativo.length).toBeGreaterThan(0);
                expect(details.idade[0]).toContain('deve ser um número');
                expect(details.ativo[0]).toContain('deve ser um verdadeiro ou falso');
            }
        });
        it('deve melhorar mensagens de erro de tamanho', (done) => {
            const lengthError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be longer than 2 characters',
                    'descricao must be shorter than 100 characters',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => lengthError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    try {
                        const response = error.getResponse();
                        const details = response.details;
                        expect(details.nome[0]).toContain('deve ter mais de 2 caracteres');
                        expect(details.descricao[0]).toContain('deve ter menos de 100 caracteres');
                        done();
                    }
                    catch (e) {
                        done(e);
                    }
                },
            });
        });
        it('deve melhorar mensagens de erro numérico', (done) => {
            const numericError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'idade must not be less than 18',
                    'salario must not be greater than 50000',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => numericError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    try {
                        const response = error.getResponse();
                        const details = response.details;
                        expect(details.idade[0]).toContain('deve ser maior ou igual a 18');
                        expect(details.salario[0]).toContain('deve ser menor ou igual a 50000');
                        done();
                    }
                    catch (e) {
                        done(e);
                    }
                },
            });
        });
        it('deve passar dados válidos sem modificação', (done) => {
            const validData = { id: 1, nome: 'Teste' };
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.of)(validData));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                next: (data) => {
                    expect(data).toBe(validData);
                    done();
                },
            });
        });
    });
});
describe('ValidationMessageHelper', () => {
    describe('required', () => {
        it('deve criar mensagem para campo obrigatório', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.required('nome');
            expect(message).toBe("O campo 'nome' é obrigatório");
        });
    });
    describe('invalidType', () => {
        it('deve criar mensagem para tipo inválido', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidType('idade', 'number');
            expect(message).toBe("O campo 'idade' deve ser número");
        });
        it('deve mapear tipos em inglês para português', () => {
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'string'))
                .toBe("O campo 'campo' deve ser texto");
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'boolean'))
                .toBe("O campo 'campo' deve ser verdadeiro ou falso");
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'email'))
                .toBe("O campo 'campo' deve ser email válido");
        });
    });
    describe('invalidLength', () => {
        it('deve criar mensagem para tamanho com min e max', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', 2, 50);
            expect(message).toBe("O campo 'nome' deve ter entre 2 e 50 caracteres");
        });
        it('deve criar mensagem apenas para mínimo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', 2);
            expect(message).toBe("O campo 'nome' deve ter pelo menos 2 caracteres");
        });
        it('deve criar mensagem apenas para máximo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', undefined, 50);
            expect(message).toBe("O campo 'nome' deve ter no máximo 50 caracteres");
        });
        it('deve criar mensagem genérica quando não há limites', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome');
            expect(message).toBe("O campo 'nome' tem tamanho inválido");
        });
    });
    describe('invalidRange', () => {
        it('deve criar mensagem para intervalo com min e max', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', 18, 65);
            expect(message).toBe("O campo 'idade' deve estar entre 18 e 65");
        });
        it('deve criar mensagem apenas para mínimo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', 18);
            expect(message).toBe("O campo 'idade' deve ser maior ou igual a 18");
        });
        it('deve criar mensagem apenas para máximo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', undefined, 65);
            expect(message).toBe("O campo 'idade' deve ser menor ou igual a 65");
        });
    });
    describe('invalidFormat', () => {
        it('deve criar mensagem para formato inválido', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('email', 'email');
            expect(message).toBe("O campo 'email' deve ter o formato: email válido (exemplo: usuario@dominio.com)");
        });
        it('deve mapear formatos conhecidos', () => {
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('cpf', 'cpf'))
                .toContain('CPF válido (exemplo: 123.456.789-00)');
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('telefone', 'phone'))
                .toContain('telefone válido (exemplo: (11) 99999-9999)');
        });
        it('deve usar formato original se não mapeado', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('campo', 'formato_customizado');
            expect(message).toBe("O campo 'campo' deve ter o formato: formato_customizado");
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxcaW50ZXJjZXB0b3JzXFx2YWxpZGF0aW9uLWVycm9yLmludGVyY2VwdG9yLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsMkNBQW9GO0FBQ3BGLCtCQUFzQztBQUN0QyxpRkFBcUc7QUFFckcsUUFBUSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtJQUMxQyxJQUFJLFdBQXVDLENBQUM7SUFDNUMsSUFBSSxvQkFBc0MsQ0FBQztJQUMzQyxJQUFJLGVBQTRCLENBQUM7SUFFakMsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE1BQU0sTUFBTSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUMzRCxTQUFTLEVBQUUsQ0FBQyx5REFBMEIsQ0FBQztTQUN4QyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixXQUFXLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBNkIseURBQTBCLENBQUMsQ0FBQztRQUVqRixvQkFBb0IsR0FBRztZQUNyQixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN2QixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNuQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN4QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN0QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNuQixDQUFDO1FBRUYsZUFBZSxHQUFHO1lBQ2hCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ2xCLENBQUM7SUFDSixDQUFDLENB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QUFFLEtBQUssQ0FBQyxDQUFDO2lCQUN4RCxTQUFTLENBQUMsc0NBQXNDLENBQUMsQ0FBQztZQUNyRCxNQUFNLENBQUMsc0RBQXVCLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQztpQkFDL0QsU0FBUyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sT0FBTyxHQUFHLHNEQUF1QixDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUN0RixNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHlEQUF5RCxDQUFDLENBQUM7UUFDbEYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxzaGFyZWRcXGludGVyY2VwdG9yc1xcdmFsaWRhdGlvbi1lcnJvci5pbnRlcmNlcHRvci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgQmFkUmVxdWVzdEV4Y2VwdGlvbiwgRXhlY3V0aW9uQ29udGV4dCwgQ2FsbEhhbmRsZXIgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBvZiwgdGhyb3dFcnJvciB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9ySW50ZXJjZXB0b3IsIFZhbGlkYXRpb25NZXNzYWdlSGVscGVyIH0gZnJvbSAnLi92YWxpZGF0aW9uLWVycm9yLmludGVyY2VwdG9yJztcblxuZGVzY3JpYmUoJ1ZhbGlkYXRpb25FcnJvckludGVyY2VwdG9yJywgKCkgPT4ge1xuICBsZXQgaW50ZXJjZXB0b3I6IFZhbGlkYXRpb25FcnJvckludGVyY2VwdG9yO1xuICBsZXQgbW9ja0V4ZWN1dGlvbkNvbnRleHQ6IEV4ZWN1dGlvbkNvbnRleHQ7XG4gIGxldCBtb2NrQ2FsbEhhbmRsZXI6IENhbGxIYW5kbGVyO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtWYWxpZGF0aW9uRXJyb3JJbnRlcmNlcHRvcl0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgaW50ZXJjZXB0b3IgPSBtb2R1bGUuZ2V0PFZhbGlkYXRpb25FcnJvckludGVyY2VwdG9yPihWYWxpZGF0aW9uRXJyb3JJbnRlcmNlcHRvcik7XG4gICAgXG4gICAgbW9ja0V4ZWN1dGlvbkNvbnRleHQgPSB7XG4gICAgICBzd2l0Y2hUb0h0dHA6IGplc3QuZm4oKSxcbiAgICAgIGdldENsYXNzOiBqZXN0LmZuKCksXG4gICAgICBnZXRIYW5kbGVyOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcmdzOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcmdCeUluZGV4OiBqZXN0LmZuKCksXG4gICAgICBzd2l0Y2hUb1JwYzogamVzdC5mbigpLFxuICAgICAgc3dpdGNoVG9XczogamVzdC5mbigpLFxuICAgICAgZ2V0VHlwZTogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBtb2NrQ2FsbEhhbmRsZXIgPSB7XG4gICAgICBoYW5kbGU6IGplc3QuZm4oKSxcbiAgICB9O1xuICB9KTtcblxuICBkZXNjcmliZSgnaW50ZXJjZXB0JywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHBhc3NhciBlcnJvcyBuw6NvIHJlbGFjaW9uYWRvcyDDoCB2YWxpZGHDp8OjbyBzZW0gbW9kaWZpY2HDp8OjbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBub25WYWxpZGF0aW9uRXJyb3IgPSBuZXcgRXJyb3IoJ0Vycm8gZ2Vuw6lyaWNvJyk7XG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IG5vblZhbGlkYXRpb25FcnJvcikpO1xuXG4gICAgICBpbnRlcmNlcHRvci5pbnRlcmNlcHQobW9ja0V4ZWN1dGlvbkNvbnRleHQsIG1vY2tDYWxsSGFuZGxlcikuc3Vic2NyaWJlKHtcbiAgICAgICAgZXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGV4cGVjdChlcnJvcikudG9CZShub25WYWxpZGF0aW9uRXJyb3IpO1xuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcGFzc2FyIEJhZFJlcXVlc3RFeGNlcHRpb24gbsOjbyByZWxhY2lvbmFkbyDDoCB2YWxpZGHDp8OjbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBub25WYWxpZGF0aW9uQmFkUmVxdWVzdCA9IG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKCdFcnJvIGN1c3RvbWl6YWRvJyk7XG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IG5vblZhbGlkYXRpb25CYWRSZXF1ZXN0KSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgICAgICBleHBlY3QoZXJyb3IuZ2V0UmVzcG9uc2UoKSkudG9CZSgnRXJybyBjdXN0b21pemFkbycpO1xuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWVsaG9yYXIgZXJyb3MgZGUgdmFsaWRhw6fDo28gZG8gY2xhc3MtdmFsaWRhdG9yJywgKGRvbmUpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKHtcbiAgICAgICAgZXJyb3I6ICdCYWQgUmVxdWVzdCcsXG4gICAgICAgIG1lc3NhZ2U6IFtcbiAgICAgICAgICAnbm9tZSBtdXN0IGJlIGEgc3RyaW5nJyxcbiAgICAgICAgICAnZW1haWwgbXVzdCBiZSBhbiBlbWFpbCcsXG4gICAgICAgICAgJ2lkYWRlIG11c3Qgbm90IGJlIGxlc3MgdGhhbiAxOCcsXG4gICAgICAgIF0sXG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IHZhbGlkYXRpb25FcnJvcikpO1xuXG4gICAgICBpbnRlcmNlcHRvci5pbnRlcmNlcHQobW9ja0V4ZWN1dGlvbkNvbnRleHQsIG1vY2tDYWxsSGFuZGxlcikuc3Vic2NyaWJlKHtcbiAgICAgICAgZXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicsICdFcnJvIGRlIFZhbGlkYcOnw6NvJyk7XG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJywgJ09zIGRhZG9zIGZvcm5lY2lkb3MgY29udMOqbSBlcnJvcyBkZSB2YWxpZGHDp8OjbycpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgnZGV0YWlscycpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgndGltZXN0YW1wJyk7XG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdzdGF0dXNDb2RlJywgNDAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRvbmUoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBhZ3J1cGFyIGVycm9zIHBvciBjYW1wbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ25vbWUgbXVzdCBiZSBhIHN0cmluZycsXG4gICAgICAgICAgJ25vbWUgbXVzdCBiZSBsb25nZXIgdGhhbiAyIGNoYXJhY3RlcnMnLFxuICAgICAgICAgICdlbWFpbCBtdXN0IGJlIGFuIGVtYWlsJyxcbiAgICAgICAgXSxcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDYWxsSGFuZGxlci5oYW5kbGUgPSBqZXN0LmZuKCgpID0+IHRocm93RXJyb3IoKCkgPT4gdmFsaWRhdGlvbkVycm9yKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3IuZ2V0UmVzcG9uc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSByZXNwb25zZS5kZXRhaWxzO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QoZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ25vbWUnKTtcbiAgICAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgICAgICAgIGV4cGVjdChkZXRhaWxzLm5vbWUpLnRvSGF2ZUxlbmd0aCgyKTsgLy8gRG9pcyBlcnJvcyBwYXJhIG8gY2FtcG8gbm9tZVxuICAgICAgICAgICAgZXhwZWN0KGRldGFpbHMuZW1haWwpLnRvSGF2ZUxlbmd0aCgxKTsgLy8gVW0gZXJybyBwYXJhIG8gY2FtcG8gZW1haWxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRvbmUoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBtZWxob3JhciBtZW5zYWdlbnMgZGUgZXJybyBkZSBlbnVtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW51bUVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oe1xuICAgICAgICBlcnJvcjogJ0JhZCBSZXF1ZXN0JyxcbiAgICAgICAgbWVzc2FnZTogW1xuICAgICAgICAgICdzdGF0dXMgbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXMgW0FUSVZPLCBJTkFUSVZPLCBQRU5ERU5URV0nLFxuICAgICAgICBdLFxuICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICB9KTtcblxuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gdGhyb3dFcnJvcigoKSA9PiBlbnVtRXJyb3IpKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgIGF3YWl0IGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS50b1Byb21pc2UoKTtcbiAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgnZGV0YWlscycpO1xuICAgICAgICAgY29uc3QgZGV0YWlscyA9IHJlc3BvbnNlLmRldGFpbHM7XG4gICAgICAgICBcbiAgICAgICAgIC8vIFZlcmlmaWNhIHNlIG8gY2FtcG8gc3RhdHVzIGV4aXN0ZSBlIHRlbSBwZWxvIG1lbm9zIHVtIGVycm9cbiAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShkZXRhaWxzLnN0YXR1cykpLnRvQmUodHJ1ZSk7XG4gICAgICAgICBleHBlY3QoZGV0YWlscy5zdGF0dXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICBcbiAgICAgICAgIGV4cGVjdChkZXRhaWxzLnN0YXR1c1swXSkudG9Db250YWluKCdkZXZlIHNlciB1bSBkb3Mgc2VndWludGVzIHZhbG9yZXMnKTtcbiAgICAgICAgIGV4cGVjdChkZXRhaWxzLnN0YXR1c1swXSkudG9Db250YWluKCdBVElWTywgSU5BVElWTywgUEVOREVOVEUnKTtcbiAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBtZWxob3JhciBtZW5zYWdlbnMgZGUgZXJybyBkZSB0aXBvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHlwZUVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oe1xuICAgICAgICBlcnJvcjogJ0JhZCBSZXF1ZXN0JyxcbiAgICAgICAgbWVzc2FnZTogW1xuICAgICAgICAgICdpZGFkZSBtdXN0IGJlIGEgbnVtYmVyJyxcbiAgICAgICAgICAnYXRpdm8gbXVzdCBiZSBhIGJvb2xlYW4nLFxuICAgICAgICBdLFxuICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICB9KTtcblxuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gdGhyb3dFcnJvcigoKSA9PiB0eXBlRXJyb3IpKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgIGF3YWl0IGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS50b1Byb21pc2UoKTtcbiAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgnZGV0YWlscycpO1xuICAgICAgICAgY29uc3QgZGV0YWlscyA9IHJlc3BvbnNlLmRldGFpbHM7XG4gICAgICAgICBcbiAgICAgICAgIC8vIFZlcmlmaWNhIHNlIG9zIGNhbXBvcyBleGlzdGVtIGUgdMOqbSBwZWxvIG1lbm9zIHVtIGVycm9cbiAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnaWRhZGUnKTtcbiAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGRldGFpbHMuaWRhZGUpKS50b0JlKHRydWUpO1xuICAgICAgICAgZXhwZWN0KGRldGFpbHMuaWRhZGUubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICBcbiAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnYXRpdm8nKTtcbiAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGRldGFpbHMuYXRpdm8pKS50b0JlKHRydWUpO1xuICAgICAgICAgZXhwZWN0KGRldGFpbHMuYXRpdm8ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICBcbiAgICAgICAgIGV4cGVjdChkZXRhaWxzLmlkYWRlWzBdKS50b0NvbnRhaW4oJ2RldmUgc2VyIHVtIG7Dum1lcm8nKTtcbiAgICAgICAgIGV4cGVjdChkZXRhaWxzLmF0aXZvWzBdKS50b0NvbnRhaW4oJ2RldmUgc2VyIHVtIHZlcmRhZGVpcm8gb3UgZmFsc28nKTtcbiAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBtZWxob3JhciBtZW5zYWdlbnMgZGUgZXJybyBkZSB0YW1hbmhvJywgKGRvbmUpID0+IHtcbiAgICAgIGNvbnN0IGxlbmd0aEVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oe1xuICAgICAgICBlcnJvcjogJ0JhZCBSZXF1ZXN0JyxcbiAgICAgICAgbWVzc2FnZTogW1xuICAgICAgICAgICdub21lIG11c3QgYmUgbG9uZ2VyIHRoYW4gMiBjaGFyYWN0ZXJzJyxcbiAgICAgICAgICAnZGVzY3JpY2FvIG11c3QgYmUgc2hvcnRlciB0aGFuIDEwMCBjaGFyYWN0ZXJzJyxcbiAgICAgICAgXSxcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDYWxsSGFuZGxlci5oYW5kbGUgPSBqZXN0LmZuKCgpID0+IHRocm93RXJyb3IoKCkgPT4gbGVuZ3RoRXJyb3IpKTtcblxuICAgICAgaW50ZXJjZXB0b3IuaW50ZXJjZXB0KG1vY2tFeGVjdXRpb25Db250ZXh0LCBtb2NrQ2FsbEhhbmRsZXIpLnN1YnNjcmliZSh7XG4gICAgICAgIGVycm9yOiAoZXJyb3IpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgICAgY29uc3QgZGV0YWlscyA9IHJlc3BvbnNlLmRldGFpbHM7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdChkZXRhaWxzLm5vbWVbMF0pLnRvQ29udGFpbignZGV2ZSB0ZXIgbWFpcyBkZSAyIGNhcmFjdGVyZXMnKTtcbiAgICAgICAgICAgIGV4cGVjdChkZXRhaWxzLmRlc2NyaWNhb1swXSkudG9Db250YWluKCdkZXZlIHRlciBtZW5vcyBkZSAxMDAgY2FyYWN0ZXJlcycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZG9uZShlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1lbGhvcmFyIG1lbnNhZ2VucyBkZSBlcnJvIG51bcOpcmljbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBudW1lcmljRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ2lkYWRlIG11c3Qgbm90IGJlIGxlc3MgdGhhbiAxOCcsXG4gICAgICAgICAgJ3NhbGFyaW8gbXVzdCBub3QgYmUgZ3JlYXRlciB0aGFuIDUwMDAwJyxcbiAgICAgICAgXSxcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDYWxsSGFuZGxlci5oYW5kbGUgPSBqZXN0LmZuKCgpID0+IHRocm93RXJyb3IoKCkgPT4gbnVtZXJpY0Vycm9yKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3IuZ2V0UmVzcG9uc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSByZXNwb25zZS5kZXRhaWxzO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QoZGV0YWlscy5pZGFkZVswXSkudG9Db250YWluKCdkZXZlIHNlciBtYWlvciBvdSBpZ3VhbCBhIDE4Jyk7XG4gICAgICAgICAgICBleHBlY3QoZGV0YWlscy5zYWxhcmlvWzBdKS50b0NvbnRhaW4oJ2RldmUgc2VyIG1lbm9yIG91IGlndWFsIGEgNTAwMDAnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRvbmUoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwYXNzYXIgZGFkb3MgdsOhbGlkb3Mgc2VtIG1vZGlmaWNhw6fDo28nLCAoZG9uZSkgPT4ge1xuICAgICAgY29uc3QgdmFsaWREYXRhID0geyBpZDogMSwgbm9tZTogJ1Rlc3RlJyB9O1xuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gb2YodmFsaWREYXRhKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBuZXh0OiAoZGF0YSkgPT4ge1xuICAgICAgICAgIGV4cGVjdChkYXRhKS50b0JlKHZhbGlkRGF0YSk7XG4gICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdWYWxpZGF0aW9uTWVzc2FnZUhlbHBlcicsICgpID0+IHtcbiAgZGVzY3JpYmUoJ3JlcXVpcmVkJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIHBhcmEgY2FtcG8gb2JyaWdhdMOzcmlvJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLnJlcXVpcmVkKCdub21lJyk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ25vbWUnIMOpIG9icmlnYXTDs3Jpb1wiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ludmFsaWRUeXBlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIHBhcmEgdGlwbyBpbnbDoWxpZG8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZFR5cGUoJ2lkYWRlJywgJ251bWJlcicpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdpZGFkZScgZGV2ZSBzZXIgbsO6bWVyb1wiKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1hcGVhciB0aXBvcyBlbSBpbmdsw6pzIHBhcmEgcG9ydHVndcOqcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkVHlwZSgnY2FtcG8nLCAnc3RyaW5nJykpXG4gICAgICAgIC50b0JlKFwiTyBjYW1wbyAnY2FtcG8nIGRldmUgc2VyIHRleHRvXCIpO1xuICAgICAgZXhwZWN0KFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRUeXBlKCdjYW1wbycsICdib29sZWFuJykpXG4gICAgICAgIC50b0JlKFwiTyBjYW1wbyAnY2FtcG8nIGRldmUgc2VyIHZlcmRhZGVpcm8gb3UgZmFsc29cIik7XG4gICAgICBleHBlY3QoVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZFR5cGUoJ2NhbXBvJywgJ2VtYWlsJykpXG4gICAgICAgIC50b0JlKFwiTyBjYW1wbyAnY2FtcG8nIGRldmUgc2VyIGVtYWlsIHbDoWxpZG9cIik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbnZhbGlkTGVuZ3RoJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIHBhcmEgdGFtYW5obyBjb20gbWluIGUgbWF4JywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRMZW5ndGgoJ25vbWUnLCAyLCA1MCk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ25vbWUnIGRldmUgdGVyIGVudHJlIDIgZSA1MCBjYXJhY3RlcmVzXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gYXBlbmFzIHBhcmEgbcOtbmltbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkTGVuZ3RoKCdub21lJywgMik7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ25vbWUnIGRldmUgdGVyIHBlbG8gbWVub3MgMiBjYXJhY3RlcmVzXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gYXBlbmFzIHBhcmEgbcOheGltbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkTGVuZ3RoKCdub21lJywgdW5kZWZpbmVkLCA1MCk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ25vbWUnIGRldmUgdGVyIG5vIG3DoXhpbW8gNTAgY2FyYWN0ZXJlc1wiKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIGdlbsOpcmljYSBxdWFuZG8gbsOjbyBow6EgbGltaXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkTGVuZ3RoKCdub21lJyk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ25vbWUnIHRlbSB0YW1hbmhvIGludsOhbGlkb1wiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ludmFsaWRSYW5nZScsICgpID0+IHtcbiAgICBpdCgnZGV2ZSBjcmlhciBtZW5zYWdlbSBwYXJhIGludGVydmFsbyBjb20gbWluIGUgbWF4JywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRSYW5nZSgnaWRhZGUnLCAxOCwgNjUpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdpZGFkZScgZGV2ZSBlc3RhciBlbnRyZSAxOCBlIDY1XCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gYXBlbmFzIHBhcmEgbcOtbmltbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkUmFuZ2UoJ2lkYWRlJywgMTgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdpZGFkZScgZGV2ZSBzZXIgbWFpb3Igb3UgaWd1YWwgYSAxOFwiKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIGFwZW5hcyBwYXJhIG3DoXhpbW8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZFJhbmdlKCdpZGFkZScsIHVuZGVmaW5lZCwgNjUpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdpZGFkZScgZGV2ZSBzZXIgbWVub3Igb3UgaWd1YWwgYSA2NVwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ludmFsaWRGb3JtYXQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gcGFyYSBmb3JtYXRvIGludsOhbGlkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkRm9ybWF0KCdlbWFpbCcsICdlbWFpbCcpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdlbWFpbCcgZGV2ZSB0ZXIgbyBmb3JtYXRvOiBlbWFpbCB2w6FsaWRvIChleGVtcGxvOiB1c3VhcmlvQGRvbWluaW8uY29tKVwiKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1hcGVhciBmb3JtYXRvcyBjb25oZWNpZG9zJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRGb3JtYXQoJ2NwZicsICdjcGYnKSlcbiAgICAgICAgLnRvQ29udGFpbignQ1BGIHbDoWxpZG8gKGV4ZW1wbG86IDEyMy40NTYuNzg5LTAwKScpO1xuICAgICAgZXhwZWN0KFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRGb3JtYXQoJ3RlbGVmb25lJywgJ3Bob25lJykpXG4gICAgICAgIC50b0NvbnRhaW4oJ3RlbGVmb25lIHbDoWxpZG8gKGV4ZW1wbG86ICgxMSkgOTk5OTktOTk5OSknKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHVzYXIgZm9ybWF0byBvcmlnaW5hbCBzZSBuw6NvIG1hcGVhZG8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZEZvcm1hdCgnY2FtcG8nLCAnZm9ybWF0b19jdXN0b21pemFkbycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvQmUoXCJPIGNhbXBvICdjYW1wbycgZGV2ZSB0ZXIgbyBmb3JtYXRvOiBmb3JtYXRvX2N1c3RvbWl6YWRvXCIpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==