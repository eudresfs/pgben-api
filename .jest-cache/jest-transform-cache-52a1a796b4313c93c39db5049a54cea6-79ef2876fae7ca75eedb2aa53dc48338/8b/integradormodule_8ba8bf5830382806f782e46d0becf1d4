f7797ab59be6c7fd858a82c386981ea9
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.IntegradorModule = void 0;
const common_1 = require("@nestjs/common");
const typeorm_1 = require("@nestjs/typeorm");
const jwt_1 = require("@nestjs/jwt");
const config_1 = require("@nestjs/config");
const entities_1 = require("../../entities");
const integrador_service_1 = require("./services/integrador.service");
const integrador_token_service_1 = require("./services/integrador-token.service");
const integrador_auth_service_1 = require("./services/integrador-auth.service");
const integrador_controller_1 = require("./controllers/integrador.controller");
const api_exemplo_controller_1 = require("./controllers/api-exemplo.controller");
const integrador_auth_guard_1 = require("./guards/integrador-auth.guard");
/**
 * Módulo principal para gerenciamento de integradores.
 * Configura todas as entidades, serviços e controllers necessários.
 */
let IntegradorModule = class IntegradorModule {
};
exports.IntegradorModule = IntegradorModule;
exports.IntegradorModule = IntegradorModule = __decorate([
    (0, common_1.Module)({
        imports: [
            typeorm_1.TypeOrmModule.forFeature([
                entities_1.Integrador,
                entities_1.IntegradorToken,
                entities_1.TokenRevogado
            ]),
            jwt_1.JwtModule.registerAsync({
                imports: [config_1.ConfigModule],
                inject: [config_1.ConfigService],
                useFactory: (configService) => {
                    const privateKeyBase64 = configService.get('JWT_PRIVATE_KEY_BASE64');
                    const privateKey = Buffer.from(privateKeyBase64 || '', 'base64').toString('utf8');
                    return {
                        privateKey,
                        publicKey: Buffer.from(configService.get('JWT_PUBLIC_KEY_BASE64', ''), 'base64').toString('utf8'),
                        signOptions: {
                            algorithm: 'RS256'
                        },
                    };
                },
            })
        ],
        controllers: [
            integrador_controller_1.IntegradorController,
            api_exemplo_controller_1.ApiExemploController
        ],
        providers: [
            integrador_service_1.IntegradorService,
            integrador_token_service_1.IntegradorTokenService,
            integrador_auth_service_1.IntegradorAuthService,
            integrador_auth_guard_1.IntegradorAuthGuard
        ],
        exports: [
            integrador_service_1.IntegradorService,
            integrador_token_service_1.IntegradorTokenService,
            integrador_auth_service_1.IntegradorAuthService,
            integrador_auth_guard_1.IntegradorAuthGuard
        ],
    })
], IntegradorModule);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGludGVncmFkb3JcXGludGVncmFkb3IubW9kdWxlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDJDQUF3QztBQUN4Qyw2Q0FBZ0Q7QUFDaEQscUNBQXdDO0FBQ3hDLDJDQUE2RDtBQUU3RCw2Q0FJd0I7QUFFeEIsc0VBQWtFO0FBQ2xFLGtGQUE2RTtBQUM3RSxnRkFBMkU7QUFFM0UsK0VBQTJFO0FBQzNFLGlGQUE0RTtBQUU1RSwwRUFBcUU7QUFFckU7OztHQUdHO0FBNkNJLElBQU0sZ0JBQWdCLEdBQXRCLE1BQU0sZ0JBQWdCO0NBQUcsQ0FBQTtBQUFuQiw0Q0FBZ0I7MkJBQWhCLGdCQUFnQjtJQTVDNUIsSUFBQSxlQUFNLEVBQUM7UUFDTixPQUFPLEVBQUU7WUFDUCx1QkFBYSxDQUFDLFVBQVUsQ0FBQztnQkFDdkIscUJBQVU7Z0JBQ1YsMEJBQWU7Z0JBQ2Ysd0JBQWE7YUFDZCxDQUFDO1lBQ0YsZUFBUyxDQUFDLGFBQWEsQ0FBQztnQkFDdEIsT0FBTyxFQUFFLENBQUMscUJBQVksQ0FBQztnQkFDdkIsTUFBTSxFQUFFLENBQUMsc0JBQWEsQ0FBQztnQkFDdkIsVUFBVSxFQUFFLENBQUMsYUFBNEIsRUFBRSxFQUFFO29CQUMzQyxNQUFNLGdCQUFnQixHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQVMsd0JBQXdCLENBQUMsQ0FBQztvQkFDN0UsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsSUFBSSxFQUFFLEVBQUUsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO29CQUVsRixPQUFPO3dCQUNMLFVBQVU7d0JBQ1YsU0FBUyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQ3BCLGFBQWEsQ0FBQyxHQUFHLENBQVMsdUJBQXVCLEVBQUUsRUFBRSxDQUFDLEVBQ3RELFFBQVEsQ0FDVCxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7d0JBQ2xCLFdBQVcsRUFBRTs0QkFDWCxTQUFTLEVBQUUsT0FBTzt5QkFDbkI7cUJBQ0YsQ0FBQztnQkFDSixDQUFDO2FBQ0YsQ0FBQztTQUNIO1FBQ0QsV0FBVyxFQUFFO1lBQ1gsNENBQW9CO1lBQ3BCLDZDQUFvQjtTQUNyQjtRQUNELFNBQVMsRUFBRTtZQUNULHNDQUFpQjtZQUNqQixpREFBc0I7WUFDdEIsK0NBQXFCO1lBQ3JCLDJDQUFtQjtTQUNwQjtRQUNELE9BQU8sRUFBRTtZQUNQLHNDQUFpQjtZQUNqQixpREFBc0I7WUFDdEIsK0NBQXFCO1lBQ3JCLDJDQUFtQjtTQUNwQjtLQUNGLENBQUM7R0FDVyxnQkFBZ0IsQ0FBRyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcaW50ZWdyYWRvclxcaW50ZWdyYWRvci5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgVHlwZU9ybU1vZHVsZSB9IGZyb20gJ0BuZXN0anMvdHlwZW9ybSc7XG5pbXBvcnQgeyBKd3RNb2R1bGUgfSBmcm9tICdAbmVzdGpzL2p3dCc7XG5pbXBvcnQgeyBDb25maWdNb2R1bGUsIENvbmZpZ1NlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2NvbmZpZyc7XG5cbmltcG9ydCB7IFxuICBJbnRlZ3JhZG9yLCBcbiAgSW50ZWdyYWRvclRva2VuLCBcbiAgVG9rZW5SZXZvZ2FkbyBcbn0gZnJvbSAnLi4vLi4vZW50aXRpZXMnO1xuXG5pbXBvcnQgeyBJbnRlZ3JhZG9yU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvaW50ZWdyYWRvci5zZXJ2aWNlJztcbmltcG9ydCB7IEludGVncmFkb3JUb2tlblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2ludGVncmFkb3ItdG9rZW4uc2VydmljZSc7XG5pbXBvcnQgeyBJbnRlZ3JhZG9yQXV0aFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2ludGVncmFkb3ItYXV0aC5zZXJ2aWNlJztcblxuaW1wb3J0IHsgSW50ZWdyYWRvckNvbnRyb2xsZXIgfSBmcm9tICcuL2NvbnRyb2xsZXJzL2ludGVncmFkb3IuY29udHJvbGxlcic7XG5pbXBvcnQgeyBBcGlFeGVtcGxvQ29udHJvbGxlciB9IGZyb20gJy4vY29udHJvbGxlcnMvYXBpLWV4ZW1wbG8uY29udHJvbGxlcic7XG5cbmltcG9ydCB7IEludGVncmFkb3JBdXRoR3VhcmQgfSBmcm9tICcuL2d1YXJkcy9pbnRlZ3JhZG9yLWF1dGguZ3VhcmQnO1xuXG4vKipcbiAqIE3Ds2R1bG8gcHJpbmNpcGFsIHBhcmEgZ2VyZW5jaWFtZW50byBkZSBpbnRlZ3JhZG9yZXMuXG4gKiBDb25maWd1cmEgdG9kYXMgYXMgZW50aWRhZGVzLCBzZXJ2acOnb3MgZSBjb250cm9sbGVycyBuZWNlc3PDoXJpb3MuXG4gKi9cbkBNb2R1bGUoe1xuICBpbXBvcnRzOiBbXG4gICAgVHlwZU9ybU1vZHVsZS5mb3JGZWF0dXJlKFtcbiAgICAgIEludGVncmFkb3IsIFxuICAgICAgSW50ZWdyYWRvclRva2VuLCBcbiAgICAgIFRva2VuUmV2b2dhZG9cbiAgICBdKSxcbiAgICBKd3RNb2R1bGUucmVnaXN0ZXJBc3luYyh7XG4gICAgICBpbXBvcnRzOiBbQ29uZmlnTW9kdWxlXSxcbiAgICAgIGluamVjdDogW0NvbmZpZ1NlcnZpY2VdLFxuICAgICAgdXNlRmFjdG9yeTogKGNvbmZpZ1NlcnZpY2U6IENvbmZpZ1NlcnZpY2UpID0+IHtcbiAgICAgICAgY29uc3QgcHJpdmF0ZUtleUJhc2U2NCA9IGNvbmZpZ1NlcnZpY2UuZ2V0PHN0cmluZz4oJ0pXVF9QUklWQVRFX0tFWV9CQVNFNjQnKTtcbiAgICAgICAgY29uc3QgcHJpdmF0ZUtleSA9IEJ1ZmZlci5mcm9tKHByaXZhdGVLZXlCYXNlNjQgfHwgJycsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwcml2YXRlS2V5LFxuICAgICAgICAgIHB1YmxpY0tleTogQnVmZmVyLmZyb20oXG4gICAgICAgICAgICBjb25maWdTZXJ2aWNlLmdldDxzdHJpbmc+KCdKV1RfUFVCTElDX0tFWV9CQVNFNjQnLCAnJyksXG4gICAgICAgICAgICAnYmFzZTY0J1xuICAgICAgICAgICkudG9TdHJpbmcoJ3V0ZjgnKSxcbiAgICAgICAgICBzaWduT3B0aW9uczoge1xuICAgICAgICAgICAgYWxnb3JpdGhtOiAnUlMyNTYnXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSlcbiAgXSxcbiAgY29udHJvbGxlcnM6IFtcbiAgICBJbnRlZ3JhZG9yQ29udHJvbGxlcixcbiAgICBBcGlFeGVtcGxvQ29udHJvbGxlclxuICBdLFxuICBwcm92aWRlcnM6IFtcbiAgICBJbnRlZ3JhZG9yU2VydmljZSxcbiAgICBJbnRlZ3JhZG9yVG9rZW5TZXJ2aWNlLFxuICAgIEludGVncmFkb3JBdXRoU2VydmljZSxcbiAgICBJbnRlZ3JhZG9yQXV0aEd1YXJkXG4gIF0sXG4gIGV4cG9ydHM6IFtcbiAgICBJbnRlZ3JhZG9yU2VydmljZSxcbiAgICBJbnRlZ3JhZG9yVG9rZW5TZXJ2aWNlLFxuICAgIEludGVncmFkb3JBdXRoU2VydmljZSxcbiAgICBJbnRlZ3JhZG9yQXV0aEd1YXJkXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIEludGVncmFkb3JNb2R1bGUge31cbiJdLCJ2ZXJzaW9uIjozfQ==