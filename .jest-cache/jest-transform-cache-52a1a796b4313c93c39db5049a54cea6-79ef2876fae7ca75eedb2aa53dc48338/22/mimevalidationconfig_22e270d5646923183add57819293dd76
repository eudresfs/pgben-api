ea5f1049bcb3b0739da7459fba89ddef
"use strict";
/**
 * Configuração de Validação MIME
 *
 * Define tipos MIME permitidos e configurações de segurança
 * para upload de documentos no sistema SEMTAS
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.DANGEROUS_MIME_TYPES = exports.EXTENSION_TO_MIME_MAP = exports.BENEFIT_SPECIFIC_MIME_CONFIG = exports.DEFAULT_MIME_VALIDATION_CONFIG = exports.ALLOWED_EXTENSIONS = exports.ALLOWED_MIME_TYPES = void 0;
exports.getMimeConfigForBenefit = getMimeConfigForBenefit;
exports.isMimeTypeAllowed = isMimeTypeAllowed;
exports.isExtensionAllowed = isExtensionAllowed;
exports.getExpectedMimeType = getExpectedMimeType;
/**
 * Tipos MIME permitidos para documentos oficiais
 */
exports.ALLOWED_MIME_TYPES = {
    // Documentos PDF
    PDF: 'application/pdf',
    // Imagens
    JPEG: 'image/jpeg',
    JPG: 'image/jpg',
    PNG: 'image/png',
    // Documentos do Microsoft Office
    DOC: 'application/msword',
    DOCX: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
    XLS: 'application/vnd.ms-excel',
    XLSX: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    // Documentos do LibreOffice/OpenOffice
    ODT: 'application/vnd.oasis.opendocument.text',
    ODS: 'application/vnd.oasis.opendocument.spreadsheet',
    // Texto simples
    TXT: 'text/plain',
};
/**
 * Extensões de arquivo permitidas
 */
exports.ALLOWED_EXTENSIONS = [
    '.pdf',
    '.jpg',
    '.jpeg',
    '.png',
    '.doc',
    '.docx',
    '.xls',
    '.xlsx',
    '.odt',
    '.ods',
    '.txt',
];
/**
 * Configuração padrão de validação MIME
 */
exports.DEFAULT_MIME_VALIDATION_CONFIG = {
    allowedMimeTypes: Object.values(exports.ALLOWED_MIME_TYPES),
    maxFileSize: 10 * 1024 * 1024, // 10MB
    allowedExtensions: [...exports.ALLOWED_EXTENSIONS],
    strictValidation: true,
    scanForMalware: false, // Pode ser habilitado em produção
};
/**
 * Configuração específica por tipo de benefício
 */
exports.BENEFIT_SPECIFIC_MIME_CONFIG = {
    AUXILIO_NATALIDADE: {
        ...exports.DEFAULT_MIME_VALIDATION_CONFIG,
        allowedMimeTypes: [
            exports.ALLOWED_MIME_TYPES.PDF,
            exports.ALLOWED_MIME_TYPES.JPEG,
            exports.ALLOWED_MIME_TYPES.JPG,
            exports.ALLOWED_MIME_TYPES.PNG,
        ],
        maxFileSize: 5 * 1024 * 1024, // 5MB para documentos de natalidade
    },
    ALUGUEL_SOCIAL: {
        ...exports.DEFAULT_MIME_VALIDATION_CONFIG,
        allowedMimeTypes: [
            exports.ALLOWED_MIME_TYPES.PDF,
            exports.ALLOWED_MIME_TYPES.JPEG,
            exports.ALLOWED_MIME_TYPES.JPG,
            exports.ALLOWED_MIME_TYPES.PNG,
            exports.ALLOWED_MIME_TYPES.DOC,
            exports.ALLOWED_MIME_TYPES.DOCX,
        ],
        maxFileSize: 8 * 1024 * 1024, // 8MB para documentos de aluguel
    },
    DEFAULT: exports.DEFAULT_MIME_VALIDATION_CONFIG,
};
/**
 * Mapeamento de extensão para tipo MIME
 */
exports.EXTENSION_TO_MIME_MAP = {
    '.pdf': exports.ALLOWED_MIME_TYPES.PDF,
    '.jpg': exports.ALLOWED_MIME_TYPES.JPEG,
    '.jpeg': exports.ALLOWED_MIME_TYPES.JPEG,
    '.png': exports.ALLOWED_MIME_TYPES.PNG,
    '.doc': exports.ALLOWED_MIME_TYPES.DOC,
    '.docx': exports.ALLOWED_MIME_TYPES.DOCX,
    '.xls': exports.ALLOWED_MIME_TYPES.XLS,
    '.xlsx': exports.ALLOWED_MIME_TYPES.XLSX,
    '.odt': exports.ALLOWED_MIME_TYPES.ODT,
    '.ods': exports.ALLOWED_MIME_TYPES.ODS,
    '.txt': exports.ALLOWED_MIME_TYPES.TXT,
};
/**
 * Tipos MIME perigosos que devem ser sempre rejeitados
 */
exports.DANGEROUS_MIME_TYPES = [
    'application/x-executable',
    'application/x-msdownload',
    'application/x-msdos-program',
    'application/x-msi',
    'application/x-bat',
    'application/x-sh',
    'application/javascript',
    'text/javascript',
    'application/x-javascript',
    'text/html',
    'application/x-php',
    'application/x-httpd-php',
    'application/x-python-code',
    'application/java-archive',
    'application/x-java-archive',
];
/**
 * Função para obter configuração MIME por tipo de benefício
 */
function getMimeConfigForBenefit(tipoBeneficio) {
    if (!tipoBeneficio) {
        return exports.BENEFIT_SPECIFIC_MIME_CONFIG.DEFAULT;
    }
    const normalizedType = tipoBeneficio.toUpperCase().replace(/\s+/g, '_');
    return (exports.BENEFIT_SPECIFIC_MIME_CONFIG[normalizedType] ||
        exports.BENEFIT_SPECIFIC_MIME_CONFIG.DEFAULT);
}
/**
 * Função para validar se um tipo MIME é permitido
 */
function isMimeTypeAllowed(mimeType, config) {
    // Verificar se não é um tipo perigoso
    if (exports.DANGEROUS_MIME_TYPES.includes(mimeType)) {
        return false;
    }
    // Verificar se está na lista de permitidos
    return config.allowedMimeTypes.includes(mimeType);
}
/**
 * Função para validar extensão de arquivo
 */
function isExtensionAllowed(filename, config) {
    const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));
    return config.allowedExtensions.includes(extension);
}
/**
 * Função para obter tipo MIME esperado baseado na extensão
 */
function getExpectedMimeType(filename) {
    const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));
    return (exports.EXTENSION_TO_MIME_MAP[extension] ||
        null);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGRvY3VtZW50b1xcY29uZmlnXFxtaW1lLXZhbGlkYXRpb24uY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7O0FBd0lILDBEQWFDO0FBS0QsOENBV0M7QUFLRCxnREFNQztBQUtELGtEQU1DO0FBakxEOztHQUVHO0FBQ1UsUUFBQSxrQkFBa0IsR0FBRztJQUNoQyxpQkFBaUI7SUFDakIsR0FBRyxFQUFFLGlCQUFpQjtJQUV0QixVQUFVO0lBQ1YsSUFBSSxFQUFFLFlBQVk7SUFDbEIsR0FBRyxFQUFFLFdBQVc7SUFDaEIsR0FBRyxFQUFFLFdBQVc7SUFFaEIsaUNBQWlDO0lBQ2pDLEdBQUcsRUFBRSxvQkFBb0I7SUFDekIsSUFBSSxFQUFFLHlFQUF5RTtJQUMvRSxHQUFHLEVBQUUsMEJBQTBCO0lBQy9CLElBQUksRUFBRSxtRUFBbUU7SUFFekUsdUNBQXVDO0lBQ3ZDLEdBQUcsRUFBRSx5Q0FBeUM7SUFDOUMsR0FBRyxFQUFFLGdEQUFnRDtJQUVyRCxnQkFBZ0I7SUFDaEIsR0FBRyxFQUFFLFlBQVk7Q0FDVCxDQUFDO0FBRVg7O0dBRUc7QUFDVSxRQUFBLGtCQUFrQixHQUFHO0lBQ2hDLE1BQU07SUFDTixNQUFNO0lBQ04sT0FBTztJQUNQLE1BQU07SUFDTixNQUFNO0lBQ04sT0FBTztJQUNQLE1BQU07SUFDTixPQUFPO0lBQ1AsTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0NBQ0UsQ0FBQztBQUVYOztHQUVHO0FBQ1UsUUFBQSw4QkFBOEIsR0FBeUI7SUFDbEUsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQywwQkFBa0IsQ0FBQztJQUNuRCxXQUFXLEVBQUUsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTztJQUN0QyxpQkFBaUIsRUFBRSxDQUFDLEdBQUcsMEJBQWtCLENBQUM7SUFDMUMsZ0JB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TSxTQUFTLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDOUUsT0FBTyxNQUFNLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3RELENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLG1CQUFtQixDQUFDLFFBQWdCO0lBQ2xELE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQzlFLE9BQU8sQ0FDTCw2QkFBcUIsQ0FBQyxTQUErQyxDQUFDO1FBQ3RFLElBQUksQ0FDTCxDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcZG9jdW1lbnRvXFxjb25maWdcXG1pbWUtdmFsaWRhdGlvbi5jb25maWcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb25maWd1cmHDp8OjbyBkZSBWYWxpZGHDp8OjbyBNSU1FXG4gKlxuICogRGVmaW5lIHRpcG9zIE1JTUUgcGVybWl0aWRvcyBlIGNvbmZpZ3VyYcOnw7VlcyBkZSBzZWd1cmFuw6dhXG4gKiBwYXJhIHVwbG9hZCBkZSBkb2N1bWVudG9zIG5vIHNpc3RlbWEgU0VNVEFTXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBNaW1lVmFsaWRhdGlvbkNvbmZpZyB7XG4gIGFsbG93ZWRNaW1lVHlwZXM6IHN0cmluZ1tdO1xuICBtYXhGaWxlU2l6ZTogbnVtYmVyO1xuICBhbGxvd2VkRXh0ZW5zaW9uczogc3RyaW5nW107XG4gIHN0cmljdFZhbGlkYXRpb246IGJvb2xlYW47XG4gIHNjYW5Gb3JNYWx3YXJlOiBib29sZWFuO1xufVxuXG4vKipcbiAqIFRpcG9zIE1JTUUgcGVybWl0aWRvcyBwYXJhIGRvY3VtZW50b3Mgb2ZpY2lhaXNcbiAqL1xuZXhwb3J0IGNvbnN0IEFMTE9XRURfTUlNRV9UWVBFUyA9IHtcbiAgLy8gRG9jdW1lbnRvcyBQREZcbiAgUERGOiAnYXBwbGljYXRpb24vcGRmJyxcblxuICAvLyBJbWFnZW5zXG4gIEpQRUc6ICdpbWFnZS9qcGVnJyxcbiAgSlBHOiAnaW1hZ2UvanBnJyxcbiAgUE5HOiAnaW1hZ2UvcG5nJyxcblxuICAvLyBEb2N1bWVudG9zIGRvIE1pY3Jvc29mdCBPZmZpY2VcbiAgRE9DOiAnYXBwbGljYXRpb24vbXN3b3JkJyxcbiAgRE9DWDogJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50JyxcbiAgWExTOiAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJyxcbiAgWExTWDogJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0JyxcblxuICAvLyBEb2N1bWVudG9zIGRvIExpYnJlT2ZmaWNlL09wZW5PZmZpY2VcbiAgT0RUOiAnYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC50ZXh0JyxcbiAgT0RTOiAnYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC5zcHJlYWRzaGVldCcsXG5cbiAgLy8gVGV4dG8gc2ltcGxlc1xuICBUWFQ6ICd0ZXh0L3BsYWluJyxcbn0gYXMgY29uc3Q7XG5cbi8qKlxuICogRXh0ZW5zw7VlcyBkZSBhcnF1aXZvIHBlcm1pdGlkYXNcbiAqL1xuZXhwb3J0IGNvbnN0IEFMTE9XRURfRVhURU5TSU9OUyA9IFtcbiAgJy5wZGYnLFxuICAnLmpwZycsXG4gICcuanBlZycsXG4gICcucG5nJyxcbiAgJy5kb2MnLFxuICAnLmRvY3gnLFxuICAnLnhscycsXG4gICcueGxzeCcsXG4gICcub2R0JyxcbiAgJy5vZHMnLFxuICAnLnR4dCcsXG5dIGFzIGNvbnN0O1xuXG4vKipcbiAqIENvbmZpZ3VyYcOnw6NvIHBhZHLDo28gZGUgdmFsaWRhw6fDo28gTUlNRVxuICovXG5leHBvcnQgY29uc3QgREVGQVVMVF9NSU1FX1ZBTElEQVRJT05fQ09ORklHOiBNaW1lVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgYWxsb3dlZE1pbWVUeXBlczogT2JqZWN0LnZhbHVlcyhBTExPV0VEX01JTUVfVFlQRVMpLFxuICBtYXhGaWxlU2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxuICBhbGxvd2VkRXh0ZW5zaW9uczogWy4uLkFMTE9XRURfRVhURU5TSU9OU10sXG4gIHN0cmljdFZhbGlkYXRpb246IHRydWUsXG4gIHNjYW5Gb3JNYWx3YXJlOiBmYWxzZSwgLy8gUG9kZSBzZXIgaGFiaWxpdGFkbyBlbSBwcm9kdcOnw6NvXG59O1xuXG4vKipcbiAqIENvbmZpZ3VyYcOnw6NvIGVzcGVjw61maWNhIHBvciB0aXBvIGRlIGJlbmVmw61jaW9cbiAqL1xuZXhwb3J0IGNvbnN0IEJFTkVGSVRfU1BFQ0lGSUNfTUlNRV9DT05GSUcgPSB7XG4gIEFVWElMSU9fTkFUQUxJREFERToge1xuICAgIC4uLkRFRkFVTFRfTUlNRV9WQUxJREFUSU9OX0NPTkZJRyxcbiAgICBhbGxvd2VkTWltZVR5cGVzOiBbXG4gICAgICBBTExPV0VEX01JTUVfVFlQRVMuUERGLFxuICAgICAgQUxMT1dFRF9NSU1FX1RZUEVTLkpQRUcsXG4gICAgICBBTExPV0VEX01JTUVfVFlQRVMuSlBHLFxuICAgICAgQUxMT1dFRF9NSU1FX1RZUEVTLlBORyxcbiAgICBdLFxuICAgIG1heEZpbGVTaXplOiA1ICogMTAyNCAqIDEwMjQsIC8vIDVNQiBwYXJhIGRvY3VtZW50b3MgZGUgbmF0YWxpZGFkZVxuICB9LFxuXG4gIEFMVUdVRUxfU09DSUFMOiB7XG4gICAgLi4uREVGQVVMVF9NSU1FX1ZBTElEQVRJT05fQ09ORklHLFxuICAgIGFsbG93ZWRNaW1lVHlwZXM6IFtcbiAgICAgIEFMTE9XRURfTUlNRV9UWVBFUy5QREYsXG4gICAgICBBTExPV0VEX01JTUVfVFlQRVMuSlBFRyxcbiAgICAgIEFMTE9XRURfTUlNRV9UWVBFUy5KUEcsXG4gICAgICBBTExPV0VEX01JTUVfVFlQRVMuUE5HLFxuICAgICAgQUxMT1dFRF9NSU1FX1RZUEVTLkRPQyxcbiAgICAgIEFMTE9XRURfTUlNRV9UWVBFUy5ET0NYLFxuICAgIF0sXG4gICAgbWF4RmlsZVNpemU6IDggKiAxMDI0ICogMTAyNCwgLy8gOE1CIHBhcmEgZG9jdW1lbnRvcyBkZSBhbHVndWVsXG4gIH0sXG5cbiAgREVGQVVMVDogREVGQVVMVF9NSU1FX1ZBTElEQVRJT05fQ09ORklHLFxufSBhcyBjb25zdDtcblxuLyoqXG4gKiBNYXBlYW1lbnRvIGRlIGV4dGVuc8OjbyBwYXJhIHRpcG8gTUlNRVxuICovXG5leHBvcnQgY29uc3QgRVhURU5TSU9OX1RPX01JTUVfTUFQID0ge1xuICAnLnBkZic6IEFMTE9XRURfTUlNRV9UWVBFUy5QREYsXG4gICcuanBnJzogQUxMT1dFRF9NSU1FX1RZUEVTLkpQRUcsXG4gICcuanBlZyc6IEFMTE9XRURfTUlNRV9UWVBFUy5KUEVHLFxuICAnLnBuZyc6IEFMTE9XRURfTUlNRV9UWVBFUy5QTkcsXG4gICcuZG9jJzogQUxMT1dFRF9NSU1FX1RZUEVTLkRPQyxcbiAgJy5kb2N4JzogQUxMT1dFRF9NSU1FX1RZUEVTLkRPQ1gsXG4gICcueGxzJzogQUxMT1dFRF9NSU1FX1RZUEVTLlhMUyxcbiAgJy54bHN4JzogQUxMT1dFRF9NSU1FX1RZUEVTLlhMU1gsXG4gICcub2R0JzogQUxMT1dFRF9NSU1FX1RZUEVTLk9EVCxcbiAgJy5vZHMnOiBBTExPV0VEX01JTUVfVFlQRVMuT0RTLFxuICAnLnR4dCc6IEFMTE9XRURfTUlNRV9UWVBFUy5UWFQsXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIFRpcG9zIE1JTUUgcGVyaWdvc29zIHF1ZSBkZXZlbSBzZXIgc2VtcHJlIHJlamVpdGFkb3NcbiAqL1xuZXhwb3J0IGNvbnN0IERBTkdFUk9VU19NSU1FX1RZUEVTID0gW1xuICAnYXBwbGljYXRpb24veC1leGVjdXRhYmxlJyxcbiAgJ2FwcGxpY2F0aW9uL3gtbXNkb3dubG9hZCcsXG4gICdhcHBsaWNhdGlvbi94LW1zZG9zLXByb2dyYW0nLFxuICAnYXBwbGljYXRpb24veC1tc2knLFxuICAnYXBwbGljYXRpb24veC1iYXQnLFxuICAnYXBwbGljYXRpb24veC1zaCcsXG4gICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JyxcbiAgJ3RleHQvamF2YXNjcmlwdCcsXG4gICdhcHBsaWNhdGlvbi94LWphdmFzY3JpcHQnLFxuICAndGV4dC9odG1sJyxcbiAgJ2FwcGxpY2F0aW9uL3gtcGhwJyxcbiAgJ2FwcGxpY2F0aW9uL3gtaHR0cGQtcGhwJyxcbiAgJ2FwcGxpY2F0aW9uL3gtcHl0aG9uLWNvZGUnLFxuICAnYXBwbGljYXRpb24vamF2YS1hcmNoaXZlJyxcbiAgJ2FwcGxpY2F0aW9uL3gtamF2YS1hcmNoaXZlJyxcbl0gYXMgY29uc3Q7XG5cbi8qKlxuICogRnVuw6fDo28gcGFyYSBvYnRlciBjb25maWd1cmHDp8OjbyBNSU1FIHBvciB0aXBvIGRlIGJlbmVmw61jaW9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1pbWVDb25maWdGb3JCZW5lZml0KFxuICB0aXBvQmVuZWZpY2lvPzogc3RyaW5nLFxuKTogTWltZVZhbGlkYXRpb25Db25maWcge1xuICBpZiAoIXRpcG9CZW5lZmljaW8pIHtcbiAgICByZXR1cm4gQkVORUZJVF9TUEVDSUZJQ19NSU1FX0NPTkZJRy5ERUZBVUxUO1xuICB9XG5cbiAgY29uc3Qgbm9ybWFsaXplZFR5cGUgPSB0aXBvQmVuZWZpY2lvLnRvVXBwZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnXycpO1xuXG4gIHJldHVybiAoXG4gICAgKEJFTkVGSVRfU1BFQ0lGSUNfTUlNRV9DT05GSUcgYXMgYW55KVtub3JtYWxpemVkVHlwZV0gfHxcbiAgICBCRU5FRklUX1NQRUNJRklDX01JTUVfQ09ORklHLkRFRkFVTFRcbiAgKTtcbn1cblxuLyoqXG4gKiBGdW7Dp8OjbyBwYXJhIHZhbGlkYXIgc2UgdW0gdGlwbyBNSU1FIMOpIHBlcm1pdGlkb1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNNaW1lVHlwZUFsbG93ZWQoXG4gIG1pbWVUeXBlOiBzdHJpbmcsXG4gIGNvbmZpZzogTWltZVZhbGlkYXRpb25Db25maWcsXG4pOiBib29sZWFuIHtcbiAgLy8gVmVyaWZpY2FyIHNlIG7Do28gw6kgdW0gdGlwbyBwZXJpZ29zb1xuICBpZiAoREFOR0VST1VTX01JTUVfVFlQRVMuaW5jbHVkZXMobWltZVR5cGUgYXMgYW55KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIFZlcmlmaWNhciBzZSBlc3TDoSBuYSBsaXN0YSBkZSBwZXJtaXRpZG9zXG4gIHJldHVybiBjb25maWcuYWxsb3dlZE1pbWVUeXBlcy5pbmNsdWRlcyhtaW1lVHlwZSk7XG59XG5cbi8qKlxuICogRnVuw6fDo28gcGFyYSB2YWxpZGFyIGV4dGVuc8OjbyBkZSBhcnF1aXZvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVuc2lvbkFsbG93ZWQoXG4gIGZpbGVuYW1lOiBzdHJpbmcsXG4gIGNvbmZpZzogTWltZVZhbGlkYXRpb25Db25maWcsXG4pOiBib29sZWFuIHtcbiAgY29uc3QgZXh0ZW5zaW9uID0gZmlsZW5hbWUudG9Mb3dlckNhc2UoKS5zdWJzdHJpbmcoZmlsZW5hbWUubGFzdEluZGV4T2YoJy4nKSk7XG4gIHJldHVybiBjb25maWcuYWxsb3dlZEV4dGVuc2lvbnMuaW5jbHVkZXMoZXh0ZW5zaW9uKTtcbn1cblxuLyoqXG4gKiBGdW7Dp8OjbyBwYXJhIG9idGVyIHRpcG8gTUlNRSBlc3BlcmFkbyBiYXNlYWRvIG5hIGV4dGVuc8Ojb1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwZWN0ZWRNaW1lVHlwZShmaWxlbmFtZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGVuYW1lLnRvTG93ZXJDYXNlKCkuc3Vic3RyaW5nKGZpbGVuYW1lLmxhc3RJbmRleE9mKCcuJykpO1xuICByZXR1cm4gKFxuICAgIEVYVEVOU0lPTl9UT19NSU1FX01BUFtleHRlbnNpb24gYXMga2V5b2YgdHlwZW9mIEVYVEVOU0lPTl9UT19NSU1FX01BUF0gfHxcbiAgICBudWxsXG4gICk7XG59XG4iXSwidmVyc2lvbiI6M30=