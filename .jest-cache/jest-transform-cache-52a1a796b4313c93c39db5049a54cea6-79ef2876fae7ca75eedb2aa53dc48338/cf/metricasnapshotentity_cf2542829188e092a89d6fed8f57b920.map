{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\metrica-snapshot.entity.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\metrica-snapshot.entity.ts"],"sourcesContent":["import { Entity, Column, PrimaryGeneratedColumn, CreateDateColumn, ManyToOne, JoinColumn, Index } from 'typeorm';\nimport { MetricaDefinicao, GranularidadeTemporal } from './metrica-definicao.entity';\n\n/**\n * Snapshot de valor de uma métrica\n * \n * Esta entidade armazena os valores coletados ou calculados para cada métrica\n * ao longo do tempo, mantendo um histórico completo para análise e visualização.\n */\n@Entity('metrica_snapshot')\n@Index(['definicao_id', 'periodo_inicio', 'periodo_fim', 'dimensoes_hash'], { unique: true })\n@Index(['periodo_inicio', 'periodo_fim'])\nexport class MetricaSnapshot {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  /**\n   * Referência para a definição da métrica\n   */\n  @Column({ type: 'uuid' })\n  definicao_id: string;\n\n  /**\n   * Relacionamento com a definição da métrica\n   * \n   * Usando lazy loading para evitar dependências circulares\n   */\n  @ManyToOne(() => MetricaDefinicao, (definicao) => definicao.snapshots, { onDelete: 'CASCADE', lazy: true })\n  @JoinColumn({ name: 'definicao_id' })\n  definicao: Promise<MetricaDefinicao>;\n\n  /**\n   * Início do período de referência\n   */\n  @Column({ type: 'timestamp' })\n  periodo_inicio: Date;\n\n  /**\n   * Fim do período de referência\n   */\n  @Column({ type: 'timestamp' })\n  periodo_fim: Date;\n\n  /**\n   * Granularidade temporal do snapshot\n   */\n  @Column({\n    type: 'enum',\n    enum: GranularidadeTemporal,\n    enumName: 'granularidade_temporal',\n  })\n  granularidade: GranularidadeTemporal;\n\n  /**\n   * Valor numérico da métrica\n   */\n  @Column({ type: 'decimal', precision: 20, scale: 6 })\n  valor: number;\n\n  /**\n   * Valor formatado conforme configurações de exibição da métrica\n   */\n  @Column({ length: 100, nullable: true })\n  valor_formatado: string;\n\n  /**\n   * Dimensões ou filtros aplicados na coleta do valor\n   * Exemplo: { \"regiao\": \"nordeste\", \"faixa_etaria\": \"18-25\" }\n   */\n  @Column({ type: 'jsonb', default: {} })\n  dimensoes: Record<string, any>;\n\n  /**\n   * Hash das dimensões para garantir unicidade\n   * Gerado a partir do objeto de dimensões\n   */\n  @Column({ length: 64, default: '' })\n  dimensoes_hash: string;\n\n  /**\n   * Metadados adicionais sobre o snapshot\n   * Exemplo: fonte de dados específica, contexto da coleta\n   */\n  @Column({ type: 'jsonb', nullable: true })\n  metadados: Record<string, any>;\n\n  /**\n   * Flag indicando se o valor foi validado após a coleta\n   */\n  @Column({ default: true })\n  validado: boolean;\n\n  /**\n   * Versão da definição da métrica utilizada no cálculo\n   */\n  @Column({ default: 1 })\n  versao_definicao: number;\n\n  /**\n   * Data e hora da coleta/cálculo do valor\n   */\n  @CreateDateColumn()\n  created_at: Date;\n\n  /**\n   * Duração em milissegundos do processo de coleta/cálculo\n   */\n  @Column({ default: 0 })\n  duracao_processamento_ms: number;\n\n  /**\n   * Status da coleta\n   * 'sucesso', 'erro', 'parcial'\n   */\n  @Column({ length: 20, default: 'sucesso' })\n  status_coleta: string;\n\n  /**\n   * Mensagem de erro ou informação adicional sobre o status\n   */\n  @Column({ type: 'text', nullable: true })\n  mensagem_status: string;\n}\n"],"version":3}