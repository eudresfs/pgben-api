9445da0eb172a43bcdff2fb99bef3f3f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("@nestjs/typeorm");
const typeorm_2 = require("typeorm");
const auditoria_queue_service_1 = require("../../../../src/modules/auditoria/services/auditoria-queue.service");
const log_auditoria_entity_1 = require("../../../../src/modules/auditoria/entities/log-auditoria.entity");
const tipo_operacao_enum_1 = require("../../../../src/modules/auditoria/enums/tipo-operacao.enum");
const create_log_auditoria_dto_1 = require("../../../../src/modules/auditoria/dto/create-log-auditoria.dto");
describe('AuditoriaQueueService', () => {
    let service;
    let mockQueue;
    beforeEach(async () => {
        mockQueue = {
            add: jest.fn().mockResolvedValue({ id: 'mock-job-id' }),
        };
        const module = await testing_1.Test.createTestingModule({
            providers: [
                auditoria_queue_service_1.AuditoriaQueueService,
                {
                    provide: 'BullQueue_auditoria',
                    useValue: mockQueue,
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(log_auditoria_entity_1.LogAuditoria),
                    useClass: typeorm_2.Repository,
                },
            ],
        }).compile();
        service = module.get(auditoria_queue_service_1.AuditoriaQueueService);
    });
    it('deve ser definido', () => {
        expect(service).toBeDefined();
    });
    describe('enfileirarLogAuditoria', () => {
        it('deve enfileirar um log de auditoria com sucesso', async () => {
            const logDto = new create_log_auditoria_dto_1.CreateLogAuditoriaDto();
            logDto.tipo_operacao = tipo_operacao_enum_1.TipoOperacao.CREATE;
            logDto.entidade_afetada = 'Usuario';
            logDto.entidade_id = '123e4567-e89b-12d3-a456-426614174000';
            logDto.descricao = 'Criação de novo usuário';
            logDto.ip_origem = '192.168.1.1';
            logDto.usuario_id = 'mock-user-id';
            await service.enfileirarLogAuditoria(logDto);
            expect(mockQueue.add).toHaveBeenCalledWith('registrar-log', logDto, expect.objectContaining({
                attempts: 3,
                backoff: expect.objectContaining({
                    type: 'exponential',
                    delay: 1000,
                }),
            }));
        });
        it('deve lidar com erros ao enfileirar', async () => {
            const logDto = new create_log_auditoria_dto_1.CreateLogAuditoriaDto();
            logDto.tipo_operacao = tipo_operacao_enum_1.TipoOperacao.CREATE;
            logDto.entidade_afetada = 'Usuario';
            mockQueue.add.mockRejectedValueOnce(new Error('Erro ao enfileirar'));
            await expect(service.enfileirarLogAuditoria(logDto)).rejects.toThrow('Erro ao enfileirar');
        });
    });
    describe('enfileirarAcessoDadosSensiveis', () => {
        it('deve enfileirar um registro de acesso a dados sensíveis', async () => {
            const usuarioId = 'mock-user-id';
            const entidade = 'Usuario';
            const entidadeId = '123e4567-e89b-12d3-a456-426614174000';
            const dadosSensiveis = ['cpf', 'renda_familiar'];
            const ip = '192.168.1.1';
            const userAgent = 'Mozilla/5.0';
            const endpoint = '/api/v1/usuarios';
            const metodo = 'GET';
            await service.enfileirarAcessoDadosSensiveis(usuarioId, entidade, entidadeId, dadosSensiveis, ip, userAgent, endpoint, metodo);
            expect(mockQueue.add).toHaveBeenCalledWith('registrar-acesso-dados-sensiveis', expect.objectContaining({
                usuario_id: usuarioId,
                entidade_afetada: entidade,
                entidade_id: entidadeId,
                dados_sensiveis_acessados: dadosSensiveis,
                ip_origem: ip,
                user_agent: userAgent,
                endpoint: endpoint,
                metodo_http: metodo,
                tipo_operacao: tipo_operacao_enum_1.TipoOperacao.READ,
            }), expect.objectContaining({
                attempts: 3,
                backoff: expect.objectContaining({
                    type: 'exponential',
                    delay: 1000,
                }),
            }));
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFx0ZXN0XFxtb2R1bGVzXFxhdWRpdG9yaWFcXHNlcnZpY2VzXFxhdWRpdG9yaWEtcXVldWUuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELDZDQUFxRDtBQUNyRCxxQ0FBcUM7QUFDckMsZ0hBQTJHO0FBQzNHLDBHQUErRjtBQUMvRixtR0FBMEY7QUFDMUYsNkdBQXVHO0FBR3ZHLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDckMsSUFBSSxPQUE4QixDQUFDO0lBQ25DLElBQUksU0FBYyxDQUFDO0lBRW5CLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQixTQUFTLEdBQUc7WUFDVixHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxFQUFFLGFBQWEsRUFBRSxDQUFDO1NBQ3hELENBQUM7UUFFRixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFO2dCQUNULCtDQUFxQjtnQkFDckI7b0JBQ0UsT0FBTyxFQUFFLHFCQUFxQjtvQkFDOUIsUUFBUSxFQUFFLFNBQVM7aUJBQ3BCO2dCQUNEO29CQUNFLE9BQU8sRUFBRSxJQUFBLDRCQUFrQixFQUFDLG1DQUFZLENBQUM7b0JBQ3pDLFFBQVEsRUFBRSxvQkFBVTtpQkFDckI7YUFDRjtTQUNGLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUViLE9BQU8sR0FBRyxNQUFNLENBQUMsR0FBRyxDQUF3QiwrQ0FBcUIsQ0FBQyxDQUFDO0lBQ3JFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtRQUMzQixNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDaEMsQ0FBQyxDQUFDLENBQUM7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Q0FBWSxDQUFDLElBQUk7YUFDakMsQ0FBQyxFQUNGLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztnQkFDdEIsUUFBUSxFQUFFLENBQUM7Z0JBQ1gsT0FBTyxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztvQkFDL0IsSUFBSSxFQUFFLGFBQWE7b0JBQ25CLEtBQUssRUFBRSxJQUFJO2lCQUNaLENBQUM7YUFDSCxDQUFDLENBQ0gsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHRlc3RcXG1vZHVsZXNcXGF1ZGl0b3JpYVxcc2VydmljZXNcXGF1ZGl0b3JpYS1xdWV1ZS5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBnZXRSZXBvc2l0b3J5VG9rZW4gfSBmcm9tICdAbmVzdGpzL3R5cGVvcm0nO1xuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgQXVkaXRvcmlhUXVldWVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvYXVkaXRvcmlhL3NlcnZpY2VzL2F1ZGl0b3JpYS1xdWV1ZS5zZXJ2aWNlJztcbmltcG9ydCB7IExvZ0F1ZGl0b3JpYSB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9tb2R1bGVzL2F1ZGl0b3JpYS9lbnRpdGllcy9sb2ctYXVkaXRvcmlhLmVudGl0eSc7XG5pbXBvcnQgeyBUaXBvT3BlcmFjYW8gfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvbW9kdWxlcy9hdWRpdG9yaWEvZW51bXMvdGlwby1vcGVyYWNhby5lbnVtJztcbmltcG9ydCB7IENyZWF0ZUxvZ0F1ZGl0b3JpYUR0byB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9tb2R1bGVzL2F1ZGl0b3JpYS9kdG8vY3JlYXRlLWxvZy1hdWRpdG9yaWEuZHRvJztcbmltcG9ydCB7IEluamVjdFF1ZXVlIH0gZnJvbSAnQG5lc3Rqcy9idWxsJztcblxuZGVzY3JpYmUoJ0F1ZGl0b3JpYVF1ZXVlU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IEF1ZGl0b3JpYVF1ZXVlU2VydmljZTtcbiAgbGV0IG1vY2tRdWV1ZTogYW55O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tRdWV1ZSA9IHtcbiAgICAgIGFkZDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgaWQ6ICdtb2NrLWpvYi1pZCcgfSksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgQXVkaXRvcmlhUXVldWVTZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogJ0J1bGxRdWV1ZV9hdWRpdG9yaWEnLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrUXVldWUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oTG9nQXVkaXRvcmlhKSxcbiAgICAgICAgICB1c2VDbGFzczogUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8QXVkaXRvcmlhUXVldWVTZXJ2aWNlPihBdWRpdG9yaWFRdWV1ZVNlcnZpY2UpO1xuICB9KTtcblxuICBpdCgnZGV2ZSBzZXIgZGVmaW5pZG8nLCAoKSA9PiB7XG4gICAgZXhwZWN0KHNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlbmZpbGVpcmFyTG9nQXVkaXRvcmlhJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGVuZmlsZWlyYXIgdW0gbG9nIGRlIGF1ZGl0b3JpYSBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ0R0byA9IG5ldyBDcmVhdGVMb2dBdWRpdG9yaWFEdG8oKTtcbiAgICAgIGxvZ0R0by50aXBvX29wZXJhY2FvID0gVGlwb09wZXJhY2FvLkNSRUFURTtcbiAgICAgIGxvZ0R0by5lbnRpZGFkZV9hZmV0YWRhID0gJ1VzdWFyaW8nO1xuICAgICAgbG9nRHRvLmVudGlkYWRlX2lkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCc7XG4gICAgICBsb2dEdG8uZGVzY3JpY2FvID0gJ0NyaWHDp8OjbyBkZSBub3ZvIHVzdcOhcmlvJztcbiAgICAgIGxvZ0R0by5pcF9vcmlnZW0gPSAnMTkyLjE2OC4xLjEnO1xuICAgICAgbG9nRHRvLnVzdWFyaW9faWQgPSAnbW9jay11c2VyLWlkJztcblxuICAgICAgYXdhaXQgc2VydmljZS5lbmZpbGVpcmFyTG9nQXVkaXRvcmlhKGxvZ0R0byk7XG5cbiAgICAgIGV4cGVjdChtb2NrUXVldWUuYWRkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3JlZ2lzdHJhci1sb2cnLFxuICAgICAgICBsb2dEdG8sXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBhdHRlbXB0czogMyxcbiAgICAgICAgICBiYWNrb2ZmOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICB0eXBlOiAnZXhwb25lbnRpYWwnLFxuICAgICAgICAgICAgZGVsYXk6IDEwMDAsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxpZGFyIGNvbSBlcnJvcyBhbyBlbmZpbGVpcmFyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbG9nRHRvID0gbmV3IENyZWF0ZUxvZ0F1ZGl0b3JpYUR0bygpO1xuICAgICAgbG9nRHRvLnRpcG9fb3BlcmFjYW8gPSBUaXBvT3BlcmFjYW8uQ1JFQVRFO1xuICAgICAgbG9nRHRvLmVudGlkYWRlX2FmZXRhZGEgPSAnVXN1YXJpbyc7XG5cbiAgICAgIG1vY2tRdWV1ZS5hZGQubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignRXJybyBhbyBlbmZpbGVpcmFyJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5lbmZpbGVpcmFyTG9nQXVkaXRvcmlhKGxvZ0R0bykpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgJ0Vycm8gYW8gZW5maWxlaXJhcicsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZW5maWxlaXJhckFjZXNzb0RhZG9zU2Vuc2l2ZWlzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGVuZmlsZWlyYXIgdW0gcmVnaXN0cm8gZGUgYWNlc3NvIGEgZGFkb3Mgc2Vuc8OtdmVpcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzdWFyaW9JZCA9ICdtb2NrLXVzZXItaWQnO1xuICAgICAgY29uc3QgZW50aWRhZGUgPSAnVXN1YXJpbyc7XG4gICAgICBjb25zdCBlbnRpZGFkZUlkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCc7XG4gICAgICBjb25zdCBkYWRvc1NlbnNpdmVpcyA9IFsnY3BmJywgJ3JlbmRhX2ZhbWlsaWFyJ107XG4gICAgICBjb25zdCBpcCA9ICcxOTIuMTY4LjEuMSc7XG4gICAgICBjb25zdCB1c2VyQWdlbnQgPSAnTW96aWxsYS81LjAnO1xuICAgICAgY29uc3QgZW5kcG9pbnQgPSAnL2FwaS92MS91c3Vhcmlvcyc7XG4gICAgICBjb25zdCBtZXRvZG8gPSAnR0VUJztcblxuICAgICAgYXdhaXQgc2VydmljZS5lbmZpbGVpcmFyQWNlc3NvRGFkb3NTZW5zaXZlaXMoXG4gICAgICAgIHVzdWFyaW9JZCxcbiAgICAgICAgZW50aWRhZGUsXG4gICAgICAgIGVudGlkYWRlSWQsXG4gICAgICAgIGRhZG9zU2Vuc2l2ZWlzLFxuICAgICAgICBpcCxcbiAgICAgICAgdXNlckFnZW50LFxuICAgICAgICBlbmRwb2ludCxcbiAgICAgICAgbWV0b2RvLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tRdWV1ZS5hZGQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAncmVnaXN0cmFyLWFjZXNzby1kYWRvcy1zZW5zaXZlaXMnLFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdXN1YXJpb19pZDogdXN1YXJpb0lkLFxuICAgICAgICAgIGVudGlkYWRlX2FmZXRhZGE6IGVudGlkYWRlLFxuICAgICAgICAgIGVudGlkYWRlX2lkOiBlbnRpZGFkZUlkLFxuICAgICAgICAgIGRhZG9zX3NlbnNpdmVpc19hY2Vzc2Fkb3M6IGRhZG9zU2Vuc2l2ZWlzLFxuICAgICAgICAgIGlwX29yaWdlbTogaXAsXG4gICAgICAgICAgdXNlcl9hZ2VudDogdXNlckFnZW50LFxuICAgICAgICAgIGVuZHBvaW50OiBlbmRwb2ludCxcbiAgICAgICAgICBtZXRvZG9faHR0cDogbWV0b2RvLFxuICAgICAgICAgIHRpcG9fb3BlcmFjYW86IFRpcG9PcGVyYWNhby5SRUFELFxuICAgICAgICB9KSxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGF0dGVtcHRzOiAzLFxuICAgICAgICAgIGJhY2tvZmY6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIHR5cGU6ICdleHBvbmVudGlhbCcsXG4gICAgICAgICAgICBkZWxheTogMTAwMCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9