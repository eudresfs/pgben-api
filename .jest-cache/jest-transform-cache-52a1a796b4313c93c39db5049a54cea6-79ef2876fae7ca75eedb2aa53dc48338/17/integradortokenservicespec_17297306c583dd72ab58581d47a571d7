235334d217505822e03d41a6fc22131d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("@nestjs/typeorm");
const jwt_1 = require("@nestjs/jwt");
const common_1 = require("@nestjs/common");
const entities_1 = require("../../../entities");
const integrador_token_service_1 = require("../services/integrador-token.service");
const integrador_service_1 = require("../services/integrador.service");
/**
 * Testes unitários para o serviço de tokens de integradores.
 * Valida a geração, validação e revogação de tokens, além das verificações
 * de permissões e restrições de IP.
 */
describe('IntegradorTokenService', () => {
    let service;
    let integradorService;
    let jwtService;
    let tokenRepository;
    let tokenRevogadoRepository;
    // Mocks de repositórios e serviços
    const mockTokenRepository = {
        create: jest.fn(),
        save: jest.fn(),
        find: jest.fn(),
        findOne: jest.fn(),
        remove: jest.fn(),
    };
    const mockTokenRevogadoRepository = {
        create: jest.fn(),
        save: jest.fn(),
        findOne: jest.fn(),
        delete: jest.fn(),
        createQueryBuilder: jest.fn().mockReturnThis(),
        delete: jest.fn().mockReturnThis(),
        from: jest.fn().mockReturnThis(),
        where: jest.fn().mockReturnThis(),
        execute: jest.fn(),
    };
    const mockIntegradorService = {
        findById: jest.fn(),
        registrarAcesso: jest.fn(),
    };
    const mockJwtService = {
        sign: jest.fn(),
        verify: jest.fn(),
    };
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                integrador_token_service_1.IntegradorTokenService,
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.IntegradorToken),
                    useValue: mockTokenRepository,
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.TokenRevogado),
                    useValue: mockTokenRevogadoRepository,
                },
                {
                    provide: integrador_service_1.IntegradorService,
                    useValue: mockIntegradorService,
                },
                {
                    provide: jwt_1.JwtService,
                    useValue: mockJwtService,
                },
            ],
        }).compile();
        service = module.get(integrador_token_service_1.IntegradorTokenService);
        integradorService = module.get(integrador_service_1.IntegradorService);
        jwtService = module.get(jwt_1.JwtService);
        tokenRepository = module.get((0, typeorm_1.getRepositoryToken)(entities_1.IntegradorToken));
        tokenRevogadoRepository = module.get((0, typeorm_1.getRepositoryToken)(entities_1.TokenRevogado));
        // Mock da função crypto.createHash que é usada no serviço
        jest.spyOn(global.crypto, 'createHash').mockReturnValue({
            update: jest.fn().mockReturnThis(),
            digest: jest.fn().mockReturnValue('token-hash'),
        });
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    it('deve estar definido', () => {
        expect(service).toBeDefined();
    });
    describe('createToken', () => {
        it('deve criar um token com sucesso', async () => {
            // Arrange
            const integradorId = 'integrador-id';
            const createTokenDto = {
                nome: 'Token Teste',
                descricao: 'Token para testes',
                escopos: ['read:dados_basicos', 'write:solicitacoes'],
                diasValidade: 30,
                semExpiracao: false,
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Teste',
                ativo: true,
                permissoesEscopo: ['read:dados_basicos', 'write:solicitacoes', 'read:cidadaos'],
            };
            const tokenEntity = {
                id: 'token-id',
                integradorId,
                nome: createTokenDto.nome,
                descricao: createTokenDto.descricao,
                tokenHash: 'token-hash',
                escopos: createTokenDto.escopos,
                dataExpiracao: expect.any(Date),
                dataCriacao: new Date(),
            };
            const jwtToken = 'jwt-token-string';
            mockIntegradorService.findById.mockResolvedValue(integrador);
            mockTokenRepository.create.mockReturnValue(tokenEntity);
            mockTokenRepository.save.mockResolvedValue(tokenEntity);
            mockJwtService.sign.mockReturnValue(jwtToken);
            // Act
            const result = await service.createToken(integradorId, createTokenDto);
            // Assert
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockJwtService.sign).toHaveBeenCalledWith({
                sub: `integrador:${integradorId}`,
                name: integrador.nome,
                type: 'api_token',
                scopes: createTokenDto.escopos,
            }, { expiresIn: '30d' });
            expect(mockTokenRepository.create).toHaveBeenCalledWith(expect.objectContaining({
                integradorId,
                nome: createTokenDto.nome,
                descricao: createTokenDto.descricao,
                tokenHash: expect.any(String),
                escopos: createTokenDto.escopos,
                dataExpiracao: expect.any(Date),
            }));
            expect(mockTokenRepository.save).toHaveBeenCalled();
            expect(result).toEqual({
                token: jwtToken,
                tokenInfo: expect.any(Object)
            });
        });
        it('deve criar um token sem expiração quando semExpiracao=true', async () => {
            // Arrange
            const integradorId = 'integrador-id';
            const createTokenDto = {
                nome: 'Token Permanente',
                descricao: 'Token sem expiração',
                escopos: ['read:dados_basicos'],
                semExpiracao: true,
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Teste',
                ativo: true,
                permissoesEscopo: ['read:dados_basicos', 'write:solicitacoes', 'read:cidadaos'],
            };
            const tokenEntity = {
                id: 'token-id',
                integradorId,
                nome: createTokenDto.nome,
                descricao: createTokenDto.descricao,
                tokenHash: 'token-hash',
                escopos: createTokenDto.escopos,
                dataExpiracao: null, // Sem expiração
                dataCriacao: new Date(),
            };
            mockIntegradorService.findById.mockResolvedValue(integrador);
            mockTokenRepository.create.mockReturnValue(tokenEntity);
            mockTokenRepository.save.mockResolvedValue(tokenEntity);
            mockJwtService.sign.mockReturnValue('jwt-token-string');
            // Act
            const result = await service.createToken(integradorId, createTokenDto);
            // Assert
            expect(mockJwtService.sign).toHaveBeenCalledWith(expect.any(Object), {} // Sem opções de expiração
            );
            expect(mockTokenRepository.create).toHaveBeenCalledWith(expect.objectContaining({
                dataExpiracao: null, // Confirma que token não tem expiração
            }));
            expect(result.tokenInfo.dataExpiracao).toBeNull();
        });
        it('deve lançar BadRequestException quando integrador está inativo', async () => {
            // Arrange
            const integradorId = 'integrador-id';
            const createTokenDto = {
                nome: 'Token Teste',
                escopos: ['read:dados_basicos'],
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Inativo',
                ativo: false,
            };
            mockIntegradorService.findById.mockResolvedValue(integrador);
            // Act & Assert
            await expect(service.createToken(integradorId, createTokenDto))
                .rejects.toThrow(common_1.BadRequestException);
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockTokenRepository.create).not.toHaveBeenCalled();
            expect(mockTokenRepository.save).not.toHaveBeenCalled();
        });
        it('deve lançar BadRequestException quando escopo solicitado não é permitido', async () => {
            // Arrange
            const integradorId = 'integrador-id';
            const createTokenDto = {
                nome: 'Token Teste',
                escopos: ['read:dados_basicos', 'admin:sistema'], // escopo não permitido
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Teste',
                ativo: true,
                permissoesEscopo: ['read:dados_basicos', 'write:solicitacoes'],
            };
            mockIntegradorService.findById.mockResolvedValue(integrador);
            // Act & Assert
            await expect(service.createToken(integradorId, createTokenDto))
                .rejects.toThrow(common_1.BadRequestException);
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockTokenRepository.create).not.toHaveBeenCalled();
            expect(mockTokenRepository.save).not.toHaveBeenCalled();
        });
    });
    describe('findAllByIntegrador', () => {
        it('deve retornar todos os tokens de um integrador', async () => {
            // Arrange
            const integradorId = 'integrador-id';
            const tokens = [
                {
                    id: 'token-1',
                    integradorId,
                    nome: 'Token 1',
                    dataCriacao: new Date(),
                },
                {
                    id: 'token-2',
                    integradorId,
                    nome: 'Token 2',
                    dataCriacao: new Date(),
                },
            ];
            mockIntegradorService.findById.mockResolvedValue({ id: integradorId });
            mockTokenRepository.find.mockResolvedValue(tokens);
            // Act
            const result = await service.findAllByIntegrador(integradorId);
            // Assert
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockTokenRepository.find).toHaveBeenCalledWith({
                where: { integradorId },
                order: { dataCriacao: 'DESC' }
            });
            expect(result).toHaveLength(2);
            expect(result[0].id).toEqual(tokens[0].id);
            expect(result[1].id).toEqual(tokens[1].id);
        });
    });
    describe('findOne', () => {
        it('deve retornar um token específico pelo ID', async () => {
            // Arrange
            const tokenId = 'token-id';
            const token = {
                id: tokenId,
                integradorId: 'integrador-id',
                nome: 'Token Teste',
                dataCriacao: new Date(),
            };
            mockTokenRepository.findOne.mockResolvedValue(token);
            // Act
            const result = await service.findOne(tokenId);
            // Assert
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { id: tokenId }
            });
            expect(result).toBeDefined();
            expect(result.id).toEqual(tokenId);
        });
        it('deve lançar NotFoundException quando token não existe', async () => {
            // Arrange
            const tokenId = 'token-inexistente';
            mockTokenRepository.findOne.mockResolvedValue(null);
            // Act & Assert
            await expect(service.findOne(tokenId)).rejects.toThrow(common_1.NotFoundException);
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { id: tokenId }
            });
        });
    });
    describe('revogarToken', () => {
        it('deve revogar um token com sucesso', async () => {
            // Arrange
            const tokenId = 'token-id';
            const motivo = 'Teste de revogação';
            const token = {
                id: tokenId,
                integradorId: 'integrador-id',
                nome: 'Token para Revogar',
                tokenHash: 'token-hash',
                revogado: false,
                dataExpiracao: new Date(Date.now() + 1000 * 60 * 60 * 24 * 30), // 30 dias no futuro
            };
            const tokenRevogado = {
                ...token,
                revogado: true,
                dataRevogacao: expect.any(Date),
                motivoRevogacao: motivo,
            };
            mockTokenRepository.findOne.mockResolvedValue(token);
            mockTokenRepository.save.mockResolvedValue(tokenRevogado);
            mockTokenRevogadoRepository.create.mockReturnValue({
                tokenHash: token.tokenHash,
                integradorId: token.integradorId,
                motivoRevogacao: motivo,
                dataExpiracao: token.dataExpiracao,
                dataLimpeza: expect.any(Date),
            });
            mockTokenRevogadoRepository.save.mockResolvedValue({});
            // Act
            const result = await service.revogarToken(tokenId, motivo);
            // Assert
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { id: tokenId }
            });
            expect(mockTokenRepository.save).toHaveBeenCalledWith(expect.objectContaining({
                id: tokenId,
                revogado: true,
                dataRevogacao: expect.any(Date),
                motivoRevogacao: motivo,
            }));
            expect(mockTokenRevogadoRepository.create).toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.save).toHaveBeenCalled();
            expect(result.revogado).toBe(true);
            expect(result.motivoRevogacao).toEqual(motivo);
        });
        it('deve lançar BadRequestException ao tentar revogar um token já revogado', async () => {
            // Arrange
            const tokenId = 'token-id';
            const motivo = 'Teste de revogação';
            const token = {
                id: tokenId,
                nome: 'Token já Revogado',
                revogado: true,
                dataRevogacao: new Date(Date.now() - 1000 * 60 * 60), // 1 hora atrás
                motivoRevogacao: 'Revogado anteriormente',
            };
            mockTokenRepository.findOne.mockResolvedValue(token);
            // Act & Assert
            await expect(service.revogarToken(tokenId, motivo))
                .rejects.toThrow(common_1.BadRequestException);
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { id: tokenId }
            });
            expect(mockTokenRepository.save).not.toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.create).not.toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.save).not.toHaveBeenCalled();
        });
        it('deve lançar NotFoundException ao tentar revogar um token inexistente', async () => {
            // Arrange
            const tokenId = 'token-inexistente';
            const motivo = 'Teste de revogação';
            mockTokenRepository.findOne.mockResolvedValue(null);
            // Act & Assert
            await expect(service.revogarToken(tokenId, motivo))
                .rejects.toThrow(common_1.NotFoundException);
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { id: tokenId }
            });
            expect(mockTokenRepository.save).not.toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.create).not.toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.save).not.toHaveBeenCalled();
        });
    });
    describe('validateToken', () => {
        it('deve validar um token válido com sucesso', async () => {
            // Arrange
            const token = 'valid-jwt-token';
            const tokenHash = 'token-hash';
            const integradorId = 'integrador-id';
            const jwtPayload = {
                sub: `integrador:${integradorId}`,
                name: 'Integrador Teste',
                type: 'api_token',
                scopes: ['read:dados_basicos'],
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Teste',
                ativo: true,
            };
            const tokenInfo = {
                id: 'token-id',
                integradorId,
                tokenHash,
                ultimoUso: null,
            };
            mockJwtService.verify.mockReturnValue(jwtPayload);
            mockTokenRevogadoRepository.findOne.mockResolvedValue(null); // Não está revogado
            mockIntegradorService.findById.mockResolvedValue(integrador);
            mockTokenRepository.findOne.mockResolvedValue(tokenInfo);
            // Act
            const result = await service.validateToken(token);
            // Assert
            expect(mockJwtService.verify).toHaveBeenCalledWith(token);
            expect(mockTokenRevogadoRepository.findOne).toHaveBeenCalledWith({
                where: { tokenHash }
            });
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockIntegradorService.registrarAcesso).toHaveBeenCalledWith(integradorId);
            expect(mockTokenRepository.findOne).toHaveBeenCalledWith({
                where: { tokenHash }
            });
            expect(mockTokenRepository.save).toHaveBeenCalledWith(expect.objectContaining({
                id: tokenInfo.id,
                ultimoUso: expect.any(Date),
            }));
            expect(result).toEqual({
                ...jwtPayload,
                integrador,
            });
        });
        it('deve lançar UnauthorizedException quando token está revogado', async () => {
            // Arrange
            const token = 'revoked-jwt-token';
            const tokenHash = 'token-hash';
            const integradorId = 'integrador-id';
            const jwtPayload = {
                sub: `integrador:${integradorId}`,
                name: 'Integrador Teste',
                type: 'api_token',
            };
            mockJwtService.verify.mockReturnValue(jwtPayload);
            mockTokenRevogadoRepository.findOne.mockResolvedValue({
                id: 'revoked-id',
                tokenHash,
            }); // Token revogado
            // Act & Assert
            await expect(service.validateToken(token))
                .rejects.toThrow(common_1.UnauthorizedException);
            expect(mockJwtService.verify).toHaveBeenCalledWith(token);
            expect(mockTokenRevogadoRepository.findOne).toHaveBeenCalledWith({
                where: { tokenHash }
            });
            expect(mockIntegradorService.findById).not.toHaveBeenCalled();
            expect(mockIntegradorService.registrarAcesso).not.toHaveBeenCalled();
        });
        it('deve lançar UnauthorizedException quando integrador está inativo', async () => {
            // Arrange
            const token = 'valid-jwt-token';
            const tokenHash = 'token-hash';
            const integradorId = 'integrador-id';
            const jwtPayload = {
                sub: `integrador:${integradorId}`,
                name: 'Integrador Inativo',
                type: 'api_token',
            };
            const integrador = {
                id: integradorId,
                nome: 'Integrador Inativo',
                ativo: false, // Integrador inativo
            };
            mockJwtService.verify.mockReturnValue(jwtPayload);
            mockTokenRevogadoRepository.findOne.mockResolvedValue(null); // Não está revogado
            mockIntegradorService.findById.mockResolvedValue(integrador);
            // Act & Assert
            await expect(service.validateToken(token))
                .rejects.toThrow(common_1.UnauthorizedException);
            expect(mockJwtService.verify).toHaveBeenCalledWith(token);
            expect(mockTokenRevogadoRepository.findOne).toHaveBeenCalledWith({
                where: { tokenHash }
            });
            expect(mockIntegradorService.findById).toHaveBeenCalledWith(integradorId);
            expect(mockIntegradorService.registrarAcesso).not.toHaveBeenCalled();
        });
        it('deve lançar UnauthorizedException quando type do token não é api_token', async () => {
            // Arrange
            const token = 'wrong-type-token';
            const jwtPayload = {
                sub: 'user:123',
                name: 'Usuário',
                type: 'user_token', // Tipo incorreto
            };
            mockJwtService.verify.mockReturnValue(jwtPayload);
            // Act & Assert
            await expect(service.validateToken(token))
                .rejects.toThrow(common_1.UnauthorizedException);
            expect(mockJwtService.verify).toHaveBeenCalledWith(token);
            expect(mockTokenRevogadoRepository.findOne).not.toHaveBeenCalled();
            expect(mockIntegradorService.findById).not.toHaveBeenCalled();
        });
    });
    describe('hasRequiredScopes', () => {
        it('deve retornar true quando token tem todos os escopos necessários', () => {
            // Arrange
            const payload = {
                scopes: ['read:dados_basicos', 'write:solicitacoes', 'read:cidadaos'],
            };
            const requiredScopes = ['read:dados_basicos', 'write:solicitacoes'];
            // Act
            const result = service.hasRequiredScopes(payload, requiredScopes);
            // Assert
            expect(result).toBe(true);
        });
        it('deve retornar false quando token não tem todos os escopos necessários', () => {
            // Arrange
            const payload = {
                scopes: ['read:dados_basicos'],
            };
            const requiredScopes = ['read:dados_basicos', 'write:solicitacoes'];
            // Act
            const result = service.hasRequiredScopes(payload, requiredScopes);
            // Assert
            expect(result).toBe(false);
        });
        it('deve retornar true quando não há escopos requeridos', () => {
            // Arrange
            const payload = {
                scopes: ['read:dados_basicos'],
            };
            const requiredScopes = [];
            // Act
            const result = service.hasRequiredScopes(payload, requiredScopes);
            // Assert
            expect(result).toBe(true);
        });
        it('deve retornar false quando payload não tem escopos', () => {
            // Arrange
            const payload = {};
            const requiredScopes = ['read:dados_basicos'];
            // Act
            const result = service.hasRequiredScopes(payload, requiredScopes);
            // Assert
            expect(result).toBe(false);
        });
    });
    describe('isIpAllowed', () => {
        it('deve retornar true quando IP está na lista de permitidos', () => {
            // Arrange
            const integrador = {
                ipPermitidos: ['192.168.1.1', '10.0.0.1', '172.16.0.1'],
            };
            const ipAddress = '192.168.1.1';
            // Act
            const result = service.isIpAllowed(integrador, ipAddress);
            // Assert
            expect(result).toBe(true);
        });
        it('deve retornar false quando IP não está na lista de permitidos', () => {
            // Arrange
            const integrador = {
                ipPermitidos: ['192.168.1.1', '10.0.0.1'],
            };
            const ipAddress = '172.16.0.1';
            // Act
            const result = service.isIpAllowed(integrador, ipAddress);
            // Assert
            expect(result).toBe(false);
        });
        it('deve retornar true quando não há lista de IPs permitidos', () => {
            // Arrange
            const integrador = {
                ipPermitidos: [],
            };
            const ipAddress = '192.168.1.1';
            // Act
            const result = service.isIpAllowed(integrador, ipAddress);
            // Assert
            expect(result).toBe(true);
        });
        it('deve retornar true quando a propriedade ipPermitidos não existe', () => {
            // Arrange
            const integrador = {};
            const ipAddress = '192.168.1.1';
            // Act
            const result = service.isIpAllowed(integrador, ipAddress);
            // Assert
            expect(result).toBe(true);
        });
    });
    describe('limparTokensRevogadosExpirados', () => {
        it('deve remover tokens revogados expirados', async () => {
            // Arrange
            mockTokenRevogadoRepository.execute.mockResolvedValue({ affected: 5 });
            // Act
            const result = await service.limparTokensRevogadosExpirados();
            // Assert
            expect(mockTokenRevogadoRepository.createQueryBuilder).toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.delete).toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.from).toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.where).toHaveBeenCalled();
            expect(mockTokenRevogadoRepository.execute).toHaveBeenCalled();
            expect(result).toBe(5);
        });
        it('deve retornar 0 quando nenhum token for removido', async () => {
            // Arrange
            mockTokenRevogadoRepository.execute.mockResolvedValue({ affected: 0 });
            // Act
            const result = await service.limparTokensRevogadosExpirados();
            // Assert
            expect(mockTokenRevogadoRepository.execute).toHaveBeenCalled();
            expect(result).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGludGVncmFkb3JcXHRlc3RzXFxpbnRlZ3JhZG9yLXRva2VuLnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCw2Q0FBcUQ7QUFDckQscUNBQXlDO0FBQ3pDLDJDQUErRjtBQUMvRixnREFBbUU7QUFDbkUsbUZBQThFO0FBQzlFLHVFQUFtRTtBQUduRTs7OztHQUlHO0FBQ0gsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUN0QyxJQUFJLE9BQStCLENBQUM7SUFDcEMsSUFBSSxpQkFBb0MsQ0FBQztJQUN6QyxJQUFJLFVBQXNCLENBQUM7SUFDM0IsSUFBSSxlQUFvQixDQUFDO0lBQ3pCLElBQUksdUJBQTRCLENBQUM7SUFFakMsbUNBQW1DO0lBQ25DLE1BQU0sbUJBQW1CLEdBQUc7UUFDMUIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2xCLENBQUM7SUFFRixNQUFNLDJCQUEyQixHQUFHO1FBQ2xDLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbEIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMsRUFBRTtRQUM5QyxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMs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TixNQUFNLE1BQU0sR0FBRyxNQUFNLE9BQU8sQ0FBQyw4QkFBOEIsRUFBRSxDQUFDO1lBRTlELFNBQVM7WUFDVCxNQUFNLENBQUMsMkJBQTJCLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzFFLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzlELE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzVELE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzdELE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQy9ELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekIsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsVUFBVTtZQUNWLDJCQUEyQixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBRXZFLE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLE9BQU8sQ0FBQyw4QkFBOEIsRUFBRSxDQUFDO1lBRTlELFNBQVM7WUFDVCxNQUFNLENBQUMsMkJBQTJCLENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUMvRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcaW50ZWdyYWRvclxcdGVzdHNcXGludGVncmFkb3ItdG9rZW4uc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgZ2V0UmVwb3NpdG9yeVRva2VuIH0gZnJvbSAnQG5lc3Rqcy90eXBlb3JtJztcbmltcG9ydCB7IEp3dFNlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2p3dCc7XG5pbXBvcnQgeyBCYWRSZXF1ZXN0RXhjZXB0aW9uLCBOb3RGb3VuZEV4Y2VwdGlvbiwgVW5hdXRob3JpemVkRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgSW50ZWdyYWRvclRva2VuLCBUb2tlblJldm9nYWRvIH0gZnJvbSAnLi4vLi4vLi4vZW50aXRpZXMnO1xuaW1wb3J0IHsgSW50ZWdyYWRvclRva2VuU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ludGVncmFkb3ItdG9rZW4uc2VydmljZSc7XG5pbXBvcnQgeyBJbnRlZ3JhZG9yU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ludGVncmFkb3Iuc2VydmljZSc7XG5pbXBvcnQgeyBDcmVhdGVUb2tlbkR0byB9IGZyb20gJy4uL2R0by9jcmVhdGUtdG9rZW4uZHRvJztcblxuLyoqXG4gKiBUZXN0ZXMgdW5pdMOhcmlvcyBwYXJhIG8gc2VydmnDp28gZGUgdG9rZW5zIGRlIGludGVncmFkb3Jlcy5cbiAqIFZhbGlkYSBhIGdlcmHDp8OjbywgdmFsaWRhw6fDo28gZSByZXZvZ2HDp8OjbyBkZSB0b2tlbnMsIGFsw6ltIGRhcyB2ZXJpZmljYcOnw7Vlc1xuICogZGUgcGVybWlzc8O1ZXMgZSByZXN0cmnDp8O1ZXMgZGUgSVAuXG4gKi9cbmRlc2NyaWJlKCdJbnRlZ3JhZG9yVG9rZW5TZXJ2aWNlJywgKCkgPT4ge1xuICBsZXQgc2VydmljZTogSW50ZWdyYWRvclRva2VuU2VydmljZTtcbiAgbGV0IGludGVncmFkb3JTZXJ2aWNlOiBJbnRlZ3JhZG9yU2VydmljZTtcbiAgbGV0IGp3dFNlcnZpY2U6IEp3dFNlcnZpY2U7XG4gIGxldCB0b2tlblJlcG9zaXRvcnk6IGFueTtcbiAgbGV0IHRva2VuUmV2b2dhZG9SZXBvc2l0b3J5OiBhbnk7XG5cbiAgLy8gTW9ja3MgZGUgcmVwb3NpdMOzcmlvcyBlIHNlcnZpw6dvc1xuICBjb25zdCBtb2NrVG9rZW5SZXBvc2l0b3J5ID0ge1xuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICBmaW5kOiBqZXN0LmZuKCksXG4gICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgIHJlbW92ZTogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeSA9IHtcbiAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICBzYXZlOiBqZXN0LmZuKCksXG4gICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgIGRlbGV0ZTogamVzdC5mbigpLFxuICAgIGNyZWF0ZVF1ZXJ5QnVpbGRlcjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBmcm9tOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICB3aGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgZXhlY3V0ZTogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tJbnRlZ3JhZG9yU2VydmljZSA9IHtcbiAgICBmaW5kQnlJZDogamVzdC5mbigpLFxuICAgIHJlZ2lzdHJhckFjZXNzbzogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tKd3RTZXJ2aWNlID0ge1xuICAgIHNpZ246IGplc3QuZm4oKSxcbiAgICB2ZXJpZnk6IGplc3QuZm4oKSxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIEludGVncmFkb3JUb2tlblNlcnZpY2UsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oSW50ZWdyYWRvclRva2VuKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1Rva2VuUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IGdldFJlcG9zaXRvcnlUb2tlbihUb2tlblJldm9nYWRvKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogSW50ZWdyYWRvclNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tJbnRlZ3JhZG9yU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IEp3dFNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tKd3RTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxJbnRlZ3JhZG9yVG9rZW5TZXJ2aWNlPihJbnRlZ3JhZG9yVG9rZW5TZXJ2aWNlKTtcbiAgICBpbnRlZ3JhZG9yU2VydmljZSA9IG1vZHVsZS5nZXQ8SW50ZWdyYWRvclNlcnZpY2U+KEludGVncmFkb3JTZXJ2aWNlKTtcbiAgICBqd3RTZXJ2aWNlID0gbW9kdWxlLmdldDxKd3RTZXJ2aWNlPihKd3RTZXJ2aWNlKTtcbiAgICB0b2tlblJlcG9zaXRvcnkgPSBtb2R1bGUuZ2V0KGdldFJlcG9zaXRvcnlUb2tlbihJbnRlZ3JhZG9yVG9rZW4pKTtcbiAgICB0b2tlblJldm9nYWRvUmVwb3NpdG9yeSA9IG1vZHVsZS5nZXQoZ2V0UmVwb3NpdG9yeVRva2VuKFRva2VuUmV2b2dhZG8pKTtcblxuICAgIC8vIE1vY2sgZGEgZnVuw6fDo28gY3J5cHRvLmNyZWF0ZUhhc2ggcXVlIMOpIHVzYWRhIG5vIHNlcnZpw6dvXG4gICAgamVzdC5zcHlPbihnbG9iYWwuY3J5cHRvLCAnY3JlYXRlSGFzaCcpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgZGlnZXN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCd0b2tlbi1oYXNoJyksXG4gICAgfSBhcyBhbnkpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBpdCgnZGV2ZSBlc3RhciBkZWZpbmlkbycsICgpID0+IHtcbiAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NyZWF0ZVRva2VuJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIHVtIHRva2VuIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgaW50ZWdyYWRvcklkID0gJ2ludGVncmFkb3ItaWQnO1xuICAgICAgY29uc3QgY3JlYXRlVG9rZW5EdG86IENyZWF0ZVRva2VuRHRvID0ge1xuICAgICAgICBub21lOiAnVG9rZW4gVGVzdGUnLFxuICAgICAgICBkZXNjcmljYW86ICdUb2tlbiBwYXJhIHRlc3RlcycsXG4gICAgICAgIGVzY29wb3M6IFsncmVhZDpkYWRvc19iYXNpY29zJywgJ3dyaXRlOnNvbGljaXRhY29lcyddLFxuICAgICAgICBkaWFzVmFsaWRhZGU6IDMwLFxuICAgICAgICBzZW1FeHBpcmFjYW86IGZhbHNlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgaW50ZWdyYWRvciA9IHtcbiAgICAgICAgaWQ6IGludGVncmFkb3JJZCxcbiAgICAgICAgbm9tZTogJ0ludGVncmFkb3IgVGVzdGUnLFxuICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgcGVybWlzc29lc0VzY29wbzogWydyZWFkOmRhZG9zX2Jhc2ljb3MnLCAnd3JpdGU6c29saWNpdGFjb2VzJywgJ3JlYWQ6Y2lkYWRhb3MnXSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRva2VuRW50aXR5ID0ge1xuICAgICAgICBpZDogJ3Rva2VuLWlkJyxcbiAgICAgICAgaW50ZWdyYWRvcklkLFxuICAgICAgICBub21lOiBjcmVhdGVUb2tlbkR0by5ub21lLFxuICAgICAgICBkZXNjcmljYW86IGNyZWF0ZVRva2VuRHRvLmRlc2NyaWNhbyxcbiAgICAgICAgdG9rZW5IYXNoOiAndG9rZW4taGFzaCcsXG4gICAgICAgIGVzY29wb3M6IGNyZWF0ZVRva2VuRHRvLmVzY29wb3MsXG4gICAgICAgIGRhdGFFeHBpcmFjYW86IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgIGRhdGFDcmlhY2FvOiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcblxuICAgICAgY29uc3Qgand0VG9rZW4gPSAnand0LXRva2VuLXN0cmluZyc7XG5cbiAgICAgIG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShpbnRlZ3JhZG9yKTtcbiAgICAgIG1vY2tUb2tlblJlcG9zaXRvcnkuY3JlYXRlLm1vY2tSZXR1cm5WYWx1ZSh0b2tlbkVudGl0eSk7XG4gICAgICBtb2NrVG9rZW5SZXBvc2l0b3J5LnNhdmUubW9ja1Jlc29sdmVkVmFsdWUodG9rZW5FbnRpdHkpO1xuICAgICAgbW9ja0p3dFNlcnZpY2Uuc2lnbi5tb2NrUmV0dXJuVmFsdWUoand0VG9rZW4pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlVG9rZW4oaW50ZWdyYWRvcklkLCBjcmVhdGVUb2tlbkR0byk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW50ZWdyYWRvcklkKTtcbiAgICAgIGV4cGVjdChtb2NrSnd0U2VydmljZS5zaWduKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAge1xuICAgICAgICAgIHN1YjogYGludGVncmFkb3I6JHtpbnRlZ3JhZG9ySWR9YCxcbiAgICAgICAgICBuYW1lOiBpbnRlZ3JhZG9yLm5vbWUsXG4gICAgICAgICAgdHlwZTogJ2FwaV90b2tlbicsXG4gICAgICAgICAgc2NvcGVzOiBjcmVhdGVUb2tlbkR0by5lc2NvcG9zLFxuICAgICAgICB9LFxuICAgICAgICB7IGV4cGlyZXNJbjogJzMwZCcgfVxuICAgICAgKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICBpbnRlZ3JhZG9ySWQsXG4gICAgICAgIG5vbWU6IGNyZWF0ZVRva2VuRHRvLm5vbWUsXG4gICAgICAgIGRlc2NyaWNhbzogY3JlYXRlVG9rZW5EdG8uZGVzY3JpY2FvLFxuICAgICAgICB0b2tlbkhhc2g6IGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgZXNjb3BvczogY3JlYXRlVG9rZW5EdG8uZXNjb3BvcyxcbiAgICAgICAgZGF0YUV4cGlyYWNhbzogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgIH0pKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICB0b2tlbjogand0VG9rZW4sXG4gICAgICAgIHRva2VuSW5mbzogZXhwZWN0LmFueShPYmplY3QpXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGNyaWFyIHVtIHRva2VuIHNlbSBleHBpcmHDp8OjbyBxdWFuZG8gc2VtRXhwaXJhY2FvPXRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnRlZ3JhZG9ySWQgPSAnaW50ZWdyYWRvci1pZCc7XG4gICAgICBjb25zdCBjcmVhdGVUb2tlbkR0bzogQ3JlYXRlVG9rZW5EdG8gPSB7XG4gICAgICAgIG5vbWU6ICdUb2tlbiBQZXJtYW5lbnRlJyxcbiAgICAgICAgZGVzY3JpY2FvOiAnVG9rZW4gc2VtIGV4cGlyYcOnw6NvJyxcbiAgICAgICAgZXNjb3BvczogWydyZWFkOmRhZG9zX2Jhc2ljb3MnXSxcbiAgICAgICAgc2VtRXhwaXJhY2FvOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgaW50ZWdyYWRvciA9IHtcbiAgICAgICAgaWQ6IGludGVncmFkb3JJZCxcbiAgICAgICAgbm9tZTogJ0ludGVncmFkb3IgVGVzdGUnLFxuICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgcGVybWlzc29lc0VzY29wbzogWydyZWFkOmRhZG9zX2Jhc2ljb3MnLCAnd3JpdGU6c29saWNpdGFjb2VzJywgJ3JlYWQ6Y2lkYWRhb3MnXSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRva2VuRW50aXR5ID0ge1xuICAgICAgICBpZDogJ3Rva2VuLWlkJyxcbiAgICAgICAgaW50ZWdyYWRvcklkLFxuICAgICAgICBub21lOiBjcmVhdGVUb2tlbkR0by5ub21lLFxuICAgICAgICBkZXNjcmljYW86IGNyZWF0ZVRva2VuRHRvLmRlc2NyaWNhbyxcbiAgICAgICAgdG9rZW5IYXNoOiAndG9rZW4taGFzaCcsXG4gICAgICAgIGVzY29wb3M6IGNyZWF0ZVRva2VuRHRvLmVzY29wb3MsXG4gICAgICAgIGRhdGFFeHBpcmFjYW86IG51bGwsIC8vIFNlbSBleHBpcmHDp8Ojb1xuICAgICAgICBkYXRhQ3JpYWNhbzogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShpbnRlZ3JhZG9yKTtcbiAgICAgIG1vY2tUb2tlblJlcG9zaXRvcnkuY3JlYXRlLm1vY2tSZXR1cm5WYWx1ZSh0b2tlbkVudGl0eSk7XG4gICAgICBtb2NrVG9rZW5SZXBvc2l0b3J5LnNhdmUubW9ja1Jlc29sdmVkVmFsdWUodG9rZW5FbnRpdHkpO1xuICAgICAgbW9ja0p3dFNlcnZpY2Uuc2lnbi5tb2NrUmV0dXJuVmFsdWUoJ2p3dC10b2tlbi1zdHJpbmcnKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVRva2VuKGludGVncmFkb3JJZCwgY3JlYXRlVG9rZW5EdG8pO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrSnd0U2VydmljZS5zaWduKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICB7fSAvLyBTZW0gb3DDp8O1ZXMgZGUgZXhwaXJhw6fDo29cbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmVwb3NpdG9yeS5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgZGF0YUV4cGlyYWNhbzogbnVsbCwgLy8gQ29uZmlybWEgcXVlIHRva2VuIG7Do28gdGVtIGV4cGlyYcOnw6NvXG4gICAgICB9KSk7XG4gICAgICBleHBlY3QocmVzdWx0LnRva2VuSW5mby5kYXRhRXhwaXJhY2FvKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBCYWRSZXF1ZXN0RXhjZXB0aW9uIHF1YW5kbyBpbnRlZ3JhZG9yIGVzdMOhIGluYXRpdm8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnRlZ3JhZG9ySWQgPSAnaW50ZWdyYWRvci1pZCc7XG4gICAgICBjb25zdCBjcmVhdGVUb2tlbkR0bzogQ3JlYXRlVG9rZW5EdG8gPSB7XG4gICAgICAgIG5vbWU6ICdUb2tlbiBUZXN0ZScsXG4gICAgICAgIGVzY29wb3M6IFsncmVhZDpkYWRvc19iYXNpY29zJ10sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBpbnRlZ3JhZG9yID0ge1xuICAgICAgICBpZDogaW50ZWdyYWRvcklkLFxuICAgICAgICBub21lOiAnSW50ZWdyYWRvciBJbmF0aXZvJyxcbiAgICAgICAgYXRpdm86IGZhbHNlLFxuICAgICAgfTtcblxuICAgICAgbW9ja0ludGVncmFkb3JTZXJ2aWNlLmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKGludGVncmFkb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyZWF0ZVRva2VuKGludGVncmFkb3JJZCwgY3JlYXRlVG9rZW5EdG8pKVxuICAgICAgICAucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW50ZWdyYWRvcklkKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LmNyZWF0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LnNhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIEJhZFJlcXVlc3RFeGNlcHRpb24gcXVhbmRvIGVzY29wbyBzb2xpY2l0YWRvIG7Do28gw6kgcGVybWl0aWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgaW50ZWdyYWRvcklkID0gJ2ludGVncmFkb3ItaWQnO1xuICAgICAgY29uc3QgY3JlYXRlVG9rZW5EdG86IENyZWF0ZVRva2VuRHRvID0ge1xuICAgICAgICBub21lOiAnVG9rZW4gVGVzdGUnLFxuICAgICAgICBlc2NvcG9zOiBbJ3JlYWQ6ZGFkb3NfYmFzaWNvcycsICdhZG1pbjpzaXN0ZW1hJ10sIC8vIGVzY29wbyBuw6NvIHBlcm1pdGlkb1xuICAgICAgfTtcblxuICAgICAgY29uc3QgaW50ZWdyYWRvciA9IHtcbiAgICAgICAgaWQ6IGludGVncmFkb3JJZCxcbiAgICAgICAgbm9tZTogJ0ludGVncmFkb3IgVGVzdGUnLFxuICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgcGVybWlzc29lc0VzY29wbzogWydyZWFkOmRhZG9zX2Jhc2ljb3MnLCAnd3JpdGU6c29saWNpdGFjb2VzJ10sXG4gICAgICB9O1xuXG4gICAgICBtb2NrSW50ZWdyYWRvclNlcnZpY2UuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUoaW50ZWdyYWRvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlVG9rZW4oaW50ZWdyYWRvcklkLCBjcmVhdGVUb2tlbkR0bykpXG4gICAgICAgIC5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICBleHBlY3QobW9ja0ludGVncmFkb3JTZXJ2aWNlLmZpbmRCeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChpbnRlZ3JhZG9ySWQpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuY3JlYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuc2F2ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRBbGxCeUludGVncmFkb3InLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdG9kb3Mgb3MgdG9rZW5zIGRlIHVtIGludGVncmFkb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnRlZ3JhZG9ySWQgPSAnaW50ZWdyYWRvci1pZCc7XG4gICAgICBjb25zdCB0b2tlbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3Rva2VuLTEnLFxuICAgICAgICAgIGludGVncmFkb3JJZCxcbiAgICAgICAgICBub21lOiAnVG9rZW4gMScsXG4gICAgICAgICAgZGF0YUNyaWFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3Rva2VuLTInLFxuICAgICAgICAgIGludGVncmFkb3JJZCxcbiAgICAgICAgICBub21lOiAnVG9rZW4gMicsXG4gICAgICAgICAgZGF0YUNyaWFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBtb2NrSW50ZWdyYWRvclNlcnZpY2UuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUoeyBpZDogaW50ZWdyYWRvcklkIH0pO1xuICAgICAgbW9ja1Rva2VuUmVwb3NpdG9yeS5maW5kLm1vY2tSZXNvbHZlZFZhbHVlKHRva2Vucyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5maW5kQWxsQnlJbnRlZ3JhZG9yKGludGVncmFkb3JJZCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW50ZWdyYWRvcklkKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LmZpbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaW50ZWdyYWRvcklkIH0sXG4gICAgICAgIG9yZGVyOiB7IGRhdGFDcmlhY2FvOiAnREVTQycgfVxuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLmlkKS50b0VxdWFsKHRva2Vuc1swXS5pZCk7XG4gICAgICBleHBlY3QocmVzdWx0WzFdLmlkKS50b0VxdWFsKHRva2Vuc1sxXS5pZCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kT25lJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIHVtIHRva2VuIGVzcGVjw61maWNvIHBlbG8gSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbklkID0gJ3Rva2VuLWlkJztcbiAgICAgIGNvbnN0IHRva2VuID0ge1xuICAgICAgICBpZDogdG9rZW5JZCxcbiAgICAgICAgaW50ZWdyYWRvcklkOiAnaW50ZWdyYWRvci1pZCcsXG4gICAgICAgIG5vbWU6ICdUb2tlbiBUZXN0ZScsXG4gICAgICAgIGRhdGFDcmlhY2FvOiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcblxuICAgICAgbW9ja1Rva2VuUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKHRva2VuKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmZpbmRPbmUodG9rZW5JZCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogdG9rZW5JZCB9XG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlkKS50b0VxdWFsKHRva2VuSWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBOb3RGb3VuZEV4Y2VwdGlvbiBxdWFuZG8gdG9rZW4gbsOjbyBleGlzdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbklkID0gJ3Rva2VuLWluZXhpc3RlbnRlJztcbiAgICAgIG1vY2tUb2tlblJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5maW5kT25lKHRva2VuSWQpKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogdG9rZW5JZCB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Jldm9nYXJUb2tlbicsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXZvZ2FyIHVtIHRva2VuIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW5JZCA9ICd0b2tlbi1pZCc7XG4gICAgICBjb25zdCBtb3Rpdm8gPSAnVGVzdGUgZGUgcmV2b2dhw6fDo28nO1xuICAgICAgXG4gICAgICBjb25zdCB0b2tlbiA9IHtcbiAgICAgICAgaWQ6IHRva2VuSWQsXG4gICAgICAgIGludGVncmFkb3JJZDogJ2ludGVncmFkb3ItaWQnLFxuICAgICAgICBub21lOiAnVG9rZW4gcGFyYSBSZXZvZ2FyJyxcbiAgICAgICAgdG9rZW5IYXNoOiAndG9rZW4taGFzaCcsXG4gICAgICAgIHJldm9nYWRvOiBmYWxzZSxcbiAgICAgICAgZGF0YUV4cGlyYWNhbzogbmV3IERhdGUoRGF0ZS5ub3coKSArIDEwMDAgKiA2MCAqIDYwICogMjQgKiAzMCksIC8vIDMwIGRpYXMgbm8gZnV0dXJvXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0b2tlblJldm9nYWRvID0ge1xuICAgICAgICAuLi50b2tlbixcbiAgICAgICAgcmV2b2dhZG86IHRydWUsXG4gICAgICAgIGRhdGFSZXZvZ2FjYW86IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgIG1vdGl2b1Jldm9nYWNhbzogbW90aXZvLFxuICAgICAgfTtcblxuICAgICAgbW9ja1Rva2VuUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKHRva2VuKTtcbiAgICAgIG1vY2tUb2tlblJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh0b2tlblJldm9nYWRvKTtcbiAgICAgIG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5jcmVhdGUubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdG9rZW5IYXNoOiB0b2tlbi50b2tlbkhhc2gsXG4gICAgICAgIGludGVncmFkb3JJZDogdG9rZW4uaW50ZWdyYWRvcklkLFxuICAgICAgICBtb3Rpdm9SZXZvZ2FjYW86IG1vdGl2byxcbiAgICAgICAgZGF0YUV4cGlyYWNhbzogdG9rZW4uZGF0YUV4cGlyYWNhbyxcbiAgICAgICAgZGF0YUxpbXBlemE6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICB9KTtcbiAgICAgIG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5zYXZlLm1vY2tSZXNvbHZlZFZhbHVlKHt9KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnJldm9nYXJUb2tlbih0b2tlbklkLCBtb3Rpdm8pO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHRva2VuSWQgfVxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgIGlkOiB0b2tlbklkLFxuICAgICAgICByZXZvZ2FkbzogdHJ1ZSxcbiAgICAgICAgZGF0YVJldm9nYWNhbzogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgbW90aXZvUmV2b2dhY2FvOiBtb3Rpdm8sXG4gICAgICB9KSk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnJldm9nYWRvKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tb3Rpdm9SZXZvZ2FjYW8pLnRvRXF1YWwobW90aXZvKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgQmFkUmVxdWVzdEV4Y2VwdGlvbiBhbyB0ZW50YXIgcmV2b2dhciB1bSB0b2tlbiBqw6EgcmV2b2dhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbklkID0gJ3Rva2VuLWlkJztcbiAgICAgIGNvbnN0IG1vdGl2byA9ICdUZXN0ZSBkZSByZXZvZ2HDp8Ojbyc7XG4gICAgICBcbiAgICAgIGNvbnN0IHRva2VuID0ge1xuICAgICAgICBpZDogdG9rZW5JZCxcbiAgICAgICAgbm9tZTogJ1Rva2VuIGrDoSBSZXZvZ2FkbycsXG4gICAgICAgIHJldm9nYWRvOiB0cnVlLFxuICAgICAgICBkYXRhUmV2b2dhY2FvOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTAwMCAqIDYwICogNjApLCAvLyAxIGhvcmEgYXRyw6FzXG4gICAgICAgIG1vdGl2b1Jldm9nYWNhbzogJ1Jldm9nYWRvIGFudGVyaW9ybWVudGUnLFxuICAgICAgfTtcblxuICAgICAgbW9ja1Rva2VuUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKHRva2VuKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5yZXZvZ2FyVG9rZW4odG9rZW5JZCwgbW90aXZvKSlcbiAgICAgICAgLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHRva2VuSWQgfVxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmVwb3NpdG9yeS5zYXZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5jcmVhdGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LnNhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIGFvIHRlbnRhciByZXZvZ2FyIHVtIHRva2VuIGluZXhpc3RlbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW5JZCA9ICd0b2tlbi1pbmV4aXN0ZW50ZSc7XG4gICAgICBjb25zdCBtb3Rpdm8gPSAnVGVzdGUgZGUgcmV2b2dhw6fDo28nO1xuICAgICAgXG4gICAgICBtb2NrVG9rZW5SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmV2b2dhclRva2VuKHRva2VuSWQsIG1vdGl2bykpXG4gICAgICAgIC5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogdG9rZW5JZCB9XG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXBvc2l0b3J5LnNhdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmNyZWF0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXZvZ2Fkb1JlcG9zaXRvcnkuc2F2ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZhbGlkYXRlVG9rZW4nLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgdmFsaWRhciB1bSB0b2tlbiB2w6FsaWRvIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW4gPSAndmFsaWQtand0LXRva2VuJztcbiAgICAgIGNvbnN0IHRva2VuSGFzaCA9ICd0b2tlbi1oYXNoJztcbiAgICAgIGNvbnN0IGludGVncmFkb3JJZCA9ICdpbnRlZ3JhZG9yLWlkJztcbiAgICAgIFxuICAgICAgY29uc3Qgand0UGF5bG9hZCA9IHtcbiAgICAgICAgc3ViOiBgaW50ZWdyYWRvcjoke2ludGVncmFkb3JJZH1gLFxuICAgICAgICBuYW1lOiAnSW50ZWdyYWRvciBUZXN0ZScsXG4gICAgICAgIHR5cGU6ICdhcGlfdG9rZW4nLFxuICAgICAgICBzY29wZXM6IFsncmVhZDpkYWRvc19iYXNpY29zJ10sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBpbnRlZ3JhZG9yID0ge1xuICAgICAgICBpZDogaW50ZWdyYWRvcklkLFxuICAgICAgICBub21lOiAnSW50ZWdyYWRvciBUZXN0ZScsXG4gICAgICAgIGF0aXZvOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgdG9rZW5JbmZvID0ge1xuICAgICAgICBpZDogJ3Rva2VuLWlkJyxcbiAgICAgICAgaW50ZWdyYWRvcklkLFxuICAgICAgICB0b2tlbkhhc2gsXG4gICAgICAgIHVsdGltb1VzbzogbnVsbCxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3RTZXJ2aWNlLnZlcmlmeS5tb2NrUmV0dXJuVmFsdWUoand0UGF5bG9hZCk7XG4gICAgICBtb2NrVG9rZW5SZXZvZ2Fkb1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTsgLy8gTsOjbyBlc3TDoSByZXZvZ2Fkb1xuICAgICAgbW9ja0ludGVncmFkb3JTZXJ2aWNlLmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKGludGVncmFkb3IpO1xuICAgICAgbW9ja1Rva2VuUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKHRva2VuSW5mbyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS52YWxpZGF0ZVRva2VuKHRva2VuKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja0p3dFNlcnZpY2UudmVyaWZ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0b2tlbik7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgdG9rZW5IYXNoIH1cbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW50ZWdyYWRvcklkKTtcbiAgICAgIGV4cGVjdChtb2NrSW50ZWdyYWRvclNlcnZpY2UucmVnaXN0cmFyQWNlc3NvKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChpbnRlZ3JhZG9ySWQpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyB0b2tlbkhhc2ggfVxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgIGlkOiB0b2tlbkluZm8uaWQsXG4gICAgICAgIHVsdGltb1VzbzogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgIH0pKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICAuLi5qd3RQYXlsb2FkLFxuICAgICAgICBpbnRlZ3JhZG9yLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIFVuYXV0aG9yaXplZEV4Y2VwdGlvbiBxdWFuZG8gdG9rZW4gZXN0w6EgcmV2b2dhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdyZXZva2VkLWp3dC10b2tlbic7XG4gICAgICBjb25zdCB0b2tlbkhhc2ggPSAndG9rZW4taGFzaCc7XG4gICAgICBjb25zdCBpbnRlZ3JhZG9ySWQgPSAnaW50ZWdyYWRvci1pZCc7XG4gICAgICBcbiAgICAgIGNvbnN0IGp3dFBheWxvYWQgPSB7XG4gICAgICAgIHN1YjogYGludGVncmFkb3I6JHtpbnRlZ3JhZG9ySWR9YCxcbiAgICAgICAgbmFtZTogJ0ludGVncmFkb3IgVGVzdGUnLFxuICAgICAgICB0eXBlOiAnYXBpX3Rva2VuJyxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3RTZXJ2aWNlLnZlcmlmeS5tb2NrUmV0dXJuVmFsdWUoand0UGF5bG9hZCk7XG4gICAgICBtb2NrVG9rZW5SZXZvZ2Fkb1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiAncmV2b2tlZC1pZCcsXG4gICAgICAgIHRva2VuSGFzaCxcbiAgICAgIH0pOyAvLyBUb2tlbiByZXZvZ2Fkb1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnZhbGlkYXRlVG9rZW4odG9rZW4pKVxuICAgICAgICAucmVqZWN0cy50b1Rocm93KFVuYXV0aG9yaXplZEV4Y2VwdGlvbik7XG4gICAgICBleHBlY3QobW9ja0p3dFNlcnZpY2UudmVyaWZ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0b2tlbik7XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgdG9rZW5IYXNoIH1cbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrSW50ZWdyYWRvclNlcnZpY2UucmVnaXN0cmFyQWNlc3NvKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBVbmF1dGhvcml6ZWRFeGNlcHRpb24gcXVhbmRvIGludGVncmFkb3IgZXN0w6EgaW5hdGl2bycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ3ZhbGlkLWp3dC10b2tlbic7XG4gICAgICBjb25zdCB0b2tlbkhhc2ggPSAndG9rZW4taGFzaCc7XG4gICAgICBjb25zdCBpbnRlZ3JhZG9ySWQgPSAnaW50ZWdyYWRvci1pZCc7XG4gICAgICBcbiAgICAgIGNvbnN0IGp3dFBheWxvYWQgPSB7XG4gICAgICAgIHN1YjogYGludGVncmFkb3I6JHtpbnRlZ3JhZG9ySWR9YCxcbiAgICAgICAgbmFtZTogJ0ludGVncmFkb3IgSW5hdGl2bycsXG4gICAgICAgIHR5cGU6ICdhcGlfdG9rZW4nLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgaW50ZWdyYWRvciA9IHtcbiAgICAgICAgaWQ6IGludGVncmFkb3JJZCxcbiAgICAgICAgbm9tZTogJ0ludGVncmFkb3IgSW5hdGl2bycsXG4gICAgICAgIGF0aXZvOiBmYWxzZSwgLy8gSW50ZWdyYWRvciBpbmF0aXZvXG4gICAgICB9O1xuXG4gICAgICBtb2NrSnd0U2VydmljZS52ZXJpZnkubW9ja1JldHVyblZhbHVlKGp3dFBheWxvYWQpO1xuICAgICAgbW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7IC8vIE7Do28gZXN0w6EgcmV2b2dhZG9cbiAgICAgIG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShpbnRlZ3JhZG9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS52YWxpZGF0ZVRva2VuKHRva2VuKSlcbiAgICAgICAgLnJlamVjdHMudG9UaHJvdyhVbmF1dGhvcml6ZWRFeGNlcHRpb24pO1xuICAgICAgZXhwZWN0KG1vY2tKd3RTZXJ2aWNlLnZlcmlmeSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodG9rZW4pO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5maW5kT25lKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IHRva2VuSGFzaCB9XG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrSW50ZWdyYWRvclNlcnZpY2UuZmluZEJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGludGVncmFkb3JJZCk7XG4gICAgICBleHBlY3QobW9ja0ludGVncmFkb3JTZXJ2aWNlLnJlZ2lzdHJhckFjZXNzbykubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgVW5hdXRob3JpemVkRXhjZXB0aW9uIHF1YW5kbyB0eXBlIGRvIHRva2VuIG7Do28gw6kgYXBpX3Rva2VuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW4gPSAnd3JvbmctdHlwZS10b2tlbic7XG4gICAgICBcbiAgICAgIGNvbnN0IGp3dFBheWxvYWQgPSB7XG4gICAgICAgIHN1YjogJ3VzZXI6MTIzJyxcbiAgICAgICAgbmFtZTogJ1VzdcOhcmlvJyxcbiAgICAgICAgdHlwZTogJ3VzZXJfdG9rZW4nLCAvLyBUaXBvIGluY29ycmV0b1xuICAgICAgfTtcblxuICAgICAgbW9ja0p3dFNlcnZpY2UudmVyaWZ5Lm1vY2tSZXR1cm5WYWx1ZShqd3RQYXlsb2FkKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS52YWxpZGF0ZVRva2VuKHRva2VuKSlcbiAgICAgICAgLnJlamVjdHMudG9UaHJvdyhVbmF1dGhvcml6ZWRFeGNlcHRpb24pO1xuICAgICAgZXhwZWN0KG1vY2tKd3RTZXJ2aWNlLnZlcmlmeSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodG9rZW4pO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5maW5kT25lKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tJbnRlZ3JhZG9yU2VydmljZS5maW5kQnlJZCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2hhc1JlcXVpcmVkU2NvcGVzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIHRydWUgcXVhbmRvIHRva2VuIHRlbSB0b2RvcyBvcyBlc2NvcG9zIG5lY2Vzc8OhcmlvcycsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgIHNjb3BlczogWydyZWFkOmRhZG9zX2Jhc2ljb3MnLCAnd3JpdGU6c29saWNpdGFjb2VzJywgJ3JlYWQ6Y2lkYWRhb3MnXSxcbiAgICAgIH07XG4gICAgICBjb25zdCByZXF1aXJlZFNjb3BlcyA9IFsncmVhZDpkYWRvc19iYXNpY29zJywgJ3dyaXRlOnNvbGljaXRhY29lcyddO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuaGFzUmVxdWlyZWRTY29wZXMocGF5bG9hZCwgcmVxdWlyZWRTY29wZXMpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBmYWxzZSBxdWFuZG8gdG9rZW4gbsOjbyB0ZW0gdG9kb3Mgb3MgZXNjb3BvcyBuZWNlc3PDoXJpb3MnLCAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICBzY29wZXM6IFsncmVhZDpkYWRvc19iYXNpY29zJ10sXG4gICAgICB9O1xuICAgICAgY29uc3QgcmVxdWlyZWRTY29wZXMgPSBbJ3JlYWQ6ZGFkb3NfYmFzaWNvcycsICd3cml0ZTpzb2xpY2l0YWNvZXMnXTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmhhc1JlcXVpcmVkU2NvcGVzKHBheWxvYWQsIHJlcXVpcmVkU2NvcGVzKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIHRydWUgcXVhbmRvIG7Do28gaMOhIGVzY29wb3MgcmVxdWVyaWRvcycsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgIHNjb3BlczogWydyZWFkOmRhZG9zX2Jhc2ljb3MnXSxcbiAgICAgIH07XG4gICAgICBjb25zdCByZXF1aXJlZFNjb3BlcyA9IFtdO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuaGFzUmVxdWlyZWRTY29wZXMocGF5bG9hZCwgcmVxdWlyZWRTY29wZXMpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBmYWxzZSBxdWFuZG8gcGF5bG9hZCBuw6NvIHRlbSBlc2NvcG9zJywgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcGF5bG9hZCA9IHt9O1xuICAgICAgY29uc3QgcmVxdWlyZWRTY29wZXMgPSBbJ3JlYWQ6ZGFkb3NfYmFzaWNvcyddO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuaGFzUmVxdWlyZWRTY29wZXMocGF5bG9hZCwgcmVxdWlyZWRTY29wZXMpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaXNJcEFsbG93ZWQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdHJ1ZSBxdWFuZG8gSVAgZXN0w6EgbmEgbGlzdGEgZGUgcGVybWl0aWRvcycsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGludGVncmFkb3IgPSB7XG4gICAgICAgIGlwUGVybWl0aWRvczogWycxOTIuMTY4LjEuMScsICcxMC4wLjAuMScsICcxNzIuMTYuMC4xJ10sXG4gICAgICB9O1xuICAgICAgY29uc3QgaXBBZGRyZXNzID0gJzE5Mi4xNjguMS4xJztcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmlzSXBBbGxvd2VkKGludGVncmFkb3IsIGlwQWRkcmVzcyk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGZhbHNlIHF1YW5kbyBJUCBuw6NvIGVzdMOhIG5hIGxpc3RhIGRlIHBlcm1pdGlkb3MnLCAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnRlZ3JhZG9yID0ge1xuICAgICAgICBpcFBlcm1pdGlkb3M6IFsnMTkyLjE2OC4xLjEnLCAnMTAuMC4wLjEnXSxcbiAgICAgIH07XG4gICAgICBjb25zdCBpcEFkZHJlc3MgPSAnMTcyLjE2LjAuMSc7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5pc0lwQWxsb3dlZChpbnRlZ3JhZG9yLCBpcEFkZHJlc3MpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdHJ1ZSBxdWFuZG8gbsOjbyBow6EgbGlzdGEgZGUgSVBzIHBlcm1pdGlkb3MnLCAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnRlZ3JhZG9yID0ge1xuICAgICAgICBpcFBlcm1pdGlkb3M6IFtdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGlwQWRkcmVzcyA9ICcxOTIuMTY4LjEuMSc7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5pc0lwQWxsb3dlZChpbnRlZ3JhZG9yLCBpcEFkZHJlc3MpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciB0cnVlIHF1YW5kbyBhIHByb3ByaWVkYWRlIGlwUGVybWl0aWRvcyBuw6NvIGV4aXN0ZScsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGludGVncmFkb3IgPSB7fTtcbiAgICAgIGNvbnN0IGlwQWRkcmVzcyA9ICcxOTIuMTY4LjEuMSc7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5pc0lwQWxsb3dlZChpbnRlZ3JhZG9yLCBpcEFkZHJlc3MpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdsaW1wYXJUb2tlbnNSZXZvZ2Fkb3NFeHBpcmFkb3MnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVtb3ZlciB0b2tlbnMgcmV2b2dhZG9zIGV4cGlyYWRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5leGVjdXRlLm1vY2tSZXNvbHZlZFZhbHVlKHsgYWZmZWN0ZWQ6IDUgfSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5saW1wYXJUb2tlbnNSZXZvZ2Fkb3NFeHBpcmFkb3MoKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmNyZWF0ZVF1ZXJ5QnVpbGRlcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5kZWxldGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrVG9rZW5SZXZvZ2Fkb1JlcG9zaXRvcnkuZnJvbSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS53aGVyZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5leGVjdXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKDUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgMCBxdWFuZG8gbmVuaHVtIHRva2VuIGZvciByZW1vdmlkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIG1vY2tUb2tlblJldm9nYWRvUmVwb3NpdG9yeS5leGVjdXRlLm1vY2tSZXNvbHZlZFZhbHVlKHsgYWZmZWN0ZWQ6IDAgfSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5saW1wYXJUb2tlbnNSZXZvZ2Fkb3NFeHBpcmFkb3MoKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1Rva2VuUmV2b2dhZG9SZXBvc2l0b3J5LmV4ZWN1dGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=