{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\dados-natalidade.entity.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\dados-natalidade.entity.ts"],"sourcesContent":["import {\n  Entity,\n  PrimaryGeneratedColumn,\n  Column,\n  CreateDateColumn,\n  UpdateDateColumn,\n  DeleteDateColumn,\n  ManyToOne,\n  JoinColumn,\n  Index,\n} from 'typeorm';\nimport {\n  IsNotEmpty,\n  IsBoolean,\n  IsDateString,\n  IsOptional,\n  IsNumber,\n  Min,\n} from 'class-validator';\nimport { Solicitacao } from './solicitacao.entity';\n\n/**\n * Entidade para armazenar dados específicos do cidadão para Auxílio Natalidade\n *\n * Armazena informações específicas necessárias para a solicitação do benefício\n * de Auxílio Natalidade, como dados da gestação, pré-natal, etc.\n */\n@Entity('dados_natalidade')\n@Index(['solicitacao_id'], { unique: true })\nexport class DadosNatalidade {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  @IsNotEmpty({ message: 'ID da solicitação é obrigatório' })\n  solicitacao_id: string;\n\n  @ManyToOne(() => Solicitacao, { onDelete: 'CASCADE' })\n  @JoinColumn({ name: 'solicitacao_id' })\n  solicitacao: Solicitacao;\n\n  @Column({ default: false })\n  @IsBoolean({ message: 'Realiza pré-natal deve ser um booleano' })\n  realiza_pre_natal: boolean;\n\n  @Column({ default: false })\n  @IsBoolean({ message: 'Atendida pelo PSF/UBS deve ser um booleano' })\n  atendida_psf_ubs: boolean;\n\n  @Column({ default: false })\n  @IsBoolean({ message: 'Gravidez de risco deve ser um booleano' })\n  gravidez_risco: boolean;\n\n  @Column({ type: 'date', nullable: true })\n  @IsOptional()\n  @IsDateString({}, { message: 'Data provável do parto deve ser uma data válida' })\n  data_provavel_parto?: Date;\n\n  @Column({ default: false })\n  @IsBoolean({ message: 'Gêmeos/Trigêmeos deve ser um booleano' })\n  gemeos_trigemeos: boolean;\n\n  @Column({ default: false })\n  @IsBoolean({ message: 'Já tem filhos deve ser um booleano' })\n  ja_tem_filhos: boolean;\n\n  @Column({ type: 'integer', nullable: true })\n  @IsOptional()\n  @IsNumber({}, { message: 'Quantidade de filhos deve ser um número' })\n  @Min(0, { message: 'Quantidade de filhos não pode ser negativa' })\n  quantidade_filhos?: number;\n\n  @Column({ nullable: true })\n  @IsOptional()\n  telefone_cadastrado_cpf?: string;\n\n  @Column({ nullable: true })\n  @IsOptional()\n  chave_pix?: string;\n\n  @CreateDateColumn()\n  created_at: Date;\n\n  @UpdateDateColumn()\n  updated_at: Date;\n\n  @DeleteDateColumn()\n  removed_at: Date;\n\n  // Getters\n  get createdAt(): Date {\n    return this.created_at;\n  }\n\n  get updatedAt(): Date {\n    return this.updated_at;\n  }\n\n  get removedAt(): Date {\n    return this.removed_at;\n  }\n\n  // Métodos Utilitários\n\n  /**\n   * Verifica se todos os critérios para pecúnia estão preenchidos\n   */\n  temCriteriosPecunia(): boolean {\n    return !!(this.telefone_cadastrado_cpf && this.chave_pix);\n  }\n\n  /**\n   * Verifica se é uma gravidez múltipla\n   */\n  isGravidezMultipla(): boolean {\n    return this.gemeos_trigemeos;\n  }\n\n  /**\n   * Verifica se é primípara (primeiro filho)\n   */\n  isPrimipara(): boolean {\n    return !this.ja_tem_filhos || this.quantidade_filhos === 0;\n  }\n\n  /**\n   * Calcula se está no prazo para solicitação baseado na data provável do parto\n   */\n  estaNoPrazoSolicitacao(prazoMaximoDias: number): boolean {\n    if (!this.data_provavel_parto) return false;\n    \n    const hoje = new Date();\n    const dataLimite = new Date(this.data_provavel_parto);\n    dataLimite.setDate(dataLimite.getDate() + prazoMaximoDias);\n    \n    return hoje <= dataLimite;\n  }\n\n  /**\n   * Valida se os dados estão completos para submissão\n   */\n  validarDadosCompletos(): { valido: boolean; erros: string[] } {\n    const erros: string[] = [];\n\n    if (this.ja_tem_filhos && (this.quantidade_filhos === null || this.quantidade_filhos === undefined)) {\n      erros.push('Quantidade de filhos é obrigatória quando já tem filhos');\n    }\n\n    if (this.realiza_pre_natal && !this.atendida_psf_ubs) {\n      erros.push('Quando realiza pré-natal, deve informar se é atendida pelo PSF/UBS');\n    }\n\n    return {\n      valido: erros.length === 0,\n      erros\n    };\n  }\n}"],"version":3}