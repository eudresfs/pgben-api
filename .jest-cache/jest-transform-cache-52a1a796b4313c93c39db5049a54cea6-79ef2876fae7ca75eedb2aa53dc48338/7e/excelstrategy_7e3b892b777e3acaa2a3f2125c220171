1358bf8b58d6568d1b5c858e1efed12a
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var ExcelStrategy_1;
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ExcelStrategy = void 0;
const common_1 = require("@nestjs/common");
const ExcelJS = __importStar(require("exceljs"));
const fs = __importStar(require("fs"));
const temp_files_service_1 = require("../services/temp-files.service");
/**
 * Estratégia de geração de relatórios em formato Excel
 *
 * Implementa a geração de relatórios em formato Excel usando ExcelJS
 */
let ExcelStrategy = ExcelStrategy_1 = class ExcelStrategy {
    tempFilesService;
    logger = new common_1.Logger(ExcelStrategy_1.name);
    constructor(tempFilesService) {
        this.tempFilesService = tempFilesService;
    }
    /**
     * Gera um relatório em formato Excel
     * @param tipo Tipo de relatório
     * @param dados Dados do relatório
     * @param opcoes Opções de configuração
     * @returns Buffer contendo o Excel gerado
     */
    async gerar(tipo, dados, opcoes) {
        this.logger.log(`Gerando relatório Excel do tipo: ${tipo}`);
        // Criar arquivo temporário
        const tempFilePath = this.tempFilesService.getTempFilePath('relatorio-excel', 'xlsx');
        try {
            // Criar workbook e planilha
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet(this.getTitulo(tipo));
            // Adicionar título
            worksheet.mergeCells('A1:E1');
            const tituloCell = worksheet.getCell('A1');
            tituloCell.value = this.getTitulo(tipo);
            tituloCell.font = { size: 16, bold: true };
            tituloCell.alignment = { horizontal: 'center' };
            // Adicionar período
            if (opcoes.dataInicio && opcoes.dataFim) {
                const dataInicio = new Date(opcoes.dataInicio).toLocaleDateString('pt-BR');
                const dataFim = new Date(opcoes.dataFim).toLocaleDateString('pt-BR');
                worksheet.mergeCells('A2:E2');
                const periodoCell = worksheet.getCell('A2');
                periodoCell.value = `Período: ${dataInicio} a ${dataFim}`;
                periodoCell.font = { size: 12 };
                periodoCell.alignment = { horizontal: 'center' };
            }
            // Adicionar data de geração
            worksheet.mergeCells('A3:E3');
            const dataGeracaoCell = worksheet.getCell('A3');
            dataGeracaoCell.value = `Gerado em: ${new Date().toLocaleString('pt-BR')}`;
            dataGeracaoCell.font = { size: 10 };
            dataGeracaoCell.alignment = { horizontal: 'right' };
            // Adicionar linha em branco
            worksheet.addRow([]);
            // Adicionar conteúdo específico conforme o tipo de relatório
            switch (tipo) {
                case 'beneficios-concedidos':
                    await this.gerarBeneficiosConcedidos(worksheet, dados, opcoes);
                    break;
                case 'solicitacoes-por-status':
                    await this.gerarSolicitacoesPorStatus(worksheet, dados, opcoes);
                    break;
                case 'atendimentos-por-unidade':
                    await this.gerarAtendimentosPorUnidade(worksheet, dados, opcoes);
                    break;
                default:
                    worksheet.addRow(['Tipo de relatório não implementado']);
            }
            // Auto-ajustar colunas
            if (worksheet.columns) {
                worksheet.columns.forEach((column) => {
                    if (column && typeof column.eachCell === 'function') {
                        let maxColumnLength = 0;
                        column.eachCell({ includeEmpty: true }, (cell) => {
                            const columnLength = cell.value
                                ? cell.value.toString().length
                                : 10;
                            if (columnLength > maxColumnLength) {
                                maxColumnLength = columnLength;
                            }
                        });
                        column.width = maxColumnLength < 10 ? 10 : maxColumnLength + 2;
                    }
                });
            }
            // Salvar arquivo
            await workbook.xlsx.writeFile(tempFilePath);
            // Retornar buffer e remover arquivo temporário
            return this.tempFilesService.readAndRemove(tempFilePath);
        }
        catch (error) {
            this.logger.error(`Erro ao gerar relatório Excel: ${error.message}`);
            // Tentar limpar arquivo temporário em caso de erro
            try {
                if (fs.existsSync(tempFilePath)) {
                    fs.unlinkSync(tempFilePath);
                }
            }
            catch (cleanupError) {
                this.logger.warn(`Erro ao limpar arquivo temporário: ${cleanupError.message}`);
            }
            throw error;
        }
    }
    /**
     * Retorna o tipo MIME para arquivos Excel
     */
    getMimeType() {
        return 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
    }
    /**
     * Retorna a extensão para arquivos Excel
     */
    getExtensao() {
        return 'xlsx';
    }
    /**
     * Retorna o título do relatório com base no tipo
     * @param tipo Tipo de relatório
     * @returns Título formatado
     */
    getTitulo(tipo) {
        switch (tipo) {
            case 'beneficios-concedidos':
                return 'Relatório de Benefícios Concedidos';
            case 'solicitacoes-por-status':
                return 'Relatório de Solicitações por Status';
            case 'atendimentos-por-unidade':
                return 'Relatório de Atendimentos por Unidade';
            default:
                return 'Relatório';
        }
    }
    /**
     * Gera conteúdo para relatório de benefícios concedidos
     * @param worksheet Planilha Excel
     * @param dados Dados para o relatório
     * @param opcoes Opções de configuração
     */
    async gerarBeneficiosConcedidos(worksheet, dados, opcoes) {
        // Adicionar cabeçalho da tabela
        const cabecalho = [
            'Protocolo',
            'Beneficiário',
            'Benefício',
            'Unidade',
            'Data Liberação',
            'Valor',
        ];
        const headerRow = worksheet.addRow(cabecalho);
        headerRow.eachCell((cell) => {
            cell.font = { bold: true };
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'FFD9D9D9' },
            };
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' },
            };
        });
        // Adicionar dados
        dados.forEach((solicitacao) => {
            const row = worksheet.addRow([
                solicitacao.protocolo || '',
                solicitacao.beneficiario?.nome || 'N/A',
                solicitacao.tipo_beneficio?.nome || 'N/A',
                solicitacao.unidade?.nome || 'N/A',
                solicitacao.data_liberacao
                    ? new Date(solicitacao.data_liberacao).toLocaleDateString('pt-BR')
                    : 'N/A',
                solicitacao.tipo_beneficio?.valor || 0,
            ]);
            row.eachCell((cell) => {
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' },
                };
            });
        });
        // Adicionar linha em branco
        worksheet.addRow([]);
        // Adicionar resumo
        const resumoRow = worksheet.addRow([
            'Total de benefícios concedidos:',
            dados.length,
        ]);
        resumoRow.getCell(1).font = { bold: true };
        // Calcular valor total
        const valorTotal = dados.reduce((total, item) => total + (item.tipo_beneficio?.valor || 0), 0);
        const valorRow = worksheet.addRow([
            'Valor total:',
            valorTotal.toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL',
            }),
        ]);
        valorRow.getCell(1).font = { bold: true };
    }
    /**
     * Gera conteúdo para relatório de solicitações por status
     * @param worksheet Planilha Excel
     * @param dados Dados para o relatório
     * @param opcoes Opções de configuração
     */
    async gerarSolicitacoesPorStatus(worksheet, dados, opcoes) {
        const statusList = Object.keys(dados);
        // Adicionar resumo geral
        worksheet.mergeCells('A5:C5');
        const resumoCell = worksheet.getCell('A5');
        resumoCell.value = 'Resumo por Status';
        resumoCell.font = { size: 14, bold: true };
        let row = 6;
        let totalGeral = 0;
        statusList.forEach((status, index) => {
            const quantidade = dados[status].length;
            totalGeral += quantidade;
            const statusRow = worksheet.getRow(row + index);
            statusRow.getCell(1).value = status;
            statusRow.getCell(2).value = quantidade;
            statusRow.getCell(3).value = 'solicitações';
        });
        row += statusList.length + 1;
        const totalRow = worksheet.getRow(row);
        totalRow.getCell(1).value = 'Total Geral';
        totalRow.getCell(2).value = totalGeral;
        totalRow.getCell(3).value = 'solicitações';
        totalRow.getCell(1).font = { bold: true };
        totalRow.getCell(2).font = { bold: true };
        // Adicionar detalhamento por status em novas planilhas
        if (worksheet.workbook) {
            statusList.forEach((status) => {
                this.criarPlanilhaStatus(worksheet.workbook, status, dados[status]);
            });
        }
    }
    /**
     * Cria uma nova planilha para um status específico
     * @param workbook Workbook Excel
     * @param status Nome do status
     * @param solicitacoes Lista de solicitações com este status
     */
    criarPlanilhaStatus(workbook, status, solicitacoes) {
        const statusWorksheet = workbook.addWorksheet(`Status - ${status}`);
        // Adicionar título
        statusWorksheet.mergeCells('A1:E1');
        const tituloCell = statusWorksheet.getCell('A1');
        tituloCell.value = `Solicitações com Status: ${status}`;
        tituloCell.font = { size: 16, bold: true };
        tituloCell.alignment = { horizontal: 'center' };
        // Adicionar data de geração
        statusWorksheet.mergeCells('A2:E2');
        const dataGeracaoCell = statusWorksheet.getCell('A2');
        dataGeracaoCell.value = `Gerado em: ${new Date().toLocaleString('pt-BR')}`;
        dataGeracaoCell.font = { size: 10 };
        dataGeracaoCell.alignment = { horizontal: 'right' };
        // Adicionar linha em branco
        statusWorksheet.addRow([]);
        // Adicionar cabeçalho da tabela
        const cabecalho = [
            'Protocolo',
            'Beneficiário',
            'Benefício',
            'Unidade',
            'Data Abertura',
        ];
        const headerRow = statusWorksheet.addRow(cabecalho);
        headerRow.eachCell((cell) => {
            cell.font = { bold: true };
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'FFD9D9D9' },
            };
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' },
            };
        });
        // Adicionar dados
        solicitacoes.forEach((solicitacao) => {
            const row = statusWorksheet.addRow([
                solicitacao.protocolo || '',
                solicitacao.beneficiario?.nome || 'N/A',
                solicitacao.tipo_beneficio?.nome || 'N/A',
                solicitacao.unidade?.nome || 'N/A',
                solicitacao.data_abertura
                    ? new Date(solicitacao.data_abertura).toLocaleDateString('pt-BR')
                    : 'N/A',
            ]);
            row.eachCell((cell) => {
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' },
                };
            });
        });
        // Auto-ajustar colunas
        if (statusWorksheet.columns) {
            statusWorksheet.columns.forEach((column) => {
                if (column && typeof column.eachCell === 'function') {
                    let maxColumnLength = 0;
                    column.eachCell({ includeEmpty: true }, (cell) => {
                        const columnLength = cell.value ? cell.value.toString().length : 10;
                        if (columnLength > maxColumnLength) {
                            maxColumnLength = columnLength;
                        }
                    });
                    column.width = maxColumnLength < 10 ? 10 : maxColumnLength + 2;
                }
            });
        }
        return statusWorksheet;
    }
    /**
     * Gera conteúdo para relatório de atendimentos por unidade
     * @param worksheet Planilha Excel
     * @param dados Dados para o relatório
     * @param opcoes Opções de configuração
     */
    async gerarAtendimentosPorUnidade(worksheet, dados, opcoes) {
        // Adicionar cabeçalho da tabela
        const cabecalho = [
            'Unidade',
            'Total Solicitações',
            'Liberadas',
            'Pendentes',
            'Taxa Aprovação',
        ];
        const headerRow = worksheet.addRow(cabecalho);
        headerRow.eachCell((cell) => {
            cell.font = { bold: true };
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'FFD9D9D9' },
            };
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' },
            };
        });
        // Adicionar dados
        dados.forEach((item) => {
            const taxaAprovacao = item.totalSolicitacoes > 0
                ? ((item.solicitacoesLiberadas / item.totalSolicitacoes) *
                    100).toFixed(2)
                : '0.00';
            const row = worksheet.addRow([
                item.unidade.nome || 'N/A',
                item.totalSolicitacoes,
                item.solicitacoesLiberadas,
                item.solicitacoesPendentes,
                `${taxaAprovacao}%`,
            ]);
            row.eachCell((cell) => {
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' },
                };
            });
        });
        // Adicionar linha em branco
        worksheet.addRow([]);
        // Adicionar totais
        const totais = dados.reduce((acc, item) => {
            acc.total += item.totalSolicitacoes;
            acc.liberadas += item.solicitacoesLiberadas;
            acc.pendentes += item.solicitacoesPendentes;
            return acc;
        }, { total: 0, liberadas: 0, pendentes: 0 });
        const taxaGeral = totais.total > 0
            ? ((totais.liberadas / totais.total) * 100).toFixed(2)
            : '0.00';
        const totalRow = worksheet.addRow([
            'Total Geral',
            totais.total,
            totais.liberadas,
            totais.pendentes,
            `${taxaGeral}%`,
        ]);
        totalRow.eachCell((cell) => {
            cell.font = { bold: true };
        });
    }
};
exports.ExcelStrategy = ExcelStrategy;
exports.ExcelStrategy = ExcelStrategy = ExcelStrategy_1 = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [typeof (_a = typeof temp_files_service_1.TempFilesService !== "undefined" && temp_files_service_1.TempFilesService) === "function" ? _a : Object])
], ExcelStrategy);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHJlbGF0b3Jpb3MtdW5pZmljYWRvXFxzdHJhdGVnaWVzXFxleGNlbC5zdHJhdGVneS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUFvRDtBQUVwRCxpREFBbUM7QUFDbkMsdUNBQXlCO0FBQ3pCLHVFQUFrRTtBQUVsRTs7OztHQUlHO0FBRUksSUFBTSxhQUFhLHFCQUFuQixNQUFNLGFBQWE7SUFHSztJQUZaLE1BQU0sR0FBRyxJQUFJLGVBQU0sQ0FBQyxlQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFekQsWUFBNkIsZ0JBQWtDO1FBQWxDLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7SUFBRyxDQUFDO0lBRW5FOzs7Ozs7T0FNRztJQUNILEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBWSxFQUFFLEtBQVUsRUFBRSxNQUFXO1FBQy9DLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLG9DQUFvQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBRTVELDJCQUEyQjtRQUMzQixNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUN4RCxpQkFBaUIsRUFDakIsTUFBTSxDQUNQLENBQUM7UUFFRixJQUFJLENBQUM7WUFDSCw0QkFBNEI7WUFDNUIsTUFBTSxRQUFRLEdBQUcsSUFBSSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDeEMsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFFOUQsbUJBQW1CO1lBQ25CLFNBQVMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDOUIsTUFBTSxVQUFVLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzQyxVQUFVLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEMsVUFBVSxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1lBQzNDLFVBQVUsQ0FBQyxTQUFTLEdBQUcsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLENBQUM7WUFFaEQsb0JBQW9CO1lBQ3BCLElBQUksTUFBTSxDQUFDLFVBQVUsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ3hDLE1BQU0sVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxrQkFBa0IsQ0FDL0QsT0FBTyxDQUNSLENBQUM7Z0JBQ0YsTUFBTSxPQUFPLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUVyRSxTQUFTLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUM5QixNQUFNLFdBQVcsR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM1QyxXQUFXLENBQUMsS0FBSyxHQUFHLFlBQVksVUFBVSxNQUFNLE9BQU8sRUFBRSxDQUFDO2dCQUMxRCxXQUFXLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDO2dCQUNoQyxXQUFXLENBQUMsU0FBUyxHQUFHLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxDQUFDO1lBQ25ELENBQUM7WUFFRCw0QkFBNEI7WUFDNUIsU0FBUyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUM5QixNQUFNLGVBQWUsR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2hELGVBQWUsQ0FBQyxLQUFLLEdBQUcsY0FBYyxJQUFJLElBQUksRUFBRSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQzNFLGVBQWUsQ0FBQyxJQUFJLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUM7WUFDcEMsZUFBZSxDQUFDLFNBQVMsR0FBRyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsQ0FBQztZQUVwRCw0QkFBNEI7WUFDNUIsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUVyQiw2REFBNkQ7WUFDN0QsUUFBUSxJQUFJLEVBQUUsQ0FBQztnQkFDYixLQUFLLHVCQUF1QjtvQkFDMUIsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztvQkFDL0QsTUFBTTtnQkFDUixLQUFLLHlCQUF5QjtvQkFDNUIsTUFBTSxJQUFJLENBQUMsMEJBQTBCLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztvQkFDaEUsTUFBTTtnQkFDUixLQUFLLDBCQUEwQjtvQkFDN0IsTUFBTSxJQUFJLENBQUMsMkJBQTJCLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztvQkFDakUsTUFBTTtnQkFDUjtvQkFDRSxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsb0NBQW9DLENBQUMsQ0FBQyxDQUFDO1lBQzdELENBQUM7WUFFRCx1QkFBdUI7WUFDdkIsSUFBSSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ3RCLFNBQVMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7b0JBQ25DLElBQUksTUFBTSxJQUFJLE9BQU8sTUFBTSxDQUFDLFFBQVEsS0FBSyxVQUFVLEVBQUUsQ0FBQzt3QkFDcEQsSUFBSSxlQUFlLEdBQUcsQ0FBQyxDQUFDO3dCQUN4QixNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7NEJBQy9DLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFLO2dDQUM3QixDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxNQUFNO2dDQUM5QixDQUFDLENBQUMsRUFBRSxDQUFDOzRCQUNQLElBQUksWUFBWSxHQUFHLGVBQWUsRUFBRSxDQUFDO2dDQUNuQyxlQUFlLEdBQUcsWUFBWSxDQUFDOzRCQUNqQyxDQUFDO3dCQUNILENBQUMsQ0FBQyxDQUFDO3dCQUNILE1BQU0sQ0FBQyxLQUFLLEdBQUcsZUFBZSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDO29CQUNqRSxDQUFDO2dCQUNILENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQztZQUVELGlCQUFpQjtZQUNqQixNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRTVDLCtDQUErQztZQUMvQyxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDM0QsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxrQ0FBa0MsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7WUFFckUsbURBQW1EO1lBQ25ELElBQUksQ0FBQztnQkFDSCxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQztvQkFDaEMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDOUIsQ0FBQztZQUNILENBQUM7WUFBQyxPQUFPLFlBQVksRUFBRSxDQUFDO2dCQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDZCxzQ0FBc0MsWUFBWSxDQUFDLE9BQU8sRUFBRSxDQUM3RCxDQUFDO1lBQ0osQ0FBQztZQUVELE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILFdBQVc7UUFDVCxPQUFPLG1FQUFtRSxDQUFDO0lBQzdFLENBQUM7SUFFRDs7T0FFRztJQUNILFdBQVc7UUFDVCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLFNBQVMsQ0FBQyxJQUFZO1FBQzVCLFFBQVEsSUFBSSxFQUFFLENBQUM7WUFDYixLQUFLLHVCQUF1QjtnQkFDMUIsT0FBTyxvQ0FBb0MsQ0FBQztZQUM5QyxLQUFLLHlCQUF5QjtnQkFDNUIsT0FBTyxzQ0FBc0MsQ0FBQztZQUNoRCxLQUFLLDBCQUEwQjtnQkFDN0IsT0FBTyx1Q0FBdUMsQ0FBQztZQUNqRDtnQkFDRSxPQUFPLFdBQVcsQ0FBQztRQUN2QixDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssS0FBSyxDQUFDLHlCQUF5QixDQUNyQyxTQUE0QixFQUM1QixLQUFZLEVBQ1osTUFBVztRQUVYLGdDQUFnQztRQUNoQyxNQUFNLFNBQVMsR0FBRztZQUNoQixXQUFXO1lBQ1gsY0FBYztZQUNkLFdBQVc7WUFDWCxTQUFTO1lBQ1QsZ0JBQWdCO1lBQ2hCLE9BQU87U0FDUixDQUFDO1FBQ0YsTUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM5QyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDMUIsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztZQUMzQixJQUFJLENBQUMsSUFBSSxHQUFHO2dCQUNWLElBQUksRUFBRSxTQUFTO2dCQUNmLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFO2FBQzlCLENBQUM7WUFDRixJQUFJLENBQUMsTUFBTSxHQUFHO2dCQUNaLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3RCLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3ZCLE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3pCLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7YUFDekIsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsa0JBQWtCO1FBQ2xCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLEVBQUUsRUFBRTtZQUM1QixNQUFNLEdBQUcsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDO2dCQUMzQixXQUFXLENBQUMsU0FBUyxJQUFJLEVBQUU7Z0JBQzNCLFdBQVcsQ0FBQyxZQUFZLEVBQUUsSUFBSSxJQUFJLEtBQUs7Z0JBQ3ZDLFdBQVcsQ0FBQyxjQUFjLEVBQUUsSUFBSSxJQUFJLEtBQUs7Z0JBQ3pDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxJQUFJLEtBQUs7Z0JBQ2xDLFdBQVcsQ0FBQyxjQUFjO29CQUN4QixDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQztvQkFDbEUsQ0FBQyxDQUFDLEtBQUs7Z0JBQ1QsV0FBVyxDQUFDLGNBQWMsRUFBRSxLQUFLLElBQUksQ0FBQzthQUN2QyxDQUFDLENBQUM7WUFFSCxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQ3BCLElBQUksQ0FBQyxNQUFNLEdBQUc7b0JBQ1osR0FBRyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtvQkFDdEIsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtvQkFDdkIsTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtvQkFDekIsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtpQkFDekIsQ0FBQztZQUNKLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCw0QkFBNEI7UUFDNUIsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUVyQixtQkFBbUI7UUFDbkIsTUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQztZQUNqQyxpQ0FBaUM7WUFDakMsS0FBSyxDQUFDLE1BQU07U0FDYixDQUFDLENBQUM7UUFDSCxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztRQUUzQyx1QkFBdUI7UUFDdkIsTUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FDN0IsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLEtBQUssSUFBSSxDQUFDLENBQUMsRUFDMUQsQ0FBQyxDQUNGLENBQUM7UUFDRixNQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDO1lBQ2hDLGNBQWM7WUFDZCxVQUFVLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRTtnQkFDakMsS0FBSyxFQUFFLFVBQVU7Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7U0FDSCxDQUFDLENBQUM7UUFDSCxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztJQUM1QyxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSyxLQUFLLENBQUMsMEJBQTBCLENBQ3RDLFNBQTRCLEVBQzVCLEtBQVUsRUFDVixNQUFXO1FBRVgsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUV0Qyx5QkFBeUI7UUFDekIsU0FBUyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QixNQUFNLFVBQVUsR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNDLFVBQVUsQ0FBQyxLQUFLLEdBQUcsbUJBQW1CLENBQUM7UUFDdkMsVUFBVSxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1FBRTNDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNaLElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQztRQUVuQixVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFO1lBQ25DLE1BQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUM7WUFDeEMsVUFBVSxJQUFJLFVBQVUsQ0FBQztZQUV6QixNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQztZQUNoRCxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7WUFDcEMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1lBQ3hDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLGNBQWMsQ0FBQztRQUM5QyxDQUFDLENBQUMsQ0FBQztRQUVILEdBQUcsSUFBSSxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUM3QixNQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLGFBQWEsQ0FBQztRQUMxQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7UUFDdkMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsY0FBYyxDQUFDO1FBQzNDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1FBQzFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1FBRTFDLHVEQUF1RDtRQUN2RCxJQUFJLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN2QixVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7Z0JBQzVCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUN0RSxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSyxtQkFBbUIsQ0FDekIsUUFBMEIsRUFDMUIsTUFBYyxFQUNkLFlBQW1CO1FBRW5CLE1BQU0sZUFBZSxHQUFHLFFBQVEsQ0FBQyxZQUFZLENBQUMsWUFBWSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBRXBFLG1CQUFtQjtRQUNuQixlQUFlLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLE1BQU0sVUFBVSxHQUFHLGVBQWUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDakQsVUFBVSxDQUFDLEtBQUssR0FBRyw0QkFBNEIsTUFBTSxFQUFFLENBQUM7UUFDeEQsVUFBVSxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1FBQzNDLFVBQVUsQ0FBQyxTQUFTLEdBQUcsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLENBQUM7UUFFaEQsNEJBQTRCO1FBQzVCLGVBQWUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDcEMsTUFBTSxlQUFlLEdBQUcsZUFBZSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0RCxlQUFlLENBQUMsS0FBSyxHQUFHLGNBQWMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUMzRSxlQUFlLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ3BDLGVBQWUsQ0FBQyxTQUFTLEdBQUcsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLENBQUM7UUFFcEQsNEJBQTRCO1FBQzVCLGVBQWUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFM0IsZ0NBQWdDO1FBQ2hDLE1BQU0sU0FBUyxHQUFHO1lBQ2hCLFdBQVc7WUFDWCxjQUFjO1lBQ2QsV0FBVztZQUNYLFNBQVM7WUFDVCxlQUFlO1NBQ2hCLENBQUM7UUFDRixNQUFNLFNBQVMsR0FBRyxlQUFlLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3BELFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUMxQixJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1lBQzNCLElBQUksQ0FBQyxJQUFJLEdBQUc7Z0JBQ1YsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLE9BQU87Z0JBQ2hCLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7YUFDOUIsQ0FBQztZQUNGLElBQUksQ0FBQyxNQUFNLEdBQUc7Z0JBQ1osR0FBRyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtnQkFDdEIsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtnQkFDdkIsTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtnQkFDekIsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTthQUN6QixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxrQkFBa0I7UUFDbEIsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxFQUFFO1lBQ25DLE1BQU0sR0FBRyxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUM7Z0JBQ2pDLFdBQVcsQ0FBQyxTQUFTLElBQUksRUFBRTtnQkFDM0IsV0FBVyxDQUFDLFlBQVksRUFBRSxJQUFJLElBQUksS0FBSztnQkFDdkMsV0FBVyxDQUFDLGNBQWMsRUFBRSxJQUFJLElBQUksS0FBSztnQkFDekMsV0FBVyxDQUFDLE9BQU8sRUFBRSxJQUFJLElBQUksS0FBSztnQkFDbEMsV0FBVyxDQUFDLGFBQWE7b0JBQ3ZCLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDO29CQUNqRSxDQUFDLENBQUMsS0FBSzthQUNWLENBQUMsQ0FBQztZQUVILEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRztvQkFDWixHQUFHLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFO29CQUN0QixJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFO29CQUN2QixNQUFNLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFO29CQUN6QixLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFO2lCQUN6QixDQUFDO1lBQ0osQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILHVCQUF1QjtRQUN2QixJQUFJLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUM1QixlQUFlLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO2dCQUN6QyxJQUFJLE1BQU0sSUFBSSxPQUFPLE1BQU0sQ0FBQyxRQUFRLEtBQUssVUFBVSxFQUFFLENBQUM7b0JBQ3BELElBQUksZUFBZSxHQUFHLENBQUMsQ0FBQztvQkFDeEIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO3dCQUMvQyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO3dCQUNwRSxJQUFJLFlBQVksR0FBRyxlQUFlLEVBQUUsQ0FBQzs0QkFDbkMsZUFBZSxHQUFHLFlBQVksQ0FBQzt3QkFDakMsQ0FBQztvQkFDSCxDQUFDLENBQUMsQ0FBQztvQkFDSCxNQUFNLENBQUMsS0FBSyxHQUFHLGVBQWUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsZUFBZSxHQUFHLENBQUMsQ0FBQztnQkFDakUsQ0FBQztZQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztRQUVELE9BQU8sZUFBZSxDQUFDO0lBQ3pCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLEtBQUssQ0FBQywyQkFBMkIsQ0FDdkMsU0FBNEIsRUFDNUIsS0FBWSxFQUNaLE1BQVc7UUFFWCxnQ0FBZ0M7UUFDaEMsTUFBTSxTQUFTLEdBQUc7WUFDaEIsU0FBUztZQUNULG9CQUFvQjtZQUNwQixXQUFXO1lBQ1gsV0FBVztZQUNYLGdCQUFnQjtTQUNqQixDQUFDO1FBQ0YsTUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM5QyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDMUIsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztZQUMzQixJQUFJLENBQUMsSUFBSSxHQUFHO2dCQUNWLElBQUksRUFBRSxTQUFTO2dCQUNmLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFO2FBQzlCLENBQUM7WUFDRixJQUFJLENBQUMsTUFBTSxHQUFHO2dCQUNaLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3RCLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3ZCLE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7Z0JBQ3pCLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7YUFDekIsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsa0JBQWtCO1FBQ2xCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNyQixNQUFNLGFBQWEsR0FDakIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLENBQUM7Z0JBQ3hCLENBQUMsQ0FBQyxDQUNFLENBQUMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztvQkFDckQsR0FBRyxDQUNKLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDZCxDQUFDLENBQUMsTUFBTSxDQUFDO1lBRWIsTUFBTSxHQUFHLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQztnQkFDM0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksS0FBSztnQkFDMUIsSUFBSSxDQUFDLGlCQUFpQjtnQkFDdEIsSUFBSSxDQUFDLHFCQUFxQjtnQkFDMUIsSUFBSSxDQUFDLHFCQUFxQjtnQkFDMUIsR0FBRyxhQUFhLEdBQUc7YUFDcEIsQ0FBQyxDQUFDO1lBRUgsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUNwQixJQUFJLENBQUMsTUFBTSxHQUFHO29CQUNaLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7b0JBQ3RCLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7b0JBQ3ZCLE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7b0JBQ3pCLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7aUJBQ3pCLENBQUM7WUFDSixDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsNEJBQTRCO1FBQzVCLFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFckIsbUJBQW1CO1FBQ25CLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQ3pCLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO1lBQ1osR0FBRyxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUM7WUFDcEMsR0FBRyxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMscUJBQXFCLENBQUM7WUFDNUMsR0FBRyxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMscUJBQXFCLENBQUM7WUFDNUMsT0FBTyxHQUFHLENBQUM7UUFDYixDQUFDLEVBQ0QsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLENBQUMsRUFBRSxDQUN6QyxDQUFDO1FBRUYsTUFBTSxTQUFTLEdBQ2IsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDO1lBQ2QsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ3RELENBQUMsQ0FBQyxNQUFNLENBQUM7UUFFYixNQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDO1lBQ2hDLGFBQWE7WUFDYixNQUFNLENBQUMsS0FBSztZQUNaLE1BQU0sQ0FBQyxTQUFTO1lBQ2hCLE1BQU0sQ0FBQyxTQUFTO1lBQ2hCLEdBQUcsU0FBUyxHQUFHO1NBQ2hCLENBQUMsQ0FBQztRQUNILFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUN6QixJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGLENBQUE7QUFqZFksc0NBQWE7d0JBQWIsYUFBYTtJQUR6QixJQUFBLG1CQUFVLEdBQUU7eURBSW9DLHFDQUFnQixvQkFBaEIscUNBQWdCO0dBSHBELGFBQWEsQ0FpZHpCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxyZWxhdG9yaW9zLXVuaWZpY2Fkb1xcc3RyYXRlZ2llc1xcZXhjZWwuc3RyYXRlZ3kudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgTG9nZ2VyIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgUmVsYXRvcmlvU3RyYXRlZ3kgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3JlbGF0b3Jpby1zdHJhdGVneS5pbnRlcmZhY2UnO1xuaW1wb3J0ICogYXMgRXhjZWxKUyBmcm9tICdleGNlbGpzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCB7IFRlbXBGaWxlc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy90ZW1wLWZpbGVzLnNlcnZpY2UnO1xuXG4vKipcbiAqIEVzdHJhdMOpZ2lhIGRlIGdlcmHDp8OjbyBkZSByZWxhdMOzcmlvcyBlbSBmb3JtYXRvIEV4Y2VsXG4gKlxuICogSW1wbGVtZW50YSBhIGdlcmHDp8OjbyBkZSByZWxhdMOzcmlvcyBlbSBmb3JtYXRvIEV4Y2VsIHVzYW5kbyBFeGNlbEpTXG4gKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBFeGNlbFN0cmF0ZWd5IGltcGxlbWVudHMgUmVsYXRvcmlvU3RyYXRlZ3kge1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dlciA9IG5ldyBMb2dnZXIoRXhjZWxTdHJhdGVneS5uYW1lKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHRlbXBGaWxlc1NlcnZpY2U6IFRlbXBGaWxlc1NlcnZpY2UpIHt9XG5cbiAgLyoqXG4gICAqIEdlcmEgdW0gcmVsYXTDs3JpbyBlbSBmb3JtYXRvIEV4Y2VsXG4gICAqIEBwYXJhbSB0aXBvIFRpcG8gZGUgcmVsYXTDs3Jpb1xuICAgKiBAcGFyYW0gZGFkb3MgRGFkb3MgZG8gcmVsYXTDs3Jpb1xuICAgKiBAcGFyYW0gb3Bjb2VzIE9ww6fDtWVzIGRlIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEByZXR1cm5zIEJ1ZmZlciBjb250ZW5kbyBvIEV4Y2VsIGdlcmFkb1xuICAgKi9cbiAgYXN5bmMgZ2VyYXIodGlwbzogc3RyaW5nLCBkYWRvczogYW55LCBvcGNvZXM6IGFueSk6IFByb21pc2U8QnVmZmVyPiB7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBHZXJhbmRvIHJlbGF0w7NyaW8gRXhjZWwgZG8gdGlwbzogJHt0aXBvfWApO1xuXG4gICAgLy8gQ3JpYXIgYXJxdWl2byB0ZW1wb3LDoXJpb1xuICAgIGNvbnN0IHRlbXBGaWxlUGF0aCA9IHRoaXMudGVtcEZpbGVzU2VydmljZS5nZXRUZW1wRmlsZVBhdGgoXG4gICAgICAncmVsYXRvcmlvLWV4Y2VsJyxcbiAgICAgICd4bHN4JyxcbiAgICApO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENyaWFyIHdvcmtib29rIGUgcGxhbmlsaGFcbiAgICAgIGNvbnN0IHdvcmtib29rID0gbmV3IEV4Y2VsSlMuV29ya2Jvb2soKTtcbiAgICAgIGNvbnN0IHdvcmtzaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCh0aGlzLmdldFRpdHVsbyh0aXBvKSk7XG5cbiAgICAgIC8vIEFkaWNpb25hciB0w610dWxvXG4gICAgICB3b3Jrc2hlZXQubWVyZ2VDZWxscygnQTE6RTEnKTtcbiAgICAgIGNvbnN0IHRpdHVsb0NlbGwgPSB3b3Jrc2hlZXQuZ2V0Q2VsbCgnQTEnKTtcbiAgICAgIHRpdHVsb0NlbGwudmFsdWUgPSB0aGlzLmdldFRpdHVsbyh0aXBvKTtcbiAgICAgIHRpdHVsb0NlbGwuZm9udCA9IHsgc2l6ZTogMTYsIGJvbGQ6IHRydWUgfTtcbiAgICAgIHRpdHVsb0NlbGwuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJyB9O1xuXG4gICAgICAvLyBBZGljaW9uYXIgcGVyw61vZG9cbiAgICAgIGlmIChvcGNvZXMuZGF0YUluaWNpbyAmJiBvcGNvZXMuZGF0YUZpbSkge1xuICAgICAgICBjb25zdCBkYXRhSW5pY2lvID0gbmV3IERhdGUob3Bjb2VzLmRhdGFJbmljaW8pLnRvTG9jYWxlRGF0ZVN0cmluZyhcbiAgICAgICAgICAncHQtQlInLFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBkYXRhRmltID0gbmV3IERhdGUob3Bjb2VzLmRhdGFGaW0pLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKTtcblxuICAgICAgICB3b3Jrc2hlZXQubWVyZ2VDZWxscygnQTI6RTInKTtcbiAgICAgICAgY29uc3QgcGVyaW9kb0NlbGwgPSB3b3Jrc2hlZXQuZ2V0Q2VsbCgnQTInKTtcbiAgICAgICAgcGVyaW9kb0NlbGwudmFsdWUgPSBgUGVyw61vZG86ICR7ZGF0YUluaWNpb30gYSAke2RhdGFGaW19YDtcbiAgICAgICAgcGVyaW9kb0NlbGwuZm9udCA9IHsgc2l6ZTogMTIgfTtcbiAgICAgICAgcGVyaW9kb0NlbGwuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJyB9O1xuICAgICAgfVxuXG4gICAgICAvLyBBZGljaW9uYXIgZGF0YSBkZSBnZXJhw6fDo29cbiAgICAgIHdvcmtzaGVldC5tZXJnZUNlbGxzKCdBMzpFMycpO1xuICAgICAgY29uc3QgZGF0YUdlcmFjYW9DZWxsID0gd29ya3NoZWV0LmdldENlbGwoJ0EzJyk7XG4gICAgICBkYXRhR2VyYWNhb0NlbGwudmFsdWUgPSBgR2VyYWRvIGVtOiAke25ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJyl9YDtcbiAgICAgIGRhdGFHZXJhY2FvQ2VsbC5mb250ID0geyBzaXplOiAxMCB9O1xuICAgICAgZGF0YUdlcmFjYW9DZWxsLmFsaWdubWVudCA9IHsgaG9yaXpvbnRhbDogJ3JpZ2h0JyB9O1xuXG4gICAgICAvLyBBZGljaW9uYXIgbGluaGEgZW0gYnJhbmNvXG4gICAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTtcblxuICAgICAgLy8gQWRpY2lvbmFyIGNvbnRlw7pkbyBlc3BlY8OtZmljbyBjb25mb3JtZSBvIHRpcG8gZGUgcmVsYXTDs3Jpb1xuICAgICAgc3dpdGNoICh0aXBvKSB7XG4gICAgICAgIGNhc2UgJ2JlbmVmaWNpb3MtY29uY2VkaWRvcyc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5nZXJhckJlbmVmaWNpb3NDb25jZWRpZG9zKHdvcmtzaGVldCwgZGFkb3MsIG9wY29lcyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3NvbGljaXRhY29lcy1wb3Itc3RhdHVzJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmdlcmFyU29saWNpdGFjb2VzUG9yU3RhdHVzKHdvcmtzaGVldCwgZGFkb3MsIG9wY29lcyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2F0ZW5kaW1lbnRvcy1wb3ItdW5pZGFkZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5nZXJhckF0ZW5kaW1lbnRvc1BvclVuaWRhZGUod29ya3NoZWV0LCBkYWRvcywgb3Bjb2VzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB3b3Jrc2hlZXQuYWRkUm93KFsnVGlwbyBkZSByZWxhdMOzcmlvIG7Do28gaW1wbGVtZW50YWRvJ10pO1xuICAgICAgfVxuXG4gICAgICAvLyBBdXRvLWFqdXN0YXIgY29sdW5hc1xuICAgICAgaWYgKHdvcmtzaGVldC5jb2x1bW5zKSB7XG4gICAgICAgIHdvcmtzaGVldC5jb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xuICAgICAgICAgIGlmIChjb2x1bW4gJiYgdHlwZW9mIGNvbHVtbi5lYWNoQ2VsbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgbGV0IG1heENvbHVtbkxlbmd0aCA9IDA7XG4gICAgICAgICAgICBjb2x1bW4uZWFjaENlbGwoeyBpbmNsdWRlRW1wdHk6IHRydWUgfSwgKGNlbGwpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgY29sdW1uTGVuZ3RoID0gY2VsbC52YWx1ZVxuICAgICAgICAgICAgICAgID8gY2VsbC52YWx1ZS50b1N0cmluZygpLmxlbmd0aFxuICAgICAgICAgICAgICAgIDogMTA7XG4gICAgICAgICAgICAgIGlmIChjb2x1bW5MZW5ndGggPiBtYXhDb2x1bW5MZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBtYXhDb2x1bW5MZW5ndGggPSBjb2x1bW5MZW5ndGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29sdW1uLndpZHRoID0gbWF4Q29sdW1uTGVuZ3RoIDwgMTAgPyAxMCA6IG1heENvbHVtbkxlbmd0aCArIDI7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gU2FsdmFyIGFycXVpdm9cbiAgICAgIGF3YWl0IHdvcmtib29rLnhsc3gud3JpdGVGaWxlKHRlbXBGaWxlUGF0aCk7XG5cbiAgICAgIC8vIFJldG9ybmFyIGJ1ZmZlciBlIHJlbW92ZXIgYXJxdWl2byB0ZW1wb3LDoXJpb1xuICAgICAgcmV0dXJuIHRoaXMudGVtcEZpbGVzU2VydmljZS5yZWFkQW5kUmVtb3ZlKHRlbXBGaWxlUGF0aCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGBFcnJvIGFvIGdlcmFyIHJlbGF0w7NyaW8gRXhjZWw6ICR7ZXJyb3IubWVzc2FnZX1gKTtcblxuICAgICAgLy8gVGVudGFyIGxpbXBhciBhcnF1aXZvIHRlbXBvcsOhcmlvIGVtIGNhc28gZGUgZXJyb1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmModGVtcEZpbGVQYXRoKSkge1xuICAgICAgICAgIGZzLnVubGlua1N5bmModGVtcEZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoY2xlYW51cEVycm9yKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oXG4gICAgICAgICAgYEVycm8gYW8gbGltcGFyIGFycXVpdm8gdGVtcG9yw6FyaW86ICR7Y2xlYW51cEVycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldG9ybmEgbyB0aXBvIE1JTUUgcGFyYSBhcnF1aXZvcyBFeGNlbFxuICAgKi9cbiAgZ2V0TWltZVR5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0JztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRvcm5hIGEgZXh0ZW5zw6NvIHBhcmEgYXJxdWl2b3MgRXhjZWxcbiAgICovXG4gIGdldEV4dGVuc2FvKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICd4bHN4JztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRvcm5hIG8gdMOtdHVsbyBkbyByZWxhdMOzcmlvIGNvbSBiYXNlIG5vIHRpcG9cbiAgICogQHBhcmFtIHRpcG8gVGlwbyBkZSByZWxhdMOzcmlvXG4gICAqIEByZXR1cm5zIFTDrXR1bG8gZm9ybWF0YWRvXG4gICAqL1xuICBwcml2YXRlIGdldFRpdHVsbyh0aXBvOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHN3aXRjaCAodGlwbykge1xuICAgICAgY2FzZSAnYmVuZWZpY2lvcy1jb25jZWRpZG9zJzpcbiAgICAgICAgcmV0dXJuICdSZWxhdMOzcmlvIGRlIEJlbmVmw61jaW9zIENvbmNlZGlkb3MnO1xuICAgICAgY2FzZSAnc29saWNpdGFjb2VzLXBvci1zdGF0dXMnOlxuICAgICAgICByZXR1cm4gJ1JlbGF0w7NyaW8gZGUgU29saWNpdGHDp8O1ZXMgcG9yIFN0YXR1cyc7XG4gICAgICBjYXNlICdhdGVuZGltZW50b3MtcG9yLXVuaWRhZGUnOlxuICAgICAgICByZXR1cm4gJ1JlbGF0w7NyaW8gZGUgQXRlbmRpbWVudG9zIHBvciBVbmlkYWRlJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnUmVsYXTDs3Jpbyc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlcmEgY29udGXDumRvIHBhcmEgcmVsYXTDs3JpbyBkZSBiZW5lZsOtY2lvcyBjb25jZWRpZG9zXG4gICAqIEBwYXJhbSB3b3Jrc2hlZXQgUGxhbmlsaGEgRXhjZWxcbiAgICogQHBhcmFtIGRhZG9zIERhZG9zIHBhcmEgbyByZWxhdMOzcmlvXG4gICAqIEBwYXJhbSBvcGNvZXMgT3DDp8O1ZXMgZGUgY29uZmlndXJhw6fDo29cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2VyYXJCZW5lZmljaW9zQ29uY2VkaWRvcyhcbiAgICB3b3Jrc2hlZXQ6IEV4Y2VsSlMuV29ya3NoZWV0LFxuICAgIGRhZG9zOiBhbnlbXSxcbiAgICBvcGNvZXM6IGFueSxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gQWRpY2lvbmFyIGNhYmXDp2FsaG8gZGEgdGFiZWxhXG4gICAgY29uc3QgY2FiZWNhbGhvID0gW1xuICAgICAgJ1Byb3RvY29sbycsXG4gICAgICAnQmVuZWZpY2nDoXJpbycsXG4gICAgICAnQmVuZWbDrWNpbycsXG4gICAgICAnVW5pZGFkZScsXG4gICAgICAnRGF0YSBMaWJlcmHDp8OjbycsXG4gICAgICAnVmFsb3InLFxuICAgIF07XG4gICAgY29uc3QgaGVhZGVyUm93ID0gd29ya3NoZWV0LmFkZFJvdyhjYWJlY2FsaG8pO1xuICAgIGhlYWRlclJvdy5lYWNoQ2VsbCgoY2VsbCkgPT4ge1xuICAgICAgY2VsbC5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgICBjZWxsLmZpbGwgPSB7XG4gICAgICAgIHR5cGU6ICdwYXR0ZXJuJyxcbiAgICAgICAgcGF0dGVybjogJ3NvbGlkJyxcbiAgICAgICAgZmdDb2xvcjogeyBhcmdiOiAnRkZEOUQ5RDknIH0sXG4gICAgICB9O1xuICAgICAgY2VsbC5ib3JkZXIgPSB7XG4gICAgICAgIHRvcDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIGxlZnQ6IHsgc3R5bGU6ICd0aGluJyB9LFxuICAgICAgICBib3R0b206IHsgc3R5bGU6ICd0aGluJyB9LFxuICAgICAgICByaWdodDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gQWRpY2lvbmFyIGRhZG9zXG4gICAgZGFkb3MuZm9yRWFjaCgoc29saWNpdGFjYW8pID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IHdvcmtzaGVldC5hZGRSb3coW1xuICAgICAgICBzb2xpY2l0YWNhby5wcm90b2NvbG8gfHwgJycsXG4gICAgICAgIHNvbGljaXRhY2FvLmJlbmVmaWNpYXJpbz8ubm9tZSB8fCAnTi9BJyxcbiAgICAgICAgc29saWNpdGFjYW8udGlwb19iZW5lZmljaW8/Lm5vbWUgfHwgJ04vQScsXG4gICAgICAgIHNvbGljaXRhY2FvLnVuaWRhZGU/Lm5vbWUgfHwgJ04vQScsXG4gICAgICAgIHNvbGljaXRhY2FvLmRhdGFfbGliZXJhY2FvXG4gICAgICAgICAgPyBuZXcgRGF0ZShzb2xpY2l0YWNhby5kYXRhX2xpYmVyYWNhbykudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpXG4gICAgICAgICAgOiAnTi9BJyxcbiAgICAgICAgc29saWNpdGFjYW8udGlwb19iZW5lZmljaW8/LnZhbG9yIHx8IDAsXG4gICAgICBdKTtcblxuICAgICAgcm93LmVhY2hDZWxsKChjZWxsKSA9PiB7XG4gICAgICAgIGNlbGwuYm9yZGVyID0ge1xuICAgICAgICAgIHRvcDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgICAgbGVmdDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgICAgYm90dG9tOiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgICByaWdodDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIEFkaWNpb25hciBsaW5oYSBlbSBicmFuY29cbiAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTtcblxuICAgIC8vIEFkaWNpb25hciByZXN1bW9cbiAgICBjb25zdCByZXN1bW9Sb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFtcbiAgICAgICdUb3RhbCBkZSBiZW5lZsOtY2lvcyBjb25jZWRpZG9zOicsXG4gICAgICBkYWRvcy5sZW5ndGgsXG4gICAgXSk7XG4gICAgcmVzdW1vUm93LmdldENlbGwoMSkuZm9udCA9IHsgYm9sZDogdHJ1ZSB9O1xuXG4gICAgLy8gQ2FsY3VsYXIgdmFsb3IgdG90YWxcbiAgICBjb25zdCB2YWxvclRvdGFsID0gZGFkb3MucmVkdWNlKFxuICAgICAgKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIChpdGVtLnRpcG9fYmVuZWZpY2lvPy52YWxvciB8fCAwKSxcbiAgICAgIDAsXG4gICAgKTtcbiAgICBjb25zdCB2YWxvclJvdyA9IHdvcmtzaGVldC5hZGRSb3coW1xuICAgICAgJ1ZhbG9yIHRvdGFsOicsXG4gICAgICB2YWxvclRvdGFsLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicsIHtcbiAgICAgICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgICAgIGN1cnJlbmN5OiAnQlJMJyxcbiAgICAgIH0pLFxuICAgIF0pO1xuICAgIHZhbG9yUm93LmdldENlbGwoMSkuZm9udCA9IHsgYm9sZDogdHJ1ZSB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlcmEgY29udGXDumRvIHBhcmEgcmVsYXTDs3JpbyBkZSBzb2xpY2l0YcOnw7VlcyBwb3Igc3RhdHVzXG4gICAqIEBwYXJhbSB3b3Jrc2hlZXQgUGxhbmlsaGEgRXhjZWxcbiAgICogQHBhcmFtIGRhZG9zIERhZG9zIHBhcmEgbyByZWxhdMOzcmlvXG4gICAqIEBwYXJhbSBvcGNvZXMgT3DDp8O1ZXMgZGUgY29uZmlndXJhw6fDo29cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2VyYXJTb2xpY2l0YWNvZXNQb3JTdGF0dXMoXG4gICAgd29ya3NoZWV0OiBFeGNlbEpTLldvcmtzaGVldCxcbiAgICBkYWRvczogYW55LFxuICAgIG9wY29lczogYW55LFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzdGF0dXNMaXN0ID0gT2JqZWN0LmtleXMoZGFkb3MpO1xuXG4gICAgLy8gQWRpY2lvbmFyIHJlc3VtbyBnZXJhbFxuICAgIHdvcmtzaGVldC5tZXJnZUNlbGxzKCdBNTpDNScpO1xuICAgIGNvbnN0IHJlc3Vtb0NlbGwgPSB3b3Jrc2hlZXQuZ2V0Q2VsbCgnQTUnKTtcbiAgICByZXN1bW9DZWxsLnZhbHVlID0gJ1Jlc3VtbyBwb3IgU3RhdHVzJztcbiAgICByZXN1bW9DZWxsLmZvbnQgPSB7IHNpemU6IDE0LCBib2xkOiB0cnVlIH07XG5cbiAgICBsZXQgcm93ID0gNjtcbiAgICBsZXQgdG90YWxHZXJhbCA9IDA7XG5cbiAgICBzdGF0dXNMaXN0LmZvckVhY2goKHN0YXR1cywgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHF1YW50aWRhZGUgPSBkYWRvc1tzdGF0dXNdLmxlbmd0aDtcbiAgICAgIHRvdGFsR2VyYWwgKz0gcXVhbnRpZGFkZTtcblxuICAgICAgY29uc3Qgc3RhdHVzUm93ID0gd29ya3NoZWV0LmdldFJvdyhyb3cgKyBpbmRleCk7XG4gICAgICBzdGF0dXNSb3cuZ2V0Q2VsbCgxKS52YWx1ZSA9IHN0YXR1cztcbiAgICAgIHN0YXR1c1Jvdy5nZXRDZWxsKDIpLnZhbHVlID0gcXVhbnRpZGFkZTtcbiAgICAgIHN0YXR1c1Jvdy5nZXRDZWxsKDMpLnZhbHVlID0gJ3NvbGljaXRhw6fDtWVzJztcbiAgICB9KTtcblxuICAgIHJvdyArPSBzdGF0dXNMaXN0Lmxlbmd0aCArIDE7XG4gICAgY29uc3QgdG90YWxSb3cgPSB3b3Jrc2hlZXQuZ2V0Um93KHJvdyk7XG4gICAgdG90YWxSb3cuZ2V0Q2VsbCgxKS52YWx1ZSA9ICdUb3RhbCBHZXJhbCc7XG4gICAgdG90YWxSb3cuZ2V0Q2VsbCgyKS52YWx1ZSA9IHRvdGFsR2VyYWw7XG4gICAgdG90YWxSb3cuZ2V0Q2VsbCgzKS52YWx1ZSA9ICdzb2xpY2l0YcOnw7Vlcyc7XG4gICAgdG90YWxSb3cuZ2V0Q2VsbCgxKS5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgdG90YWxSb3cuZ2V0Q2VsbCgyKS5mb250ID0geyBib2xkOiB0cnVlIH07XG5cbiAgICAvLyBBZGljaW9uYXIgZGV0YWxoYW1lbnRvIHBvciBzdGF0dXMgZW0gbm92YXMgcGxhbmlsaGFzXG4gICAgaWYgKHdvcmtzaGVldC53b3JrYm9vaykge1xuICAgICAgc3RhdHVzTGlzdC5mb3JFYWNoKChzdGF0dXMpID0+IHtcbiAgICAgICAgdGhpcy5jcmlhclBsYW5pbGhhU3RhdHVzKHdvcmtzaGVldC53b3JrYm9vaywgc3RhdHVzLCBkYWRvc1tzdGF0dXNdKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmlhIHVtYSBub3ZhIHBsYW5pbGhhIHBhcmEgdW0gc3RhdHVzIGVzcGVjw61maWNvXG4gICAqIEBwYXJhbSB3b3JrYm9vayBXb3JrYm9vayBFeGNlbFxuICAgKiBAcGFyYW0gc3RhdHVzIE5vbWUgZG8gc3RhdHVzXG4gICAqIEBwYXJhbSBzb2xpY2l0YWNvZXMgTGlzdGEgZGUgc29saWNpdGHDp8O1ZXMgY29tIGVzdGUgc3RhdHVzXG4gICAqL1xuICBwcml2YXRlIGNyaWFyUGxhbmlsaGFTdGF0dXMoXG4gICAgd29ya2Jvb2s6IEV4Y2VsSlMuV29ya2Jvb2ssXG4gICAgc3RhdHVzOiBzdHJpbmcsXG4gICAgc29saWNpdGFjb2VzOiBhbnlbXSxcbiAgKTogRXhjZWxKUy5Xb3Jrc2hlZXQge1xuICAgIGNvbnN0IHN0YXR1c1dvcmtzaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldChgU3RhdHVzIC0gJHtzdGF0dXN9YCk7XG5cbiAgICAvLyBBZGljaW9uYXIgdMOtdHVsb1xuICAgIHN0YXR1c1dvcmtzaGVldC5tZXJnZUNlbGxzKCdBMTpFMScpO1xuICAgIGNvbnN0IHRpdHVsb0NlbGwgPSBzdGF0dXNXb3Jrc2hlZXQuZ2V0Q2VsbCgnQTEnKTtcbiAgICB0aXR1bG9DZWxsLnZhbHVlID0gYFNvbGljaXRhw6fDtWVzIGNvbSBTdGF0dXM6ICR7c3RhdHVzfWA7XG4gICAgdGl0dWxvQ2VsbC5mb250ID0geyBzaXplOiAxNiwgYm9sZDogdHJ1ZSB9O1xuICAgIHRpdHVsb0NlbGwuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJyB9O1xuXG4gICAgLy8gQWRpY2lvbmFyIGRhdGEgZGUgZ2VyYcOnw6NvXG4gICAgc3RhdHVzV29ya3NoZWV0Lm1lcmdlQ2VsbHMoJ0EyOkUyJyk7XG4gICAgY29uc3QgZGF0YUdlcmFjYW9DZWxsID0gc3RhdHVzV29ya3NoZWV0LmdldENlbGwoJ0EyJyk7XG4gICAgZGF0YUdlcmFjYW9DZWxsLnZhbHVlID0gYEdlcmFkbyBlbTogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicpfWA7XG4gICAgZGF0YUdlcmFjYW9DZWxsLmZvbnQgPSB7IHNpemU6IDEwIH07XG4gICAgZGF0YUdlcmFjYW9DZWxsLmFsaWdubWVudCA9IHsgaG9yaXpvbnRhbDogJ3JpZ2h0JyB9O1xuXG4gICAgLy8gQWRpY2lvbmFyIGxpbmhhIGVtIGJyYW5jb1xuICAgIHN0YXR1c1dvcmtzaGVldC5hZGRSb3coW10pO1xuXG4gICAgLy8gQWRpY2lvbmFyIGNhYmXDp2FsaG8gZGEgdGFiZWxhXG4gICAgY29uc3QgY2FiZWNhbGhvID0gW1xuICAgICAgJ1Byb3RvY29sbycsXG4gICAgICAnQmVuZWZpY2nDoXJpbycsXG4gICAgICAnQmVuZWbDrWNpbycsXG4gICAgICAnVW5pZGFkZScsXG4gICAgICAnRGF0YSBBYmVydHVyYScsXG4gICAgXTtcbiAgICBjb25zdCBoZWFkZXJSb3cgPSBzdGF0dXNXb3Jrc2hlZXQuYWRkUm93KGNhYmVjYWxobyk7XG4gICAgaGVhZGVyUm93LmVhY2hDZWxsKChjZWxsKSA9PiB7XG4gICAgICBjZWxsLmZvbnQgPSB7IGJvbGQ6IHRydWUgfTtcbiAgICAgIGNlbGwuZmlsbCA9IHtcbiAgICAgICAgdHlwZTogJ3BhdHRlcm4nLFxuICAgICAgICBwYXR0ZXJuOiAnc29saWQnLFxuICAgICAgICBmZ0NvbG9yOiB7IGFyZ2I6ICdGRkQ5RDlEOScgfSxcbiAgICAgIH07XG4gICAgICBjZWxsLmJvcmRlciA9IHtcbiAgICAgICAgdG9wOiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgbGVmdDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIGJvdHRvbTogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIHJpZ2h0OiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBBZGljaW9uYXIgZGFkb3NcbiAgICBzb2xpY2l0YWNvZXMuZm9yRWFjaCgoc29saWNpdGFjYW8pID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IHN0YXR1c1dvcmtzaGVldC5hZGRSb3coW1xuICAgICAgICBzb2xpY2l0YWNhby5wcm90b2NvbG8gfHwgJycsXG4gICAgICAgIHNvbGljaXRhY2FvLmJlbmVmaWNpYXJpbz8ubm9tZSB8fCAnTi9BJyxcbiAgICAgICAgc29saWNpdGFjYW8udGlwb19iZW5lZmljaW8/Lm5vbWUgfHwgJ04vQScsXG4gICAgICAgIHNvbGljaXRhY2FvLnVuaWRhZGU/Lm5vbWUgfHwgJ04vQScsXG4gICAgICAgIHNvbGljaXRhY2FvLmRhdGFfYWJlcnR1cmFcbiAgICAgICAgICA/IG5ldyBEYXRlKHNvbGljaXRhY2FvLmRhdGFfYWJlcnR1cmEpLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKVxuICAgICAgICAgIDogJ04vQScsXG4gICAgICBdKTtcblxuICAgICAgcm93LmVhY2hDZWxsKChjZWxsKSA9PiB7XG4gICAgICAgIGNlbGwuYm9yZGVyID0ge1xuICAgICAgICAgIHRvcDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgICAgbGVmdDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgICAgYm90dG9tOiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgICByaWdodDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIEF1dG8tYWp1c3RhciBjb2x1bmFzXG4gICAgaWYgKHN0YXR1c1dvcmtzaGVldC5jb2x1bW5zKSB7XG4gICAgICBzdGF0dXNXb3Jrc2hlZXQuY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcbiAgICAgICAgaWYgKGNvbHVtbiAmJiB0eXBlb2YgY29sdW1uLmVhY2hDZWxsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgbGV0IG1heENvbHVtbkxlbmd0aCA9IDA7XG4gICAgICAgICAgY29sdW1uLmVhY2hDZWxsKHsgaW5jbHVkZUVtcHR5OiB0cnVlIH0sIChjZWxsKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2x1bW5MZW5ndGggPSBjZWxsLnZhbHVlID8gY2VsbC52YWx1ZS50b1N0cmluZygpLmxlbmd0aCA6IDEwO1xuICAgICAgICAgICAgaWYgKGNvbHVtbkxlbmd0aCA+IG1heENvbHVtbkxlbmd0aCkge1xuICAgICAgICAgICAgICBtYXhDb2x1bW5MZW5ndGggPSBjb2x1bW5MZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29sdW1uLndpZHRoID0gbWF4Q29sdW1uTGVuZ3RoIDwgMTAgPyAxMCA6IG1heENvbHVtbkxlbmd0aCArIDI7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBzdGF0dXNXb3Jrc2hlZXQ7XG4gIH1cblxuICAvKipcbiAgICogR2VyYSBjb250ZcO6ZG8gcGFyYSByZWxhdMOzcmlvIGRlIGF0ZW5kaW1lbnRvcyBwb3IgdW5pZGFkZVxuICAgKiBAcGFyYW0gd29ya3NoZWV0IFBsYW5pbGhhIEV4Y2VsXG4gICAqIEBwYXJhbSBkYWRvcyBEYWRvcyBwYXJhIG8gcmVsYXTDs3Jpb1xuICAgKiBAcGFyYW0gb3Bjb2VzIE9ww6fDtWVzIGRlIGNvbmZpZ3VyYcOnw6NvXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdlcmFyQXRlbmRpbWVudG9zUG9yVW5pZGFkZShcbiAgICB3b3Jrc2hlZXQ6IEV4Y2VsSlMuV29ya3NoZWV0LFxuICAgIGRhZG9zOiBhbnlbXSxcbiAgICBvcGNvZXM6IGFueSxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gQWRpY2lvbmFyIGNhYmXDp2FsaG8gZGEgdGFiZWxhXG4gICAgY29uc3QgY2FiZWNhbGhvID0gW1xuICAgICAgJ1VuaWRhZGUnLFxuICAgICAgJ1RvdGFsIFNvbGljaXRhw6fDtWVzJyxcbiAgICAgICdMaWJlcmFkYXMnLFxuICAgICAgJ1BlbmRlbnRlcycsXG4gICAgICAnVGF4YSBBcHJvdmHDp8OjbycsXG4gICAgXTtcbiAgICBjb25zdCBoZWFkZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KGNhYmVjYWxobyk7XG4gICAgaGVhZGVyUm93LmVhY2hDZWxsKChjZWxsKSA9PiB7XG4gICAgICBjZWxsLmZvbnQgPSB7IGJvbGQ6IHRydWUgfTtcbiAgICAgIGNlbGwuZmlsbCA9IHtcbiAgICAgICAgdHlwZTogJ3BhdHRlcm4nLFxuICAgICAgICBwYXR0ZXJuOiAnc29saWQnLFxuICAgICAgICBmZ0NvbG9yOiB7IGFyZ2I6ICdGRkQ5RDlEOScgfSxcbiAgICAgIH07XG4gICAgICBjZWxsLmJvcmRlciA9IHtcbiAgICAgICAgdG9wOiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgbGVmdDogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIGJvdHRvbTogeyBzdHlsZTogJ3RoaW4nIH0sXG4gICAgICAgIHJpZ2h0OiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBBZGljaW9uYXIgZGFkb3NcbiAgICBkYWRvcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCB0YXhhQXByb3ZhY2FvID1cbiAgICAgICAgaXRlbS50b3RhbFNvbGljaXRhY29lcyA+IDBcbiAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgKGl0ZW0uc29saWNpdGFjb2VzTGliZXJhZGFzIC8gaXRlbS50b3RhbFNvbGljaXRhY29lcykgKlxuICAgICAgICAgICAgICAxMDBcbiAgICAgICAgICAgICkudG9GaXhlZCgyKVxuICAgICAgICAgIDogJzAuMDAnO1xuXG4gICAgICBjb25zdCByb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFtcbiAgICAgICAgaXRlbS51bmlkYWRlLm5vbWUgfHwgJ04vQScsXG4gICAgICAgIGl0ZW0udG90YWxTb2xpY2l0YWNvZXMsXG4gICAgICAgIGl0ZW0uc29saWNpdGFjb2VzTGliZXJhZGFzLFxuICAgICAgICBpdGVtLnNvbGljaXRhY29lc1BlbmRlbnRlcyxcbiAgICAgICAgYCR7dGF4YUFwcm92YWNhb30lYCxcbiAgICAgIF0pO1xuXG4gICAgICByb3cuZWFjaENlbGwoKGNlbGwpID0+IHtcbiAgICAgICAgY2VsbC5ib3JkZXIgPSB7XG4gICAgICAgICAgdG9wOiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgICBsZWZ0OiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgICBib3R0b206IHsgc3R5bGU6ICd0aGluJyB9LFxuICAgICAgICAgIHJpZ2h0OiB7IHN0eWxlOiAndGhpbicgfSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gQWRpY2lvbmFyIGxpbmhhIGVtIGJyYW5jb1xuICAgIHdvcmtzaGVldC5hZGRSb3coW10pO1xuXG4gICAgLy8gQWRpY2lvbmFyIHRvdGFpc1xuICAgIGNvbnN0IHRvdGFpcyA9IGRhZG9zLnJlZHVjZShcbiAgICAgIChhY2MsIGl0ZW0pID0+IHtcbiAgICAgICAgYWNjLnRvdGFsICs9IGl0ZW0udG90YWxTb2xpY2l0YWNvZXM7XG4gICAgICAgIGFjYy5saWJlcmFkYXMgKz0gaXRlbS5zb2xpY2l0YWNvZXNMaWJlcmFkYXM7XG4gICAgICAgIGFjYy5wZW5kZW50ZXMgKz0gaXRlbS5zb2xpY2l0YWNvZXNQZW5kZW50ZXM7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LFxuICAgICAgeyB0b3RhbDogMCwgbGliZXJhZGFzOiAwLCBwZW5kZW50ZXM6IDAgfSxcbiAgICApO1xuXG4gICAgY29uc3QgdGF4YUdlcmFsID1cbiAgICAgIHRvdGFpcy50b3RhbCA+IDBcbiAgICAgICAgPyAoKHRvdGFpcy5saWJlcmFkYXMgLyB0b3RhaXMudG90YWwpICogMTAwKS50b0ZpeGVkKDIpXG4gICAgICAgIDogJzAuMDAnO1xuXG4gICAgY29uc3QgdG90YWxSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFtcbiAgICAgICdUb3RhbCBHZXJhbCcsXG4gICAgICB0b3RhaXMudG90YWwsXG4gICAgICB0b3RhaXMubGliZXJhZGFzLFxuICAgICAgdG90YWlzLnBlbmRlbnRlcyxcbiAgICAgIGAke3RheGFHZXJhbH0lYCxcbiAgICBdKTtcbiAgICB0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCkgPT4ge1xuICAgICAgY2VsbC5mb250ID0geyBib2xkOiB0cnVlIH07XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==