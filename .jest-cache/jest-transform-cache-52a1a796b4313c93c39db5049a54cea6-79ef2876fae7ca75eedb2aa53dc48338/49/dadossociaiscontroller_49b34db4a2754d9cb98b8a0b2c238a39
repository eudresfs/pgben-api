229f0fb08aceb1a146aa563c0bc206eb
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h;
Object.defineProperty(exports, "__esModule", { value: true });
exports.DadosSociaisController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const jwt_auth_guard_1 = require("../../../auth/guards/jwt-auth.guard");
const permission_guard_1 = require("../../../auth/guards/permission.guard");
const requires_permission_decorator_1 = require("../../../auth/decorators/requires-permission.decorator");
const dados_sociais_service_1 = require("../services/dados-sociais.service");
const create_dados_sociais_dto_1 = require("../dto/create-dados-sociais.dto");
const update_dados_sociais_dto_1 = require("../dto/update-dados-sociais.dto");
const dados_sociais_response_dto_1 = require("../dto/dados-sociais-response.dto");
const cidadao_audit_interceptor_1 = require("../interceptors/cidadao-audit.interceptor");
/**
 * Controller responsável pelo gerenciamento dos dados sociais dos cidadãos
 *
 * Fornece endpoints para CRUD completo dos dados sociais, incluindo:
 * - Criação de dados sociais para um cidadão
 * - Consulta de dados sociais existentes
 * - Atualização de dados sociais
 * - Remoção de dados sociais
 *
 * Todas as operações incluem validações de negócio e auditoria automática.
 */
let DadosSociaisController = class DadosSociaisController {
    dadosSociaisService;
    logger;
    constructor(dadosSociaisService, logger) {
        this.dadosSociaisService = dadosSociaisService;
        this.logger = logger;
    }
    /**
     * Cria dados sociais para um cidadão específico
     *
     * Valida se o cidadão existe e se não possui dados sociais já cadastrados.
     * Calcula automaticamente a renda per capita baseada na composição familiar.
     */
    async create(cidadaoId, createDadosSociaisDto) {
        try {
            const dadosSociais = await this.dadosSociaisService.create(cidadaoId, createDadosSociaisDto);
            return new dados_sociais_response_dto_1.DadosSociaisResponseDto(dadosSociais);
        }
        catch (error) {
            if (error instanceof common_1.BadRequestException || error instanceof common_1.ConflictException || error instanceof common_1.NotFoundException) {
                throw error;
            }
            this.logger.error(`Erro ao criar dados sociais para cidadão ${cidadaoId}`, error.stack);
            throw new common_1.InternalServerErrorException('Erro interno do servidor ao criar dados sociais');
        }
    }
    /**
     * Busca os dados sociais de um cidadão específico
     *
     * Retorna os dados sociais completos incluindo informações calculadas
     * como renda per capita e status de benefícios.
     */
    async findByCidadaoId(cidadaoId) {
        const dadosSociais = await this.dadosSociaisService.findByCidadaoId(cidadaoId);
        return new dados_sociais_response_dto_1.DadosSociaisResponseDto(dadosSociais);
    }
    /**
     * Atualiza os dados sociais de um cidadão
     *
     * Permite atualização parcial dos dados sociais.
     * Recalcula automaticamente valores derivados como renda per capita.
     */
    async update(cidadaoId, updateDadosSociaisDto) {
        try {
            const dadosSociais = await this.dadosSociaisService.update(cidadaoId, updateDadosSociaisDto);
            return new dados_sociais_response_dto_1.DadosSociaisResponseDto(dadosSociais);
        }
        catch (error) {
            if (error instanceof common_1.BadRequestException || error instanceof common_1.NotFoundException) {
                throw error;
            }
            this.logger.error(`Erro ao atualizar dados sociais ${cidadaoId}`, error.stack);
            throw new common_1.InternalServerErrorException('Erro interno do servidor ao atualizar dados sociais');
        }
    }
    /**
     * Remove os dados sociais de um cidadão
     *
     * Realiza soft delete dos dados sociais, mantendo histórico para auditoria.
     * Verifica dependências antes da remoção.
     */
    async remove(cidadaoId) {
        await this.dadosSociaisService.remove(cidadaoId);
    }
};
exports.DadosSociaisController = DadosSociaisController;
__decorate([
    (0, common_1.Post)(':id/dados-sociais'),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao:dados-sociais:create' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Criar dados sociais para um cidadão',
        description: 'Cria novos dados sociais para um cidadão. Valida automaticamente a consistência dos dados de benefícios (PBF/BPC) e calcula a renda per capita familiar.'
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        description: 'ID do cidadão',
        type: 'string',
        format: 'uuid'
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Dados sociais criados com sucesso',
        type: dados_sociais_response_dto_1.DadosSociaisResponseDto
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Dados inválidos - Verifique os campos obrigatórios e valores dos benefícios',
        schema: {
            type: 'object',
            properties: {
                message: { type: 'string', example: 'Dados de benefícios inválidos' },
                errors: {
                    type: 'array',
                    items: { type: 'string' },
                    example: ['Valor do PBF é obrigatório e deve ser maior que zero quando recebe_pbf é verdadeiro']
                },
                statusCode: { type: 'number', example: 400 }
            }
        }
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Token de autenticação inválido ou expirado' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Usuário sem permissão para criar dados sociais' }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão não encontrado'
    }),
    (0, swagger_1.ApiResponse)({
        status: 409,
        description: 'Conflito - Dados sociais já existem para este cidadão',
        schema: {
            type: 'object',
            properties: {
                message: { type: 'string', example: 'Dados sociais já existem para este cidadão' },
                statusCode: { type: 'number', example: 409 }
            }
        }
    }),
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_c = typeof create_dados_sociais_dto_1.CreateDadosSociaisDto !== "undefined" && create_dados_sociais_dto_1.CreateDadosSociaisDto) === "function" ? _c : Object]),
    __metadata("design:returntype", typeof (_d = typeof Promise !== "undefined" && Promise) === "function" ? _d : Object)
], DadosSociaisController.prototype, "create", null);
__decorate([
    (0, common_1.Get)(':id/dados-sociais'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao:dados-sociais:read' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Buscar dados sociais de um cidadão',
        description: 'Retorna os dados sociais completos do cidadão especificado, incluindo cálculos automáticos.'
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        description: 'ID do cidadão',
        type: 'string',
        format: 'uuid'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Dados sociais encontrados',
        type: dados_sociais_response_dto_1.DadosSociaisResponseDto
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão ou dados sociais não encontrados'
    }),
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], DadosSociaisController.prototype, "findByCidadaoId", null);
__decorate([
    (0, common_1.Put)(':id/dados-sociais'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao:dados-sociais:update' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Atualizar dados sociais de um cidadão',
        description: 'Atualiza dados sociais existentes. Revalida automaticamente a consistência dos dados de benefícios e recalcula a renda per capita familiar.'
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        description: 'ID único dos dados sociais a serem atualizados',
        type: 'string',
        format: 'uuid'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Dados sociais atualizados com sucesso',
        type: dados_sociais_response_dto_1.DadosSociaisResponseDto
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Dados inválidos - Verifique os campos e valores dos benefícios',
        schema: {
            type: 'object',
            properties: {
                message: { type: 'string', example: 'Dados de benefícios inválidos' },
                errors: {
                    type: 'array',
                    items: { type: 'string' },
                    example: ['Valor do BPC não pode exceder R$ 10.000,00']
                },
                statusCode: { type: 'number', example: 400 }
            }
        }
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Token de autenticação inválido ou expirado' }),
    (0, swagger_1.ApiResponse)({ status: 403, description: 'Usuário sem permissão para atualizar dados sociais' }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Dados sociais não encontrados',
        schema: {
            type: 'object',
            properties: {
                message: { type: 'string', example: 'Dados sociais não encontrados' },
                statusCode: { type: 'number', example: 404 }
            }
        }
    }),
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_f = typeof update_dados_sociais_dto_1.UpdateDadosSociaisDto !== "undefined" && update_dados_sociais_dto_1.UpdateDadosSociaisDto) === "function" ? _f : Object]),
    __metadata("design:returntype", typeof (_g = typeof Promise !== "undefined" && Promise) === "function" ? _g : Object)
], DadosSociaisController.prototype, "update", null);
__decorate([
    (0, common_1.Delete)(':id/dados-sociais'),
    (0, common_1.HttpCode)(common_1.HttpStatus.NO_CONTENT),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao:dados-sociais:delete' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Remover dados sociais de um cidadão',
        description: 'Remove os dados sociais do cidadão (soft delete). Verifica dependências antes da remoção.'
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        description: 'ID do cidadão',
        type: 'string',
        format: 'uuid'
    }),
    (0, swagger_1.ApiResponse)({
        status: 204,
        description: 'Dados sociais removidos com sucesso'
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão ou dados sociais não encontrados'
    }),
    (0, swagger_1.ApiResponse)({
        status: 409,
        description: 'Não é possível remover dados sociais devido a dependências'
    }),
    __param(0, (0, common_1.Param)('id', common_1.ParseUUIDPipe)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_h = typeof Promise !== "undefined" && Promise) === "function" ? _h : Object)
], DadosSociaisController.prototype, "remove", null);
exports.DadosSociaisController = DadosSociaisController = __decorate([
    (0, swagger_1.ApiTags)('Cidadão'),
    (0, common_1.Controller)('cidadao'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, permission_guard_1.PermissionGuard),
    (0, swagger_1.ApiBearerAuth)(),
    (0, common_1.UseInterceptors)(cidadao_audit_interceptor_1.CidadaoAuditInterceptor),
    __metadata("design:paramtypes", [typeof (_a = typeof dados_sociais_service_1.DadosSociaisService !== "undefined" && dados_sociais_service_1.DadosSociaisService) === "function" ? _a : Object, typeof (_b = typeof common_1.Logger !== "undefined" && common_1.Logger) === "function" ? _b : Object])
], DadosSociaisController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNpZGFkYW9cXGNvbnRyb2xsZXJzXFxkYWRvcy1zb2NpYWlzLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQWtCd0I7QUFDeEIsNkNBQThGO0FBQzlGLHdFQUFtRTtBQUNuRSw0RUFBd0U7QUFDeEUsMEdBQTRGO0FBQzVGLDZFQUF3RTtBQUN4RSw4RUFBd0U7QUFDeEUsOEVBQXdFO0FBQ3hFLGtGQUE0RTtBQUM1RSx5RkFBb0Y7QUFHcEY7Ozs7Ozs7Ozs7R0FVRztBQU1JLElBQU0sc0JBQXNCLEdBQTVCLE1BQU0sc0JBQXNCO0lBRWQ7SUFDQTtJQUZuQixZQUNtQixtQkFBd0MsRUFDeEMsTUFBYztRQURkLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsV0FBTSxHQUFOLE1BQU0sQ0FBUTtJQUM5QixDQUFDO0lBRUo7Ozs7O09BS0c7SUFvREcsQUFBTixLQUFLLENBQUMsTUFBTSxDQUNrQixTQUFpQixFQUNyQyxxQkFBNEM7UUFFcEQsSUFBSSxDQUFDO1lBQ0gsTUFBTSxZQUFZLEdBQUcsTUFBTSxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO1lBQzdGLE9BQU8sSUFBSSxvREFBdUIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNuRCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLElBQUksS0FBSyxZQUFZLDRCQUFtQixJQUFJLEtBQUssWUFBWSwwQkFBaUIsSUFBSSxLQUFLLFlBQVksMEJBQWlCLEVBQUUsQ0FBQztnQkFDckgsTUFBTSxLQUFLLENBQUM7WUFDZCxDQUFDO1lBQ0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsNENBQTRDLFNBQVMsRUFBRSxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FB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QUFNLEVBQUUsR0FBRztRQUNYLFdBQVcsRUFBRSxxQ0FBcUM7S0FDbkQsQ0FBQztJQUNELElBQUEscUJBQVcsRUFBQztRQUNYLE1BQU0sRUFBRSxHQUFHO1FBQ1gsV0FBVyxFQUFFLDBDQUEwQztLQUN4RCxDQUFDO0lBQ0QsSUFBQSxxQkFBVyxFQUFDO1FBQ1gsTUFBTSxFQUFFLEdBQUc7UUFDWCxXQUFXLEVBQUUsNERBQTREO0tBQzFFLENBQUM7SUFFQyxXQUFBLElBQUEsY0FBSyxFQUFDLElBQUksRUFBRSxzQkFBYSxDQUFDLENBQUE7Ozt3REFDMUIsT0FBTyxvQkFBUCxPQUFPO29EQUVUO2lDQXhOVSxzQkFBc0I7SUFMbEMsSUFBQSxpQkFBTyxFQUFDLFNBQVMsQ0FBQztJQUNsQixJQUFBLG1CQUFVLEVBQUMsU0FBUyxDQUFDO0lBQ3JCLElBQUEsa0JBQVMsRUFBQyw2QkFBWSxFQUFFLGtDQUFlLENBQUM7SUFDeEMsSUFBQSx1QkFBYSxHQUFFO0lBQ2YsSUFBQSx3QkFBZSxFQUFDLG1EQUF1QixDQUFDO3lEQUdDLDJDQUFtQixvQkFBbkIsMkNBQW1CLG9EQUNoQyxlQUFNLG9CQUFOLGVBQU07R0FIdEIsc0JBQXNCLENBeU5sQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcY2lkYWRhb1xcY29udHJvbGxlcnNcXGRhZG9zLXNvY2lhaXMuY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb250cm9sbGVyLFxuICBHZXQsXG4gIFBvc3QsXG4gIFB1dCxcbiAgRGVsZXRlLFxuICBCb2R5LFxuICBQYXJhbSxcbiAgVXNlR3VhcmRzLFxuICBIdHRwU3RhdHVzLFxuICBIdHRwQ29kZSxcbiAgUGFyc2VVVUlEUGlwZSxcbiAgVXNlSW50ZXJjZXB0b3JzLFxuICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICBDb25mbGljdEV4Y2VwdGlvbixcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbixcbiAgTm90Rm91bmRFeGNlcHRpb24sXG4gIExvZ2dlcixcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQXBpVGFncywgQXBpT3BlcmF0aW9uLCBBcGlSZXNwb25zZSwgQXBpQmVhcmVyQXV0aCwgQXBpUGFyYW0gfSBmcm9tICdAbmVzdGpzL3N3YWdnZXInO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgUGVybWlzc2lvbkd1YXJkIH0gZnJvbSAnLi4vLi4vLi4vYXV0aC9ndWFyZHMvcGVybWlzc2lvbi5ndWFyZCc7XG5pbXBvcnQgeyBSZXF1aXJlc1Blcm1pc3Npb24gfSBmcm9tICcuLi8uLi8uLi9hdXRoL2RlY29yYXRvcnMvcmVxdWlyZXMtcGVybWlzc2lvbi5kZWNvcmF0b3InO1xuaW1wb3J0IHsgRGFkb3NTb2NpYWlzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2RhZG9zLXNvY2lhaXMuc2VydmljZSc7XG5pbXBvcnQgeyBDcmVhdGVEYWRvc1NvY2lhaXNEdG8gfSBmcm9tICcuLi9kdG8vY3JlYXRlLWRhZG9zLXNvY2lhaXMuZHRvJztcbmltcG9ydCB7IFVwZGF0ZURhZG9zU29jaWFpc0R0byB9IGZyb20gJy4uL2R0by91cGRhdGUtZGFkb3Mtc29jaWFpcy5kdG8nO1xuaW1wb3J0IHsgRGFkb3NTb2NpYWlzUmVzcG9uc2VEdG8gfSBmcm9tICcuLi9kdG8vZGFkb3Mtc29jaWFpcy1yZXNwb25zZS5kdG8nO1xuaW1wb3J0IHsgQ2lkYWRhb0F1ZGl0SW50ZXJjZXB0b3IgfSBmcm9tICcuLi9pbnRlcmNlcHRvcnMvY2lkYWRhby1hdWRpdC5pbnRlcmNlcHRvcic7XG5pbXBvcnQgeyBEYWRvc1NvY2lhaXMgfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9kYWRvcy1zb2NpYWlzLmVudGl0eSc7XG5cbi8qKlxuICogQ29udHJvbGxlciByZXNwb25zw6F2ZWwgcGVsbyBnZXJlbmNpYW1lbnRvIGRvcyBkYWRvcyBzb2NpYWlzIGRvcyBjaWRhZMOjb3NcbiAqIFxuICogRm9ybmVjZSBlbmRwb2ludHMgcGFyYSBDUlVEIGNvbXBsZXRvIGRvcyBkYWRvcyBzb2NpYWlzLCBpbmNsdWluZG86XG4gKiAtIENyaWHDp8OjbyBkZSBkYWRvcyBzb2NpYWlzIHBhcmEgdW0gY2lkYWTDo29cbiAqIC0gQ29uc3VsdGEgZGUgZGFkb3Mgc29jaWFpcyBleGlzdGVudGVzXG4gKiAtIEF0dWFsaXphw6fDo28gZGUgZGFkb3Mgc29jaWFpc1xuICogLSBSZW1vw6fDo28gZGUgZGFkb3Mgc29jaWFpc1xuICogXG4gKiBUb2RhcyBhcyBvcGVyYcOnw7VlcyBpbmNsdWVtIHZhbGlkYcOnw7VlcyBkZSBuZWfDs2NpbyBlIGF1ZGl0b3JpYSBhdXRvbcOhdGljYS5cbiAqL1xuQEFwaVRhZ3MoJ0NpZGFkw6NvJylcbkBDb250cm9sbGVyKCdjaWRhZGFvJylcbkBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkLCBQZXJtaXNzaW9uR3VhcmQpXG5AQXBpQmVhcmVyQXV0aCgpXG5AVXNlSW50ZXJjZXB0b3JzKENpZGFkYW9BdWRpdEludGVyY2VwdG9yKVxuZXhwb3J0IGNsYXNzIERhZG9zU29jaWFpc0NvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRhZG9zU29jaWFpc1NlcnZpY2U6IERhZG9zU29jaWFpc1NlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dnZXI6IExvZ2dlclxuICApIHt9XG5cbiAgLyoqXG4gICAqIENyaWEgZGFkb3Mgc29jaWFpcyBwYXJhIHVtIGNpZGFkw6NvIGVzcGVjw61maWNvXG4gICAqIFxuICAgKiBWYWxpZGEgc2UgbyBjaWRhZMOjbyBleGlzdGUgZSBzZSBuw6NvIHBvc3N1aSBkYWRvcyBzb2NpYWlzIGrDoSBjYWRhc3RyYWRvcy5cbiAgICogQ2FsY3VsYSBhdXRvbWF0aWNhbWVudGUgYSByZW5kYSBwZXIgY2FwaXRhIGJhc2VhZGEgbmEgY29tcG9zacOnw6NvIGZhbWlsaWFyLlxuICAgKi9cbiAgQFBvc3QoJzppZC9kYWRvcy1zb2NpYWlzJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuQ1JFQVRFRClcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnY2lkYWRhbzpkYWRvcy1zb2NpYWlzOmNyZWF0ZScgfSlcbiAgQEFwaU9wZXJhdGlvbih7IFxuICAgIHN1bW1hcnk6ICdDcmlhciBkYWRvcyBzb2NpYWlzIHBhcmEgdW0gY2lkYWTDo28nLFxuICAgIGRlc2NyaXB0aW9uOiAnQ3JpYSBub3ZvcyBkYWRvcyBzb2NpYWlzIHBhcmEgdW0gY2lkYWTDo28uIFZhbGlkYSBhdXRvbWF0aWNhbWVudGUgYSBjb25zaXN0w6puY2lhIGRvcyBkYWRvcyBkZSBiZW5lZsOtY2lvcyAoUEJGL0JQQykgZSBjYWxjdWxhIGEgcmVuZGEgcGVyIGNhcGl0YSBmYW1pbGlhci4nXG4gIH0pXG4gIEBBcGlQYXJhbSh7IFxuICAgIG5hbWU6ICdpZCcsIFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgZG8gY2lkYWTDo28nLCBcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBmb3JtYXQ6ICd1dWlkJ1xuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDIwMSwgXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBzb2NpYWlzIGNyaWFkb3MgY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IERhZG9zU29jaWFpc1Jlc3BvbnNlRHRvIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwMCwgXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zIC0gVmVyaWZpcXVlIG9zIGNhbXBvcyBvYnJpZ2F0w7NyaW9zIGUgdmFsb3JlcyBkb3MgYmVuZWbDrWNpb3MnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1lc3NhZ2U6IHsgdHlwZTogJ3N0cmluZycsIGV4YW1wbGU6ICdEYWRvcyBkZSBiZW5lZsOtY2lvcyBpbnbDoWxpZG9zJyB9LFxuICAgICAgICBlcnJvcnM6IHsgXG4gICAgICAgICAgdHlwZTogJ2FycmF5JywgXG4gICAgICAgICAgaXRlbXM6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICBleGFtcGxlOiBbJ1ZhbG9yIGRvIFBCRiDDqSBvYnJpZ2F0w7NyaW8gZSBkZXZlIHNlciBtYWlvciBxdWUgemVybyBxdWFuZG8gcmVjZWJlX3BiZiDDqSB2ZXJkYWRlaXJvJ11cbiAgICAgICAgfSxcbiAgICAgICAgc3RhdHVzQ29kZTogeyB0eXBlOiAnbnVtYmVyJywgZXhhbXBsZTogNDAwIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1Rva2VuIGRlIGF1dGVudGljYcOnw6NvIGludsOhbGlkbyBvdSBleHBpcmFkbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDMsIGRlc2NyaXB0aW9uOiAnVXN1w6FyaW8gc2VtIHBlcm1pc3PDo28gcGFyYSBjcmlhciBkYWRvcyBzb2NpYWlzJyB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwNCwgXG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBuw6NvIGVuY29udHJhZG8nXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogNDA5LCBcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZsaXRvIC0gRGFkb3Mgc29jaWFpcyBqw6EgZXhpc3RlbSBwYXJhIGVzdGUgY2lkYWTDo28nLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1lc3NhZ2U6IHsgdHlwZTogJ3N0cmluZycsIGV4YW1wbGU6ICdEYWRvcyBzb2NpYWlzIGrDoSBleGlzdGVtIHBhcmEgZXN0ZSBjaWRhZMOjbycgfSxcbiAgICAgICAgc3RhdHVzQ29kZTogeyB0eXBlOiAnbnVtYmVyJywgZXhhbXBsZTogNDA5IH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIGFzeW5jIGNyZWF0ZShcbiAgICBAUGFyYW0oJ2lkJywgUGFyc2VVVUlEUGlwZSkgY2lkYWRhb0lkOiBzdHJpbmcsXG4gICAgQEJvZHkoKSBjcmVhdGVEYWRvc1NvY2lhaXNEdG86IENyZWF0ZURhZG9zU29jaWFpc0R0byxcbiAgKTogUHJvbWlzZTxEYWRvc1NvY2lhaXNSZXNwb25zZUR0bz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYWRvc1NvY2lhaXMgPSBhd2FpdCB0aGlzLmRhZG9zU29jaWFpc1NlcnZpY2UuY3JlYXRlKGNpZGFkYW9JZCwgY3JlYXRlRGFkb3NTb2NpYWlzRHRvKTtcbiAgICAgIHJldHVybiBuZXcgRGFkb3NTb2NpYWlzUmVzcG9uc2VEdG8oZGFkb3NTb2NpYWlzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgQmFkUmVxdWVzdEV4Y2VwdGlvbiB8fCBlcnJvciBpbnN0YW5jZW9mIENvbmZsaWN0RXhjZXB0aW9uIHx8IGVycm9yIGluc3RhbmNlb2YgTm90Rm91bmRFeGNlcHRpb24pIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgRXJybyBhbyBjcmlhciBkYWRvcyBzb2NpYWlzIHBhcmEgY2lkYWTDo28gJHtjaWRhZGFvSWR9YCwgZXJyb3Iuc3RhY2spO1xuICAgICAgdGhyb3cgbmV3IEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24oJ0Vycm8gaW50ZXJubyBkbyBzZXJ2aWRvciBhbyBjcmlhciBkYWRvcyBzb2NpYWlzJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJ1c2NhIG9zIGRhZG9zIHNvY2lhaXMgZGUgdW0gY2lkYWTDo28gZXNwZWPDrWZpY29cbiAgICogXG4gICAqIFJldG9ybmEgb3MgZGFkb3Mgc29jaWFpcyBjb21wbGV0b3MgaW5jbHVpbmRvIGluZm9ybWHDp8O1ZXMgY2FsY3VsYWRhc1xuICAgKiBjb21vIHJlbmRhIHBlciBjYXBpdGEgZSBzdGF0dXMgZGUgYmVuZWbDrWNpb3MuXG4gICAqL1xuICBAR2V0KCc6aWQvZGFkb3Mtc29jaWFpcycpXG4gIEBSZXF1aXJlc1Blcm1pc3Npb24oeyBwZXJtaXNzaW9uTmFtZTogJ2NpZGFkYW86ZGFkb3Mtc29jaWFpczpyZWFkJyB9KVxuICBAQXBpT3BlcmF0aW9uKHsgXG4gICAgc3VtbWFyeTogJ0J1c2NhciBkYWRvcyBzb2NpYWlzIGRlIHVtIGNpZGFkw6NvJyxcbiAgICBkZXNjcmlwdGlvbjogJ1JldG9ybmEgb3MgZGFkb3Mgc29jaWFpcyBjb21wbGV0b3MgZG8gY2lkYWTDo28gZXNwZWNpZmljYWRvLCBpbmNsdWluZG8gY8OhbGN1bG9zIGF1dG9tw6F0aWNvcy4nXG4gIH0pXG4gIEBBcGlQYXJhbSh7IFxuICAgIG5hbWU6ICdpZCcsIFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgZG8gY2lkYWTDo28nLCBcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBmb3JtYXQ6ICd1dWlkJ1xuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDIwMCwgXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBzb2NpYWlzIGVuY29udHJhZG9zJyxcbiAgICB0eXBlOiBEYWRvc1NvY2lhaXNSZXNwb25zZUR0b1xuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwNCwgXG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBvdSBkYWRvcyBzb2NpYWlzIG7Do28gZW5jb250cmFkb3MnXG4gIH0pXG4gIGFzeW5jIGZpbmRCeUNpZGFkYW9JZChcbiAgICBAUGFyYW0oJ2lkJywgUGFyc2VVVUlEUGlwZSkgY2lkYWRhb0lkOiBzdHJpbmcsXG4gICk6IFByb21pc2U8RGFkb3NTb2NpYWlzUmVzcG9uc2VEdG8+IHtcbiAgICBjb25zdCBkYWRvc1NvY2lhaXMgPSBhd2FpdCB0aGlzLmRhZG9zU29jaWFpc1NlcnZpY2UuZmluZEJ5Q2lkYWRhb0lkKGNpZGFkYW9JZCk7XG4gICAgcmV0dXJuIG5ldyBEYWRvc1NvY2lhaXNSZXNwb25zZUR0byhkYWRvc1NvY2lhaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dWFsaXphIG9zIGRhZG9zIHNvY2lhaXMgZGUgdW0gY2lkYWTDo29cbiAgICogXG4gICAqIFBlcm1pdGUgYXR1YWxpemHDp8OjbyBwYXJjaWFsIGRvcyBkYWRvcyBzb2NpYWlzLlxuICAgKiBSZWNhbGN1bGEgYXV0b21hdGljYW1lbnRlIHZhbG9yZXMgZGVyaXZhZG9zIGNvbW8gcmVuZGEgcGVyIGNhcGl0YS5cbiAgICovXG4gIEBQdXQoJzppZC9kYWRvcy1zb2NpYWlzJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnY2lkYWRhbzpkYWRvcy1zb2NpYWlzOnVwZGF0ZScgfSlcbiAgQEFwaU9wZXJhdGlvbih7IFxuICAgIHN1bW1hcnk6ICdBdHVhbGl6YXIgZGFkb3Mgc29jaWFpcyBkZSB1bSBjaWRhZMOjbycsXG4gICAgZGVzY3JpcHRpb246ICdBdHVhbGl6YSBkYWRvcyBzb2NpYWlzIGV4aXN0ZW50ZXMuIFJldmFsaWRhIGF1dG9tYXRpY2FtZW50ZSBhIGNvbnNpc3TDqm5jaWEgZG9zIGRhZG9zIGRlIGJlbmVmw61jaW9zIGUgcmVjYWxjdWxhIGEgcmVuZGEgcGVyIGNhcGl0YSBmYW1pbGlhci4nXG4gIH0pXG4gIEBBcGlQYXJhbSh7IFxuICAgIG5hbWU6ICdpZCcsIFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgw7puaWNvIGRvcyBkYWRvcyBzb2NpYWlzIGEgc2VyZW0gYXR1YWxpemFkb3MnLFxuICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIGZvcm1hdDogJ3V1aWQnXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogMjAwLCBcbiAgICBkZXNjcmlwdGlvbjogJ0RhZG9zIHNvY2lhaXMgYXR1YWxpemFkb3MgY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IERhZG9zU29jaWFpc1Jlc3BvbnNlRHRvIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwMCwgXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zIC0gVmVyaWZpcXVlIG9zIGNhbXBvcyBlIHZhbG9yZXMgZG9zIGJlbmVmw61jaW9zJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBtZXNzYWdlOiB7IHR5cGU6ICdzdHJpbmcnLCBleGFtcGxlOiAnRGFkb3MgZGUgYmVuZWbDrWNpb3MgaW52w6FsaWRvcycgfSxcbiAgICAgICAgZXJyb3JzOiB7IFxuICAgICAgICAgIHR5cGU6ICdhcnJheScsIFxuICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgZXhhbXBsZTogWydWYWxvciBkbyBCUEMgbsOjbyBwb2RlIGV4Y2VkZXIgUiQgMTAuMDAwLDAwJ11cbiAgICAgICAgfSxcbiAgICAgICAgc3RhdHVzQ29kZTogeyB0eXBlOiAnbnVtYmVyJywgZXhhbXBsZTogNDAwIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1Rva2VuIGRlIGF1dGVudGljYcOnw6NvIGludsOhbGlkbyBvdSBleHBpcmFkbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDMsIGRlc2NyaXB0aW9uOiAnVXN1w6FyaW8gc2VtIHBlcm1pc3PDo28gcGFyYSBhdHVhbGl6YXIgZGFkb3Mgc29jaWFpcycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiA0MDQsIFxuICAgIGRlc2NyaXB0aW9uOiAnRGFkb3Mgc29jaWFpcyBuw6NvIGVuY29udHJhZG9zJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBtZXNzYWdlOiB7IHR5cGU6ICdzdHJpbmcnLCBleGFtcGxlOiAnRGFkb3Mgc29jaWFpcyBuw6NvIGVuY29udHJhZG9zJyB9LFxuICAgICAgICBzdGF0dXNDb2RlOiB7IHR5cGU6ICdudW1iZXInLCBleGFtcGxlOiA0MDQgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgYXN5bmMgdXBkYXRlKFxuICAgIEBQYXJhbSgnaWQnLCBQYXJzZVVVSURQaXBlKSBjaWRhZGFvSWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIHVwZGF0ZURhZG9zU29jaWFpc0R0bzogVXBkYXRlRGFkb3NTb2NpYWlzRHRvLFxuICApOiBQcm9taXNlPERhZG9zU29jaWFpc1Jlc3BvbnNlRHRvPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhZG9zU29jaWFpcyA9IGF3YWl0IHRoaXMuZGFkb3NTb2NpYWlzU2VydmljZS51cGRhdGUoY2lkYWRhb0lkLCB1cGRhdGVEYWRvc1NvY2lhaXNEdG8pO1xuICAgICAgcmV0dXJuIG5ldyBEYWRvc1NvY2lhaXNSZXNwb25zZUR0byhkYWRvc1NvY2lhaXMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBCYWRSZXF1ZXN0RXhjZXB0aW9uIHx8IGVycm9yIGluc3RhbmNlb2YgTm90Rm91bmRFeGNlcHRpb24pIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgRXJybyBhbyBhdHVhbGl6YXIgZGFkb3Mgc29jaWFpcyAke2NpZGFkYW9JZH1gLCBlcnJvci5zdGFjayk7XG4gICAgICB0aHJvdyBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbignRXJybyBpbnRlcm5vIGRvIHNlcnZpZG9yIGFvIGF0dWFsaXphciBkYWRvcyBzb2NpYWlzJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBvcyBkYWRvcyBzb2NpYWlzIGRlIHVtIGNpZGFkw6NvXG4gICAqIFxuICAgKiBSZWFsaXphIHNvZnQgZGVsZXRlIGRvcyBkYWRvcyBzb2NpYWlzLCBtYW50ZW5kbyBoaXN0w7NyaWNvIHBhcmEgYXVkaXRvcmlhLlxuICAgKiBWZXJpZmljYSBkZXBlbmTDqm5jaWFzIGFudGVzIGRhIHJlbW/Dp8Ojby5cbiAgICovXG4gIEBEZWxldGUoJzppZC9kYWRvcy1zb2NpYWlzJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuTk9fQ09OVEVOVClcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnY2lkYWRhbzpkYWRvcy1zb2NpYWlzOmRlbGV0ZScgfSlcbiAgQEFwaU9wZXJhdGlvbih7IFxuICAgIHN1bW1hcnk6ICdSZW1vdmVyIGRhZG9zIHNvY2lhaXMgZGUgdW0gY2lkYWTDo28nLFxuICAgIGRlc2NyaXB0aW9uOiAnUmVtb3ZlIG9zIGRhZG9zIHNvY2lhaXMgZG8gY2lkYWTDo28gKHNvZnQgZGVsZXRlKS4gVmVyaWZpY2EgZGVwZW5kw6puY2lhcyBhbnRlcyBkYSByZW1vw6fDo28uJ1xuICB9KVxuICBAQXBpUGFyYW0oeyBcbiAgICBuYW1lOiAnaWQnLCBcbiAgICBkZXNjcmlwdGlvbjogJ0lEIGRvIGNpZGFkw6NvJywgXG4gICAgdHlwZTogJ3N0cmluZycsXG4gICAgZm9ybWF0OiAndXVpZCdcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDQsIFxuICAgIGRlc2NyaXB0aW9uOiAnRGFkb3Mgc29jaWFpcyByZW1vdmlkb3MgY29tIHN1Y2Vzc28nXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogNDA0LCBcbiAgICBkZXNjcmlwdGlvbjogJ0NpZGFkw6NvIG91IGRhZG9zIHNvY2lhaXMgbsOjbyBlbmNvbnRyYWRvcydcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiA0MDksIFxuICAgIGRlc2NyaXB0aW9uOiAnTsOjbyDDqSBwb3Nzw612ZWwgcmVtb3ZlciBkYWRvcyBzb2NpYWlzIGRldmlkbyBhIGRlcGVuZMOqbmNpYXMnXG4gIH0pXG4gIGFzeW5jIHJlbW92ZShcbiAgICBAUGFyYW0oJ2lkJywgUGFyc2VVVUlEUGlwZSkgY2lkYWRhb0lkOiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuZGFkb3NTb2NpYWlzU2VydmljZS5yZW1vdmUoY2lkYWRhb0lkKTtcbiAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==