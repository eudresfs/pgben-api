9832c7ab73737833c0d59557cfd09496
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const request = __importStar(require("supertest"));
const typeorm_1 = require("@nestjs/typeorm");
const config_1 = require("@nestjs/config");
const jwt_1 = require("@nestjs/jwt");
const axios_1 = require("@nestjs/axios");
const pagamento_module_1 = require("../../pagamento.module");
const entities_1 = require("../../entities");
const status_pagamento_enum_1 = require("../../enums/status-pagamento.enum");
const metodo_pagamento_enum_1 = require("../../enums/metodo-pagamento.enum");
const pagamento_service_1 = require("../../services/pagamento.service");
const integracao_solicitacao_service_1 = require("../../services/integracao-solicitacao.service");
const integracao_cidadao_service_1 = require("../../services/integracao-cidadao.service");
const integracao_documento_service_1 = require("../../services/integracao-documento.service");
const auditoria_pagamento_service_1 = require("../../services/auditoria-pagamento.service");
/**
 * Testes de integração para segurança do módulo de pagamento
 *
 * Verifica o funcionamento correto dos mecanismos de segurança,
 * incluindo autenticação, autorização e proteção de dados sensíveis.
 *
 * @author Equipe PGBen
 */
describe('Segurança do Módulo de Pagamento (Integration)', () => {
    let app;
    let jwtService;
    let pagamentoService;
    // Dados de teste
    const usuarioId = 'usuario-teste-id';
    const usuarioOutraUnidadeId = 'usuario-outra-unidade-id';
    const solicitacaoId = 'solicitacao-teste-id';
    const unidadeId = 'unidade-teste-id';
    const outraUnidadeId = 'outra-unidade-id';
    const pagamentoId = 'pagamento-teste-id';
    const comprovanteId = 'comprovante-teste-id';
    // Mock dos serviços externos
    const mockIntegracaoSolicitacaoService = {
        verificarStatusSolicitacao: jest
            .fn()
            .mockResolvedValue('PAGAMENTO_PENDENTE'),
        verificarSolicitacaoElegivel: jest.fn().mockResolvedValue(true),
        atualizarStatusSolicitacao: jest.fn().mockResolvedValue(true),
        obterDetalhesSolicitacao: jest.fn().mockResolvedValue({
            id: solicitacaoId,
            unidadeId: unidadeId,
            status: 'PAGAMENTO_PENDENTE',
        }),
    };
    const mockIntegracaoCidadaoService = {
        obterDadosCidadao: jest.fn().mockResolvedValue({
            id: 'cidadao-id',
            nome: 'João da Silva',
            cpf: '12345678900',
        }),
        obterDadosBancarios: jest.fn().mockResolvedValue([
            {
                id: 'info-bancaria-id',
                tipo: 'PIX',
                pixTipo: 'CPF',
                pixChave: '12345678900',
            },
        ]),
        validarDadosBancarios: jest.fn().mockResolvedValue(true),
    };
    const mockIntegracaoDocumentoService = {
        uploadComprovante: jest.fn().mockResolvedValue({
            id: 'documento-id',
            nome: 'comprovante.pdf',
        }),
        obterComprovante: jest.fn().mockResolvedValue({
            id: 'documento-id',
            nome: 'comprovante.pdf',
        }),
        listarComprovantes: jest.fn().mockResolvedValue([]),
        removerComprovante: jest.fn().mockResolvedValue(undefined),
    };
    const mockAuditoriaPagamentoService = {
        logCriacaoPagamento: jest.fn(),
        logMudancaStatus: jest.fn(),
        logCancelamentoPagamento: jest.fn(),
        logUploadComprovante: jest.fn(),
        logRemocaoComprovante: jest.fn(),
        logConfirmacaoRecebimento: jest.fn(),
        logErroProcessamento: jest.fn(),
        logTentativaAcessoNaoAutorizado: jest.fn(),
    };
    // Mock dos repositórios
    const mockPagamentoRepository = {
        create: jest.fn(),
        save: jest.fn(),
        findOne: jest.fn(),
        find: jest.fn(),
        findAndCount: jest.fn(),
        update: jest.fn(),
    };
    const mockComprovanteRepository = {
        create: jest.fn(),
        save: jest.fn(),
        findOne: jest.fn(),
        find: jest.fn(),
        findAndCount: jest.fn(),
        delete: jest.fn(),
    };
    const mockConfirmacaoRepository = {
        create: jest.fn(),
        save: jest.fn(),
        findOne: jest.fn(),
        find: jest.fn(),
        findAndCount: jest.fn(),
    };
    beforeAll(async () => {
        const moduleFixture = await testing_1.Test.createTestingModule({
            imports: [
                pagamento_module_1.PagamentoModule,
                config_1.ConfigModule.forRoot({
                    isGlobal: true,
                    envFilePath: '.env.test',
                }),
                jwt_1.JwtModule.registerAsync({
                    imports: [config_1.ConfigModule],
                    useFactory: async (configService) => ({
                        secret: configService.get('JWT_SECRET') || 'test-secret',
                        signOptions: { expiresIn: '1h' },
                    }),
                    inject: [config_1.ConfigService],
                }),
                axios_1.HttpModule,
            ],
            providers: [
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.Pagamento),
                    useValue: mockPagamentoRepository,
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.ComprovantePagamento),
                    useValue: mockComprovanteRepository,
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.ConfirmacaoRecebimento),
                    useValue: mockConfirmacaoRepository,
                },
            ],
        })
            .overrideProvider(integracao_solicitacao_service_1.IntegracaoSolicitacaoService)
            .useValue(mockIntegracaoSolicitacaoService)
            .overrideProvider(integracao_cidadao_service_1.IntegracaoCidadaoService)
            .useValue(mockIntegracaoCidadaoService)
            .overrideProvider(integracao_documento_service_1.IntegracaoDocumentoService)
            .useValue(mockIntegracaoDocumentoService)
            .overrideProvider(auditoria_pagamento_service_1.AuditoriaPagamentoService)
            .useValue(mockAuditoriaPagamentoService)
            .compile();
        app = moduleFixture.createNestApplication();
        jwtService = moduleFixture.get(jwt_1.JwtService);
        pagamentoService = moduleFixture.get(pagamento_service_1.PagamentoService);
        await app.init();
    });
    afterAll(async () => {
        await app.close();
    });
    beforeEach(() => {
        jest.clearAllMocks();
    });
    // Função auxiliar para gerar tokens JWT com diferentes perfis
    const gerarToken = (userId, perfis = ['usuario'], unidadeId = 'unidade-teste-id') => {
        return jwtService.sign({
            sub: userId,
            perfis,
            unidadeId,
        });
    };
    describe('Autenticação', () => {
        it('deve rejeitar acesso sem token JWT', async () => {
            const response = await request(app.getHttpServer()).get('/pagamentos');
            expect(response.status).toBe(401);
        });
        it('deve rejeitar acesso com token JWT inválido', async () => {
            const response = await request(app.getHttpServer())
                .get('/pagamentos')
                .set('Authorization', 'Bearer token-invalido');
            expect(response.status).toBe(401);
        });
        it('deve permitir acesso com token JWT válido', async () => {
            // Configurar mock
            mockPagamentoRepository.findAndCount.mockResolvedValue([[], 0]);
            const token = gerarToken(usuarioId);
            const response = await request(app.getHttpServer())
                .get('/pagamentos')
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
        });
    });
    describe('Autorização por Perfil', () => {
        it('deve rejeitar acesso a operações administrativas para usuários sem perfil adequado', async () => {
            // Token com perfil básico
            const token = gerarToken(usuarioId, ['usuario_basico']);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/cancelar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                motivo: 'Teste de cancelamento',
            });
            expect(response.status).toBe(403);
            expect(mockAuditoriaPagamentoService.logTentativaAcessoNaoAutorizado).toHaveBeenCalled();
        });
        it('deve permitir acesso a operações administrativas para usuários com perfil adequado', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId,
            });
            mockPagamentoRepository.save.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO,
                unidadeId,
            });
            // Token com perfil administrativo
            const token = gerarToken(usuarioId, ['admin_pagamentos']);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/cancelar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                motivo: 'Teste de cancelamento',
            });
            expect(response.status).toBe(200);
        });
    });
    describe('Segurança por Unidade (Row-Level Security)', () => {
        it('deve rejeitar acesso a pagamentos de outra unidade', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId: outraUnidadeId, // Unidade diferente do usuário
            });
            // Token de usuário de uma unidade específica
            const token = gerarToken(usuarioId, ['usuario'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(403);
            expect(mockAuditoriaPagamentoService.logTentativaAcessoNaoAutorizado).toHaveBeenCalled();
        });
        it('deve permitir acesso a pagamentos da mesma unidade', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId, // Mesma unidade do usuário
            });
            // Token de usuário da mesma unidade
            const token = gerarToken(usuarioId, ['usuario'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
        });
        it('deve permitir acesso global para usuários com perfil super_admin', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId: outraUnidadeId, // Unidade diferente do usuário
            });
            // Token com perfil super_admin
            const token = gerarToken(usuarioId, ['super_admin'], 'qualquer-unidade');
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
        });
    });
    describe('Proteção de Dados Sensíveis', () => {
        it('deve mascarar dados bancários na resposta', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId,
                metodoPagamento: metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX,
                dadosBancarios: {
                    pixTipo: 'CPF',
                    pixChave: '12345678900',
                },
            });
            const token = gerarToken(usuarioId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            // Verificar que a chave PIX está mascarada
            expect(response.body.dadosBancarios.pixChave).not.toBe('12345678900');
            expect(response.body.dadosBancarios.pixChave).toContain('*');
        });
        it('deve mascarar CPF na resposta', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId,
                beneficiario: {
                    id: 'cidadao-id',
                    nome: 'João da Silva',
                    cpf: '12345678900',
                },
            });
            const token = gerarToken(usuarioId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            // Verificar que o CPF está mascarado
            if (response.body.beneficiario && response.body.beneficiario.cpf) {
                expect(response.body.beneficiario.cpf).not.toBe('12345678900');
                expect(response.body.beneficiario.cpf).toContain('*');
            }
        });
    });
    describe('Validação de Uploads', () => {
        it('deve rejeitar uploads de arquivos maliciosos', async () => {
            // Criar arquivo de teste com extensão suspeita
            const buffer = Buffer.from('conteúdo malicioso');
            const token = gerarToken(usuarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/comprovantes`)
                .set('Authorization', `Bearer ${token}`)
                .attach('arquivo', buffer, 'malicioso.exe');
            expect(response.status).toBe(400);
            expect(response.body.message).toContain('não permitido');
        });
        it('deve rejeitar uploads de arquivos muito grandes', async () => {
            // Criar arquivo de teste muito grande (simulado)
            const buffer = Buffer.alloc(6 * 1024 * 1024); // 6MB
            const token = gerarToken(usuarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/comprovantes`)
                .set('Authorization', `Bearer ${token}`)
                .attach('arquivo', buffer, 'grande.pdf');
            expect(response.status).toBe(413); // Payload Too Large
        });
    });
    describe('Proteção contra Ataques', () => {
        it('deve registrar tentativas de acesso não autorizado', async () => {
            // Configurar mock
            mockPagamentoRepository.findOne.mockResolvedValue({
                id: pagamentoId,
                solicitacaoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO,
                unidadeId: outraUnidadeId,
            });
            const token = gerarToken(usuarioId);
            await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(mockAuditoriaPagamentoService.logTentativaAcessoNaoAutorizado).toHaveBeenCalled();
        });
        it('deve limitar taxa de requisições (rate limiting)', async () => {
            const token = gerarToken(usuarioId);
            // Fazer múltiplas requisições em sequência
            const promises = Array(20)
                .fill(0)
                .map(() => request(app.getHttpServer())
                .get('/pagamentos')
                .set('Authorization', `Bearer ${token}`));
            const responses = await Promise.all(promises);
            // Verificar se alguma requisição foi limitada (429 Too Many Requests)
            const limitedRequests = responses.filter((res) => res.status === 429);
            // Em um ambiente real, algumas requisições seriam limitadas
            // No ambiente de teste, isso depende da configuração do rate limiter
            console.log(`Requisições limitadas: ${limitedRequests.length} de ${promises.length}`);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXGludGVncmF0aW9uXFxwYWdhbWVudG8tc2VndXJhbmNhLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw2Q0FBc0Q7QUFFdEQsbURBQXFDO0FBQ3JDLDZDQUFxRDtBQUNyRCwyQ0FBNkQ7QUFDN0QscUNBQW9EO0FBQ3BELHlDQUEyQztBQUUzQyw2REFBeUQ7QUFDekQsNkNBSXdCO0FBQ3hCLDZFQUF3RTtBQUN4RSw2RUFBd0U7QUFDeEUsd0VBQW9FO0FBQ3BFLGtHQUE2RjtBQUM3RiwwRkFBcUY7QUFDckYsOEZBQXlGO0FBQ3pGLDRGQUF1RjtBQUV2Rjs7Ozs7OztHQU9HO0FBQ0gsUUFBUSxDQUFDLGdEQUFnRCxFQUFFLEdBQUcsRUFBRTtJQUM5RCxJQUFJLEdBQXFCLENBQUM7SUFDMUIsSUFBSSxVQUFzQixDQUFDO0lBQzNCLElBQUksZ0JBQWtDLENBQUM7SUFFdkMsaUJBQWlCO0lBQ2pCLE1BQU0sU0FBUyxHQUFHLGtCQUFrQixDQUFDO0lBQ3JDLE1BQU0scUJBQXFCLEdBQUcsMEJBQTBCLENBQUM7SUFDekQsTUFBTSxhQUFhLEdBQUcsc0JBQXNCLENBQUM7SUFDN0MsTUFBTSxTQUFTLEdBQUcsa0JBQWtCLENBQUM7SUFDckMsTUFBTSxjQUFjLEdBQUcsa0JBQWtCLENBQUM7SUFDMUMsTUFBTSxXQUFXLEdBQUcsb0JBQW9CLENBQUM7SUFDekMsTUFBTSxhQUFhLEdBQUcsc0JBQXNCLENBQUM7SUFFN0MsNkJBQTZCO0lBQzdCLE1BQU0sZ0NBQWdDLEdBQUc7UUFDdkMsMEJBQTBCLEVBQUUsSUFBSTthQUM3QixFQUFFLEVBQUU7YUFDSixpQkFBaUIsQ0FBQyxvQkFBb0IsQ0FBQztRQUMxQyw0QkFBNEIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDO1FBQy9ELDBCQUEwQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUM7UUFDN0Qsd0JBQXdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDO1lBQ3BELEVBQUUsRUFBRSxhQUFhO1lBQ2pCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLE1BQU0sRUFBRSxvQkFBb0I7U0FDN0IsQ0FBQztLQUNILENBQUM7SUFFRixNQUFNLDRCQUE0QixHQUFHO1FBQ25DLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztZQUM3QyxFQUFFLEVBQUUsWUFBWTtZQUNoQixJQUFJLEVBQUUsZUFBZTtZQUNyQixHQUFHLEVBQUUsYUFBYTtTQUNuQixDQUFDO1FBQ0YsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDO1lBQy9DO2dCQUNFLEVBQUUsRUFBRSxrQkFBa0I7Z0JBQ3RCLElBQUksRUFBRSxLQUFLO2dCQUNYLE9BQU8sRUFBRSxLQUFLO2dCQUNkLFFBQVEsRUFBRSxhQUFhO2FBQ3hCO1NBQ0YsQ0FBQztRQUNGLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUM7S0FDekQsQ0FBQztJQUVGLE1BQU0sOEJBQThCLEdBQUc7UUFDckMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDO1lBQzdDLEVBQUUsRUFBRSxjQUFjO1lBQ2xCLElBQUksRUFBRSxpQkFBaUI7U0FDeEIsQ0FBQztRQUNGLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztZQUM1QyxFQUFFLEVBQUUsY0FBYztZQUNsQixJQUFJLEVBQUUsaUJBQWlCO1NBQ3hCLENBQUM7UUFDRixrQkFBa0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO1FBQ25ELGtCQUFrQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUM7S0FDM0QsQ0FBQztJQUVGLE1BQU0sNkJBQTZCLEdBQUc7UUFDcEMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUM5QixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzNCLHdCQUF3QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbkMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUMvQixxQkFBcUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hDLHlCQUF5QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDcEMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUMvQiwrQkFBK0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQzNDLENBQUM7SUFFRix3QkFBd0I7SUFDeEIsTUFBTSx1QkFBdUIsR0FBRztRQUM5QixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNqQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDdkIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDbEIsQ0FBQztJQUVGLE1BQU0seUJBQXlCLEdBQUc7UUFDaEMsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNsQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLFlBQVksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3ZCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2xCLENBQUM7SUFFRixNQUFNLHlCQUF5QixHQUFHO1FBQ2hDLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUN4QixDQUFDO0lBRUYsU0FBUyxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ25CLE1BQU0sYUFBYSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUNsRSxPQUFPLEVBQUU7Z0JBQ1Asa0NBQWU7Z0JBQ2YscUJBQVksQ0FBQyxPQUFPLENBQUM7b0JBQ25CLFFBQVEsRUFBRSxJQUFJO29CQUNkLFdBQVcsRUFBRSxXQUFXO2lCQUN6QixDQUFDO2dCQUNGLGVBQVMsQ0FBQyxhQUFhLENBQUM7b0JBQ3RCLE9BQU8sRUFBRSxDQUFDLHFCQUFZLENBQUM7b0JBQ3ZCLFVBQVUsRUFBRSxLQUFLLEVBQUUsYUFBNEIsRUFBRSxFQUFFLENBQUMsQ0FBQzt3QkFDbkQsTUFBTSxFQUFFLGFBQWEsQ0FBQyxHQUFHLENBQVMsWUFBWSxDQUFDLElBQUksYUFBYTt3QkFDaEUsV0FBVyxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRTtxQkFDakMsQ0FBQztvQkFDRixNQUFNLEVBQUUsQ0FBQyxzQkFBYSxDQUFDO2lCQUN4QixDQUFDO2dCQUNGLGtCQUFVO2FBQ1g7WUFDRCxTQUFTLEVBQUU7Z0JBQ1Q7b0JBQ0UsT0FBTyxFQUFFLElBQUEsNEJBQWtCLEVBQUMsb0JBQVMsQ0FBQztvQkFDdEMsUUFBUSxFQUFFLHVCQUF1QjtpQkFDbEM7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLElBQUEsNEJBQWtCLEVBQUMsK0JBQW9CLENBQUM7b0JBQ2pELFFBQVEsRUFBRSx5QkFBeUI7aUJBQ3BDO2dCQUNEO29CQUNFLE9BQU8sRUFBRSxJQUFBLDRCQUFrQixFQUFDLGlDQUFzQixDQUFDO29CQUNuRCxRQUFRLEVBQUUseUJBQXlCO2lCQUNwQzthQUNGO1NBQ0YsQ0FBQzthQUNDLGdCQUFnQixDQUFDLDZEQUE0QixDQUFDO2FBQzlDLFFBQVEsQ0FBQyxnQ0FBZ0MsQ0FBQzthQUMxQyxnQkFBZ0IsQ0FBQyxxREFBd0IsQ0FBQzthQUMxQyxRQUFRLENBQUMsNEJBQTRCLENBQUM7YUFDdEMsZ0JBQWdCLENBQUMseURBQTBCLENBQUM7YUFDNUMsUUFBUSxDQUFDLDhCQUE4QixDQUFDO2FBQ3hDLGdCQUFnQixDQUFDLHVEQUF5QixDQUFDO2FBQzNDLFFBQVEsQ0FBQyw2QkFBNkIsQ0FBQzthQUN2QyxPQUFPLEVBQUUsQ0FBQztRQUViLEdBQUcsR0FBRyxhQUFhLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUM1QyxVQUFVLEdBQUcsYUFBYSxDQUFDLEdBQUcsQ0FBYSxnQkFBVSxDQUFDLENBQUM7UUFDdkQsZ0JBQWdCLEdBQUcsYUFBYSxDQUFDLEdBQUcsQ0FBbUIsb0NBQWdCLENBQUMsQ0FBQztRQUV6RSxNQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNuQixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNsQixNQUFNLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNwQixDQUFDLENBQUMsQ0FBQztJQUVILFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCw4REFBOEQ7SUFDOUQsTUFBTSxVQUFVLEdBQUcsQ0FDakIsTUFBYyxFQUNkLFNBQW1CLENBQUMsU0FBUyxDQUFDLEVBQzlCLFlBQW9CLGtCQUFrQixFQUN0QyxFQUFFO1FBQ0YsT0FBTyxVQUFVLENBQUMsSUFBSSxDQUFDO1lBQ3JCLEdBQUcsRUFBRSxNQUFNO1lBQ1gsTUFBTTtZQUNOLFNBQVM7U0FDVixDQUFDLENBQUM7SUFDTCxDQUFDLENBQUM7SUFFRixRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtRQUM1QixFQUFFLENBQUMsb0NBQW9DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRXZFLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNELE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsR0FBRyxDQUFDLGFBQWEsQ0FBQztpQkFDbEIsR0FBRyxDQUFDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO1lBRWpELE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3pELGtCQUFrQjtZQUNsQix1QkFBdUIsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVoRSxNQUFNLEtBQUssR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFcEMsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUNoRCxHQUFHLENBQUMsYUFBYSxDQUFDO2lCQUNsQixHQUFHLENBQUMsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUUzQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtRQUN0QyxFQUFFLENBQUMsb0ZBQW9GLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEcsMEJBQTBCO1lBQzFCLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7WUFFeEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUNoRCxJQUFJLENBQUMsZUFBZSxXQUFXLFdBQVcsQ0FBQztpQkFDM0MsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFVLEtBQUssRUFBRSxDQUFDO2lCQUN2QyxJQUFJLENBQUM7Z0JBQ0osTUFBTSxFQUFFLHVCQUF1QjthQUNoQyxDQUFDLENBQUM7WUFFTCxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQ0osNkJBQTZCLENBQUMsK0JBQStCLENBQzlELENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvRkFBb0YsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRyxrQkFBa0I7WUFDbEIsdUJBQXVCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDO2dCQUNoRCxFQUFFLEVBQUUsV0FBVztnQkFDZixhQUFhO2dCQUNiLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxRQUFRO2dCQUNwQyxTQUFTO2FBQ1YsQ0FBQyxDQUFDO1lBRUgsdUJBQXVCLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDO2dCQUM3QyxFQUFFLEVBQUUsV0FBVztnQkFDZixhQUFhO2dCQUNiLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxTQUFTO2dCQUNyQyxTQUFTO2FBQ1YsQ0FBQyxDQUFDO1lBRUgsa0NBQWtDO1lBQ2xDLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7WUFFMUQsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUNoRCxJQUFJLENBQUMsZUFBZSxXQUFXLFdBQVcsQ0FBQztpQkFDM0MsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFVLEtBQUssRUFBRSxDQUFDO2lCQUN2QyxJQUFJLENBQUM7Z0JBQ0osTUFBTSxFQUFFLHVCQUF1QjthQUNoQyxDQUFDLENBQUM7WUFFTCxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtRQUMxRCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsa0JBQWtCO1lBQ2xCLHVCQUF1QixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztnQkFDaEQsRUFBRSxFQUFFLFdBQVc7Z0JBQ2YsYUFBYTtnQkFDYixNQUFNLEVBQUUsMkNBQW1CLENBQUMsUUFBUTtnQkFDcEMsU0FBUyxFQUFFLGNBQWMsRUFBRSwrQkFBK0I7YUFDM0QsQ0FBQyxDQUFDO1lBRUgsNkNBQTZDO1lBQzdDLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUU1RCxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7aUJBQ2hELEdBQUcsQ0FBQyxlQUFlLFdBQVcsRUFBRSxDQUFDO2lCQUNqQyxHQUFHLENBQUMsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUUzQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQ0osNkJBQTZCLENBQUMsK0JBQStCLENBQzlELENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRSxrQkFBa0I7WUFDbEIsdUJBQXVCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDO2dCQUNoRCxFQUFFLEVBQUUsV0FBVztnQkFDZixhQUFhO2dCQUNiLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxRQUFRO2dCQUNwQyxTQUFTLEVBQUUsMkJBQTJCO2FBQ3ZDLENBQUMsQ0FBQztZQUVILG9DQUFvQztZQUNwQyxNQUFNLEtBQUssR0FBRyxVQUFVLENBQUMsU0FBUyxFQUFFLENBQUMsU0FBUyxDQUFDLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFNUQsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUNoRCxHQUFHLENBQUMsZUFBZSxXQUFXLEVBQUUsQ0FBQztpQkFDakMsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFVLEtBQUssRUFBRSxDQUFDLENBQUM7WUFFM0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0VBQWtFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEYsa0JBQWtCO1lBQ2xCLHVCQUF1QixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztnQkFDaEQsRUFBRSxFQUFFLFdBQVc7Z0JBQ2YsYUFBYTtnQkFDYixNQUFNLEVBQUUsMkNBQW1CLENBQUMsUUFBUTtnQkFDcEMsU0FBUyxFQUFFLGNBQWMsRUFBRSwrQkFBK0I7YUFDM0QsQ0FBQyxDQUFDO1lBRUgsK0JBQStCO1lBQy9CLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxhQUFhLENBQUMsRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsR0FBRyxDQUFDLGVBQWUsV0FBVyxFQUFFLENBQUM7aUJBQ2pDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBRTNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQzNDLEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN6RCxrQkFBa0I7WUFDbEIsdUJBQXVCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDO2dCQUNoRCxFQUFFLEVBQUUsV0FBVztnQkFDZixhQUFhO2dCQUNiLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxRQUFRO2dCQUNwQyxTQUFTO2dCQUNULGVBQWUsRUFBRSwyQ0FBbUIsQ0FBQyxHQUFHO2dCQUN4QyxjQUFjLEVBQUU7b0JBQ2QsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsUUFBUSxFQUFFLGFBQWE7aUJBQ3hCO2FBQ0YsQ0FBQyxDQUFDO1lBRUgsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXBDLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsR0FBRyxDQUFDLGVBQWUsV0FBVyxFQUFFLENBQUM7aUJBQ2pDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBRTNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRWxDLDJDQUEyQztZQUMzQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN0RSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLCtCQUErQixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdDLGtCQUFrQjtZQUNsQix1QkFBdUIsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUM7Z0JBQ2hELEVBQUUsRUFBRSxXQUFXO2dCQUNmLGFBQWE7Z0JBQ2IsTUFBTSxFQUFFLDJDQUFtQixDQUFDLFFBQVE7Z0JBQ3BDLFNBQVM7Z0JBQ1QsWUFBWSxFQUFFO29CQUNaLEVBQUUsRUFBRSxZQUFZO29CQUNoQixJQUFJLEVBQUUsZUFBZTtvQkFDckIsR0FBRyxFQUFFLGFBQWE7aUJBQ25CO2FBQ0YsQ0FBQyxDQUFDO1lBRUgsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXBDLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsR0FBRyxDQUFDLGVBQWUsV0FBVyxFQUFFLENBQUM7aUJBQ2pDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBRTNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRWxDLHFDQUFxQztZQUNyQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsWUFBWSxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUNqRSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDL0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN4RCxDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDcEMsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVELCtDQUErQztZQUMvQyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFFakQsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXBDLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztpQkFDaEQsSUFBSSxDQUFDLGVBQWUsV0FBVyxlQUFlLENBQUM7aUJBQy9DLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsQ0FBQztpQkFDdkMsTUFBTSxDQUFDLFNBQVMsRUFBRSxNQUFNLEVBQUUsZUFBZSxDQUFDLENBQUM7WUFFOUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlEQUFpRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQy9ELGlEQUFpRDtZQUNqRCxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNO1lBRXBELE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUVwQyxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7aUJBQ2hELElBQUksQ0FBQyxlQUFlLFdBQVcsZUFBZSxDQUFDO2lCQUMvQyxHQUFHLENBQUMsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLENBQUM7aUJBQ3ZDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksQ0FBQyxDQUFDO1lBRTNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsb0JBQW9CO1FBQ3pELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRSxrQkFBa0I7WUFDbEIsdUJBQXVCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDO2dCQUNoRCxFQUFFLEVBQUUsV0FBVztnQkFDZixhQUFhO2dCQUNiLE1BQU0sRUFBRSwyQ0FBbUIsQ0FBQyxRQUFRO2dCQUNwQyxTQUFTLEVBQUUsY0FBYzthQUMxQixDQUFDLENBQUM7WUFFSCxNQUFNLEtBQUssR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFcEMsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUMvQixHQUFHLENBQUMsZUFBZSxXQUFXLEVBQUUsQ0FBQztpQkFDakMsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFVLEtBQUssRUFBRSxDQUFDLENBQUM7WUFFM0MsTUFBTSxDQUNKLDZCQUE2QixDQUFDLCtCQUErQixDQUM5RCxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXBDLDJDQUEyQztZQUMzQyxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsRUFBRSxDQUFDO2lCQUN2QixJQUFJLENBQUMsQ0FBQyxDQUFDO2lCQUNQLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FDUixPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO2lCQUN6QixHQUFHLENBQUMsYUFBYSxDQUFDO2lCQUNsQixHQUFHLENBQUMsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLENBQUMsQ0FDM0MsQ0FBQztZQUVKLE1BQU0sU0FBUyxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU5QyxzRUFBc0U7WUFDdEUsTUFBTSxlQUFlLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQztZQUV0RSw0REFBNEQ7WUFDNUQscUVBQXFFO1lBQ3JFLE9BQU8sQ0FBQyxHQUFHLENBQ1QsMEJBQTBCLGVBQWUsQ0FBQyxNQUFNLE9BQU8sUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUN6RSxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxwYWdhbWVudG9cXHRlc3RzXFxpbnRlZ3JhdGlvblxccGFnYW1lbnRvLXNlZ3VyYW5jYS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgSU5lc3RBcHBsaWNhdGlvbiB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCAqIGFzIHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcbmltcG9ydCB7IGdldFJlcG9zaXRvcnlUb2tlbiB9IGZyb20gJ0BuZXN0anMvdHlwZW9ybSc7XG5pbXBvcnQgeyBDb25maWdNb2R1bGUsIENvbmZpZ1NlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2NvbmZpZyc7XG5pbXBvcnQgeyBKd3RNb2R1bGUsIEp3dFNlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2p3dCc7XG5pbXBvcnQgeyBIdHRwTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy9heGlvcyc7XG5cbmltcG9ydCB7IFBhZ2FtZW50b01vZHVsZSB9IGZyb20gJy4uLy4uL3BhZ2FtZW50by5tb2R1bGUnO1xuaW1wb3J0IHtcbiAgUGFnYW1lbnRvLFxuICBDb21wcm92YW50ZVBhZ2FtZW50byxcbiAgQ29uZmlybWFjYW9SZWNlYmltZW50byxcbn0gZnJvbSAnLi4vLi4vZW50aXRpZXMnO1xuaW1wb3J0IHsgU3RhdHVzUGFnYW1lbnRvRW51bSB9IGZyb20gJy4uLy4uL2VudW1zL3N0YXR1cy1wYWdhbWVudG8uZW51bSc7XG5pbXBvcnQgeyBNZXRvZG9QYWdhbWVudG9FbnVtIH0gZnJvbSAnLi4vLi4vZW51bXMvbWV0b2RvLXBhZ2FtZW50by5lbnVtJztcbmltcG9ydCB7IFBhZ2FtZW50b1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wYWdhbWVudG8uc2VydmljZSc7XG5pbXBvcnQgeyBJbnRlZ3JhY2FvU29saWNpdGFjYW9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvaW50ZWdyYWNhby1zb2xpY2l0YWNhby5zZXJ2aWNlJztcbmltcG9ydCB7IEludGVncmFjYW9DaWRhZGFvU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2ludGVncmFjYW8tY2lkYWRhby5zZXJ2aWNlJztcbmltcG9ydCB7IEludGVncmFjYW9Eb2N1bWVudG9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvaW50ZWdyYWNhby1kb2N1bWVudG8uc2VydmljZSc7XG5pbXBvcnQgeyBBdWRpdG9yaWFQYWdhbWVudG9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvYXVkaXRvcmlhLXBhZ2FtZW50by5zZXJ2aWNlJztcblxuLyoqXG4gKiBUZXN0ZXMgZGUgaW50ZWdyYcOnw6NvIHBhcmEgc2VndXJhbsOnYSBkbyBtw7NkdWxvIGRlIHBhZ2FtZW50b1xuICpcbiAqIFZlcmlmaWNhIG8gZnVuY2lvbmFtZW50byBjb3JyZXRvIGRvcyBtZWNhbmlzbW9zIGRlIHNlZ3VyYW7Dp2EsXG4gKiBpbmNsdWluZG8gYXV0ZW50aWNhw6fDo28sIGF1dG9yaXphw6fDo28gZSBwcm90ZcOnw6NvIGRlIGRhZG9zIHNlbnPDrXZlaXMuXG4gKlxuICogQGF1dGhvciBFcXVpcGUgUEdCZW5cbiAqL1xuZGVzY3JpYmUoJ1NlZ3VyYW7Dp2EgZG8gTcOzZHVsbyBkZSBQYWdhbWVudG8gKEludGVncmF0aW9uKScsICgpID0+IHtcbiAgbGV0IGFwcDogSU5lc3RBcHBsaWNhdGlvbjtcbiAgbGV0IGp3dFNlcnZpY2U6IEp3dFNlcnZpY2U7XG4gIGxldCBwYWdhbWVudG9TZXJ2aWNlOiBQYWdhbWVudG9TZXJ2aWNlO1xuXG4gIC8vIERhZG9zIGRlIHRlc3RlXG4gIGNvbnN0IHVzdWFyaW9JZCA9ICd1c3VhcmlvLXRlc3RlLWlkJztcbiAgY29uc3QgdXN1YXJpb091dHJhVW5pZGFkZUlkID0gJ3VzdWFyaW8tb3V0cmEtdW5pZGFkZS1pZCc7XG4gIGNvbnN0IHNvbGljaXRhY2FvSWQgPSAnc29saWNpdGFjYW8tdGVzdGUtaWQnO1xuICBjb25zdCB1bmlkYWRlSWQgPSAndW5pZGFkZS10ZXN0ZS1pZCc7XG4gIGNvbnN0IG91dHJhVW5pZGFkZUlkID0gJ291dHJhLXVuaWRhZGUtaWQnO1xuICBjb25zdCBwYWdhbWVudG9JZCA9ICdwYWdhbWVudG8tdGVzdGUtaWQnO1xuICBjb25zdCBjb21wcm92YW50ZUlkID0gJ2NvbXByb3ZhbnRlLXRlc3RlLWlkJztcblxuICAvLyBNb2NrIGRvcyBzZXJ2acOnb3MgZXh0ZXJub3NcbiAgY29uc3QgbW9ja0ludGVncmFjYW9Tb2xpY2l0YWNhb1NlcnZpY2UgPSB7XG4gICAgdmVyaWZpY2FyU3RhdHVzU29saWNpdGFjYW86IGplc3RcbiAgICAgIC5mbigpXG4gICAgICAubW9ja1Jlc29sdmVkVmFsdWUoJ1BBR0FNRU5UT19QRU5ERU5URScpLFxuICAgIHZlcmlmaWNhclNvbGljaXRhY2FvRWxlZ2l2ZWw6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKSxcbiAgICBhdHVhbGl6YXJTdGF0dXNTb2xpY2l0YWNhbzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpLFxuICAgIG9idGVyRGV0YWxoZXNTb2xpY2l0YWNhbzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIGlkOiBzb2xpY2l0YWNhb0lkLFxuICAgICAgdW5pZGFkZUlkOiB1bmlkYWRlSWQsXG4gICAgICBzdGF0dXM6ICdQQUdBTUVOVE9fUEVOREVOVEUnLFxuICAgIH0pLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tJbnRlZ3JhY2FvQ2lkYWRhb1NlcnZpY2UgPSB7XG4gICAgb2J0ZXJEYWRvc0NpZGFkYW86IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBpZDogJ2NpZGFkYW8taWQnLFxuICAgICAgbm9tZTogJ0pvw6NvIGRhIFNpbHZhJyxcbiAgICAgIGNwZjogJzEyMzQ1Njc4OTAwJyxcbiAgICB9KSxcbiAgICBvYnRlckRhZG9zQmFuY2FyaW9zOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW1xuICAgICAge1xuICAgICAgICBpZDogJ2luZm8tYmFuY2FyaWEtaWQnLFxuICAgICAgICB0aXBvOiAnUElYJyxcbiAgICAgICAgcGl4VGlwbzogJ0NQRicsXG4gICAgICAgIHBpeENoYXZlOiAnMTIzNDU2Nzg5MDAnLFxuICAgICAgfSxcbiAgICBdKSxcbiAgICB2YWxpZGFyRGFkb3NCYW5jYXJpb3M6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKSxcbiAgfTtcblxuICBjb25zdCBtb2NrSW50ZWdyYWNhb0RvY3VtZW50b1NlcnZpY2UgPSB7XG4gICAgdXBsb2FkQ29tcHJvdmFudGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBpZDogJ2RvY3VtZW50by1pZCcsXG4gICAgICBub21lOiAnY29tcHJvdmFudGUucGRmJyxcbiAgICB9KSxcbiAgICBvYnRlckNvbXByb3ZhbnRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgaWQ6ICdkb2N1bWVudG8taWQnLFxuICAgICAgbm9tZTogJ2NvbXByb3ZhbnRlLnBkZicsXG4gICAgfSksXG4gICAgbGlzdGFyQ29tcHJvdmFudGVzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pLFxuICAgIHJlbW92ZXJDb21wcm92YW50ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXG4gIH07XG5cbiAgY29uc3QgbW9ja0F1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UgPSB7XG4gICAgbG9nQ3JpYWNhb1BhZ2FtZW50bzogamVzdC5mbigpLFxuICAgIGxvZ011ZGFuY2FTdGF0dXM6IGplc3QuZm4oKSxcbiAgICBsb2dDYW5jZWxhbWVudG9QYWdhbWVudG86IGplc3QuZm4oKSxcbiAgICBsb2dVcGxvYWRDb21wcm92YW50ZTogamVzdC5mbigpLFxuICAgIGxvZ1JlbW9jYW9Db21wcm92YW50ZTogamVzdC5mbigpLFxuICAgIGxvZ0NvbmZpcm1hY2FvUmVjZWJpbWVudG86IGplc3QuZm4oKSxcbiAgICBsb2dFcnJvUHJvY2Vzc2FtZW50bzogamVzdC5mbigpLFxuICAgIGxvZ1RlbnRhdGl2YUFjZXNzb05hb0F1dG9yaXphZG86IGplc3QuZm4oKSxcbiAgfTtcblxuICAvLyBNb2NrIGRvcyByZXBvc2l0w7NyaW9zXG4gIGNvbnN0IG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5ID0ge1xuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICBmaW5kT25lOiBqZXN0LmZuKCksXG4gICAgZmluZDogamVzdC5mbigpLFxuICAgIGZpbmRBbmRDb3VudDogamVzdC5mbigpLFxuICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tDb21wcm92YW50ZVJlcG9zaXRvcnkgPSB7XG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgc2F2ZTogamVzdC5mbigpLFxuICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICBmaW5kOiBqZXN0LmZuKCksXG4gICAgZmluZEFuZENvdW50OiBqZXN0LmZuKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gIH07XG5cbiAgY29uc3QgbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeSA9IHtcbiAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICBzYXZlOiBqZXN0LmZuKCksXG4gICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgIGZpbmQ6IGplc3QuZm4oKSxcbiAgICBmaW5kQW5kQ291bnQ6IGplc3QuZm4oKSxcbiAgfTtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vZHVsZUZpeHR1cmU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgaW1wb3J0czogW1xuICAgICAgICBQYWdhbWVudG9Nb2R1bGUsXG4gICAgICAgIENvbmZpZ01vZHVsZS5mb3JSb290KHtcbiAgICAgICAgICBpc0dsb2JhbDogdHJ1ZSxcbiAgICAgICAgICBlbnZGaWxlUGF0aDogJy5lbnYudGVzdCcsXG4gICAgICAgIH0pLFxuICAgICAgICBKd3RNb2R1bGUucmVnaXN0ZXJBc3luYyh7XG4gICAgICAgICAgaW1wb3J0czogW0NvbmZpZ01vZHVsZV0sXG4gICAgICAgICAgdXNlRmFjdG9yeTogYXN5bmMgKGNvbmZpZ1NlcnZpY2U6IENvbmZpZ1NlcnZpY2UpID0+ICh7XG4gICAgICAgICAgICBzZWNyZXQ6IGNvbmZpZ1NlcnZpY2UuZ2V0PHN0cmluZz4oJ0pXVF9TRUNSRVQnKSB8fCAndGVzdC1zZWNyZXQnLFxuICAgICAgICAgICAgc2lnbk9wdGlvbnM6IHsgZXhwaXJlc0luOiAnMWgnIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgICAgaW5qZWN0OiBbQ29uZmlnU2VydmljZV0sXG4gICAgICAgIH0pLFxuICAgICAgICBIdHRwTW9kdWxlLFxuICAgICAgXSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogZ2V0UmVwb3NpdG9yeVRva2VuKFBhZ2FtZW50byksXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogZ2V0UmVwb3NpdG9yeVRva2VuKENvbXByb3ZhbnRlUGFnYW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0NvbXByb3ZhbnRlUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IGdldFJlcG9zaXRvcnlUb2tlbihDb25maXJtYWNhb1JlY2ViaW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSlcbiAgICAgIC5vdmVycmlkZVByb3ZpZGVyKEludGVncmFjYW9Tb2xpY2l0YWNhb1NlcnZpY2UpXG4gICAgICAudXNlVmFsdWUobW9ja0ludGVncmFjYW9Tb2xpY2l0YWNhb1NlcnZpY2UpXG4gICAgICAub3ZlcnJpZGVQcm92aWRlcihJbnRlZ3JhY2FvQ2lkYWRhb1NlcnZpY2UpXG4gICAgICAudXNlVmFsdWUobW9ja0ludGVncmFjYW9DaWRhZGFvU2VydmljZSlcbiAgICAgIC5vdmVycmlkZVByb3ZpZGVyKEludGVncmFjYW9Eb2N1bWVudG9TZXJ2aWNlKVxuICAgICAgLnVzZVZhbHVlKG1vY2tJbnRlZ3JhY2FvRG9jdW1lbnRvU2VydmljZSlcbiAgICAgIC5vdmVycmlkZVByb3ZpZGVyKEF1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UpXG4gICAgICAudXNlVmFsdWUobW9ja0F1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UpXG4gICAgICAuY29tcGlsZSgpO1xuXG4gICAgYXBwID0gbW9kdWxlRml4dHVyZS5jcmVhdGVOZXN0QXBwbGljYXRpb24oKTtcbiAgICBqd3RTZXJ2aWNlID0gbW9kdWxlRml4dHVyZS5nZXQ8Snd0U2VydmljZT4oSnd0U2VydmljZSk7XG4gICAgcGFnYW1lbnRvU2VydmljZSA9IG1vZHVsZUZpeHR1cmUuZ2V0PFBhZ2FtZW50b1NlcnZpY2U+KFBhZ2FtZW50b1NlcnZpY2UpO1xuXG4gICAgYXdhaXQgYXBwLmluaXQoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGFwcC5jbG9zZSgpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgLy8gRnVuw6fDo28gYXV4aWxpYXIgcGFyYSBnZXJhciB0b2tlbnMgSldUIGNvbSBkaWZlcmVudGVzIHBlcmZpc1xuICBjb25zdCBnZXJhclRva2VuID0gKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHBlcmZpczogc3RyaW5nW10gPSBbJ3VzdWFyaW8nXSxcbiAgICB1bmlkYWRlSWQ6IHN0cmluZyA9ICd1bmlkYWRlLXRlc3RlLWlkJyxcbiAgKSA9PiB7XG4gICAgcmV0dXJuIGp3dFNlcnZpY2Uuc2lnbih7XG4gICAgICBzdWI6IHVzZXJJZCxcbiAgICAgIHBlcmZpcyxcbiAgICAgIHVuaWRhZGVJZCxcbiAgICB9KTtcbiAgfTtcblxuICBkZXNjcmliZSgnQXV0ZW50aWNhw6fDo28nLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgYWNlc3NvIHNlbSB0b2tlbiBKV1QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSkuZ2V0KCcvcGFnYW1lbnRvcycpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciBhY2Vzc28gY29tIHRva2VuIEpXVCBpbnbDoWxpZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldCgnL3BhZ2FtZW50b3MnKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgJ0JlYXJlciB0b2tlbi1pbnZhbGlkbycpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciBhY2Vzc28gY29tIHRva2VuIEpXVCB2w6FsaWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ29uZmlndXJhciBtb2NrXG4gICAgICBtb2NrUGFnYW1lbnRvUmVwb3NpdG9yeS5maW5kQW5kQ291bnQubW9ja1Jlc29sdmVkVmFsdWUoW1tdLCAwXSk7XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldCgnL3BhZ2FtZW50b3MnKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRvcml6YcOnw6NvIHBvciBQZXJmaWwnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgYWNlc3NvIGEgb3BlcmHDp8O1ZXMgYWRtaW5pc3RyYXRpdmFzIHBhcmEgdXN1w6FyaW9zIHNlbSBwZXJmaWwgYWRlcXVhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUb2tlbiBjb20gcGVyZmlsIGLDoXNpY29cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQsIFsndXN1YXJpb19iYXNpY28nXSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY2FuY2VsYXJgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBtb3Rpdm86ICdUZXN0ZSBkZSBjYW5jZWxhbWVudG8nLFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICBtb2NrQXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZS5sb2dUZW50YXRpdmFBY2Vzc29OYW9BdXRvcml6YWRvLFxuICAgICAgKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciBhY2Vzc28gYSBvcGVyYcOnw7VlcyBhZG1pbmlzdHJhdGl2YXMgcGFyYSB1c3XDoXJpb3MgY29tIHBlcmZpbCBhZGVxdWFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENvbmZpZ3VyYXIgbW9ja1xuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiBwYWdhbWVudG9JZCxcbiAgICAgICAgc29saWNpdGFjYW9JZCxcbiAgICAgICAgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgICB1bmlkYWRlSWQsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiBwYWdhbWVudG9JZCxcbiAgICAgICAgc29saWNpdGFjYW9JZCxcbiAgICAgICAgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyxcbiAgICAgICAgdW5pZGFkZUlkLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRva2VuIGNvbSBwZXJmaWwgYWRtaW5pc3RyYXRpdm9cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQsIFsnYWRtaW5fcGFnYW1lbnRvcyddKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5wb3N0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9jYW5jZWxhcmApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIG1vdGl2bzogJ1Rlc3RlIGRlIGNhbmNlbGFtZW50bycsXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWd1cmFuw6dhIHBvciBVbmlkYWRlIChSb3ctTGV2ZWwgU2VjdXJpdHkpJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJlamVpdGFyIGFjZXNzbyBhIHBhZ2FtZW50b3MgZGUgb3V0cmEgdW5pZGFkZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENvbmZpZ3VyYXIgbW9ja1xuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiBwYWdhbWVudG9JZCxcbiAgICAgICAgc29saWNpdGFjYW9JZCxcbiAgICAgICAgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgICB1bmlkYWRlSWQ6IG91dHJhVW5pZGFkZUlkLCAvLyBVbmlkYWRlIGRpZmVyZW50ZSBkbyB1c3XDoXJpb1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRva2VuIGRlIHVzdcOhcmlvIGRlIHVtYSB1bmlkYWRlIGVzcGVjw61maWNhXG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4odXN1YXJpb0lkLCBbJ3VzdWFyaW8nXSwgdW5pZGFkZUlkKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5nZXQoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9YClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICBtb2NrQXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZS5sb2dUZW50YXRpdmFBY2Vzc29OYW9BdXRvcml6YWRvLFxuICAgICAgKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciBhY2Vzc28gYSBwYWdhbWVudG9zIGRhIG1lc21hIHVuaWRhZGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDb25maWd1cmFyIG1vY2tcbiAgICAgIG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogcGFnYW1lbnRvSWQsXG4gICAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgdW5pZGFkZUlkLCAvLyBNZXNtYSB1bmlkYWRlIGRvIHVzdcOhcmlvXG4gICAgICB9KTtcblxuICAgICAgLy8gVG9rZW4gZGUgdXN1w6FyaW8gZGEgbWVzbWEgdW5pZGFkZVxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKHVzdWFyaW9JZCwgWyd1c3VhcmlvJ10sIHVuaWRhZGVJZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfWApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHBlcm1pdGlyIGFjZXNzbyBnbG9iYWwgcGFyYSB1c3XDoXJpb3MgY29tIHBlcmZpbCBzdXBlcl9hZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENvbmZpZ3VyYXIgbW9ja1xuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiBwYWdhbWVudG9JZCxcbiAgICAgICAgc29saWNpdGFjYW9JZCxcbiAgICAgICAgc3RhdHVzOiBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgICB1bmlkYWRlSWQ6IG91dHJhVW5pZGFkZUlkLCAvLyBVbmlkYWRlIGRpZmVyZW50ZSBkbyB1c3XDoXJpb1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRva2VuIGNvbSBwZXJmaWwgc3VwZXJfYWRtaW5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQsIFsnc3VwZXJfYWRtaW4nXSwgJ3F1YWxxdWVyLXVuaWRhZGUnKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5nZXQoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9YClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUHJvdGXDp8OjbyBkZSBEYWRvcyBTZW5zw612ZWlzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIG1hc2NhcmFyIGRhZG9zIGJhbmPDoXJpb3MgbmEgcmVzcG9zdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDb25maWd1cmFyIG1vY2tcbiAgICAgIG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogcGFnYW1lbnRvSWQsXG4gICAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgdW5pZGFkZUlkLFxuICAgICAgICBtZXRvZG9QYWdhbWVudG86IE1ldG9kb1BhZ2FtZW50b0VudW0uUElYLFxuICAgICAgICBkYWRvc0JhbmNhcmlvczoge1xuICAgICAgICAgIHBpeFRpcG86ICdDUEYnLFxuICAgICAgICAgIHBpeENoYXZlOiAnMTIzNDU2Nzg5MDAnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH1gKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG5cbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgYSBjaGF2ZSBQSVggZXN0w6EgbWFzY2FyYWRhXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYWRvc0JhbmNhcmlvcy5waXhDaGF2ZSkubm90LnRvQmUoJzEyMzQ1Njc4OTAwJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYWRvc0JhbmNhcmlvcy5waXhDaGF2ZSkudG9Db250YWluKCcqJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBtYXNjYXJhciBDUEYgbmEgcmVzcG9zdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDb25maWd1cmFyIG1vY2tcbiAgICAgIG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogcGFnYW1lbnRvSWQsXG4gICAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgdW5pZGFkZUlkLFxuICAgICAgICBiZW5lZmljaWFyaW86IHtcbiAgICAgICAgICBpZDogJ2NpZGFkYW8taWQnLFxuICAgICAgICAgIG5vbWU6ICdKb8OjbyBkYSBTaWx2YScsXG4gICAgICAgICAgY3BmOiAnMTIzNDU2Nzg5MDAnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH1gKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG5cbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgbyBDUEYgZXN0w6EgbWFzY2FyYWRvXG4gICAgICBpZiAocmVzcG9uc2UuYm9keS5iZW5lZmljaWFyaW8gJiYgcmVzcG9uc2UuYm9keS5iZW5lZmljaWFyaW8uY3BmKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmJlbmVmaWNpYXJpby5jcGYpLm5vdC50b0JlKCcxMjM0NTY3ODkwMCcpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5iZW5lZmljaWFyaW8uY3BmKS50b0NvbnRhaW4oJyonKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ZhbGlkYcOnw6NvIGRlIFVwbG9hZHMnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgdXBsb2FkcyBkZSBhcnF1aXZvcyBtYWxpY2lvc29zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JpYXIgYXJxdWl2byBkZSB0ZXN0ZSBjb20gZXh0ZW5zw6NvIHN1c3BlaXRhXG4gICAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbSgnY29udGXDumRvIG1hbGljaW9zbycpO1xuXG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4odXN1YXJpb0lkKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5wb3N0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9jb21wcm92YW50ZXNgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5hdHRhY2goJ2FycXVpdm8nLCBidWZmZXIsICdtYWxpY2lvc28uZXhlJyk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignbsOjbyBwZXJtaXRpZG8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIHVwbG9hZHMgZGUgYXJxdWl2b3MgbXVpdG8gZ3JhbmRlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyaWFyIGFycXVpdm8gZGUgdGVzdGUgbXVpdG8gZ3JhbmRlIChzaW11bGFkbylcbiAgICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5hbGxvYyg2ICogMTAyNCAqIDEwMjQpOyAvLyA2TUJcblxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKHVzdWFyaW9JZCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29tcHJvdmFudGVzYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAuYXR0YWNoKCdhcnF1aXZvJywgYnVmZmVyLCAnZ3JhbmRlLnBkZicpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQxMyk7IC8vIFBheWxvYWQgVG9vIExhcmdlXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQcm90ZcOnw6NvIGNvbnRyYSBBdGFxdWVzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJlZ2lzdHJhciB0ZW50YXRpdmFzIGRlIGFjZXNzbyBuw6NvIGF1dG9yaXphZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDb25maWd1cmFyIG1vY2tcbiAgICAgIG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogcGFnYW1lbnRvSWQsXG4gICAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgdW5pZGFkZUlkOiBvdXRyYVVuaWRhZGVJZCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4odXN1YXJpb0lkKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfWApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YCk7XG5cbiAgICAgIGV4cGVjdChcbiAgICAgICAgbW9ja0F1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UubG9nVGVudGF0aXZhQWNlc3NvTmFvQXV0b3JpemFkbyxcbiAgICAgICkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGltaXRhciB0YXhhIGRlIHJlcXVpc2nDp8O1ZXMgKHJhdGUgbGltaXRpbmcpJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKHVzdWFyaW9JZCk7XG5cbiAgICAgIC8vIEZhemVyIG3Dumx0aXBsYXMgcmVxdWlzacOnw7VlcyBlbSBzZXF1w6puY2lhXG4gICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5KDIwKVxuICAgICAgICAuZmlsbCgwKVxuICAgICAgICAubWFwKCgpID0+XG4gICAgICAgICAgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAgICAgLmdldCgnL3BhZ2FtZW50b3MnKVxuICAgICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKSxcbiAgICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuXG4gICAgICAvLyBWZXJpZmljYXIgc2UgYWxndW1hIHJlcXVpc2nDp8OjbyBmb2kgbGltaXRhZGEgKDQyOSBUb28gTWFueSBSZXF1ZXN0cylcbiAgICAgIGNvbnN0IGxpbWl0ZWRSZXF1ZXN0cyA9IHJlc3BvbnNlcy5maWx0ZXIoKHJlcykgPT4gcmVzLnN0YXR1cyA9PT0gNDI5KTtcblxuICAgICAgLy8gRW0gdW0gYW1iaWVudGUgcmVhbCwgYWxndW1hcyByZXF1aXNpw6fDtWVzIHNlcmlhbSBsaW1pdGFkYXNcbiAgICAgIC8vIE5vIGFtYmllbnRlIGRlIHRlc3RlLCBpc3NvIGRlcGVuZGUgZGEgY29uZmlndXJhw6fDo28gZG8gcmF0ZSBsaW1pdGVyXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYFJlcXVpc2nDp8O1ZXMgbGltaXRhZGFzOiAke2xpbWl0ZWRSZXF1ZXN0cy5sZW5ndGh9IGRlICR7cHJvbWlzZXMubGVuZ3RofWAsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9