{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\app.module.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\app.module.ts"],"sourcesContent":["import { Module } from '@nestjs/common';\nimport { ConfigModule, ConfigService } from '@nestjs/config';\nimport { TypeOrmModule } from '@nestjs/typeorm';\nimport { CacheModule } from '@nestjs/cache-manager';\nimport { ThrottlerModule, ThrottlerGuard } from '@nestjs/throttler';\nimport { createThrottlerConfig } from './config/throttler.config';\nimport { AppController } from './app.controller';\nimport { AppService } from './app.service';\nimport { MonitoringModule } from './shared/monitoring/monitoring.module';\nimport { AuthModule } from './auth/auth.module';\nimport { PermissionSharedModule } from './shared/permission/permission-shared.module';\nimport { AuditoriaSharedModule } from './shared/auditoria/auditoria-shared.module';\nimport { UsuarioModule } from './modules/usuario/usuario.module';\nimport { UnidadeModule } from './modules/unidade/unidade.module';\nimport { CidadaoModule } from './modules/cidadao/cidadao.module';\nimport { BeneficioModule } from './modules/beneficio/beneficio.module';\nimport { DocumentoModule } from './modules/documento/documento.module';\nimport { MetricasModule } from './modules/metricas/metricas.module';\nimport { AuditModule } from './audit/audit.module';\nimport { RecursoModule } from './modules/recurso/recurso.module';\nimport { LogsModule } from './modules/logs/logs.module';\nimport { APP_GUARD } from '@nestjs/core';\nimport { CatalogAwareExceptionFilter } from './shared/exceptions/error-catalog';\nimport { UnifiedLoggerModule } from './shared/logging/unified-logger.module';\nimport { ResilienceModule } from './shared/modules/resilience.module';\nimport { EmailModule } from './shared/modules/email.module';\n\n@Module({\n  imports: [\n    ConfigModule.forRoot({\n      isGlobal: true,\n      envFilePath: '.env',\n    }),\n    // Cache para relatórios e autenticação\n    CacheModule.register({\n      isGlobal: true,\n      ttl: 3600, // tempo de vida do cache: 1 hora\n      max: 100, // máximo de 100 itens no cache\n    }),\n    // Rate limiting - configuração robusta com múltiplos throttlers\n    ThrottlerModule.forRootAsync({\n      imports: [ConfigModule],\n      inject: [ConfigService],\n      useFactory: createThrottlerConfig,\n    }),\n    // Configuração do TypeORM\n    TypeOrmModule.forRootAsync({\n      imports: [ConfigModule],\n      inject: [ConfigService],\n      useFactory: (configService: ConfigService) => ({\n        type: 'postgres',\n        host: configService.get('DB_HOST', 'localhost'),\n        port: parseInt(configService.get('DB_PORT', '5432')),\n        username: configService.get('DB_USER', 'postgres'),\n        password: configService.get('DB_PASS', 'postgres'),\n        database: configService.get('DB_NAME', 'pgben'),\n        entities: [__dirname + '/**/*.entity{.ts,.js}'],\n        synchronize: false,\n        logging: configService.get('NODE_ENV') === 'development',\n        maxQueryExecutionTime: 10000,\n        extra: {\n          max: parseInt(configService.get('DB_POOL_MAX', '20')),\n          min: parseInt(configService.get('DB_POOL_MIN', '5')),\n          idleTimeoutMillis: parseInt(configService.get('DB_POOL_IDLE', '30000')),\n          connectionTimeoutMillis: parseInt(configService.get('DB_POOL_CONN_TIMEOUT', '5000')),\n          allowExitOnIdle: false,\n        },\n      }),\n    }),\n    // Módulo de monitoramento\n    MonitoringModule,\n    \n    // Módulos compartilhados\n    EmailModule, // Módulo de email\n    UnifiedLoggerModule,\n    PermissionSharedModule,\n    AuditoriaSharedModule,\n    ResilienceModule, // Reabilitado após correções no Redis/Cache\n\n    // Módulo de autenticação\n    AuthModule,\n\n    // Módulo de usuários\n    UsuarioModule,\n\n    // Módulo de unidades\n    UnidadeModule,\n\n    // Módulo de cidadãos\n    CidadaoModule,\n\n    // Módulo de benefícios\n    BeneficioModule,\n\n    // Módulo de docuentos\n    DocumentoModule,\n\n    // Módulo de auditoria e logging\n    AuditModule,\n\n    // Módulo de métricas\n    MetricasModule,\n\n    // Módulo de recursos de primeira instância\n    RecursoModule,\n\n    // Módulo de logs de auditoria\n    LogsModule,\n  ],\n  controllers: [AppController],\n  providers: [\n    AppService,\n    CatalogAwareExceptionFilter,\n    // Aplicar rate limiting globalmente\n    {\n      provide: APP_GUARD,\n      useClass: ThrottlerGuard,\n    },\n  ],\n})\nexport class AppModule {\n  constructor() {\n    console.log('✅ AppModule inicializado - com autenticação');\n  }\n}//"],"version":3}