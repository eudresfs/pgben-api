4217735fc6a2594c532ffb6c70f6f0ad
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.FluxoBeneficio = exports.TipoEtapa = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const tipo_beneficio_entity_1 = require("./tipo-beneficio.entity");
const role_enum_1 = require("../enums/role.enum");
var TipoEtapa;
(function (TipoEtapa) {
    TipoEtapa["ABERTURA"] = "abertura";
    TipoEtapa["ANALISE_DOCUMENTOS"] = "analise_documentos";
    TipoEtapa["ANALISE_TECNICA"] = "analise_tecnica";
    TipoEtapa["APROVACAO"] = "aprovacao";
    TipoEtapa["LIBERACAO"] = "liberacao";
})(TipoEtapa || (exports.TipoEtapa = TipoEtapa = {}));
let FluxoBeneficio = class FluxoBeneficio {
    id;
    tipo_beneficio_id;
    tipo_beneficio;
    nome_etapa;
    tipo_etapa;
    ordem;
    perfil_responsavel;
    setor_id;
    descricao;
    obrigatorio;
    permite_retorno;
    created_at;
    updated_at;
    removed_at;
    // Getters e Setters
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    get removedAt() {
        return this.removed_at;
    }
    // Métodos Utilitários
    /**
     * Verifica se o fluxo foi criado recentemente (últimas 24 horas)
     */
    isCriadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.created_at > umDiaAtras;
    }
    /**
     * Calcula a idade do registro em dias
     */
    getIdadeRegistroEmDias() {
        const agora = new Date();
        const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    /**
     * Verifica se foi removido
     */
    foiRemovido() {
        return !!this.removed_at;
    }
    /**
     * Verifica se está ativo
     */
    isAtivo() {
        return !this.removed_at;
    }
    /**
     * Verifica se é obrigatório
     */
    isObrigatorio() {
        return this.obrigatorio;
    }
    /**
     * Verifica se permite retorno
     */
    permiteRetorno() {
        return this.permite_retorno;
    }
    /**
     * Verifica se tem setor definido
     */
    temSetor() {
        return (this.setor_id !== null &&
            this.setor_id !== undefined &&
            this.setor_id.trim() !== '');
    }
    /**
     * Verifica se tem descrição
     */
    temDescricao() {
        return (this.descricao !== null &&
            this.descricao !== undefined &&
            this.descricao.trim() !== '');
    }
    /**
     * Obtém a descrição do tipo de etapa
     */
    getDescricaoTipoEtapa() {
        const descricoes = {
            [TipoEtapa.ABERTURA]: 'Abertura da Solicitação',
            [TipoEtapa.ANALISE_DOCUMENTOS]: 'Análise de Documentos',
            [TipoEtapa.ANALISE_TECNICA]: 'Análise Técnica',
            [TipoEtapa.APROVACAO]: 'Aprovação',
            [TipoEtapa.LIBERACAO]: 'Liberação do Benefício',
        };
        return descricoes[this.tipo_etapa] || 'Tipo de etapa desconhecido';
    }
    /**
     * Obtém a descrição do perfil responsável
     */
    getDescricaoPerfilResponsavel() {
        const descricoes = {
            [role_enum_1.Role.ADMIN]: 'Administrador',
            [role_enum_1.Role.GESTOR]: 'Gestor',
            [role_enum_1.Role.TECNICO]: 'Técnico',
            [role_enum_1.Role.COORDENADOR]: 'Coordenador',
            [role_enum_1.Role.ASSISTENTE_SOCIAL]: 'Assistente Social',
            [role_enum_1.Role.AUDITOR]: 'Auditor',
        };
        return (descricoes[this.perfil_responsavel] ||
            'Perfil desconhecido');
    }
    /**
     * Verifica se é a primeira etapa do fluxo
     */
    isPrimeiraEtapa() {
        return this.ordem === 1;
    }
    /**
     * Verifica se é uma etapa de análise
     */
    isEtapaAnalise() {
        return (this.tipo_etapa === TipoEtapa.ANALISE_DOCUMENTOS ||
            this.tipo_etapa === TipoEtapa.ANALISE_TECNICA);
    }
    /**
     * Verifica se é uma etapa de decisão
     */
    isEtapaDecisao() {
        return this.tipo_etapa === TipoEtapa.APROVACAO;
    }
    /**
     * Verifica se é a etapa final
     */
    isEtapaFinal() {
        return this.tipo_etapa === TipoEtapa.LIBERACAO;
    }
    /**
     * Verifica se é uma etapa crítica (obrigatória e não permite retorno)
     */
    isEtapaCritica() {
        return this.isObrigatorio() && !this.permiteRetorno();
    }
    /**
     * Obtém o nível de criticidade da etapa
     */
    getNivelCriticidade() {
        let pontos = 0;
        if (this.isObrigatorio())
            pontos += 2;
        if (!this.permiteRetorno())
            pontos += 2;
        if (this.isEtapaDecisao() || this.isEtapaFinal())
            pontos += 1;
        if (pontos <= 2)
            return 'BAIXA';
        if (pontos <= 4)
            return 'MEDIA';
        return 'ALTA';
    }
    /**
     * Verifica se pertence a um tipo de benefício
     */
    pertenceAoTipoBeneficio(tipoBeneficioId) {
        return this.tipo_beneficio_id === tipoBeneficioId;
    }
    /**
     * Obtém um resumo da etapa
     */
    getSummary() {
        const obrigatorio = this.isObrigatorio() ? 'Obrigatória' : 'Opcional';
        const retorno = this.permiteRetorno()
            ? 'Permite retorno'
            : 'Não permite retorno';
        return `${this.ordem}. ${this.nome_etapa} (${obrigatorio}, ${retorno})`;
    }
    /**
     * Gera uma chave única para a etapa
     */
    getUniqueKey() {
        return `fluxo_${this.tipo_beneficio_id}_${this.ordem}`;
    }
    /**
     * Verifica se a etapa é consistente
     */
    isConsistente() {
        // Verifica se tem tipo de benefício
        if (!this.tipo_beneficio_id)
            return false;
        // Verifica se tem nome da etapa
        if (!this.nome_etapa || this.nome_etapa.trim() === '')
            return false;
        // Verifica se ordem é válida
        if (this.ordem < 1)
            return false;
        // Verifica se tipo de etapa é válido
        if (!Object.values(TipoEtapa).includes(this.tipo_etapa))
            return false;
        // Verifica se perfil responsável é válido
        if (!Object.values(role_enum_1.Role).includes(this.perfil_responsavel))
            return false;
        return true;
    }
    /**
     * Verifica se pode ser removida
     */
    podeSerRemovida() {
        // Não pode remover se já foi removida
        if (this.foiRemovido())
            return false;
        // Primeira etapa geralmente não pode ser removida
        if (this.isPrimeiraEtapa())
            return false;
        // Etapas obrigatórias precisam de cuidado especial
        if (this.isObrigatorio())
            return false;
        return true;
    }
    /**
     * Clona a etapa (sem ID)
     */
    clone() {
        return {
            tipo_beneficio_id: this.tipo_beneficio_id,
            nome_etapa: this.nome_etapa,
            tipo_etapa: this.tipo_etapa,
            ordem: this.ordem,
            perfil_responsavel: this.perfil_responsavel,
            setor_id: this.setor_id,
            descricao: this.descricao,
            obrigatorio: this.obrigatorio,
            permite_retorno: this.permite_retorno,
        };
    }
    /**
     * Verifica se é uma etapa flexível
     */
    isFlexivel() {
        return !this.isObrigatorio() && this.permiteRetorno();
    }
    /**
     * Formata a data de criação
     */
    getCriacaoFormatada() {
        return this.created_at.toLocaleDateString('pt-BR');
    }
    /**
     * Formata a data de atualização
     */
    getAtualizacaoFormatada() {
        return this.updated_at.toLocaleDateString('pt-BR');
    }
    /**
     * Remove informações sensíveis para logs
     */
    toSafeLog() {
        return {
            id: this.id,
            tipo_beneficio_id: this.tipo_beneficio_id,
            nome_etapa: this.nome_etapa,
            tipo_etapa: this.tipo_etapa,
            ordem: this.ordem,
            perfil_responsavel: this.perfil_responsavel,
            obrigatorio: this.obrigatorio,
            permite_retorno: this.permite_retorno,
            created_at: this.created_at,
            updated_at: this.updated_at,
        };
    }
    /**
     * Obtém sugestões de melhoria para a etapa
     */
    getSugestoesMelhoria() {
        const sugestoes = [];
        if (!this.temDescricao()) {
            sugestoes.push('Adicionar descrição detalhada da etapa');
        }
        if (!this.temSetor()) {
            sugestoes.push('Definir setor responsável pela etapa');
        }
        if (this.isEtapaCritica() && !this.temDescricao()) {
            sugestoes.push('Etapa crítica deve ter descrição detalhada');
        }
        if (this.isEtapaAnalise() && this.permiteRetorno()) {
            sugestoes.push('Considerar não permitir retorno em etapas de análise');
        }
        if (!this.isConsistente()) {
            sugestoes.push('Verificar e corrigir inconsistências nos dados');
        }
        return sugestoes;
    }
    /**
     * Verifica se precisa de atualização (dados muito antigos)
     */
    precisaAtualizacao() {
        // Fluxos com mais de 6 meses podem precisar de revisão
        const seisMesesAtras = new Date();
        seisMesesAtras.setMonth(seisMesesAtras.getMonth() - 6);
        return this.updated_at < seisMesesAtras;
    }
    /**
     * Obtém estatísticas da etapa
     */
    getEstatisticas() {
        return {
            ordem: this.ordem,
            tipoEtapa: this.getDescricaoTipoEtapa(),
            perfilResponsavel: this.getDescricaoPerfilResponsavel(),
            obrigatorio: this.isObrigatorio(),
            permiteRetorno: this.permiteRetorno(),
            nivelCriticidade: this.getNivelCriticidade(),
            temSetor: this.temSetor(),
            temDescricao: this.temDescricao(),
        };
    }
    /**
     * Simula a execução da etapa
     */
    simularExecucao(dados) {
        const motivos = [];
        const observacoes = [];
        // Verifica se o perfil do usuário pode executar a etapa
        if (dados.perfilUsuario !== this.perfil_responsavel) {
            motivos.push(`Perfil ${dados.perfilUsuario} não autorizado. Requer: ${this.perfil_responsavel}`);
        }
        // Verifica se o setor do usuário corresponde (se definido)
        if (this.temSetor() && dados.setorUsuario !== this.setor_id) {
            motivos.push('Usuário não pertence ao setor responsável pela etapa');
        }
        // Observações sobre a etapa
        if (this.isObrigatorio()) {
            observacoes.push('Esta é uma etapa obrigatória');
        }
        if (!this.permiteRetorno()) {
            observacoes.push('Atenção: Esta etapa não permite retorno');
        }
        if (this.isEtapaFinal()) {
            observacoes.push('Esta é a etapa final do processo');
        }
        return {
            podeExecutar: motivos.length === 0,
            motivos,
            observacoes,
        };
    }
};
exports.FluxoBeneficio = FluxoBeneficio;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'Tipo de benefício é obrigatório' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "tipo_beneficio_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => tipo_beneficio_entity_1.TipoBeneficio, (tipoBeneficio) => tipoBeneficio.id, {
        onDelete: 'CASCADE',
    }),
    (0, typeorm_1.JoinColumn)({ name: 'tipo_beneficio_id' }),
    __metadata("design:type", typeof (_a = typeof tipo_beneficio_entity_1.TipoBeneficio !== "undefined" && tipo_beneficio_entity_1.TipoBeneficio) === "function" ? _a : Object)
], FluxoBeneficio.prototype, "tipo_beneficio", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'Nome da etapa é obrigatório' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "nome_etapa", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: TipoEtapa,
        enumName: 'tipo_etapa',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Tipo de etapa é obrigatório' }),
    (0, class_validator_1.IsEnum)(TipoEtapa, { message: 'Tipo de etapa inválido' }),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "tipo_etapa", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNumber)({}, { message: 'Ordem deve ser um número' }),
    (0, class_validator_1.Min)(1, { message: 'Ordem deve ser maior que zero' }),
    __metadata("design:type", Number)
], FluxoBeneficio.prototype, "ordem", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: role_enum_1.Role,
        enumName: 'perfil_responsavel',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Perfil responsável é obrigatório' }),
    (0, class_validator_1.IsEnum)(role_enum_1.Role, { message: 'Perfil responsável inválido' }),
    __metadata("design:type", typeof (_b = typeof role_enum_1.Role !== "undefined" && role_enum_1.Role) === "function" ? _b : Object)
], FluxoBeneficio.prototype, "perfil_responsavel", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "setor_id", void 0);
__decorate([
    (0, typeorm_1.Column)('text', { nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], FluxoBeneficio.prototype, "descricao", void 0);
__decorate([
    (0, typeorm_1.Column)({ default: true }),
    __metadata("design:type", Boolean)
], FluxoBeneficio.prototype, "obrigatorio", void 0);
__decorate([
    (0, typeorm_1.Column)({ default: false }),
    __metadata("design:type", Boolean)
], FluxoBeneficio.prototype, "permite_retorno", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)(),
    __metadata("design:type", typeof (_c = typeof Date !== "undefined" && Date) === "function" ? _c : Object)
], FluxoBeneficio.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)(),
    __metadata("design:type", typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object)
], FluxoBeneficio.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.DeleteDateColumn)(),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], FluxoBeneficio.prototype, "removed_at", void 0);
exports.FluxoBeneficio = FluxoBeneficio = __decorate([
    (0, typeorm_1.Entity)('fluxo_beneficio'),
    (0, typeorm_1.Index)(['tipo_beneficio_id', 'ordem'], { unique: true })
], FluxoBeneficio);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxmbHV4by1iZW5lZmljaW8uZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FVaUI7QUFDakIscURBQWdGO0FBQ2hGLG1FQUF3RDtBQUN4RCxrREFBMEM7QUFFMUMsSUFBWSxTQU1YO0FBTkQsV0FBWSxTQUFTO0lBQ25CLGtDQUFxQixDQUFBO0lBQ3JCLHNEQUF5QyxDQUFBO0lBQ3pDLGdEQUFtQyxDQUFBO0lBQ25DLG9DQUF1QixDQUFBO0lBQ3ZCLG9DQUF1QixDQUFBO0FBQ3pCLENBQUMsRUFOVyxTQUFTLHlCQUFULFNBQVMsUUFNcEI7QUFJTSxJQUFNLGNBQWMsR0FBcEIsTUFBTSxjQUFjO0lBRXpCLEVBQUUsQ0FBUztJQUlYLGlCQUFpQixDQUFTO0lBTTFCLGNBQWMsQ0FBZ0I7SUFJOUIsVUFBVSxDQUFTO0lBU25CLFVBQVUsQ0FBWTtJQUt0QixLQUFLLENBQVM7SUFTZCxrQkFBa0IsQ0FBTztJQUl6QixRQUFRLENBQVM7SUFJakIsU0FBUyxDQUFTO0lBR2xCLFdBQVcsQ0FBVTtJQUdyQixlQUFlLENBQVU7SUFHekIsVUFBVSxDQUFPO0lBR2pCLFVBQVUsQ0FBTztJQUdqQixVQUFVLENBQU87SUFFakIsb0JBQW9CO0lBQ3BCLElBQUksU0FBUztRQUNYLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN6QixDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVELHNCQUFzQjtJQUV0Qjs7T0FFRztJQUNILG9CQUFvQjtRQUNsQixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksSUFB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SUFBQSxnQkFBTSxFQUFDLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxDQUFDOzt1REFDRjtBQUd6QjtJQURDLElBQUEsMEJBQWdCLEdBQUU7a0RBQ1AsSUFBSSxvQkFBSixJQUFJO2tEQUFDO0FBR2pCO0lBREMsSUFBQSwwQkFBZ0IsR0FBRTtrREFDUCxJQUFJLG9CQUFKLElBQUk7a0RBQUM7QUFHakI7SUFEQyxJQUFBLDBCQUFnQixHQUFFO2tEQUNQLElBQUksb0JBQUosSUFBSTtrREFBQzt5QkE5RE4sY0FBYztJQUYxQixJQUFBLGdCQUFNLEVBQUMsaUJBQWlCLENBQUM7SUFDekIsSUFBQSxlQUFLLEVBQUMsQ0FBQyxtQkFBbUIsRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQztHQUMzQyxjQUFjLENBeWMxQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcZW50aXRpZXNcXGZsdXhvLWJlbmVmaWNpby5lbnRpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRW50aXR5LFxuICBQcmltYXJ5R2VuZXJhdGVkQ29sdW1uLFxuICBDb2x1bW4sXG4gIENyZWF0ZURhdGVDb2x1bW4sXG4gIFVwZGF0ZURhdGVDb2x1bW4sXG4gIERlbGV0ZURhdGVDb2x1bW4sXG4gIE1hbnlUb09uZSxcbiAgSm9pbkNvbHVtbixcbiAgSW5kZXgsXG59IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgSXNOb3RFbXB0eSwgSXNPcHRpb25hbCwgSXNOdW1iZXIsIE1pbiwgSXNFbnVtIH0gZnJvbSAnY2xhc3MtdmFsaWRhdG9yJztcbmltcG9ydCB7IFRpcG9CZW5lZmljaW8gfSBmcm9tICcuL3RpcG8tYmVuZWZpY2lvLmVudGl0eSc7XG5pbXBvcnQgeyBSb2xlIH0gZnJvbSAnLi4vZW51bXMvcm9sZS5lbnVtJztcblxuZXhwb3J0IGVudW0gVGlwb0V0YXBhIHtcbiAgQUJFUlRVUkEgPSAnYWJlcnR1cmEnLFxuICBBTkFMSVNFX0RPQ1VNRU5UT1MgPSAnYW5hbGlzZV9kb2N1bWVudG9zJyxcbiAgQU5BTElTRV9URUNOSUNBID0gJ2FuYWxpc2VfdGVjbmljYScsXG4gIEFQUk9WQUNBTyA9ICdhcHJvdmFjYW8nLFxuICBMSUJFUkFDQU8gPSAnbGliZXJhY2FvJyxcbn1cblxuQEVudGl0eSgnZmx1eG9fYmVuZWZpY2lvJylcbkBJbmRleChbJ3RpcG9fYmVuZWZpY2lvX2lkJywgJ29yZGVtJ10sIHsgdW5pcXVlOiB0cnVlIH0pXG5leHBvcnQgY2xhc3MgRmx1eG9CZW5lZmljaW8ge1xuICBAUHJpbWFyeUdlbmVyYXRlZENvbHVtbigndXVpZCcpXG4gIGlkOiBzdHJpbmc7XG5cbiAgQENvbHVtbigpXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ1RpcG8gZGUgYmVuZWbDrWNpbyDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIHRpcG9fYmVuZWZpY2lvX2lkOiBzdHJpbmc7XG5cbiAgQE1hbnlUb09uZSgoKSA9PiBUaXBvQmVuZWZpY2lvLCAodGlwb0JlbmVmaWNpbykgPT4gdGlwb0JlbmVmaWNpby5pZCwge1xuICAgIG9uRGVsZXRlOiAnQ0FTQ0FERScsXG4gIH0pXG4gIEBKb2luQ29sdW1uKHsgbmFtZTogJ3RpcG9fYmVuZWZpY2lvX2lkJyB9KVxuICB0aXBvX2JlbmVmaWNpbzogVGlwb0JlbmVmaWNpbztcblxuICBAQ29sdW1uKClcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnTm9tZSBkYSBldGFwYSDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIG5vbWVfZXRhcGE6IHN0cmluZztcblxuICBAQ29sdW1uKHtcbiAgICB0eXBlOiAnZW51bScsXG4gICAgZW51bTogVGlwb0V0YXBhLFxuICAgIGVudW1OYW1lOiAndGlwb19ldGFwYScsXG4gIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ1RpcG8gZGUgZXRhcGEgw6kgb2JyaWdhdMOzcmlvJyB9KVxuICBASXNFbnVtKFRpcG9FdGFwYSwgeyBtZXNzYWdlOiAnVGlwbyBkZSBldGFwYSBpbnbDoWxpZG8nIH0pXG4gIHRpcG9fZXRhcGE6IFRpcG9FdGFwYTtcblxuICBAQ29sdW1uKClcbiAgQElzTnVtYmVyKHt9LCB7IG1lc3NhZ2U6ICdPcmRlbSBkZXZlIHNlciB1bSBuw7ptZXJvJyB9KVxuICBATWluKDEsIHsgbWVzc2FnZTogJ09yZGVtIGRldmUgc2VyIG1haW9yIHF1ZSB6ZXJvJyB9KVxuICBvcmRlbTogbnVtYmVyO1xuXG4gIEBDb2x1bW4oe1xuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBSb2xlLFxuICAgIGVudW1OYW1lOiAncGVyZmlsX3Jlc3BvbnNhdmVsJyxcbiAgfSlcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnUGVyZmlsIHJlc3BvbnPDoXZlbCDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc0VudW0oUm9sZSwgeyBtZXNzYWdlOiAnUGVyZmlsIHJlc3BvbnPDoXZlbCBpbnbDoWxpZG8nIH0pXG4gIHBlcmZpbF9yZXNwb25zYXZlbDogUm9sZTtcblxuICBAQ29sdW1uKHsgbnVsbGFibGU6IHRydWUgfSlcbiAgQElzT3B0aW9uYWwoKVxuICBzZXRvcl9pZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oJ3RleHQnLCB7IG51bGxhYmxlOiB0cnVlIH0pXG4gIEBJc09wdGlvbmFsKClcbiAgZGVzY3JpY2FvOiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IGRlZmF1bHQ6IHRydWUgfSlcbiAgb2JyaWdhdG9yaW86IGJvb2xlYW47XG5cbiAgQENvbHVtbih7IGRlZmF1bHQ6IGZhbHNlIH0pXG4gIHBlcm1pdGVfcmV0b3JubzogYm9vbGVhbjtcblxuICBAQ3JlYXRlRGF0ZUNvbHVtbigpXG4gIGNyZWF0ZWRfYXQ6IERhdGU7XG5cbiAgQFVwZGF0ZURhdGVDb2x1bW4oKVxuICB1cGRhdGVkX2F0OiBEYXRlO1xuXG4gIEBEZWxldGVEYXRlQ29sdW1uKClcbiAgcmVtb3ZlZF9hdDogRGF0ZTtcblxuICAvLyBHZXR0ZXJzIGUgU2V0dGVyc1xuICBnZXQgY3JlYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQ7XG4gIH1cblxuICBnZXQgdXBkYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZWRfYXQ7XG4gIH1cblxuICBnZXQgcmVtb3ZlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZWRfYXQ7XG4gIH1cblxuICAvLyBNw6l0b2RvcyBVdGlsaXTDoXJpb3NcblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgbyBmbHV4byBmb2kgY3JpYWRvIHJlY2VudGVtZW50ZSAow7psdGltYXMgMjQgaG9yYXMpXG4gICAqL1xuICBpc0NyaWFkb1JlY2VudGVtZW50ZSgpOiBib29sZWFuIHtcbiAgICBjb25zdCBhZ29yYSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgdW1EaWFBdHJhcyA9IG5ldyBEYXRlKGFnb3JhLmdldFRpbWUoKSAtIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQgPiB1bURpYUF0cmFzO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgYSBpZGFkZSBkbyByZWdpc3RybyBlbSBkaWFzXG4gICAqL1xuICBnZXRJZGFkZVJlZ2lzdHJvRW1EaWFzKCk6IG51bWJlciB7XG4gICAgY29uc3QgYWdvcmEgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRpZmZUaW1lID0gTWF0aC5hYnMoYWdvcmEuZ2V0VGltZSgpIC0gdGhpcy5jcmVhdGVkX2F0LmdldFRpbWUoKSk7XG4gICAgcmV0dXJuIE1hdGguY2VpbChkaWZmVGltZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgZm9pIHJlbW92aWRvXG4gICAqL1xuICBmb2lSZW1vdmlkbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISF0aGlzLnJlbW92ZWRfYXQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgZXN0w6EgYXRpdm9cbiAgICovXG4gIGlzQXRpdm8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLnJlbW92ZWRfYXQ7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgb2JyaWdhdMOzcmlvXG4gICAqL1xuICBpc09icmlnYXRvcmlvKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm9icmlnYXRvcmlvO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBlcm1pdGUgcmV0b3Jub1xuICAgKi9cbiAgcGVybWl0ZVJldG9ybm8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucGVybWl0ZV9yZXRvcm5vO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHRlbSBzZXRvciBkZWZpbmlkb1xuICAgKi9cbiAgdGVtU2V0b3IoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuc2V0b3JfaWQgIT09IG51bGwgJiZcbiAgICAgIHRoaXMuc2V0b3JfaWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgdGhpcy5zZXRvcl9pZC50cmltKCkgIT09ICcnXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSB0ZW0gZGVzY3Jpw6fDo29cbiAgICovXG4gIHRlbURlc2NyaWNhbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5kZXNjcmljYW8gIT09IG51bGwgJiZcbiAgICAgIHRoaXMuZGVzY3JpY2FvICE9PSB1bmRlZmluZWQgJiZcbiAgICAgIHRoaXMuZGVzY3JpY2FvLnRyaW0oKSAhPT0gJydcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBhIGRlc2NyacOnw6NvIGRvIHRpcG8gZGUgZXRhcGFcbiAgICovXG4gIGdldERlc2NyaWNhb1RpcG9FdGFwYSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRlc2NyaWNvZXMgPSB7XG4gICAgICBbVGlwb0V0YXBhLkFCRVJUVVJBXTogJ0FiZXJ0dXJhIGRhIFNvbGljaXRhw6fDo28nLFxuICAgICAgW1RpcG9FdGFwYS5BTkFMSVNFX0RPQ1VNRU5UT1NdOiAnQW7DoWxpc2UgZGUgRG9jdW1lbnRvcycsXG4gICAgICBbVGlwb0V0YXBhLkFOQUxJU0VfVEVDTklDQV06ICdBbsOhbGlzZSBUw6ljbmljYScsXG4gICAgICBbVGlwb0V0YXBhLkFQUk9WQUNBT106ICdBcHJvdmHDp8OjbycsXG4gICAgICBbVGlwb0V0YXBhLkxJQkVSQUNBT106ICdMaWJlcmHDp8OjbyBkbyBCZW5lZsOtY2lvJyxcbiAgICB9O1xuICAgIHJldHVybiBkZXNjcmljb2VzW3RoaXMudGlwb19ldGFwYV0gfHwgJ1RpcG8gZGUgZXRhcGEgZGVzY29uaGVjaWRvJztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gYSBkZXNjcmnDp8OjbyBkbyBwZXJmaWwgcmVzcG9uc8OhdmVsXG4gICAqL1xuICBnZXREZXNjcmljYW9QZXJmaWxSZXNwb25zYXZlbCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRlc2NyaWNvZXMgPSB7XG4gICAgICBbUm9sZS5BRE1JTl06ICdBZG1pbmlzdHJhZG9yJyxcbiAgICAgIFtSb2xlLkdFU1RPUl06ICdHZXN0b3InLFxuICAgICAgW1JvbGUuVEVDTklDT106ICdUw6ljbmljbycsXG4gICAgICBbUm9sZS5DT09SREVOQURPUl06ICdDb29yZGVuYWRvcicsXG4gICAgICBbUm9sZS5BU1NJU1RFTlRFX1NPQ0lBTF06ICdBc3Npc3RlbnRlIFNvY2lhbCcsXG4gICAgICBbUm9sZS5BVURJVE9SXTogJ0F1ZGl0b3InLFxuICAgIH07XG4gICAgcmV0dXJuIChcbiAgICAgIGRlc2NyaWNvZXNbdGhpcy5wZXJmaWxfcmVzcG9uc2F2ZWwgYXMga2V5b2YgdHlwZW9mIGRlc2NyaWNvZXNdIHx8XG4gICAgICAnUGVyZmlsIGRlc2NvbmhlY2lkbydcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIGEgcHJpbWVpcmEgZXRhcGEgZG8gZmx1eG9cbiAgICovXG4gIGlzUHJpbWVpcmFFdGFwYSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5vcmRlbSA9PT0gMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSDDqSB1bWEgZXRhcGEgZGUgYW7DoWxpc2VcbiAgICovXG4gIGlzRXRhcGFBbmFsaXNlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLnRpcG9fZXRhcGEgPT09IFRpcG9FdGFwYS5BTkFMSVNFX0RPQ1VNRU5UT1MgfHxcbiAgICAgIHRoaXMudGlwb19ldGFwYSA9PT0gVGlwb0V0YXBhLkFOQUxJU0VfVEVDTklDQVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIGV0YXBhIGRlIGRlY2lzw6NvXG4gICAqL1xuICBpc0V0YXBhRGVjaXNhbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2V0YXBhID09PSBUaXBvRXRhcGEuQVBST1ZBQ0FPO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIGEgZXRhcGEgZmluYWxcbiAgICovXG4gIGlzRXRhcGFGaW5hbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50aXBvX2V0YXBhID09PSBUaXBvRXRhcGEuTElCRVJBQ0FPO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIHVtYSBldGFwYSBjcsOtdGljYSAob2JyaWdhdMOzcmlhIGUgbsOjbyBwZXJtaXRlIHJldG9ybm8pXG4gICAqL1xuICBpc0V0YXBhQ3JpdGljYSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc09icmlnYXRvcmlvKCkgJiYgIXRoaXMucGVybWl0ZVJldG9ybm8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gbyBuw612ZWwgZGUgY3JpdGljaWRhZGUgZGEgZXRhcGFcbiAgICovXG4gIGdldE5pdmVsQ3JpdGljaWRhZGUoKTogJ0JBSVhBJyB8ICdNRURJQScgfCAnQUxUQScge1xuICAgIGxldCBwb250b3MgPSAwO1xuXG4gICAgaWYgKHRoaXMuaXNPYnJpZ2F0b3JpbygpKSBwb250b3MgKz0gMjtcbiAgICBpZiAoIXRoaXMucGVybWl0ZVJldG9ybm8oKSkgcG9udG9zICs9IDI7XG4gICAgaWYgKHRoaXMuaXNFdGFwYURlY2lzYW8oKSB8fCB0aGlzLmlzRXRhcGFGaW5hbCgpKSBwb250b3MgKz0gMTtcblxuICAgIGlmIChwb250b3MgPD0gMikgcmV0dXJuICdCQUlYQSc7XG4gICAgaWYgKHBvbnRvcyA8PSA0KSByZXR1cm4gJ01FRElBJztcbiAgICByZXR1cm4gJ0FMVEEnO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBlcnRlbmNlIGEgdW0gdGlwbyBkZSBiZW5lZsOtY2lvXG4gICAqL1xuICBwZXJ0ZW5jZUFvVGlwb0JlbmVmaWNpbyh0aXBvQmVuZWZpY2lvSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkID09PSB0aXBvQmVuZWZpY2lvSWQ7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIHVtIHJlc3VtbyBkYSBldGFwYVxuICAgKi9cbiAgZ2V0U3VtbWFyeSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IG9icmlnYXRvcmlvID0gdGhpcy5pc09icmlnYXRvcmlvKCkgPyAnT2JyaWdhdMOzcmlhJyA6ICdPcGNpb25hbCc7XG4gICAgY29uc3QgcmV0b3JubyA9IHRoaXMucGVybWl0ZVJldG9ybm8oKVxuICAgICAgPyAnUGVybWl0ZSByZXRvcm5vJ1xuICAgICAgOiAnTsOjbyBwZXJtaXRlIHJldG9ybm8nO1xuICAgIHJldHVybiBgJHt0aGlzLm9yZGVtfS4gJHt0aGlzLm5vbWVfZXRhcGF9ICgke29icmlnYXRvcmlvfSwgJHtyZXRvcm5vfSlgO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlcmEgdW1hIGNoYXZlIMO6bmljYSBwYXJhIGEgZXRhcGFcbiAgICovXG4gIGdldFVuaXF1ZUtleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgZmx1eG9fJHt0aGlzLnRpcG9fYmVuZWZpY2lvX2lkfV8ke3RoaXMub3JkZW19YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIGV0YXBhIMOpIGNvbnNpc3RlbnRlXG4gICAqL1xuICBpc0NvbnNpc3RlbnRlKCk6IGJvb2xlYW4ge1xuICAgIC8vIFZlcmlmaWNhIHNlIHRlbSB0aXBvIGRlIGJlbmVmw61jaW9cbiAgICBpZiAoIXRoaXMudGlwb19iZW5lZmljaW9faWQpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFZlcmlmaWNhIHNlIHRlbSBub21lIGRhIGV0YXBhXG4gICAgaWYgKCF0aGlzLm5vbWVfZXRhcGEgfHwgdGhpcy5ub21lX2V0YXBhLnRyaW0oKSA9PT0gJycpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFZlcmlmaWNhIHNlIG9yZGVtIMOpIHbDoWxpZGFcbiAgICBpZiAodGhpcy5vcmRlbSA8IDEpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFZlcmlmaWNhIHNlIHRpcG8gZGUgZXRhcGEgw6kgdsOhbGlkb1xuICAgIGlmICghT2JqZWN0LnZhbHVlcyhUaXBvRXRhcGEpLmluY2x1ZGVzKHRoaXMudGlwb19ldGFwYSkpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFZlcmlmaWNhIHNlIHBlcmZpbCByZXNwb25zw6F2ZWwgw6kgdsOhbGlkb1xuICAgIGlmICghT2JqZWN0LnZhbHVlcyhSb2xlKS5pbmNsdWRlcyh0aGlzLnBlcmZpbF9yZXNwb25zYXZlbCkpIHJldHVybiBmYWxzZTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBvZGUgc2VyIHJlbW92aWRhXG4gICAqL1xuICBwb2RlU2VyUmVtb3ZpZGEoKTogYm9vbGVhbiB7XG4gICAgLy8gTsOjbyBwb2RlIHJlbW92ZXIgc2UgasOhIGZvaSByZW1vdmlkYVxuICAgIGlmICh0aGlzLmZvaVJlbW92aWRvKCkpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFByaW1laXJhIGV0YXBhIGdlcmFsbWVudGUgbsOjbyBwb2RlIHNlciByZW1vdmlkYVxuICAgIGlmICh0aGlzLmlzUHJpbWVpcmFFdGFwYSgpKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBFdGFwYXMgb2JyaWdhdMOzcmlhcyBwcmVjaXNhbSBkZSBjdWlkYWRvIGVzcGVjaWFsXG4gICAgaWYgKHRoaXMuaXNPYnJpZ2F0b3JpbygpKSByZXR1cm4gZmFsc2U7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9uYSBhIGV0YXBhIChzZW0gSUQpXG4gICAqL1xuICBjbG9uZSgpOiBQYXJ0aWFsPEZsdXhvQmVuZWZpY2lvPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpcG9fYmVuZWZpY2lvX2lkOiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkLFxuICAgICAgbm9tZV9ldGFwYTogdGhpcy5ub21lX2V0YXBhLFxuICAgICAgdGlwb19ldGFwYTogdGhpcy50aXBvX2V0YXBhLFxuICAgICAgb3JkZW06IHRoaXMub3JkZW0sXG4gICAgICBwZXJmaWxfcmVzcG9uc2F2ZWw6IHRoaXMucGVyZmlsX3Jlc3BvbnNhdmVsLFxuICAgICAgc2V0b3JfaWQ6IHRoaXMuc2V0b3JfaWQsXG4gICAgICBkZXNjcmljYW86IHRoaXMuZGVzY3JpY2FvLFxuICAgICAgb2JyaWdhdG9yaW86IHRoaXMub2JyaWdhdG9yaW8sXG4gICAgICBwZXJtaXRlX3JldG9ybm86IHRoaXMucGVybWl0ZV9yZXRvcm5vLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIGV0YXBhIGZsZXjDrXZlbFxuICAgKi9cbiAgaXNGbGV4aXZlbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMuaXNPYnJpZ2F0b3JpbygpICYmIHRoaXMucGVybWl0ZVJldG9ybm8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRhIGEgZGF0YSBkZSBjcmlhw6fDo29cbiAgICovXG4gIGdldENyaWFjYW9Gb3JtYXRhZGEoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVkX2F0LnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRhIGEgZGF0YSBkZSBhdHVhbGl6YcOnw6NvXG4gICAqL1xuICBnZXRBdHVhbGl6YWNhb0Zvcm1hdGFkYSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZWRfYXQudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBpbmZvcm1hw6fDtWVzIHNlbnPDrXZlaXMgcGFyYSBsb2dzXG4gICAqL1xuICB0b1NhZmVMb2coKTogUGFydGlhbDxGbHV4b0JlbmVmaWNpbz4ge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCxcbiAgICAgIHRpcG9fYmVuZWZpY2lvX2lkOiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkLFxuICAgICAgbm9tZV9ldGFwYTogdGhpcy5ub21lX2V0YXBhLFxuICAgICAgdGlwb19ldGFwYTogdGhpcy50aXBvX2V0YXBhLFxuICAgICAgb3JkZW06IHRoaXMub3JkZW0sXG4gICAgICBwZXJmaWxfcmVzcG9uc2F2ZWw6IHRoaXMucGVyZmlsX3Jlc3BvbnNhdmVsLFxuICAgICAgb2JyaWdhdG9yaW86IHRoaXMub2JyaWdhdG9yaW8sXG4gICAgICBwZXJtaXRlX3JldG9ybm86IHRoaXMucGVybWl0ZV9yZXRvcm5vLFxuICAgICAgY3JlYXRlZF9hdDogdGhpcy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogdGhpcy51cGRhdGVkX2F0LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIHN1Z2VzdMO1ZXMgZGUgbWVsaG9yaWEgcGFyYSBhIGV0YXBhXG4gICAqL1xuICBnZXRTdWdlc3RvZXNNZWxob3JpYSgpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc3VnZXN0b2VzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKCF0aGlzLnRlbURlc2NyaWNhbygpKSB7XG4gICAgICBzdWdlc3RvZXMucHVzaCgnQWRpY2lvbmFyIGRlc2NyacOnw6NvIGRldGFsaGFkYSBkYSBldGFwYScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy50ZW1TZXRvcigpKSB7XG4gICAgICBzdWdlc3RvZXMucHVzaCgnRGVmaW5pciBzZXRvciByZXNwb25zw6F2ZWwgcGVsYSBldGFwYScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzRXRhcGFDcml0aWNhKCkgJiYgIXRoaXMudGVtRGVzY3JpY2FvKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdFdGFwYSBjcsOtdGljYSBkZXZlIHRlciBkZXNjcmnDp8OjbyBkZXRhbGhhZGEnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0V0YXBhQW5hbGlzZSgpICYmIHRoaXMucGVybWl0ZVJldG9ybm8oKSkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ0NvbnNpZGVyYXIgbsOjbyBwZXJtaXRpciByZXRvcm5vIGVtIGV0YXBhcyBkZSBhbsOhbGlzZScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5pc0NvbnNpc3RlbnRlKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdWZXJpZmljYXIgZSBjb3JyaWdpciBpbmNvbnNpc3TDqm5jaWFzIG5vcyBkYWRvcycpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWdlc3RvZXM7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgcHJlY2lzYSBkZSBhdHVhbGl6YcOnw6NvIChkYWRvcyBtdWl0byBhbnRpZ29zKVxuICAgKi9cbiAgcHJlY2lzYUF0dWFsaXphY2FvKCk6IGJvb2xlYW4ge1xuICAgIC8vIEZsdXhvcyBjb20gbWFpcyBkZSA2IG1lc2VzIHBvZGVtIHByZWNpc2FyIGRlIHJldmlzw6NvXG4gICAgY29uc3Qgc2Vpc01lc2VzQXRyYXMgPSBuZXcgRGF0ZSgpO1xuICAgIHNlaXNNZXNlc0F0cmFzLnNldE1vbnRoKHNlaXNNZXNlc0F0cmFzLmdldE1vbnRoKCkgLSA2KTtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0IDwgc2Vpc01lc2VzQXRyYXM7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIGVzdGF0w61zdGljYXMgZGEgZXRhcGFcbiAgICovXG4gIGdldEVzdGF0aXN0aWNhcygpOiB7XG4gICAgb3JkZW06IG51bWJlcjtcbiAgICB0aXBvRXRhcGE6IHN0cmluZztcbiAgICBwZXJmaWxSZXNwb25zYXZlbDogc3RyaW5nO1xuICAgIG9icmlnYXRvcmlvOiBib29sZWFuO1xuICAgIHBlcm1pdGVSZXRvcm5vOiBib29sZWFuO1xuICAgIG5pdmVsQ3JpdGljaWRhZGU6IHN0cmluZztcbiAgICB0ZW1TZXRvcjogYm9vbGVhbjtcbiAgICB0ZW1EZXNjcmljYW86IGJvb2xlYW47XG4gIH0ge1xuICAgIHJldHVybiB7XG4gICAgICBvcmRlbTogdGhpcy5vcmRlbSxcbiAgICAgIHRpcG9FdGFwYTogdGhpcy5nZXREZXNjcmljYW9UaXBvRXRhcGEoKSxcbiAgICAgIHBlcmZpbFJlc3BvbnNhdmVsOiB0aGlzLmdldERlc2NyaWNhb1BlcmZpbFJlc3BvbnNhdmVsKCksXG4gICAgICBvYnJpZ2F0b3JpbzogdGhpcy5pc09icmlnYXRvcmlvKCksXG4gICAgICBwZXJtaXRlUmV0b3JubzogdGhpcy5wZXJtaXRlUmV0b3JubygpLFxuICAgICAgbml2ZWxDcml0aWNpZGFkZTogdGhpcy5nZXROaXZlbENyaXRpY2lkYWRlKCksXG4gICAgICB0ZW1TZXRvcjogdGhpcy50ZW1TZXRvcigpLFxuICAgICAgdGVtRGVzY3JpY2FvOiB0aGlzLnRlbURlc2NyaWNhbygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU2ltdWxhIGEgZXhlY3XDp8OjbyBkYSBldGFwYVxuICAgKi9cbiAgc2ltdWxhckV4ZWN1Y2FvKGRhZG9zOiB7IHBlcmZpbFVzdWFyaW86IFJvbGU7IHNldG9yVXN1YXJpbz86IHN0cmluZyB9KToge1xuICAgIHBvZGVFeGVjdXRhcjogYm9vbGVhbjtcbiAgICBtb3Rpdm9zOiBzdHJpbmdbXTtcbiAgICBvYnNlcnZhY29lczogc3RyaW5nW107XG4gIH0ge1xuICAgIGNvbnN0IG1vdGl2b3M6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3Qgb2JzZXJ2YWNvZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBWZXJpZmljYSBzZSBvIHBlcmZpbCBkbyB1c3XDoXJpbyBwb2RlIGV4ZWN1dGFyIGEgZXRhcGFcbiAgICBpZiAoZGFkb3MucGVyZmlsVXN1YXJpbyAhPT0gdGhpcy5wZXJmaWxfcmVzcG9uc2F2ZWwpIHtcbiAgICAgIG1vdGl2b3MucHVzaChcbiAgICAgICAgYFBlcmZpbCAke2RhZG9zLnBlcmZpbFVzdWFyaW99IG7Do28gYXV0b3JpemFkby4gUmVxdWVyOiAke3RoaXMucGVyZmlsX3Jlc3BvbnNhdmVsfWAsXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFZlcmlmaWNhIHNlIG8gc2V0b3IgZG8gdXN1w6FyaW8gY29ycmVzcG9uZGUgKHNlIGRlZmluaWRvKVxuICAgIGlmICh0aGlzLnRlbVNldG9yKCkgJiYgZGFkb3Muc2V0b3JVc3VhcmlvICE9PSB0aGlzLnNldG9yX2lkKSB7XG4gICAgICBtb3Rpdm9zLnB1c2goJ1VzdcOhcmlvIG7Do28gcGVydGVuY2UgYW8gc2V0b3IgcmVzcG9uc8OhdmVsIHBlbGEgZXRhcGEnKTtcbiAgICB9XG5cbiAgICAvLyBPYnNlcnZhw6fDtWVzIHNvYnJlIGEgZXRhcGFcbiAgICBpZiAodGhpcy5pc09icmlnYXRvcmlvKCkpIHtcbiAgICAgIG9ic2VydmFjb2VzLnB1c2goJ0VzdGEgw6kgdW1hIGV0YXBhIG9icmlnYXTDs3JpYScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5wZXJtaXRlUmV0b3JubygpKSB7XG4gICAgICBvYnNlcnZhY29lcy5wdXNoKCdBdGVuw6fDo286IEVzdGEgZXRhcGEgbsOjbyBwZXJtaXRlIHJldG9ybm8nKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0V0YXBhRmluYWwoKSkge1xuICAgICAgb2JzZXJ2YWNvZXMucHVzaCgnRXN0YSDDqSBhIGV0YXBhIGZpbmFsIGRvIHByb2Nlc3NvJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBvZGVFeGVjdXRhcjogbW90aXZvcy5sZW5ndGggPT09IDAsXG4gICAgICBtb3Rpdm9zLFxuICAgICAgb2JzZXJ2YWNvZXMsXG4gICAgfTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9