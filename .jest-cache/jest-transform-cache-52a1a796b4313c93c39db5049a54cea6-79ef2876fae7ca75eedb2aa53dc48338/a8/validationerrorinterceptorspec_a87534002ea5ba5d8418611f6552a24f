d219e68eb9cf7e4973ed65ae9955139a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const rxjs_1 = require("rxjs");
const validation_error_interceptor_1 = require("./validation-error.interceptor");
describe('ValidationErrorInterceptor', () => {
    let interceptor;
    let mockExecutionContext;
    let mockCallHandler;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [validation_error_interceptor_1.ValidationErrorInterceptor],
        }).compile();
        interceptor = module.get(validation_error_interceptor_1.ValidationErrorInterceptor);
        mockExecutionContext = {
            switchToHttp: jest.fn(),
            getClass: jest.fn(),
            getHandler: jest.fn(),
            getArgs: jest.fn(),
            getArgByIndex: jest.fn(),
            switchToRpc: jest.fn(),
            switchToWs: jest.fn(),
            getType: jest.fn(),
        };
        mockCallHandler = {
            handle: jest.fn(),
        };
    });
    describe('intercept', () => {
        it('deve passar erros não relacionados à validação sem modificação', (done) => {
            const nonValidationError = new Error('Erro genérico');
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => nonValidationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    expect(error).toBe(nonValidationError);
                    done();
                },
            });
        });
        it('deve passar BadRequestException não relacionado à validação', (done) => {
            const nonValidationBadRequest = new common_1.BadRequestException('Erro customizado');
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => nonValidationBadRequest));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    expect(error).toBeInstanceOf(common_1.BadRequestException);
                    expect(error.getResponse()).toBe('Erro customizado');
                    done();
                },
            });
        });
        it('deve melhorar erros de validação do class-validator', (done) => {
            const validationError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be a string',
                    'email must be an email',
                    'idade must not be less than 18',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => validationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    expect(error).toBeInstanceOf(common_1.BadRequestException);
                    const response = error.getResponse();
                    expect(response).toHaveProperty('error', 'Erro de Validação');
                    expect(response).toHaveProperty('message', 'Os dados fornecidos contêm erros de validação');
                    expect(response).toHaveProperty('details');
                    expect(response).toHaveProperty('timestamp');
                    expect(response).toHaveProperty('statusCode', 400);
                    done();
                },
            });
        });
        it('deve agrupar erros por campo', (done) => {
            const validationError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be a string',
                    'nome must be longer than 2 characters',
                    'email must be an email',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => validationError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    const response = error.getResponse();
                    const details = response.details;
                    expect(details).toHaveProperty('nome');
                    expect(details).toHaveProperty('email');
                    expect(details.nome).toHaveLength(2); // Dois erros para o campo nome
                    expect(details.email).toHaveLength(1); // Um erro para o campo email
                    done();
                },
            });
        });
        it('deve melhorar mensagens de erro de enum', (done) => {
            const enumError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'status must be one of the following values [ATIVO, INATIVO, PENDENTE]',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => enumError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    const response = error.getResponse();
                    const details = response.details;
                    expect(details.status[0]).toContain('deve ser um dos seguintes valores');
                    expect(details.status[0]).toContain('ATIVO, INATIVO, PENDENTE');
                    done();
                },
            });
        });
        it('deve melhorar mensagens de erro de tipo', (done) => {
            const typeError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'idade must be a number',
                    'ativo must be a boolean',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => typeError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    const response = error.getResponse();
                    const details = response.details;
                    expect(details.idade[0]).toContain('deve ser um número');
                    expect(details.ativo[0]).toContain('deve ser um verdadeiro ou falso');
                    done();
                },
            });
        });
        it('deve melhorar mensagens de erro de tamanho', (done) => {
            const lengthError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'nome must be longer than 2 characters',
                    'descricao must be shorter than 100 characters',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => lengthError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    const response = error.getResponse();
                    const details = response.details;
                    expect(details.nome[0]).toContain('deve ter mais de 2 caracteres');
                    expect(details.descricao[0]).toContain('deve ter menos de 100 caracteres');
                    done();
                },
            });
        });
        it('deve melhorar mensagens de erro numérico', (done) => {
            const numericError = new common_1.BadRequestException({
                error: 'Bad Request',
                message: [
                    'idade must not be less than 18',
                    'salario must not be greater than 50000',
                ],
                statusCode: 400,
            });
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.throwError)(() => numericError));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                error: (error) => {
                    const response = error.getResponse();
                    const details = response.details;
                    expect(details.idade[0]).toContain('deve ser maior ou igual a 18');
                    expect(details.salario[0]).toContain('deve ser menor ou igual a 50000');
                    done();
                },
            });
        });
        it('deve passar dados válidos sem modificação', (done) => {
            const validData = { id: 1, nome: 'Teste' };
            mockCallHandler.handle = jest.fn(() => (0, rxjs_1.of)(validData));
            interceptor.intercept(mockExecutionContext, mockCallHandler).subscribe({
                next: (data) => {
                    expect(data).toBe(validData);
                    done();
                },
            });
        });
    });
});
describe('ValidationMessageHelper', () => {
    describe('required', () => {
        it('deve criar mensagem para campo obrigatório', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.required('nome');
            expect(message).toBe("O campo 'nome' é obrigatório");
        });
    });
    describe('invalidType', () => {
        it('deve criar mensagem para tipo inválido', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidType('idade', 'number');
            expect(message).toBe("O campo 'idade' deve ser número");
        });
        it('deve mapear tipos em inglês para português', () => {
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'string'))
                .toBe("O campo 'campo' deve ser texto");
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'boolean'))
                .toBe("O campo 'campo' deve ser verdadeiro ou falso");
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidType('campo', 'email'))
                .toBe("O campo 'campo' deve ser email válido");
        });
    });
    describe('invalidLength', () => {
        it('deve criar mensagem para tamanho com min e max', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', 2, 50);
            expect(message).toBe("O campo 'nome' deve ter entre 2 e 50 caracteres");
        });
        it('deve criar mensagem apenas para mínimo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', 2);
            expect(message).toBe("O campo 'nome' deve ter pelo menos 2 caracteres");
        });
        it('deve criar mensagem apenas para máximo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome', undefined, 50);
            expect(message).toBe("O campo 'nome' deve ter no máximo 50 caracteres");
        });
        it('deve criar mensagem genérica quando não há limites', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidLength('nome');
            expect(message).toBe("O campo 'nome' tem tamanho inválido");
        });
    });
    describe('invalidRange', () => {
        it('deve criar mensagem para intervalo com min e max', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', 18, 65);
            expect(message).toBe("O campo 'idade' deve estar entre 18 e 65");
        });
        it('deve criar mensagem apenas para mínimo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', 18);
            expect(message).toBe("O campo 'idade' deve ser maior ou igual a 18");
        });
        it('deve criar mensagem apenas para máximo', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidRange('idade', undefined, 65);
            expect(message).toBe("O campo 'idade' deve ser menor ou igual a 65");
        });
    });
    describe('invalidFormat', () => {
        it('deve criar mensagem para formato inválido', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('email', 'email');
            expect(message).toBe("O campo 'email' deve ter o formato: email válido (exemplo: usuario@dominio.com)");
        });
        it('deve mapear formatos conhecidos', () => {
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('cpf', 'cpf'))
                .toContain('CPF válido (exemplo: 123.456.789-00)');
            expect(validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('telefone', 'phone'))
                .toContain('telefone válido (exemplo: (11) 99999-9999)');
        });
        it('deve usar formato original se não mapeado', () => {
            const message = validation_error_interceptor_1.ValidationMessageHelper.invalidFormat('campo', 'formato_customizado');
            expect(message).toBe("O campo 'campo' deve ter o formato: formato_customizado");
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxcaW50ZXJjZXB0b3JzXFx2YWxpZGF0aW9uLWVycm9yLmludGVyY2VwdG9yLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsMkNBQW9GO0FBQ3BGLCtCQUFzQztBQUN0QyxpRkFBcUc7QUFFckcsUUFBUSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtJQUMxQyxJQUFJLFdBQXVDLENBQUM7SUFDNUMsSUFBSSxvQkFBc0MsQ0FBQztJQUMzQyxJQUFJLGVBQTRCLENBQUM7SUFFakMsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE1BQU0sTUFBTSxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUMzRCxTQUFTLEVBQUUsQ0FBQyx5REFBMEIsQ0FBQztTQUN4QyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixXQUFXLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBNkIseURBQTBCLENBQUMsQ0FBQztRQUVqRixvQkFBb0IsR0FBRztZQUNyQixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN2QixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNuQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN4QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN0QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNuQixDQUFDO1FBRUYsZUFBZSxHQUFHO1lBQ2hCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ2xCLENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxnRUFBZ0UsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO1lBQzVFLE1BQU0sa0JBQWtCLEdBQUcsSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDdEQsZUFBZSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUEsaUJBQVUsRUFBQyxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7WUFFN0UsV0FBVyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3JFLEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUNmLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztvQkFDdkMsSUFBSSxFQUFFLENBQUM7Z0JBQ1QsQ0FBQzthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZEQUE2RCxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDekUsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLDRCQUFtQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDNUUsZUFBZSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUEsaUJBQVUsRUFBQyxHQUFHLEVBQUUsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUM7WUFFbEYsV0FBVyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3JFLEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUNmLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsNEJBQW1CLENBQUMsQ0FBQztvQkFDbEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO29CQUNyRCxJQUFJLEVBQUUsQ0FBQztnQkFDVCxDQUFDO2FBQ0YsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNqRSxNQUFNLGVBQWUsR0FBRyxJQUFJLDRCQUFtQixDQUFDO2dCQUM5QyxLQUFLLEVBQUUsYUFBYTtnQkFDcEIsT0FBTyxFQUFFO29CQUNQLHVCQUF1QjtvQkFDdkIsd0JBQXdCO29CQUN4QixnQ0FBZ0M7aUJBQ2pDO2dCQUNELFVBQVUsRUFBRSxHQUFHO2FBQ2hCLENBQUMsQ0FBQztZQUVILGVBQWUsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLGlCQUFVLEVBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztZQUUxRSxXQUFXLENBQUMsU0FBUyxDQUFDLG9CQUFvQixFQUFFLGVBQWUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztnQkFDckUsS0FBSyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7b0JBQ2YsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyw0QkFBbUIsQ0FBQyxDQUFDO29CQUNsRCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBRXJDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLG1CQUFtQixDQUFDLENBQUM7b0JBQzlELE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLCtDQUErQyxDQUFDLENBQUM7b0JBQzVGLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7b0JBQzNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7b0JBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFLEdBQUcsQ0FBQyxDQUFDO29CQUVuRCxJQUFJLEVBQUUsQ0FBQztnQkFDVCxDQUFDO2FBQ0YsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUMxQyxNQUFNLGVBQWUsR0FBRyxJQUFJLDRCQUFtQixDQUFDO2dCQUM5QyxLQUFLLEVBQUUsYUFBYTtnQkFDcEIsT0FBTyxFQUFFO29CQUNQLHVCQUF1QjtvQkFDdkIsdUNBQXVDO29CQUN2Qyx3QkFBd0I7aUJBQ3pCO2dCQUNELFVBQVUsRUFBRSxHQUFHO2FBQ2hCLENBQUMsQ0FBQztZQUVILGVBQWUsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLGlCQUFVLEVBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztZQUUxRSxXQUFXLENBQUMsU0FBUyxDQUFDLG9CQUFvQixFQUFFLGVBQWUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztnQkFDckUsS0FBSyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7b0JBQ2YsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUNyQyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDO29CQUVqQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO29CQUN2QyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO29CQUN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLCtCQUErQjtvQkFDckUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyw2QkFBNkI7b0JBRXBFLElBQUksRUFBRSxDQUFDO2dCQUNULENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ3JELE1BQU0sU0FBUyxHQUFHLElBQUksNEJBQW1CLENBQUM7Z0JBQ3hDLEtBQUssRUFBRSxhQUFhO2dCQUNwQixPQUFPLEVBQUU7b0JBQ1AsdUVBQXVFO2lCQUN4RTtnQkFDRCxVQUFVLEVBQUUsR0FBRzthQUNoQixDQUFDLENBQUM7WUFFSCxlQUFlLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBQSxpQkFBVSxFQUFDLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFFcEUsV0FBVyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3JFLEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUNmLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztvQkFDckMsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQztvQkFFakMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsbUNBQW1DLENBQUMsQ0FBQztvQkFDekUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsMEJBQTBCLENBQUMsQ0FBQztvQkFFaEUsSUFBSSxFQUFFLENBQUM7Z0JBQ1QsQ0FBQzthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDckQsTUFBTSxTQUFTLEdBQUcsSUFBSSw0QkFBbUIsQ0FBQztnQkFDeEMsS0FBSyxFQUFFLGFBQWE7Z0JBQ3BCLE9BQU8sRUFBRTtvQkFDUCx3QkFBd0I7b0JBQ3hCLHlCQUF5QjtpQkFDMUI7Z0JBQ0QsVUFBVSxFQUFFLEdBQUc7YUFDaEIsQ0FBQyxDQUFDO1lBRUgsZUFBZSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUEsaUJBQVUsRUFBQyxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBRXBFLFdBQVcsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLEVBQUUsZUFBZSxDQUFDLENBQUMsU0FBUyxDQUFDO2dCQUNyRSxLQUFLLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtvQkFDZixNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQ3JDLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUM7b0JBRWpDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLG9CQUFvQixDQUFDLENBQUM7b0JBQ3pELE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7b0JBRXRFLElBQUksRUFBRSxDQUFDO2dCQUNULENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ3hELE1BQU0sV0FBVyxHQUFHLElBQUksNEJBQW1CLENBQUM7Z0JBQzFDLEtBQUssRUFBRSxhQUFhO2dCQUNwQixPQUFPLEVBQUU7b0JBQ1AsdUNBQXVDO29CQUN2QywrQ0FBK0M7aUJBQ2hEO2dCQUNELFVBQVUsRUFBRSxHQUFHO2FBQ2hCLENBQUMsQ0FBQztZQUVILGVBQWUsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLGlCQUFVLEVBQUMsR0FBRyxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztZQUV0RSxXQUFXLENBQUMsU0FBUyxDQUFDLG9CQUFvQixFQUFFLGVBQWUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztnQkFDckUsS0FBSyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7b0JBQ2YsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUNyQyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDO29CQUVqQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO29CQUNuRSxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO29CQUUzRSxJQUFJLEVBQUUsQ0FBQztnQkFDVCxDQUFDO2FBQ0YsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMENBQTBDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUN0RCxNQUFNLFlBQVksR0FBRyxJQUFJLDRCQUFtQixDQUFDO2dCQUMzQyxLQUFLLEVBQUUsYUFBYTtnQkFDcEIsT0FBTyxFQUFFO29CQUNQLGdDQUFnQztvQkFDaEMsd0NBQXdDO2lCQUN6QztnQkFDRCxVQUFVLEVBQUUsR0FBRzthQUNoQixDQUFDLENBQUM7WUFFSCxlQUFlLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBQSxpQkFBVSxFQUFDLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFFdkUsV0FBVyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3JFLEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUNmLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztvQkFDckMsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQztvQkFFakMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsOEJBQThCLENBQUMsQ0FBQztvQkFDbkUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsaUNBQWlDLENBQUMsQ0FBQztvQkFFeEUsSUFBSSxFQUFFLENBQUM7Z0JBQ1QsQ0FBQzthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDdkQsTUFBTSxTQUFTLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQztZQUMzQyxlQUFlLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBQSxTQUFFLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUV0RCxXQUFXLENBQUMsU0FBUyxDQUFDLG9CQUFvQixFQUFFLGVBQWUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztnQkFDckUsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7b0JBQ2IsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztvQkFDN0IsSUFBSSxFQUFFLENBQUM7Z0JBQ1QsQ0FBQzthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7SUFDdkMsUUFBUSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7UUFDeEIsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxNQUFNLE9BQU8sR0FBRyxzREFBdUIsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO1FBQ3ZELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUMzQixFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQ2hELE1BQU0sT0FBTyxHQUFHLHNEQUF1QixDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDdkUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxNQUFNLENBQUMsc0RBQXVCLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztpQkFDM0QsSUFBSSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLHNEQUF1QixDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7aUJBQzVELElBQUksQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxzREFBdUIsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO2lCQUMxRCxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDN0IsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEdBQUcsRUFBRTtZQUN4RCxNQUFNLE9BQU8sR0FBRyxzREFBdUIsQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNyRSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlEQUFpRCxDQUFDLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQ2hELE1BQU0sT0FBTyxHQUFHLHNEQUF1QixDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxpREFBaUQsQ0FBQyxDQUFDO1FBQzFFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLE9BQU8sR0FBRyxzREFBdUIsQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUM3RSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlEQUFpRCxDQUFDLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsR0FBRyxFQUFFO1lBQzVELE1BQU0sT0FBTyxHQUFHLHNEQUF1QixDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUM5RCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHFDQUFxQyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQzVCLEVBQUUsQ0FBQyxrREFBa0QsRUFBRSxHQUFHLEVBQUU7WUFDMUQsTUFBTSxPQUFPLEdBQUcsc0RBQXVCLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDdEUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDO1FBQ25FLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLE9BQU8sR0FBRyxzREFBdUIsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2xFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsOENBQThDLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDaEQsTUFBTSxPQUFPLEdBQUcsc0RBQXVCLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDN0UsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUM3QixFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sT0FBTyxHQUFHLHNEQUF1QixDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDeEUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxpRkFBaUYsQ0FBQyxDQUFDO1FBQzFHLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtZQUN6QyxNQUFNLENBQUMsc0RBQXVCLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztpQkFDeEQsU0FBUyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7WUFDckQsTUFBTSxDQUFDLHNEQUF1QixDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsT0FBTyxDQUFDLENBQUM7aUJBQy9ELFNBQVMsQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1FBQzdELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxNQUFNLE9BQU8sR0FBRyxzREFBdUIsQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLHFCQUFxQixDQUFDLENBQUM7WUFDdEYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx5REFBeUQsQ0FBQyxDQUFDO1FBQ2xGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcc2hhcmVkXFxpbnRlcmNlcHRvcnNcXHZhbGlkYXRpb24tZXJyb3IuaW50ZXJjZXB0b3Iuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IEJhZFJlcXVlc3RFeGNlcHRpb24sIEV4ZWN1dGlvbkNvbnRleHQsIENhbGxIYW5kbGVyIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgb2YsIHRocm93RXJyb3IgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFZhbGlkYXRpb25FcnJvckludGVyY2VwdG9yLCBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlciB9IGZyb20gJy4vdmFsaWRhdGlvbi1lcnJvci5pbnRlcmNlcHRvcic7XG5cbmRlc2NyaWJlKCdWYWxpZGF0aW9uRXJyb3JJbnRlcmNlcHRvcicsICgpID0+IHtcbiAgbGV0IGludGVyY2VwdG9yOiBWYWxpZGF0aW9uRXJyb3JJbnRlcmNlcHRvcjtcbiAgbGV0IG1vY2tFeGVjdXRpb25Db250ZXh0OiBFeGVjdXRpb25Db250ZXh0O1xuICBsZXQgbW9ja0NhbGxIYW5kbGVyOiBDYWxsSGFuZGxlcjtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbVmFsaWRhdGlvbkVycm9ySW50ZXJjZXB0b3JdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIGludGVyY2VwdG9yID0gbW9kdWxlLmdldDxWYWxpZGF0aW9uRXJyb3JJbnRlcmNlcHRvcj4oVmFsaWRhdGlvbkVycm9ySW50ZXJjZXB0b3IpO1xuICAgIFxuICAgIG1vY2tFeGVjdXRpb25Db250ZXh0ID0ge1xuICAgICAgc3dpdGNoVG9IdHRwOiBqZXN0LmZuKCksXG4gICAgICBnZXRDbGFzczogamVzdC5mbigpLFxuICAgICAgZ2V0SGFuZGxlcjogamVzdC5mbigpLFxuICAgICAgZ2V0QXJnczogamVzdC5mbigpLFxuICAgICAgZ2V0QXJnQnlJbmRleDogamVzdC5mbigpLFxuICAgICAgc3dpdGNoVG9ScGM6IGplc3QuZm4oKSxcbiAgICAgIHN3aXRjaFRvV3M6IGplc3QuZm4oKSxcbiAgICAgIGdldFR5cGU6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgbW9ja0NhbGxIYW5kbGVyID0ge1xuICAgICAgaGFuZGxlOiBqZXN0LmZuKCksXG4gICAgfTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ludGVyY2VwdCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSBwYXNzYXIgZXJyb3MgbsOjbyByZWxhY2lvbmFkb3Mgw6AgdmFsaWRhw6fDo28gc2VtIG1vZGlmaWNhw6fDo28nLCAoZG9uZSkgPT4ge1xuICAgICAgY29uc3Qgbm9uVmFsaWRhdGlvbkVycm9yID0gbmV3IEVycm9yKCdFcnJvIGdlbsOpcmljbycpO1xuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gdGhyb3dFcnJvcigoKSA9PiBub25WYWxpZGF0aW9uRXJyb3IpKTtcblxuICAgICAgaW50ZXJjZXB0b3IuaW50ZXJjZXB0KG1vY2tFeGVjdXRpb25Db250ZXh0LCBtb2NrQ2FsbEhhbmRsZXIpLnN1YnNjcmliZSh7XG4gICAgICAgIGVycm9yOiAoZXJyb3IpID0+IHtcbiAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvQmUobm9uVmFsaWRhdGlvbkVycm9yKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHBhc3NhciBCYWRSZXF1ZXN0RXhjZXB0aW9uIG7Do28gcmVsYWNpb25hZG8gw6AgdmFsaWRhw6fDo28nLCAoZG9uZSkgPT4ge1xuICAgICAgY29uc3Qgbm9uVmFsaWRhdGlvbkJhZFJlcXVlc3QgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignRXJybyBjdXN0b21pemFkbycpO1xuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gdGhyb3dFcnJvcigoKSA9PiBub25WYWxpZGF0aW9uQmFkUmVxdWVzdCkpO1xuXG4gICAgICBpbnRlcmNlcHRvci5pbnRlcmNlcHQobW9ja0V4ZWN1dGlvbkNvbnRleHQsIG1vY2tDYWxsSGFuZGxlcikuc3Vic2NyaWJlKHtcbiAgICAgICAgZXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICAgICAgZXhwZWN0KGVycm9yLmdldFJlc3BvbnNlKCkpLnRvQmUoJ0Vycm8gY3VzdG9taXphZG8nKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1lbGhvcmFyIGVycm9zIGRlIHZhbGlkYcOnw6NvIGRvIGNsYXNzLXZhbGlkYXRvcicsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ25vbWUgbXVzdCBiZSBhIHN0cmluZycsXG4gICAgICAgICAgJ2VtYWlsIG11c3QgYmUgYW4gZW1haWwnLFxuICAgICAgICAgICdpZGFkZSBtdXN0IG5vdCBiZSBsZXNzIHRoYW4gMTgnLFxuICAgICAgICBdLFxuICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICB9KTtcblxuICAgICAgbW9ja0NhbGxIYW5kbGVyLmhhbmRsZSA9IGplc3QuZm4oKCkgPT4gdGhyb3dFcnJvcigoKSA9PiB2YWxpZGF0aW9uRXJyb3IpKTtcblxuICAgICAgaW50ZXJjZXB0b3IuaW50ZXJjZXB0KG1vY2tFeGVjdXRpb25Db250ZXh0LCBtb2NrQ2FsbEhhbmRsZXIpLnN1YnNjcmliZSh7XG4gICAgICAgIGVycm9yOiAoZXJyb3IpID0+IHtcbiAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3IuZ2V0UmVzcG9uc2UoKTtcbiAgICAgICAgICBcbiAgICAgICAgICBleHBlY3QocmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicsICdFcnJvIGRlIFZhbGlkYcOnw6NvJyk7XG4gICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScsICdPcyBkYWRvcyBmb3JuZWNpZG9zIGNvbnTDqm0gZXJyb3MgZGUgdmFsaWRhw6fDo28nKTtcbiAgICAgICAgICBleHBlY3QocmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdkZXRhaWxzJyk7XG4gICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgndGltZXN0YW1wJyk7XG4gICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzQ29kZScsIDQwMCk7XG4gICAgICAgICAgXG4gICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBhZ3J1cGFyIGVycm9zIHBvciBjYW1wbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ25vbWUgbXVzdCBiZSBhIHN0cmluZycsXG4gICAgICAgICAgJ25vbWUgbXVzdCBiZSBsb25nZXIgdGhhbiAyIGNoYXJhY3RlcnMnLFxuICAgICAgICAgICdlbWFpbCBtdXN0IGJlIGFuIGVtYWlsJyxcbiAgICAgICAgXSxcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDYWxsSGFuZGxlci5oYW5kbGUgPSBqZXN0LmZuKCgpID0+IHRocm93RXJyb3IoKCkgPT4gdmFsaWRhdGlvbkVycm9yKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSByZXNwb25zZS5kZXRhaWxzO1xuICAgICAgICAgIFxuICAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnbm9tZScpO1xuICAgICAgICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5ub21lKS50b0hhdmVMZW5ndGgoMik7IC8vIERvaXMgZXJyb3MgcGFyYSBvIGNhbXBvIG5vbWVcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5lbWFpbCkudG9IYXZlTGVuZ3RoKDEpOyAvLyBVbSBlcnJvIHBhcmEgbyBjYW1wbyBlbWFpbFxuICAgICAgICAgIFxuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWVsaG9yYXIgbWVuc2FnZW5zIGRlIGVycm8gZGUgZW51bScsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBlbnVtRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ3N0YXR1cyBtdXN0IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlcyBbQVRJVk8sIElOQVRJVk8sIFBFTkRFTlRFXScsXG4gICAgICAgIF0sXG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IGVudW1FcnJvcikpO1xuXG4gICAgICBpbnRlcmNlcHRvci5pbnRlcmNlcHQobW9ja0V4ZWN1dGlvbkNvbnRleHQsIG1vY2tDYWxsSGFuZGxlcikuc3Vic2NyaWJlKHtcbiAgICAgICAgZXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3IuZ2V0UmVzcG9uc2UoKTtcbiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gcmVzcG9uc2UuZGV0YWlscztcbiAgICAgICAgICBcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5zdGF0dXNbMF0pLnRvQ29udGFpbignZGV2ZSBzZXIgdW0gZG9zIHNlZ3VpbnRlcyB2YWxvcmVzJyk7XG4gICAgICAgICAgZXhwZWN0KGRldGFpbHMuc3RhdHVzWzBdKS50b0NvbnRhaW4oJ0FUSVZPLCBJTkFUSVZPLCBQRU5ERU5URScpO1xuICAgICAgICAgIFxuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWVsaG9yYXIgbWVuc2FnZW5zIGRlIGVycm8gZGUgdGlwbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCB0eXBlRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ2lkYWRlIG11c3QgYmUgYSBudW1iZXInLFxuICAgICAgICAgICdhdGl2byBtdXN0IGJlIGEgYm9vbGVhbicsXG4gICAgICAgIF0sXG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IHR5cGVFcnJvcikpO1xuXG4gICAgICBpbnRlcmNlcHRvci5pbnRlcmNlcHQobW9ja0V4ZWN1dGlvbkNvbnRleHQsIG1vY2tDYWxsSGFuZGxlcikuc3Vic2NyaWJlKHtcbiAgICAgICAgZXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3IuZ2V0UmVzcG9uc2UoKTtcbiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gcmVzcG9uc2UuZGV0YWlscztcbiAgICAgICAgICBcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5pZGFkZVswXSkudG9Db250YWluKCdkZXZlIHNlciB1bSBuw7ptZXJvJyk7XG4gICAgICAgICAgZXhwZWN0KGRldGFpbHMuYXRpdm9bMF0pLnRvQ29udGFpbignZGV2ZSBzZXIgdW0gdmVyZGFkZWlybyBvdSBmYWxzbycpO1xuICAgICAgICAgIFxuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWVsaG9yYXIgbWVuc2FnZW5zIGRlIGVycm8gZGUgdGFtYW5obycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBsZW5ndGhFcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKHtcbiAgICAgICAgZXJyb3I6ICdCYWQgUmVxdWVzdCcsXG4gICAgICAgIG1lc3NhZ2U6IFtcbiAgICAgICAgICAnbm9tZSBtdXN0IGJlIGxvbmdlciB0aGFuIDIgY2hhcmFjdGVycycsXG4gICAgICAgICAgJ2Rlc2NyaWNhbyBtdXN0IGJlIHNob3J0ZXIgdGhhbiAxMDAgY2hhcmFjdGVycycsXG4gICAgICAgIF0sXG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiB0aHJvd0Vycm9yKCgpID0+IGxlbmd0aEVycm9yKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSByZXNwb25zZS5kZXRhaWxzO1xuICAgICAgICAgIFxuICAgICAgICAgIGV4cGVjdChkZXRhaWxzLm5vbWVbMF0pLnRvQ29udGFpbignZGV2ZSB0ZXIgbWFpcyBkZSAyIGNhcmFjdGVyZXMnKTtcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5kZXNjcmljYW9bMF0pLnRvQ29udGFpbignZGV2ZSB0ZXIgbWVub3MgZGUgMTAwIGNhcmFjdGVyZXMnKTtcbiAgICAgICAgICBcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1lbGhvcmFyIG1lbnNhZ2VucyBkZSBlcnJvIG51bcOpcmljbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCBudW1lcmljRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbih7XG4gICAgICAgIGVycm9yOiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICBtZXNzYWdlOiBbXG4gICAgICAgICAgJ2lkYWRlIG11c3Qgbm90IGJlIGxlc3MgdGhhbiAxOCcsXG4gICAgICAgICAgJ3NhbGFyaW8gbXVzdCBub3QgYmUgZ3JlYXRlciB0aGFuIDUwMDAwJyxcbiAgICAgICAgXSxcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDYWxsSGFuZGxlci5oYW5kbGUgPSBqZXN0LmZuKCgpID0+IHRocm93RXJyb3IoKCkgPT4gbnVtZXJpY0Vycm9yKSk7XG5cbiAgICAgIGludGVyY2VwdG9yLmludGVyY2VwdChtb2NrRXhlY3V0aW9uQ29udGV4dCwgbW9ja0NhbGxIYW5kbGVyKS5zdWJzY3JpYmUoe1xuICAgICAgICBlcnJvcjogKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBlcnJvci5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSByZXNwb25zZS5kZXRhaWxzO1xuICAgICAgICAgIFxuICAgICAgICAgIGV4cGVjdChkZXRhaWxzLmlkYWRlWzBdKS50b0NvbnRhaW4oJ2RldmUgc2VyIG1haW9yIG91IGlndWFsIGEgMTgnKTtcbiAgICAgICAgICBleHBlY3QoZGV0YWlscy5zYWxhcmlvWzBdKS50b0NvbnRhaW4oJ2RldmUgc2VyIG1lbm9yIG91IGlndWFsIGEgNTAwMDAnKTtcbiAgICAgICAgICBcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHBhc3NhciBkYWRvcyB2w6FsaWRvcyBzZW0gbW9kaWZpY2HDp8OjbycsIChkb25lKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZERhdGEgPSB7IGlkOiAxLCBub21lOiAnVGVzdGUnIH07XG4gICAgICBtb2NrQ2FsbEhhbmRsZXIuaGFuZGxlID0gamVzdC5mbigoKSA9PiBvZih2YWxpZERhdGEpKTtcblxuICAgICAgaW50ZXJjZXB0b3IuaW50ZXJjZXB0KG1vY2tFeGVjdXRpb25Db250ZXh0LCBtb2NrQ2FsbEhhbmRsZXIpLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6IChkYXRhKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KGRhdGEpLnRvQmUodmFsaWREYXRhKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ1ZhbGlkYXRpb25NZXNzYWdlSGVscGVyJywgKCkgPT4ge1xuICBkZXNjcmliZSgncmVxdWlyZWQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gcGFyYSBjYW1wbyBvYnJpZ2F0w7NyaW8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIucmVxdWlyZWQoJ25vbWUnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlKS50b0JlKFwiTyBjYW1wbyAnbm9tZScgw6kgb2JyaWdhdMOzcmlvXCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW52YWxpZFR5cGUnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gcGFyYSB0aXBvIGludsOhbGlkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkVHlwZSgnaWRhZGUnLCAnbnVtYmVyJyk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2lkYWRlJyBkZXZlIHNlciBuw7ptZXJvXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWFwZWFyIHRpcG9zIGVtIGluZ2zDqnMgcGFyYSBwb3J0dWd1w6pzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRUeXBlKCdjYW1wbycsICdzdHJpbmcnKSlcbiAgICAgICAgLnRvQmUoXCJPIGNhbXBvICdjYW1wbycgZGV2ZSBzZXIgdGV4dG9cIik7XG4gICAgICBleHBlY3QoVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZFR5cGUoJ2NhbXBvJywgJ2Jvb2xlYW4nKSlcbiAgICAgICAgLnRvQmUoXCJPIGNhbXBvICdjYW1wbycgZGV2ZSBzZXIgdmVyZGFkZWlybyBvdSBmYWxzb1wiKTtcbiAgICAgIGV4cGVjdChWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkVHlwZSgnY2FtcG8nLCAnZW1haWwnKSlcbiAgICAgICAgLnRvQmUoXCJPIGNhbXBvICdjYW1wbycgZGV2ZSBzZXIgZW1haWwgdsOhbGlkb1wiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ludmFsaWRMZW5ndGgnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gcGFyYSB0YW1hbmhvIGNvbSBtaW4gZSBtYXgnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZExlbmd0aCgnbm9tZScsIDIsIDUwKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlKS50b0JlKFwiTyBjYW1wbyAnbm9tZScgZGV2ZSB0ZXIgZW50cmUgMiBlIDUwIGNhcmFjdGVyZXNcIik7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBjcmlhciBtZW5zYWdlbSBhcGVuYXMgcGFyYSBtw61uaW1vJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRMZW5ndGgoJ25vbWUnLCAyKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlKS50b0JlKFwiTyBjYW1wbyAnbm9tZScgZGV2ZSB0ZXIgcGVsbyBtZW5vcyAyIGNhcmFjdGVyZXNcIik7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBjcmlhciBtZW5zYWdlbSBhcGVuYXMgcGFyYSBtw6F4aW1vJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRMZW5ndGgoJ25vbWUnLCB1bmRlZmluZWQsIDUwKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlKS50b0JlKFwiTyBjYW1wbyAnbm9tZScgZGV2ZSB0ZXIgbm8gbcOheGltbyA1MCBjYXJhY3RlcmVzXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gZ2Vuw6lyaWNhIHF1YW5kbyBuw6NvIGjDoSBsaW1pdGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRMZW5ndGgoJ25vbWUnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlKS50b0JlKFwiTyBjYW1wbyAnbm9tZScgdGVtIHRhbWFuaG8gaW52w6FsaWRvXCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW52YWxpZFJhbmdlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIG1lbnNhZ2VtIHBhcmEgaW50ZXJ2YWxvIGNvbSBtaW4gZSBtYXgnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZFJhbmdlKCdpZGFkZScsIDE4LCA2NSk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2lkYWRlJyBkZXZlIGVzdGFyIGVudHJlIDE4IGUgNjVcIik7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBjcmlhciBtZW5zYWdlbSBhcGVuYXMgcGFyYSBtw61uaW1vJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRSYW5nZSgnaWRhZGUnLCAxOCk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2lkYWRlJyBkZXZlIHNlciBtYWlvciBvdSBpZ3VhbCBhIDE4XCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY3JpYXIgbWVuc2FnZW0gYXBlbmFzIHBhcmEgbcOheGltbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkUmFuZ2UoJ2lkYWRlJywgdW5kZWZpbmVkLCA2NSk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2lkYWRlJyBkZXZlIHNlciBtZW5vciBvdSBpZ3VhbCBhIDY1XCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW52YWxpZEZvcm1hdCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSBjcmlhciBtZW5zYWdlbSBwYXJhIGZvcm1hdG8gaW52w6FsaWRvJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IFZhbGlkYXRpb25NZXNzYWdlSGVscGVyLmludmFsaWRGb3JtYXQoJ2VtYWlsJywgJ2VtYWlsJyk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2VtYWlsJyBkZXZlIHRlciBvIGZvcm1hdG86IGVtYWlsIHbDoWxpZG8gKGV4ZW1wbG86IHVzdWFyaW9AZG9taW5pby5jb20pXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbWFwZWFyIGZvcm1hdG9zIGNvbmhlY2lkb3MnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZEZvcm1hdCgnY3BmJywgJ2NwZicpKVxuICAgICAgICAudG9Db250YWluKCdDUEYgdsOhbGlkbyAoZXhlbXBsbzogMTIzLjQ1Ni43ODktMDApJyk7XG4gICAgICBleHBlY3QoVmFsaWRhdGlvbk1lc3NhZ2VIZWxwZXIuaW52YWxpZEZvcm1hdCgndGVsZWZvbmUnLCAncGhvbmUnKSlcbiAgICAgICAgLnRvQ29udGFpbigndGVsZWZvbmUgdsOhbGlkbyAoZXhlbXBsbzogKDExKSA5OTk5OS05OTk5KScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdXNhciBmb3JtYXRvIG9yaWdpbmFsIHNlIG7Do28gbWFwZWFkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBWYWxpZGF0aW9uTWVzc2FnZUhlbHBlci5pbnZhbGlkRm9ybWF0KCdjYW1wbycsICdmb3JtYXRvX2N1c3RvbWl6YWRvJyk7XG4gICAgICBleHBlY3QobWVzc2FnZSkudG9CZShcIk8gY2FtcG8gJ2NhbXBvJyBkZXZlIHRlciBvIGZvcm1hdG86IGZvcm1hdG9fY3VzdG9taXphZG9cIik7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9