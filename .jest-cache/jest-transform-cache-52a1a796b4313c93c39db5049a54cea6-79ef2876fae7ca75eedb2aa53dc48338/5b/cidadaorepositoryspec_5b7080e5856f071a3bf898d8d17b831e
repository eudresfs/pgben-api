d1b16c4d483873c868701628c6178eee
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("typeorm");
const common_1 = require("@nestjs/common");
const cidadao_repository_1 = require("@modules/cidadao/repositories/cidadao.repository");
const cidadao_entity_1 = require("@modules/cidadao/entities/cidadao.entity");
describe('CidadaoRepository', () => {
    let repository;
    let dataSource;
    let typeormRepository;
    const mockTypeormRepository = {
        find: jest.fn(),
        findOne: jest.fn(),
        create: jest.fn(),
        save: jest.fn(),
        update: jest.fn(),
        softDelete: jest.fn(),
        findAndCount: jest.fn(),
    };
    const mockDataSource = {
        getRepository: jest.fn().mockReturnValue(mockTypeormRepository),
    };
    const mockCidadao = {
        id: '550e8400-e29b-41d4-a716-446655440000',
        nome: 'João da Silva',
        nome_social: 'João',
        cpf: '12345678901',
        rg: '123456789',
        nis: '12345678901',
        nome_mae: 'Maria da Silva',
        naturalidade: 'São Paulo',
        prontuario_suas: 'SUAS123456',
        data_nascimento: new Date('1990-01-01'),
        sexo: cidadao_entity_1.Sexo.MASCULINO,
        telefone: '11999999999',
        email: 'joao@example.com',
        endereco: {
            logradouro: 'Rua das Flores',
            numero: '123',
            bairro: 'Centro',
            cidade: 'São Paulo',
            estado: 'SP',
            cep: '01234567',
        },
        papeis: [],
        composicao_familiar: [],
        ativo: true,
        created_at: new Date(),
        updated_at: new Date(),
        removed_at: null,
    };
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                cidadao_repository_1.CidadaoRepository,
                {
                    provide: typeorm_1.DataSource,
                    useValue: mockDataSource,
                },
            ],
        }).compile();
        repository = module.get(cidadao_repository_1.CidadaoRepository);
        dataSource = module.get(typeorm_1.DataSource);
        typeormRepository = mockTypeormRepository;
        jest.clearAllMocks();
    });
    it('deve estar definido', () => {
        expect(repository).toBeDefined();
    });
    describe('findById', () => {
        it('deve buscar cidadão por ID com relacionamentos por padrão', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findById('550e8400-e29b-41d4-a716-446655440000');
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { id: '550e8400-e29b-41d4-a716-446655440000' },
                relations: ['papeis', 'composicao_familiar'],
            });
            expect(result).toEqual(mockCidadao);
        });
        it('deve buscar cidadão por ID sem relacionamentos quando especificado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findById('550e8400-e29b-41d4-a716-446655440000', false);
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { id: '550e8400-e29b-41d4-a716-446655440000' },
            });
            expect(result).toEqual(mockCidadao);
        });
        it('deve retornar null quando cidadão não for encontrado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(null);
            const result = await repository.findById('id-inexistente');
            expect(result).toBeNull();
        });
    });
    describe('findByCpf', () => {
        it('deve buscar cidadão por CPF normalizado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findByCpf('123.456.789-01');
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { cpf: '12345678901' },
            });
            expect(result).toEqual(mockCidadao);
        });
        it('deve buscar cidadão por CPF com relacionamentos quando especificado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findByCpf('12345678901', true);
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { cpf: '12345678901' },
                relations: ['papeis', 'composicao_familiar'],
            });
            expect(result).toEqual(mockCidadao);
        });
    });
    describe('findByNis', () => {
        it('deve buscar cidadão por NIS normalizado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findByNis('123.456.789-01');
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { nis: '12345678901' },
            });
            expect(result).toEqual(mockCidadao);
        });
        it('deve buscar cidadão por NIS com relacionamentos quando especificado', async () => {
            mockTypeormRepository.findOne.mockResolvedValue(mockCidadao);
            const result = await repository.findByNis('12345678901', true);
            expect(mockTypeormRepository.findOne).toHaveBeenCalledWith({
                where: { nis: '12345678901' },
                relations: ['papeis', 'composicao_familiar'],
            });
            expect(result).toEqual(mockCidadao);
        });
    });
    describe('update', () => {
        it('deve atualizar cidadão e retornar dados atualizados', async () => {
            const updateData = { nome: 'João Silva Atualizado' };
            mockTypeormRepository.update.mockResolvedValue({ affected: 1 });
            mockTypeormRepository.findOne.mockResolvedValue({
                ...mockCidadao,
                ...updateData,
            });
            const result = await repository.update('550e8400-e29b-41d4-a716-446655440000', updateData);
            expect(mockTypeormRepository.update).toHaveBeenCalledWith('550e8400-e29b-41d4-a716-446655440000', updateData);
            expect(result.nome).toBe('João Silva Atualizado');
        });
        it('deve normalizar CPF antes de atualizar', async () => {
            const updateData = { cpf: '987.654.321-00' };
            mockTypeormRepository.update.mockResolvedValue({ affected: 1 });
            mockTypeormRepository.findOne.mockResolvedValue({
                ...mockCidadao,
                cpf: '98765432100',
            });
            await repository.update('550e8400-e29b-41d4-a716-446655440000', updateData);
            expect(mockTypeormRepository.update).toHaveBeenCalledWith('550e8400-e29b-41d4-a716-446655440000', { cpf: '98765432100' });
        });
        it('deve normalizar NIS antes de atualizar', async () => {
            const updateData = { nis: '987.654.321-00' };
            mockTypeormRepository.update.mockResolvedValue({ affected: 1 });
            mockTypeormRepository.findOne.mockResolvedValue({
                ...mockCidadao,
                nis: '98765432100',
            });
            await repository.update('550e8400-e29b-41d4-a716-446655440000', updateData);
            expect(mockTypeormRepository.update).toHaveBeenCalledWith('550e8400-e29b-41d4-a716-446655440000', { nis: '98765432100' });
        });
        it('deve lançar NotFoundException quando cidadão não for encontrado', async () => {
            mockTypeormRepository.update.mockResolvedValue({ affected: 0 });
            await expect(repository.update('id-inexistente', { nome: 'Teste' })).rejects.toThrow(common_1.NotFoundException);
        });
        it('deve lançar NotFoundException quando cidadão não for encontrado após atualização', async () => {
            mockTypeormRepository.update.mockResolvedValue({ affected: 1 });
            mockTypeormRepository.findOne.mockResolvedValue(null);
            await expect(repository.update('550e8400-e29b-41d4-a716-446655440000', {
                nome: 'Teste',
            })).rejects.toThrow(common_1.NotFoundException);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFx0ZXN0XFx1bml0XFxjaWRhZGFvXFxjaWRhZGFvLnJlcG9zaXRvcnkuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCxxQ0FBaUQ7QUFDakQsMkNBQW1EO0FBQ25ELHlGQUFxRjtBQUNyRiw2RUFBeUU7QUFFekUsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtJQUNqQyxJQUFJLFVBQTZCLENBQUM7SUFDbEMsSUFBSSxVQUFzQixDQUFDO0lBQzNCLElBQUksaUJBQXNDLENBQUM7SUFFM0MsTUFBTSxxQkFBcUIsR0FBRztRQUM1QixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDckIsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDeEIsQ0FBQztJQUVGLE1BQU0sY0FBYyxHQUFHO1FBQ3JCLGFBQWEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLHFCQUFxQixDQUFDO0tBQ2hFLENBQUM7SUFFRixNQUFNLFdBQVcsR0FBWTtRQUMzQixFQUFFLEVBQUUsc0NBQXNDO1FBQzFDLElBQUksRUFBRSxlQUFlO1FBQ3JCLFdBQVcsRUFBRSxNQUFNO1FBQ25CLEdBQUcsRUFBRSxhQUFhO1FBQ2xCLEVBQUUsRUFBRSxXQUFXO1FBQ2YsR0FBRyxFQUFFLGFBQWE7UUFDbEIsUUFBUSxFQUFFLGdCQUFnQjtRQUMxQixZQUFZLEVBQUUsV0FBVztRQUN6QixlQUFlLEVBQUUsWUFBWTtR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LE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUV0RCxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsTUFBTSxDQUFDLHNDQUFzQyxFQUFFO2dCQUN4RCxJQUFJLEVBQUUsT0FBTzthQUNkLENBQUMsQ0FDSCxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMEJBQWlCLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFx0ZXN0XFx1bml0XFxjaWRhZGFvXFxjaWRhZGFvLnJlcG9zaXRvcnkuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IERhdGFTb3VyY2UsIFJlcG9zaXRvcnkgfSBmcm9tICd0eXBlb3JtJztcbmltcG9ydCB7IE5vdEZvdW5kRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQ2lkYWRhb1JlcG9zaXRvcnkgfSBmcm9tICdAbW9kdWxlcy9jaWRhZGFvL3JlcG9zaXRvcmllcy9jaWRhZGFvLnJlcG9zaXRvcnknO1xuaW1wb3J0IHsgQ2lkYWRhbywgU2V4byB9IGZyb20gJ0Btb2R1bGVzL2NpZGFkYW8vZW50aXRpZXMvY2lkYWRhby5lbnRpdHknO1xuXG5kZXNjcmliZSgnQ2lkYWRhb1JlcG9zaXRvcnknLCAoKSA9PiB7XG4gIGxldCByZXBvc2l0b3J5OiBDaWRhZGFvUmVwb3NpdG9yeTtcbiAgbGV0IGRhdGFTb3VyY2U6IERhdGFTb3VyY2U7XG4gIGxldCB0eXBlb3JtUmVwb3NpdG9yeTogUmVwb3NpdG9yeTxDaWRhZGFvPjtcblxuICBjb25zdCBtb2NrVHlwZW9ybVJlcG9zaXRvcnkgPSB7XG4gICAgZmluZDogamVzdC5mbigpLFxuICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICBzYXZlOiBqZXN0LmZuKCksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgc29mdERlbGV0ZTogamVzdC5mbigpLFxuICAgIGZpbmRBbmRDb3VudDogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tEYXRhU291cmNlID0ge1xuICAgIGdldFJlcG9zaXRvcnk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobW9ja1R5cGVvcm1SZXBvc2l0b3J5KSxcbiAgfTtcblxuICBjb25zdCBtb2NrQ2lkYWRhbzogQ2lkYWRhbyA9IHtcbiAgICBpZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgbm9tZTogJ0pvw6NvIGRhIFNpbHZhJyxcbiAgICBub21lX3NvY2lhbDogJ0pvw6NvJyxcbiAgICBjcGY6ICcxMjM0NTY3ODkwMScsXG4gICAgcmc6ICcxMjM0NTY3ODknLFxuICAgIG5pczogJzEyMzQ1Njc4OTAxJyxcbiAgICBub21lX21hZTogJ01hcmlhIGRhIFNpbHZhJyxcbiAgICBuYXR1cmFsaWRhZGU6ICdTw6NvIFBhdWxvJyxcbiAgICBwcm9udHVhcmlvX3N1YXM6ICdTVUFTMTIzNDU2JyxcbiAgICBkYXRhX25hc2NpbWVudG86IG5ldyBEYXRlKCcxOTkwLTAxLTAxJyksXG4gICAgc2V4bzogU2V4by5NQVNDVUxJTk8sXG4gICAgdGVsZWZvbmU6ICcxMTk5OTk5OTk5OScsXG4gICAgZW1haWw6ICdqb2FvQGV4YW1wbGUuY29tJyxcbiAgICBlbmRlcmVjbzoge1xuICAgICAgbG9ncmFkb3VybzogJ1J1YSBkYXMgRmxvcmVzJyxcbiAgICAgIG51bWVybzogJzEyMycsXG4gICAgICBiYWlycm86ICdDZW50cm8nLFxuICAgICAgY2lkYWRlOiAnU8OjbyBQYXVsbycsXG4gICAgICBlc3RhZG86ICdTUCcsXG4gICAgICBjZXA6ICcwMTIzNDU2NycsXG4gICAgfSxcbiAgICBwYXBlaXM6IFtdLFxuICAgIGNvbXBvc2ljYW9fZmFtaWxpYXI6IFtdLFxuICAgIGF0aXZvOiB0cnVlLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICByZW1vdmVkX2F0OiBudWxsLFxuICB9IGFzIHVua25vd24gYXMgQ2lkYWRhbztcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIENpZGFkYW9SZXBvc2l0b3J5LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogRGF0YVNvdXJjZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0RhdGFTb3VyY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHJlcG9zaXRvcnkgPSBtb2R1bGUuZ2V0PENpZGFkYW9SZXBvc2l0b3J5PihDaWRhZGFvUmVwb3NpdG9yeSk7XG4gICAgZGF0YVNvdXJjZSA9IG1vZHVsZS5nZXQ8RGF0YVNvdXJjZT4oRGF0YVNvdXJjZSk7XG4gICAgdHlwZW9ybVJlcG9zaXRvcnkgPSBtb2NrVHlwZW9ybVJlcG9zaXRvcnkgYXMgYW55O1xuXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdkZXZlIGVzdGFyIGRlZmluaWRvJywgKCkgPT4ge1xuICAgIGV4cGVjdChyZXBvc2l0b3J5KS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEJ5SWQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBJRCBjb20gcmVsYWNpb25hbWVudG9zIHBvciBwYWRyw6NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NpZGFkYW8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmZpbmRCeUlkKFxuICAgICAgICAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcgfSxcbiAgICAgICAgcmVsYXRpb25zOiBbJ3BhcGVpcycsICdjb21wb3NpY2FvX2ZhbWlsaWFyJ10sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0NpZGFkYW8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBJRCBzZW0gcmVsYWNpb25hbWVudG9zIHF1YW5kbyBlc3BlY2lmaWNhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhbyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5SWQoXG4gICAgICAgICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgICBmYWxzZSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQ2lkYWRhbyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBudWxsIHF1YW5kbyBjaWRhZMOjbyBuw6NvIGZvciBlbmNvbnRyYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5SWQoJ2lkLWluZXhpc3RlbnRlJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlDcGYnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBDUEYgbm9ybWFsaXphZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhbyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5Q3BmKCcxMjMuNDU2Ljc4OS0wMScpO1xuXG4gICAgICBleHBlY3QobW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgY3BmOiAnMTIzNDU2Nzg5MDEnIH0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0NpZGFkYW8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBDUEYgY29tIHJlbGFjaW9uYW1lbnRvcyBxdWFuZG8gZXNwZWNpZmljYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NpZGFkYW8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmZpbmRCeUNwZignMTIzNDU2Nzg5MDEnLCB0cnVlKTtcblxuICAgICAgZXhwZWN0KG1vY2tUeXBlb3JtUmVwb3NpdG9yeS5maW5kT25lKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGNwZjogJzEyMzQ1Njc4OTAxJyB9LFxuICAgICAgICByZWxhdGlvbnM6IFsncGFwZWlzJywgJ2NvbXBvc2ljYW9fZmFtaWxpYXInXSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQ2lkYWRhbyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlOaXMnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBOSVMgbm9ybWFsaXphZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhbyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5TmlzKCcxMjMuNDU2Ljc4OS0wMScpO1xuXG4gICAgICBleHBlY3QobW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgbmlzOiAnMTIzNDU2Nzg5MDEnIH0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0NpZGFkYW8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgYnVzY2FyIGNpZGFkw6NvIHBvciBOSVMgY29tIHJlbGFjaW9uYW1lbnRvcyBxdWFuZG8gZXNwZWNpZmljYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NpZGFkYW8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmZpbmRCeU5pcygnMTIzNDU2Nzg5MDEnLCB0cnVlKTtcblxuICAgICAgZXhwZWN0KG1vY2tUeXBlb3JtUmVwb3NpdG9yeS5maW5kT25lKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IG5pczogJzEyMzQ1Njc4OTAxJyB9LFxuICAgICAgICByZWxhdGlvbnM6IFsncGFwZWlzJywgJ2NvbXBvc2ljYW9fZmFtaWxpYXInXSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQ2lkYWRhbyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYXR1YWxpemFyIGNpZGFkw6NvIGUgcmV0b3JuYXIgZGFkb3MgYXR1YWxpemFkb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0geyBub21lOiAnSm/Do28gU2lsdmEgQXR1YWxpemFkbycgfTtcbiAgICAgIG1vY2tUeXBlb3JtUmVwb3NpdG9yeS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoeyBhZmZlY3RlZDogMSB9KTtcbiAgICAgIG1vY2tUeXBlb3JtUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgLi4ubW9ja0NpZGFkYW8sXG4gICAgICAgIC4uLnVwZGF0ZURhdGEsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVwb3NpdG9yeS51cGRhdGUoXG4gICAgICAgICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tUeXBlb3JtUmVwb3NpdG9yeS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0Lm5vbWUpLnRvQmUoJ0pvw6NvIFNpbHZhIEF0dWFsaXphZG8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG5vcm1hbGl6YXIgQ1BGIGFudGVzIGRlIGF0dWFsaXphcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7IGNwZjogJzk4Ny42NTQuMzIxLTAwJyB9O1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAxIH0pO1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrQ2lkYWRhbyxcbiAgICAgICAgY3BmOiAnOTg3NjU0MzIxMDAnLFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHJlcG9zaXRvcnkudXBkYXRlKFxuICAgICAgICAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrVHlwZW9ybVJlcG9zaXRvcnkudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgICAgIHsgY3BmOiAnOTg3NjU0MzIxMDAnIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbm9ybWFsaXphciBOSVMgYW50ZXMgZGUgYXR1YWxpemFyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHsgbmlzOiAnOTg3LjY1NC4zMjEtMDAnIH07XG4gICAgICBtb2NrVHlwZW9ybVJlcG9zaXRvcnkudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHsgYWZmZWN0ZWQ6IDEgfSk7XG4gICAgICBtb2NrVHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIC4uLm1vY2tDaWRhZGFvLFxuICAgICAgICBuaXM6ICc5ODc2NTQzMjEwMCcsXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgcmVwb3NpdG9yeS51cGRhdGUoXG4gICAgICAgICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tUeXBlb3JtUmVwb3NpdG9yeS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgICAgICAgeyBuaXM6ICc5ODc2NTQzMjEwMCcgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsYW7Dp2FyIE5vdEZvdW5kRXhjZXB0aW9uIHF1YW5kbyBjaWRhZMOjbyBuw6NvIGZvciBlbmNvbnRyYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1R5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAwIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHJlcG9zaXRvcnkudXBkYXRlKCdpZC1pbmV4aXN0ZW50ZScsIHsgbm9tZTogJ1Rlc3RlJyB9KSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgTm90Rm91bmRFeGNlcHRpb24gcXVhbmRvIGNpZGFkw6NvIG7Do28gZm9yIGVuY29udHJhZG8gYXDDs3MgYXR1YWxpemHDp8OjbycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUeXBlb3JtUmVwb3NpdG9yeS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoeyBhZmZlY3RlZDogMSB9KTtcbiAgICAgIG1vY2tUeXBlb3JtUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHJlcG9zaXRvcnkudXBkYXRlKCc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLCB7XG4gICAgICAgICAgbm9tZTogJ1Rlc3RlJyxcbiAgICAgICAgfSksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=