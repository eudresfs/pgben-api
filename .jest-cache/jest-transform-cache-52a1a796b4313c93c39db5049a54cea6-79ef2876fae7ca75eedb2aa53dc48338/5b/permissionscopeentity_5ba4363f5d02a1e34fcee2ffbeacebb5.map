{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\permission-scope.entity.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\permission-scope.entity.ts"],"sourcesContent":["import {\n  Column,\n  CreateDateColumn,\n  Entity,\n  JoinColumn,\n  ManyToOne,\n  PrimaryGeneratedColumn,\n  UpdateDateColumn,\n  Index,\n} from 'typeorm';\nimport { IsNotEmpty, IsUUID, IsEnum, IsOptional } from 'class-validator';\nimport { Permission } from './permission.entity';\nimport { Usuario } from './usuario.entity';\nimport { TipoEscopo } from './user-permission.entity';\n\n/**\n * Entidade que define regras de escopo padrão para permissões.\n *\n * Esta entidade permite definir o tipo de escopo padrão para cada permissão,\n * facilitando a atribuição de permissões com escopo adequado.\n */\n@Entity('escopo_permissao')\n@Index(['permissao_id'], { unique: true })\n@Index(['tipo_escopo_padrao'])\n@Index(['criado_por'])\n@Index(['created_at'])\nexport class PermissionScope {\n  /**\n   * Identificador único do mapeamento\n   */\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  /**\n   * Referência à permissão\n   */\n  @Column({ type: 'uuid', name: 'permissao_id' })\n  @IsNotEmpty({ message: 'ID da permissão é obrigatório' })\n  @IsUUID('4', { message: 'ID da permissão inválido' })\n  permissao_id: string;\n\n  /**\n   * Relação com a permissão\n   */\n  @ManyToOne(() => Permission, { onDelete: 'CASCADE' })\n  @JoinColumn({ name: 'permissao_id' })\n  permissao: Permission;\n\n  /**\n   * Tipo de escopo padrão (global, unidade, proprio)\n   */\n  @Column({\n    type: 'enum',\n    enum: ['global', 'unidade', 'proprio'],\n    default: 'proprio',\n  })\n  @IsEnum(['global', 'unidade', 'proprio'], {\n    message: 'Tipo de escopo deve ser global, unidade ou proprio',\n  })\n  tipo_escopo_padrao: 'global' | 'unidade' | 'proprio';\n\n  /**\n   * Data de criação\n   */\n  @CreateDateColumn({ name: 'created_at' })\n  created_at: Date;\n\n  /**\n   * Data de última atualização\n   */\n  @UpdateDateColumn({ name: 'updated_at' })\n  updated_at: Date;\n\n  /**\n   * Usuário que criou o mapeamento\n   */\n  @Column({ type: 'uuid', nullable: true, name: 'criado_por' })\n  @IsOptional()\n  @IsUUID('4', { message: 'ID do criador inválido' })\n  criado_por?: string;\n\n  /**\n   * Relação com o usuário que criou o mapeamento\n   */\n  @ManyToOne(() => Usuario, { nullable: true })\n  @JoinColumn({ name: 'criado_por' })\n  usuario_criador: Usuario | null;\n\n  /**\n   * Usuário que atualizou o mapeamento por último\n   */\n  @Column({ type: 'uuid', nullable: true, name: 'atualizado_por' })\n  @IsOptional()\n  @IsUUID('4', { message: 'ID do atualizador inválido' })\n  atualizado_por: string | null;\n\n  /**\n   * Relação com o usuário que atualizou o mapeamento por último\n   */\n  @ManyToOne(() => Usuario, { nullable: true })\n  @JoinColumn({ name: 'atualizado_por' })\n  usuario_atualizador: Usuario | null;\n\n  // Getters e setters para compatibilidade com código existente\n  get permissionId(): string {\n    return this.permissao_id;\n  }\n\n  set permissionId(value: string) {\n    this.permissao_id = value;\n  }\n\n  get permission(): Permission {\n    return this.permissao;\n  }\n\n  set permission(value: Permission) {\n    this.permissao = value;\n  }\n\n  get defaultScopeType(): 'global' | 'unidade' | 'proprio' {\n    return this.tipo_escopo_padrao;\n  }\n\n  set defaultScopeType(value: 'global' | 'unidade' | 'proprio') {\n    this.tipo_escopo_padrao = value;\n  }\n\n  get createdAt(): Date {\n    return this.created_at;\n  }\n\n  get updatedAt(): Date {\n    return this.updated_at;\n  }\n\n  get creator(): Usuario | null {\n    return this.usuario_criador;\n  }\n\n  set creator(value: Usuario | null) {\n    this.usuario_criador = value;\n  }\n\n  get updatedBy(): string | null {\n    return this.atualizado_por;\n  }\n\n  set updatedBy(value: string | null) {\n    this.atualizado_por = value;\n  }\n\n  get updater(): Usuario | null {\n    return this.usuario_atualizador;\n  }\n\n  set updater(value: Usuario | null) {\n    this.usuario_atualizador = value;\n  }\n\n  /**\n   * Verifica se o escopo foi criado por um usuário específico\n   * @param usuarioId ID do usuário\n   * @returns true se foi criado pelo usuário\n   */\n  foiCriadoPor(usuarioId: string): boolean {\n    return this.criado_por === usuarioId;\n  }\n\n  /**\n   * Verifica se o escopo foi atualizado por um usuário específico\n   * @param usuarioId ID do usuário\n   * @returns true se foi atualizado pelo usuário\n   */\n  foiAtualizadoPor(usuarioId: string): boolean {\n    return this.atualizado_por === usuarioId;\n  }\n\n  /**\n   * Verifica se o escopo é global\n   * @returns true se o escopo é global\n   */\n  isGlobal(): boolean {\n    return this.tipo_escopo_padrao === 'global';\n  }\n\n  /**\n   * Verifica se o escopo é por unidade\n   * @returns true se o escopo é por unidade\n   */\n  isPorUnidade(): boolean {\n    return this.tipo_escopo_padrao === 'unidade';\n  }\n\n  /**\n   * Verifica se o escopo é próprio\n   * @returns true se o escopo é próprio\n   */\n  isProprio(): boolean {\n    return this.tipo_escopo_padrao === 'proprio';\n  }\n\n  /**\n   * Define o tipo de escopo padrão\n   * @param tipo Tipo de escopo\n   */\n  definirTipoEscopo(tipo: 'global' | 'unidade' | 'proprio'): void {\n    this.tipo_escopo_padrao = tipo;\n  }\n\n  /**\n   * Atualiza o usuário que modificou o escopo\n   * @param usuarioId ID do usuário\n   */\n  atualizarPor(usuarioId: string): void {\n    this.atualizado_por = usuarioId;\n  }\n\n  /**\n   * Verifica se o escopo pertence a uma permissão específica\n   * @param permissaoId ID da permissão\n   * @returns true se pertence à permissão\n   */\n  pertenceAPermissao(permissaoId: string): boolean {\n    return this.permissao_id === permissaoId;\n  }\n\n  /**\n   * Obtém uma descrição legível do tipo de escopo\n   * @returns descrição do escopo\n   */\n  getDescricaoEscopo(): string {\n    const descricoes = {\n      global: 'Acesso global ao sistema',\n      unidade: 'Acesso restrito à unidade do usuário',\n      proprio: 'Acesso apenas aos próprios dados',\n    };\n    return descricoes[this.tipo_escopo_padrao];\n  }\n\n  /**\n   * Verifica se o escopo foi criado recentemente (últimas 24 horas)\n   * @returns true se foi criado nas últimas 24 horas\n   */\n  isCriadoRecentemente(): boolean {\n    const agora = new Date();\n    const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);\n    return this.created_at > umDiaAtras;\n  }\n\n  /**\n   * Calcula a idade do escopo em dias\n   * @returns número de dias desde a criação\n   */\n  getIdadeEmDias(): number {\n    const agora = new Date();\n    const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  }\n\n  /**\n   * Verifica se tem criador definido\n   * @returns true se tem criador\n   */\n  temCriador(): boolean {\n    return this.criado_por !== null && this.criado_por !== undefined;\n  }\n\n  /**\n   * Verifica se foi atualizado recentemente (últimas 24 horas)\n   * @returns true se foi atualizado nas últimas 24 horas\n   */\n  foiAtualizadoRecentemente(): boolean {\n    const agora = new Date();\n    const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);\n    return this.updated_at > umDiaAtras;\n  }\n\n  /**\n   * Obtém um resumo das informações do escopo\n   * @returns objeto com resumo das informações\n   */\n  getSummary(): {\n    id: string;\n    permissaoId: string;\n    tipoEscopo: string;\n    descricaoEscopo: string;\n    criadoEm: Date;\n    atualizadoEm: Date;\n    temCriador: boolean;\n    temAtualizador: boolean;\n  } {\n    return {\n      id: this.id,\n      permissaoId: this.permissao_id,\n      tipoEscopo: this.tipo_escopo_padrao,\n      descricaoEscopo: this.getDescricaoEscopo(),\n      criadoEm: this.created_at,\n      atualizadoEm: this.updated_at,\n      temCriador: this.temCriador(),\n      temAtualizador: this.atualizado_por !== null,\n    };\n  }\n\n  /**\n   * Verifica se é compatível com outro escopo (mesmo tipo)\n   * @param outroEscopo outro escopo para comparar\n   * @returns true se são compatíveis\n   */\n  isCompatibleWith(outroEscopo: PermissionScope): boolean {\n    return this.tipo_escopo_padrao === outroEscopo.tipo_escopo_padrao;\n  }\n\n  /**\n   * Gera uma chave única para o escopo\n   * @returns chave única\n   */\n  getUniqueKey(): string {\n    return `permission_scope_${this.permissao_id}`;\n  }\n\n  /**\n   * Verifica se o estado do escopo é consistente\n   * @returns true se está consistente\n   */\n  isConsistente(): boolean {\n    return (\n      this.id !== null &&\n      this.permissao_id !== null &&\n      this.tipo_escopo_padrao !== null &&\n      this.created_at !== null &&\n      this.updated_at !== null &&\n      this.created_at <= this.updated_at\n    );\n  }\n\n  /**\n   * Obtém uma descrição completa do escopo\n   * @returns descrição completa\n   */\n  getDescricaoCompleta(): string {\n    const permissaoInfo = this.permissao\n      ? this.permissao.nome\n      : 'Permissão não carregada';\n    return `Escopo ${this.tipo_escopo_padrao} para permissão: ${permissaoInfo}`;\n  }\n\n  /**\n   * Verifica se pode ser removido (não tem dependências críticas)\n   * @returns true se pode ser removido\n   */\n  podeSerRemovido(): boolean {\n    // Lógica básica - pode ser expandida conforme regras de negócio\n    return true;\n  }\n\n  /**\n   * Clona o escopo (sem ID)\n   * @returns nova instância do escopo\n   */\n  clone(): PermissionScope {\n    const novoEscopo = new PermissionScope();\n    novoEscopo.permissao_id = this.permissao_id;\n    novoEscopo.tipo_escopo_padrao = this.tipo_escopo_padrao;\n    novoEscopo.criado_por = this.criado_por;\n    return novoEscopo;\n  }\n\n  /**\n   * Verifica se é um escopo de alta criticidade (global)\n   * @returns true se é de alta criticidade\n   */\n  isAltaCriticidade(): boolean {\n    return this.tipo_escopo_padrao === 'global';\n  }\n\n  /**\n   * Verifica se é um escopo de média criticidade (unidade)\n   * @returns true se é de média criticidade\n   */\n  isMediaCriticidade(): boolean {\n    return this.tipo_escopo_padrao === 'unidade';\n  }\n\n  /**\n   * Verifica se é um escopo de baixa criticidade (proprio)\n   * @returns true se é de baixa criticidade\n   */\n  isBaixaCriticidade(): boolean {\n    return this.tipo_escopo_padrao === 'proprio';\n  }\n\n  /**\n   * Obtém o nível de criticidade como número\n   * @returns nível de criticidade (1-3)\n   */\n  getNivelCriticidade(): number {\n    const niveis = {\n      proprio: 1,\n      unidade: 2,\n      global: 3,\n    };\n    return niveis[this.tipo_escopo_padrao];\n  }\n\n  /**\n   * Verifica se o escopo permite acesso amplo\n   * @returns true se permite acesso amplo\n   */\n  permiteAcessoAmplo(): boolean {\n    return (\n      this.tipo_escopo_padrao === 'global' ||\n      this.tipo_escopo_padrao === 'unidade'\n    );\n  }\n\n  /**\n   * Verifica se o escopo é restritivo\n   * @returns true se é restritivo\n   */\n  isRestritivo(): boolean {\n    return this.tipo_escopo_padrao === 'proprio';\n  }\n\n  /**\n   * Formata a data de criação\n   * @returns data formatada\n   */\n  getCriacaoFormatada(): string {\n    return this.created_at.toLocaleString('pt-BR');\n  }\n\n  /**\n   * Formata a data de atualização\n   * @returns data formatada\n   */\n  getAtualizacaoFormatada(): string {\n    return this.updated_at.toLocaleString('pt-BR');\n  }\n\n  /**\n   * Remove informações sensíveis para logs\n   * @returns versão segura para logs\n   */\n  toSafeLog(): object {\n    return {\n      id: this.id,\n      permissaoId: this.permissao_id,\n      tipoEscopo: this.tipo_escopo_padrao,\n      criadoEm: this.created_at,\n      atualizadoEm: this.updated_at,\n      temCriador: this.temCriador(),\n    };\n  }\n\n  /**\n   * Verifica se o escopo requer aprovação especial para mudanças\n   * @returns true se requer aprovação especial\n   */\n  requerAprovacaoEspecial(): boolean {\n    return this.tipo_escopo_padrao === 'global';\n  }\n\n  /**\n   * Obtém sugestões de melhoria de segurança\n   * @returns array de sugestões\n   */\n  getSugestoesMelhoria(): string[] {\n    const sugestoes: string[] = [];\n\n    if (this.tipo_escopo_padrao === 'global') {\n      sugestoes.push('Considere restringir o escopo se possível');\n      sugestoes.push('Monitore o uso desta permissão global');\n    }\n\n    if (!this.temCriador()) {\n      sugestoes.push('Defina um criador para auditoria');\n    }\n\n    return sugestoes;\n  }\n}\n"],"version":3}