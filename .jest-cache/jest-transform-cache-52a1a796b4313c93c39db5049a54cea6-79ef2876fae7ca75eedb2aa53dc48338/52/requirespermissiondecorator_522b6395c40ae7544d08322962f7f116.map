{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\auth\\decorators\\requires-permission.decorator.ts","mappings":";;;AAAA,2CAA6C;AA0B7C;;GAEG;AACU,QAAA,2BAA2B,GAAG,yBAAyB,CAAC;AAErE;;;;;;;;;;;;;;;;;;;;GAoBG;AACI,MAAM,kBAAkB,GAAG,CAAC,GAAG,YAAqC,EAAE,EAAE,CAC7E,IAAA,oBAAW,EAAC,mCAA2B,EAAE,YAAY,CAAC,CAAC;AAD5C,QAAA,kBAAkB,sBAC0B","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\auth\\decorators\\requires-permission.decorator.ts"],"sourcesContent":["import { SetMetadata } from '@nestjs/common';\nimport { TipoEscopo } from '../../entities/user-permission.entity';\n\n/**\n * Interface para definição de requisitos de permissão.\n */\nexport interface PermissionRequirement {\n  /**\n   * Nome da permissão no formato `modulo.recurso.operacao`\n   */\n  permissionName: string;\n\n  /**\n   * Tipo de escopo (opcional, padrão é GLOBAL)\n   */\n  scopeType?: TipoEscopo;\n\n  /**\n   * Expressão para obter o ID do escopo a partir dos parâmetros da requisição\n   * (opcional, necessário apenas para scopeType UNIT)\n   *\n   * Exemplo: 'params.unidadeId' para obter o ID da unidade dos parâmetros da rota\n   */\n  scopeIdExpression?: string;\n}\n\n/**\n * Chave de metadados para requisitos de permissão.\n */\nexport const PERMISSION_REQUIREMENTS_KEY = 'permission_requirements';\n\n/**\n * Decorador para definir requisitos de permissão em controladores e métodos.\n *\n * Este decorador permite proteger endpoints com permissões granulares,\n * definindo quais permissões são necessárias para acessar o endpoint.\n *\n * @param requirements Requisitos de permissão\n * @returns Decorador de metadados\n *\n * @example\n * // Requer permissão global para listar cidadãos\n * @RequiresPermission({ permissionName: 'cidadao.listar' })\n *\n * @example\n * // Requer permissão para visualizar um cidadão específico na unidade\n * @RequiresPermission({\n *   permissionName: 'cidadao.visualizar',\n *   scopeType: TipoEscopo.UNIDADE, (GLOBAL, UNIDADE, PROPRIO)\n *   scopeIdExpression: 'params.unidadeId'\n * })\n */\nexport const RequiresPermission = (...requirements: PermissionRequirement[]) =>\n  SetMetadata(PERMISSION_REQUIREMENTS_KEY, requirements);\n"],"version":3}