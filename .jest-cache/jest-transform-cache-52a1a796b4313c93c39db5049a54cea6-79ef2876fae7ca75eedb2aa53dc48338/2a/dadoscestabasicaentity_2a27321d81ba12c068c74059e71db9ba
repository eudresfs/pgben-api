584384960c3455228d2c8526b8060bcf
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c, _d, _e, _f;
Object.defineProperty(exports, "__esModule", { value: true });
exports.DadosCestaBasica = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const solicitacao_entity_1 = require("./solicitacao.entity");
const enums_1 = require("../enums");
/**
 * Entidade para armazenar dados específicos do cidadão para Cesta Básica
 *
 * Armazena informações específicas necessárias para a solicitação do benefício
 * de Cesta Básica, como quantidade, período de concessão, origem do atendimento, etc.
 */
let DadosCestaBasica = class DadosCestaBasica {
    id;
    solicitacao_id;
    solicitacao;
    quantidade_cestas_solicitadas;
    periodo_concessao;
    origem_atendimento;
    numero_pessoas_familia;
    justificativa_quantidade;
    observacoes_especiais;
    tecnico_responsavel;
    unidade_solicitante;
    created_at;
    updated_at;
    removed_at;
    // Getters
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    get removedAt() {
        return this.removed_at;
    }
    // Métodos Utilitários
    /**
     * Calcula quantidade recomendada baseada no número de pessoas na família
     */
    calcularQuantidadeRecomendada() {
        if (!this.numero_pessoas_familia)
            return 1;
        // Regra: 1 cesta para até 3 pessoas, +1 cesta a cada 3 pessoas adicionais
        return Math.ceil(this.numero_pessoas_familia / 3);
    }
    /**
     * Verifica se a quantidade solicitada está dentro do recomendado
     */
    isQuantidadeDentroRecomendacao() {
        const recomendada = this.calcularQuantidadeRecomendada();
        return this.quantidade_cestas_solicitadas <= recomendada + 1; // Tolerância de +1
    }
    /**
     * Verifica se é atendimento prioritário
     */
    isAtendimentoPrioritario() {
        const origemPrioritaria = [
            enums_1.OrigemAtendimentoEnum.CREAS,
            enums_1.OrigemAtendimentoEnum.BUSCA_ATIVA,
        ];
        return origemPrioritaria.includes(this.origem_atendimento);
    }
    /**
     * Calcula duração total do benefício em meses
     */
    calcularDuracaoTotalMeses() {
        let multiplicador = 1;
        switch (this.periodo_concessao) {
            case enums_1.PeriodicidadeEnum.MENSAL:
                multiplicador = 1;
                break;
            case enums_1.PeriodicidadeEnum.BIMESTRAL:
                multiplicador = 2;
                break;
            case enums_1.PeriodicidadeEnum.TRIMESTRAL:
                multiplicador = 3;
                break;
            case enums_1.PeriodicidadeEnum.SEMESTRAL:
                multiplicador = 6;
                break;
            case enums_1.PeriodicidadeEnum.UNICO:
                multiplicador = 0; // Entrega única
                break;
        }
        return multiplicador;
    }
    /**
     * Calcula total de cestas que serão entregues no período
     */
    calcularTotalCestasNoPeriodo() {
        const duracaoMeses = this.calcularDuracaoTotalMeses();
        if (this.periodo_concessao === enums_1.PeriodicidadeEnum.UNICO) {
            return this.quantidade_cestas_solicitadas;
        }
        // Para períodos recorrentes, considera entrega mensal
        return this.quantidade_cestas_solicitadas * duracaoMeses;
    }
    /**
     * Verifica se precisa de justificativa para quantidade
     */
    precisaJustificativaQuantidade() {
        const recomendada = this.calcularQuantidadeRecomendada();
        return this.quantidade_cestas_solicitadas > recomendada + 1;
    }
    /**
     * Calcula pontuação de prioridade
     */
    calcularPontuacaoPrioridade() {
        let pontuacao = 0;
        // Pontuação por origem do atendimento
        switch (this.origem_atendimento) {
            case enums_1.OrigemAtendimentoEnum.CREAS:
                pontuacao += 100;
                break;
            case enums_1.OrigemAtendimentoEnum.BUSCA_ATIVA:
                pontuacao += 90;
                break;
            case enums_1.OrigemAtendimentoEnum.CRAS:
                pontuacao += 80;
                break;
            case enums_1.OrigemAtendimentoEnum.ENCAMINHAMENTO_EXTERNO:
                pontuacao += 70;
                break;
            case enums_1.OrigemAtendimentoEnum.UNIDADE_BASICA:
                pontuacao += 60;
                break;
            case enums_1.OrigemAtendimentoEnum.DEMANDA_ESPONTANEA:
                pontuacao += 50;
                break;
        }
        // Pontuação por tamanho da família
        if (this.numero_pessoas_familia) {
            if (this.numero_pessoas_familia >= 6)
                pontuacao += 30;
            else if (this.numero_pessoas_familia >= 4)
                pontuacao += 20;
            else if (this.numero_pessoas_familia >= 2)
                pontuacao += 10;
        }
        return pontuacao;
    }
    /**
     * Valida se os dados estão completos para submissão
     */
    validarDadosCompletos() {
        const erros = [];
        if (!this.quantidade_cestas_solicitadas ||
            this.quantidade_cestas_solicitadas < 1) {
            erros.push('Quantidade de cestas deve ser maior que zero');
        }
        if (!this.periodo_concessao) {
            erros.push('Período de concessão é obrigatório');
        }
        if (!this.origem_atendimento) {
            erros.push('Origem do atendimento é obrigatória');
        }
        if (this.precisaJustificativaQuantidade() &&
            (!this.justificativa_quantidade ||
                this.justificativa_quantidade.trim().length === 0)) {
            erros.push('Justificativa é obrigatória para quantidade acima do recomendado');
        }
        if (this.origem_atendimento ===
            enums_1.OrigemAtendimentoEnum.ENCAMINHAMENTO_EXTERNO &&
            (!this.unidade_solicitante ||
                this.unidade_solicitante.trim().length === 0)) {
            erros.push('Unidade solicitante é obrigatória para encaminhamentos externos');
        }
        return {
            valido: erros.length === 0,
            erros,
        };
    }
};
exports.DadosCestaBasica = DadosCestaBasica;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID da solicitação é obrigatório' }),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "solicitacao_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => solicitacao_entity_1.Solicitacao, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'solicitacao_id' }),
    __metadata("design:type", typeof (_a = typeof solicitacao_entity_1.Solicitacao !== "undefined" && solicitacao_entity_1.Solicitacao) === "function" ? _a : Object)
], DadosCestaBasica.prototype, "solicitacao", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'integer' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Quantidade de cestas é obrigatória' }),
    (0, class_validator_1.IsNumber)({}, { message: 'Quantidade de cestas deve ser um número' }),
    (0, class_validator_1.Min)(1, { message: 'Quantidade mínima é 1 cesta' }),
    (0, class_validator_1.Max)(12, { message: 'Quantidade máxima é 12 cestas' }),
    __metadata("design:type", Number)
], DadosCestaBasica.prototype, "quantidade_cestas_solicitadas", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: enums_1.PeriodicidadeEnum,
        enumName: 'periodo_concessao_cesta',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Período de concessão é obrigatório' }),
    (0, class_validator_1.IsEnum)(enums_1.PeriodicidadeEnum, { message: 'Período de concessão inválido' }),
    __metadata("design:type", typeof (_b = typeof enums_1.PeriodicidadeEnum !== "undefined" && enums_1.PeriodicidadeEnum) === "function" ? _b : Object)
], DadosCestaBasica.prototype, "periodo_concessao", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: enums_1.OrigemAtendimentoEnum,
        enumName: 'origem_atendimento',
    }),
    (0, class_validator_1.IsNotEmpty)({ message: 'Origem do atendimento é obrigatória' }),
    (0, class_validator_1.IsEnum)(enums_1.OrigemAtendimentoEnum, { message: 'Origem do atendimento inválida' }),
    __metadata("design:type", typeof (_c = typeof enums_1.OrigemAtendimentoEnum !== "undefined" && enums_1.OrigemAtendimentoEnum) === "function" ? _c : Object)
], DadosCestaBasica.prototype, "origem_atendimento", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'integer', nullable: true }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsNumber)({}, { message: 'Número de pessoas na família deve ser um número' }),
    (0, class_validator_1.Min)(1, { message: 'Número mínimo de pessoas na família é 1' }),
    __metadata("design:type", Number)
], DadosCestaBasica.prototype, "numero_pessoas_familia", void 0);
__decorate([
    (0, typeorm_1.Column)('text', { nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "justificativa_quantidade", void 0);
__decorate([
    (0, typeorm_1.Column)('text', { nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "observacoes_especiais", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "tecnico_responsavel", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], DadosCestaBasica.prototype, "unidade_solicitante", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)(),
    __metadata("design:type", typeof (_d = typeof Date !== "undefined" && Date) === "function" ? _d : Object)
], DadosCestaBasica.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)(),
    __metadata("design:type", typeof (_e = typeof Date !== "undefined" && Date) === "function" ? _e : Object)
], DadosCestaBasica.prototype, "updated_at", void 0);
__decorate([
    (0, typeorm_1.DeleteDateColumn)(),
    __metadata("design:type", typeof (_f = typeof Date !== "undefined" && Date) === "function" ? _f : Object)
], DadosCestaBasica.prototype, "removed_at", void 0);
exports.DadosCestaBasica = DadosCestaBasica = __decorate([
    (0, typeorm_1.Entity)('dados_cesta_basica'),
    (0, typeorm_1.Index)(['solicitacao_id'], { unique: true })
], DadosCestaBasica);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxkYWRvcy1jZXN0YS1iYXNpY2EuZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FVaUI7QUFDakIscURBT3lCO0FBQ3pCLDZEQUFtRDtBQUNuRCxvQ0FBb0U7QUFFcEU7Ozs7O0dBS0c7QUFHSSxJQUFNLGdCQUFnQixHQUF0QixNQUFNLGdCQUFnQjtJQUUzQixFQUFFLENBQVM7SUFJWCxjQUFjLENBQVM7SUFJdkIsV0FBVyxDQUFjO0lBT3pCLDZCQUE2QixDQUFTO0lBU3RDLGlCQUFpQixDQUFvQjtJQVNyQyxrQkFBa0IsQ0FBd0I7SUFNMUMsc0JBQXNCLENBQVU7SUFJaEMsd0JBQXdCLENBQVU7SUFJbEMscUJBQXFCLENBQVU7SUFJL0IsbUJBQW1CLENBQVU7SUFJN0IsbUJBQW1CLENBQVU7SUFHN0IsVUFBVSxDQUFPO0lBR2pCLFVBQVUsQ0FBTztJQUdqQixVQUFVLENBQU87SUFFakIsVUFBVTtJQUNWLElBQUksU0FBUztRQUNYLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN6QixDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVELHNCQUFzQjtJQUV0Qjs7T0FFRztJQUNILDZCQUE2QjtRQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQjtZQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRTNDLDBFQUEwRTtRQUMxRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRDs7T0FFRztJQUNILDhCQUE4QjtRQUM1QixNQUFNLFdBQVcsR0FBRyxJQUFJLENB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Q0FBQztJQUMxQixJQUFBLDRCQUFVLEdBQUU7OzZEQUNnQjtBQUc3QjtJQURDLElBQUEsMEJBQWdCLEdBQUU7a0RBQ1AsSUFBSSxvQkFBSixJQUFJO29EQUFDO0FBR2pCO0lBREMsSUFBQSwwQkFBZ0IsR0FBRTtrREFDUCxJQUFJLG9CQUFKLElBQUk7b0RBQUM7QUFHakI7SUFEQyxJQUFBLDBCQUFnQixHQUFFO2tEQUNQLElBQUksb0JBQUosSUFBSTtvREFBQzsyQkFsRU4sZ0JBQWdCO0lBRjVCLElBQUEsZ0JBQU0sRUFBQyxvQkFBb0IsQ0FBQztJQUM1QixJQUFBLGVBQUssRUFBQyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7R0FDL0IsZ0JBQWdCLENBdVA1QiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcZW50aXRpZXNcXGRhZG9zLWNlc3RhLWJhc2ljYS5lbnRpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRW50aXR5LFxuICBQcmltYXJ5R2VuZXJhdGVkQ29sdW1uLFxuICBDb2x1bW4sXG4gIENyZWF0ZURhdGVDb2x1bW4sXG4gIFVwZGF0ZURhdGVDb2x1bW4sXG4gIERlbGV0ZURhdGVDb2x1bW4sXG4gIE1hbnlUb09uZSxcbiAgSm9pbkNvbHVtbixcbiAgSW5kZXgsXG59IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHtcbiAgSXNOb3RFbXB0eSxcbiAgSXNOdW1iZXIsXG4gIElzRW51bSxcbiAgSXNPcHRpb25hbCxcbiAgTWluLFxuICBNYXgsXG59IGZyb20gJ2NsYXNzLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTb2xpY2l0YWNhbyB9IGZyb20gJy4vc29saWNpdGFjYW8uZW50aXR5JztcbmltcG9ydCB7IFBlcmlvZGljaWRhZGVFbnVtLCBPcmlnZW1BdGVuZGltZW50b0VudW0gfSBmcm9tICcuLi9lbnVtcyc7XG5cbi8qKlxuICogRW50aWRhZGUgcGFyYSBhcm1hemVuYXIgZGFkb3MgZXNwZWPDrWZpY29zIGRvIGNpZGFkw6NvIHBhcmEgQ2VzdGEgQsOhc2ljYVxuICpcbiAqIEFybWF6ZW5hIGluZm9ybWHDp8O1ZXMgZXNwZWPDrWZpY2FzIG5lY2Vzc8OhcmlhcyBwYXJhIGEgc29saWNpdGHDp8OjbyBkbyBiZW5lZsOtY2lvXG4gKiBkZSBDZXN0YSBCw6FzaWNhLCBjb21vIHF1YW50aWRhZGUsIHBlcsOtb2RvIGRlIGNvbmNlc3PDo28sIG9yaWdlbSBkbyBhdGVuZGltZW50bywgZXRjLlxuICovXG5ARW50aXR5KCdkYWRvc19jZXN0YV9iYXNpY2EnKVxuQEluZGV4KFsnc29saWNpdGFjYW9faWQnXSwgeyB1bmlxdWU6IHRydWUgfSlcbmV4cG9ydCBjbGFzcyBEYWRvc0Nlc3RhQmFzaWNhIHtcbiAgQFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4oJ3V1aWQnKVxuICBpZDogc3RyaW5nO1xuXG4gIEBDb2x1bW4oKVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdJRCBkYSBzb2xpY2l0YcOnw6NvIMOpIG9icmlnYXTDs3JpbycgfSlcbiAgc29saWNpdGFjYW9faWQ6IHN0cmluZztcblxuICBATWFueVRvT25lKCgpID0+IFNvbGljaXRhY2FvLCB7IG9uRGVsZXRlOiAnQ0FTQ0FERScgfSlcbiAgQEpvaW5Db2x1bW4oeyBuYW1lOiAnc29saWNpdGFjYW9faWQnIH0pXG4gIHNvbGljaXRhY2FvOiBTb2xpY2l0YWNhbztcblxuICBAQ29sdW1uKHsgdHlwZTogJ2ludGVnZXInIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ1F1YW50aWRhZGUgZGUgY2VzdGFzIMOpIG9icmlnYXTDs3JpYScgfSlcbiAgQElzTnVtYmVyKHt9LCB7IG1lc3NhZ2U6ICdRdWFudGlkYWRlIGRlIGNlc3RhcyBkZXZlIHNlciB1bSBuw7ptZXJvJyB9KVxuICBATWluKDEsIHsgbWVzc2FnZTogJ1F1YW50aWRhZGUgbcOtbmltYSDDqSAxIGNlc3RhJyB9KVxuICBATWF4KDEyLCB7IG1lc3NhZ2U6ICdRdWFudGlkYWRlIG3DoXhpbWEgw6kgMTIgY2VzdGFzJyB9KVxuICBxdWFudGlkYWRlX2Nlc3Rhc19zb2xpY2l0YWRhczogbnVtYmVyO1xuXG4gIEBDb2x1bW4oe1xuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBQZXJpb2RpY2lkYWRlRW51bSxcbiAgICBlbnVtTmFtZTogJ3BlcmlvZG9fY29uY2Vzc2FvX2Nlc3RhJyxcbiAgfSlcbiAgQElzTm90RW1wdHkoeyBtZXNzYWdlOiAnUGVyw61vZG8gZGUgY29uY2Vzc8OjbyDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc0VudW0oUGVyaW9kaWNpZGFkZUVudW0sIHsgbWVzc2FnZTogJ1BlcsOtb2RvIGRlIGNvbmNlc3PDo28gaW52w6FsaWRvJyB9KVxuICBwZXJpb2RvX2NvbmNlc3NhbzogUGVyaW9kaWNpZGFkZUVudW07XG5cbiAgQENvbHVtbih7XG4gICAgdHlwZTogJ2VudW0nLFxuICAgIGVudW06IE9yaWdlbUF0ZW5kaW1lbnRvRW51bSxcbiAgICBlbnVtTmFtZTogJ29yaWdlbV9hdGVuZGltZW50bycsXG4gIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ09yaWdlbSBkbyBhdGVuZGltZW50byDDqSBvYnJpZ2F0w7NyaWEnIH0pXG4gIEBJc0VudW0oT3JpZ2VtQXRlbmRpbWVudG9FbnVtLCB7IG1lc3NhZ2U6ICdPcmlnZW0gZG8gYXRlbmRpbWVudG8gaW52w6FsaWRhJyB9KVxuICBvcmlnZW1fYXRlbmRpbWVudG86IE9yaWdlbUF0ZW5kaW1lbnRvRW51bTtcblxuICBAQ29sdW1uKHsgdHlwZTogJ2ludGVnZXInLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIEBJc051bWJlcih7fSwgeyBtZXNzYWdlOiAnTsO6bWVybyBkZSBwZXNzb2FzIG5hIGZhbcOtbGlhIGRldmUgc2VyIHVtIG7Dum1lcm8nIH0pXG4gIEBNaW4oMSwgeyBtZXNzYWdlOiAnTsO6bWVybyBtw61uaW1vIGRlIHBlc3NvYXMgbmEgZmFtw61saWEgw6kgMScgfSlcbiAgbnVtZXJvX3Blc3NvYXNfZmFtaWxpYT86IG51bWJlcjtcblxuICBAQ29sdW1uKCd0ZXh0JywgeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIGp1c3RpZmljYXRpdmFfcXVhbnRpZGFkZT86IHN0cmluZztcblxuICBAQ29sdW1uKCd0ZXh0JywgeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIG9ic2VydmFjb2VzX2VzcGVjaWFpcz86IHN0cmluZztcblxuICBAQ29sdW1uKHsgbnVsbGFibGU6IHRydWUgfSlcbiAgQElzT3B0aW9uYWwoKVxuICB0ZWNuaWNvX3Jlc3BvbnNhdmVsPzogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIHVuaWRhZGVfc29saWNpdGFudGU/OiBzdHJpbmc7XG5cbiAgQENyZWF0ZURhdGVDb2x1bW4oKVxuICBjcmVhdGVkX2F0OiBEYXRlO1xuXG4gIEBVcGRhdGVEYXRlQ29sdW1uKClcbiAgdXBkYXRlZF9hdDogRGF0ZTtcblxuICBARGVsZXRlRGF0ZUNvbHVtbigpXG4gIHJlbW92ZWRfYXQ6IERhdGU7XG5cbiAgLy8gR2V0dGVyc1xuICBnZXQgY3JlYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQ7XG4gIH1cblxuICBnZXQgdXBkYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZWRfYXQ7XG4gIH1cblxuICBnZXQgcmVtb3ZlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZWRfYXQ7XG4gIH1cblxuICAvLyBNw6l0b2RvcyBVdGlsaXTDoXJpb3NcblxuICAvKipcbiAgICogQ2FsY3VsYSBxdWFudGlkYWRlIHJlY29tZW5kYWRhIGJhc2VhZGEgbm8gbsO6bWVybyBkZSBwZXNzb2FzIG5hIGZhbcOtbGlhXG4gICAqL1xuICBjYWxjdWxhclF1YW50aWRhZGVSZWNvbWVuZGFkYSgpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy5udW1lcm9fcGVzc29hc19mYW1pbGlhKSByZXR1cm4gMTtcblxuICAgIC8vIFJlZ3JhOiAxIGNlc3RhIHBhcmEgYXTDqSAzIHBlc3NvYXMsICsxIGNlc3RhIGEgY2FkYSAzIHBlc3NvYXMgYWRpY2lvbmFpc1xuICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5udW1lcm9fcGVzc29hc19mYW1pbGlhIC8gMyk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBxdWFudGlkYWRlIHNvbGljaXRhZGEgZXN0w6EgZGVudHJvIGRvIHJlY29tZW5kYWRvXG4gICAqL1xuICBpc1F1YW50aWRhZGVEZW50cm9SZWNvbWVuZGFjYW8oKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcmVjb21lbmRhZGEgPSB0aGlzLmNhbGN1bGFyUXVhbnRpZGFkZVJlY29tZW5kYWRhKCk7XG4gICAgcmV0dXJuIHRoaXMucXVhbnRpZGFkZV9jZXN0YXNfc29saWNpdGFkYXMgPD0gcmVjb21lbmRhZGEgKyAxOyAvLyBUb2xlcsOibmNpYSBkZSArMVxuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIMOpIGF0ZW5kaW1lbnRvIHByaW9yaXTDoXJpb1xuICAgKi9cbiAgaXNBdGVuZGltZW50b1ByaW9yaXRhcmlvKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG9yaWdlbVByaW9yaXRhcmlhID0gW1xuICAgICAgT3JpZ2VtQXRlbmRpbWVudG9FbnVtLkNSRUFTLFxuICAgICAgT3JpZ2VtQXRlbmRpbWVudG9FbnVtLkJVU0NBX0FUSVZBLFxuICAgIF07XG5cbiAgICByZXR1cm4gb3JpZ2VtUHJpb3JpdGFyaWEuaW5jbHVkZXModGhpcy5vcmlnZW1fYXRlbmRpbWVudG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgZHVyYcOnw6NvIHRvdGFsIGRvIGJlbmVmw61jaW8gZW0gbWVzZXNcbiAgICovXG4gIGNhbGN1bGFyRHVyYWNhb1RvdGFsTWVzZXMoKTogbnVtYmVyIHtcbiAgICBsZXQgbXVsdGlwbGljYWRvciA9IDE7XG5cbiAgICBzd2l0Y2ggKHRoaXMucGVyaW9kb19jb25jZXNzYW8pIHtcbiAgICAgIGNhc2UgUGVyaW9kaWNpZGFkZUVudW0uTUVOU0FMOlxuICAgICAgICBtdWx0aXBsaWNhZG9yID0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFBlcmlvZGljaWRhZGVFbnVtLkJJTUVTVFJBTDpcbiAgICAgICAgbXVsdGlwbGljYWRvciA9IDI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBQZXJpb2RpY2lkYWRlRW51bS5UUklNRVNUUkFMOlxuICAgICAgICBtdWx0aXBsaWNhZG9yID0gMztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFBlcmlvZGljaWRhZGVFbnVtLlNFTUVTVFJBTDpcbiAgICAgICAgbXVsdGlwbGljYWRvciA9IDY7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBQZXJpb2RpY2lkYWRlRW51bS5VTklDTzpcbiAgICAgICAgbXVsdGlwbGljYWRvciA9IDA7IC8vIEVudHJlZ2Egw7puaWNhXG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBtdWx0aXBsaWNhZG9yO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgdG90YWwgZGUgY2VzdGFzIHF1ZSBzZXLDo28gZW50cmVndWVzIG5vIHBlcsOtb2RvXG4gICAqL1xuICBjYWxjdWxhclRvdGFsQ2VzdGFzTm9QZXJpb2RvKCk6IG51bWJlciB7XG4gICAgY29uc3QgZHVyYWNhb01lc2VzID0gdGhpcy5jYWxjdWxhckR1cmFjYW9Ub3RhbE1lc2VzKCk7XG5cbiAgICBpZiAodGhpcy5wZXJpb2RvX2NvbmNlc3NhbyA9PT0gUGVyaW9kaWNpZGFkZUVudW0uVU5JQ08pIHtcbiAgICAgIHJldHVybiB0aGlzLnF1YW50aWRhZGVfY2VzdGFzX3NvbGljaXRhZGFzO1xuICAgIH1cblxuICAgIC8vIFBhcmEgcGVyw61vZG9zIHJlY29ycmVudGVzLCBjb25zaWRlcmEgZW50cmVnYSBtZW5zYWxcbiAgICByZXR1cm4gdGhpcy5xdWFudGlkYWRlX2Nlc3Rhc19zb2xpY2l0YWRhcyAqIGR1cmFjYW9NZXNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBwcmVjaXNhIGRlIGp1c3RpZmljYXRpdmEgcGFyYSBxdWFudGlkYWRlXG4gICAqL1xuICBwcmVjaXNhSnVzdGlmaWNhdGl2YVF1YW50aWRhZGUoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcmVjb21lbmRhZGEgPSB0aGlzLmNhbGN1bGFyUXVhbnRpZGFkZVJlY29tZW5kYWRhKCk7XG4gICAgcmV0dXJuIHRoaXMucXVhbnRpZGFkZV9jZXN0YXNfc29saWNpdGFkYXMgPiByZWNvbWVuZGFkYSArIDE7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYSBwb250dWHDp8OjbyBkZSBwcmlvcmlkYWRlXG4gICAqL1xuICBjYWxjdWxhclBvbnR1YWNhb1ByaW9yaWRhZGUoKTogbnVtYmVyIHtcbiAgICBsZXQgcG9udHVhY2FvID0gMDtcblxuICAgIC8vIFBvbnR1YcOnw6NvIHBvciBvcmlnZW0gZG8gYXRlbmRpbWVudG9cbiAgICBzd2l0Y2ggKHRoaXMub3JpZ2VtX2F0ZW5kaW1lbnRvKSB7XG4gICAgICBjYXNlIE9yaWdlbUF0ZW5kaW1lbnRvRW51bS5DUkVBUzpcbiAgICAgICAgcG9udHVhY2FvICs9IDEwMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIE9yaWdlbUF0ZW5kaW1lbnRvRW51bS5CVVNDQV9BVElWQTpcbiAgICAgICAgcG9udHVhY2FvICs9IDkwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgT3JpZ2VtQXRlbmRpbWVudG9FbnVtLkNSQVM6XG4gICAgICAgIHBvbnR1YWNhbyArPSA4MDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIE9yaWdlbUF0ZW5kaW1lbnRvRW51bS5FTkNBTUlOSEFNRU5UT19FWFRFUk5POlxuICAgICAgICBwb250dWFjYW8gKz0gNzA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBPcmlnZW1BdGVuZGltZW50b0VudW0uVU5JREFERV9CQVNJQ0E6XG4gICAgICAgIHBvbnR1YWNhbyArPSA2MDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIE9yaWdlbUF0ZW5kaW1lbnRvRW51bS5ERU1BTkRBX0VTUE9OVEFORUE6XG4gICAgICAgIHBvbnR1YWNhbyArPSA1MDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8gUG9udHVhw6fDo28gcG9yIHRhbWFuaG8gZGEgZmFtw61saWFcbiAgICBpZiAodGhpcy5udW1lcm9fcGVzc29hc19mYW1pbGlhKSB7XG4gICAgICBpZiAodGhpcy5udW1lcm9fcGVzc29hc19mYW1pbGlhID49IDYpIHBvbnR1YWNhbyArPSAzMDtcbiAgICAgIGVsc2UgaWYgKHRoaXMubnVtZXJvX3Blc3NvYXNfZmFtaWxpYSA+PSA0KSBwb250dWFjYW8gKz0gMjA7XG4gICAgICBlbHNlIGlmICh0aGlzLm51bWVyb19wZXNzb2FzX2ZhbWlsaWEgPj0gMikgcG9udHVhY2FvICs9IDEwO1xuICAgIH1cblxuICAgIHJldHVybiBwb250dWFjYW87XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhIHNlIG9zIGRhZG9zIGVzdMOjbyBjb21wbGV0b3MgcGFyYSBzdWJtaXNzw6NvXG4gICAqL1xuICB2YWxpZGFyRGFkb3NDb21wbGV0b3MoKTogeyB2YWxpZG86IGJvb2xlYW47IGVycm9zOiBzdHJpbmdbXSB9IHtcbiAgICBjb25zdCBlcnJvczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChcbiAgICAgICF0aGlzLnF1YW50aWRhZGVfY2VzdGFzX3NvbGljaXRhZGFzIHx8XG4gICAgICB0aGlzLnF1YW50aWRhZGVfY2VzdGFzX3NvbGljaXRhZGFzIDwgMVxuICAgICkge1xuICAgICAgZXJyb3MucHVzaCgnUXVhbnRpZGFkZSBkZSBjZXN0YXMgZGV2ZSBzZXIgbWFpb3IgcXVlIHplcm8nKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucGVyaW9kb19jb25jZXNzYW8pIHtcbiAgICAgIGVycm9zLnB1c2goJ1BlcsOtb2RvIGRlIGNvbmNlc3PDo28gw6kgb2JyaWdhdMOzcmlvJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm9yaWdlbV9hdGVuZGltZW50bykge1xuICAgICAgZXJyb3MucHVzaCgnT3JpZ2VtIGRvIGF0ZW5kaW1lbnRvIMOpIG9icmlnYXTDs3JpYScpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIHRoaXMucHJlY2lzYUp1c3RpZmljYXRpdmFRdWFudGlkYWRlKCkgJiZcbiAgICAgICghdGhpcy5qdXN0aWZpY2F0aXZhX3F1YW50aWRhZGUgfHxcbiAgICAgICAgdGhpcy5qdXN0aWZpY2F0aXZhX3F1YW50aWRhZGUudHJpbSgpLmxlbmd0aCA9PT0gMClcbiAgICApIHtcbiAgICAgIGVycm9zLnB1c2goXG4gICAgICAgICdKdXN0aWZpY2F0aXZhIMOpIG9icmlnYXTDs3JpYSBwYXJhIHF1YW50aWRhZGUgYWNpbWEgZG8gcmVjb21lbmRhZG8nLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICB0aGlzLm9yaWdlbV9hdGVuZGltZW50byA9PT1cbiAgICAgICAgT3JpZ2VtQXRlbmRpbWVudG9FbnVtLkVOQ0FNSU5IQU1FTlRPX0VYVEVSTk8gJiZcbiAgICAgICghdGhpcy51bmlkYWRlX3NvbGljaXRhbnRlIHx8XG4gICAgICAgIHRoaXMudW5pZGFkZV9zb2xpY2l0YW50ZS50cmltKCkubGVuZ3RoID09PSAwKVxuICAgICkge1xuICAgICAgZXJyb3MucHVzaChcbiAgICAgICAgJ1VuaWRhZGUgc29saWNpdGFudGUgw6kgb2JyaWdhdMOzcmlhIHBhcmEgZW5jYW1pbmhhbWVudG9zIGV4dGVybm9zJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkbzogZXJyb3MubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3MsXG4gICAgfTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9