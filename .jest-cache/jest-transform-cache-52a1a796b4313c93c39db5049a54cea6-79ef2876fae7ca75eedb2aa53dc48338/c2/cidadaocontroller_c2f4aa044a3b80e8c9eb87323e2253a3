ead24cd005b05044cd38e7d33ff84ed6
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var CidadaoController_1;
var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o;
Object.defineProperty(exports, "__esModule", { value: true });
exports.CidadaoController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const create_cidadao_dto_1 = require("../dto/create-cidadao.dto");
const update_cidadao_dto_1 = require("../dto/update-cidadao.dto");
const create_composicao_familiar_dto_1 = require("../dto/create-composicao-familiar.dto");
const busca_cidadao_dto_1 = require("../dto/busca-cidadao.dto");
const cidadao_service_1 = require("../services/cidadao.service");
const cidadao_repository_1 = require("../repositories/cidadao.repository");
const jwt_auth_guard_1 = require("../../../auth/guards/jwt-auth.guard");
// import { MulterUploader } from '../../common/uploaders/multer.uploader';
const requires_permission_decorator_1 = require("../../../auth/decorators/requires-permission.decorator");
const user_permission_entity_1 = require("../../../entities/user-permission.entity");
const cidadao_response_dto_1 = require("../dto/cidadao-response.dto");
const api_error_response_dto_1 = require("../../../shared/dtos/api-error-response.dto");
/**
 * Controlador de cidadãos
 *
 * Responsável por gerenciar as rotas relacionadas a cidadãos/beneficiários
 */
let CidadaoController = CidadaoController_1 = class CidadaoController {
    cidadaoService;
    cidadaoRepository;
    logger = new common_1.Logger(CidadaoController_1.name);
    constructor(cidadaoService, cidadaoRepository) {
        this.cidadaoService = cidadaoService;
        this.cidadaoRepository = cidadaoRepository;
    }
    /**
     * Lista todos os cidadãos com filtros e paginação
     */
    async findAll(req, page = 1, limit = 10, search, bairro) {
        // Inicia medição de tempo para performance
        const startTime = Date.now();
        const requestId = `LIST-${Date.now()}`;
        this.logger.log(`[${requestId}] Início de processamento da listagem de cidadãos`);
        try {
            // Restaurando o código original com monitoramento de performance
            const result = await this.cidadaoService.findAll({
                page,
                limit,
                search,
                bairro,
                unidadeId: req?.user?.unidade_id,
            });
            // Registra tempo total da operação para monitoramento
            const totalTime = Date.now() - startTime;
            if (totalTime > 500) {
                this.logger.warn(`[${requestId}] Operação lenta (findAll): ${totalTime}ms`);
            }
            else {
                this.logger.log(`[${requestId}] Operação concluída em ${totalTime}ms`);
            }
            return result;
        }
        catch (error) {
            // Registra erro para diagnóstico
            const totalTime = Date.now() - startTime;
            this.logger.error(`[${requestId}] Erro em ${totalTime}ms: ${error.message}`);
            throw error;
        }
    }
    async findByCursor(cursor, limit = 10, search, bairro, orderBy, orderDirection) {
        return { data: [], message: 'Endpoint desativado temporariamente para diagnóstico' };
        // Código original comentado para permitir compilação
        /*return this.cidadaoService.findByCursor({
          cursor,
          limit,
          search,
          bairro,
          unidadeId: req?.user?.unidade_id,
          orderBy,
          orderDirection,
        });*/
    }
    /**
     * Busca unificada de cidadão por ID, CPF, NIS, telefone ou nome
     */
    async buscarCidadao(query) {
        return this.cidadaoService.buscarCidadao(query);
    }
    /**
     * Obtém detalhes de um cidadão específico
     */
    async findOne(id) {
        return this.cidadaoService.findById(id, false); // Não carregar relacionamentos por padrão para melhor performance
    }
    /**
     * Cria um novo cidadão
     */
    async create(createCidadaoDto, req) {
        const startTime = Date.now();
        try {
            const result = await this.cidadaoService.create(createCidadaoDto, req?.user?.id, req?.user?.unidade_id);
            const duration = Date.now() - startTime;
            this.logger.log(`✅ Cidadão criado com sucesso em ${duration}ms`, {
                cidadaoId: result.id,
                duration
            });
            return result;
        }
        catch (error) {
            const duration = Date.now() - startTime;
            this.logger.error(`❌ Erro ao criar cidadão após ${duration}ms:`, {
                error: error.message,
                duration
            });
            throw error;
        }
    }
    /**
     * Atualiza um cidadão existente
     */
    async update(id, updateCidadaoDto, req) {
        // Inicia medição de tempo para performance
        const startTime = Date.now();
        const requestId = `UPDATE-${id.substring(0, 8)}-${Date.now()}`;
        this.logger.log(`[${requestId}] Início de processamento de atualização de cidadão`);
        try {
            // Restaurando o código original com monitoramento de performance
            const result = await this.cidadaoService.update(id, updateCidadaoDto, req.user.id);
            // Registra tempo total da operação para monitoramento
            const totalTime = Date.now() - startTime;
            if (totalTime > 500) {
                this.logger.warn(`[${requestId}] Operação lenta (update): ${totalTime}ms`);
            }
            else {
                this.logger.log(`[${requestId}] Operação concluída em ${totalTime}ms`);
            }
            return result;
        }
        catch (error) {
            // Registra erro para diagnóstico
            const totalTime = Date.now() - startTime;
            this.logger.error(`[${requestId}] Erro em ${totalTime}ms: ${error.message}`);
            throw error;
        }
    }
    /**
     * Busca um cidadão pelo CPF
     * @param cpf CPF do cidadão
     * @returns Dados do cidadão encontrado
     */
    async findByCpf(cpf) {
        // Inicia medição de tempo para performance
        const startTime = Date.now();
        const requestId = `CPF-${cpf.substring(Math.max(0, cpf.length - 4))}-${Date.now()}`;
        this.logger.log(`[${requestId}] Início de processamento da requisição CPF`);
        try {
            // Chama o serviço otimizado para buscar por CPF
            const result = await this.cidadaoService.findByCpf(cpf, true);
            // Registra tempo total da operação para monitoramento
            const totalTime = Date.now() - startTime;
            if (totalTime > 500) {
                this.logger.warn(`[${requestId}] Operação lenta: ${totalTime}ms`);
            }
            else {
                this.logger.log(`[${requestId}] Operação concluída em ${totalTime}ms`);
            }
            return result;
        }
        catch (error) {
            // Registra erro para diagnóstico
            const totalTime = Date.now() - startTime;
            this.logger.error(`[${requestId}] Erro em ${totalTime}ms: ${error.message}`);
            throw error;
        }
    }
    /**
     * Busca cidadão por NIS
     */
    async findByNis(nis) {
        // Inicia medição de tempo para performance
        const startTime = Date.now();
        const requestId = `NIS-${nis.substring(Math.max(0, nis.length - 4))}-${Date.now()}`;
        this.logger.log(`[${requestId}] Início de processamento da requisição NIS`);
        try {
            // Chama o serviço otimizado para buscar por NIS
            const result = await this.cidadaoService.findByNis(nis, true);
            // Registra tempo total da operação para monitoramento
            const totalTime = Date.now() - startTime;
            if (totalTime > 500) {
                this.logger.warn(`[${requestId}] Operação lenta: ${totalTime}ms`);
            }
            else {
                this.logger.log(`[${requestId}] Operação concluída em ${totalTime}ms`);
            }
            return result;
        }
        catch (error) {
            // Registra erro para diagnóstico
            const totalTime = Date.now() - startTime;
            this.logger.error(`[${requestId}] Erro em ${totalTime}ms: ${error.message}`);
            throw error;
        }
    }
    /**
     * Obtém histórico de solicitações de um cidadão
     */
    async findSolicitacoes(id) {
        return this.cidadaoService.findSolicitacoesByCidadaoId(id);
    }
    /**
     * Adiciona membro à composição familiar
     */
    async addComposicaoFamiliar(id, createComposicaoFamiliarDto, req) {
        // Inicia medição de tempo para performance
        const startTime = Date.now();
        const requestId = `COMP-${id.substring(0, 8)}-${Date.now()}`;
        this.logger.log(`[${requestId}] Início de processamento de adição na composição familiar`);
        try {
            // Restaurando o código original com monitoramento de performance
            const result = await this.cidadaoService.addComposicaoFamiliar(id, createComposicaoFamiliarDto, req?.user?.id);
            // Registra tempo total da operação para monitoramento
            const totalTime = Date.now() - startTime;
            if (totalTime > 500) {
                this.logger.warn(`[${requestId}] Operação lenta (addComposicaoFamiliar): ${totalTime}ms`);
            }
            else {
                this.logger.log(`[${requestId}] Operação concluída em ${totalTime}ms`);
            }
            return result;
        }
        catch (error) {
            // Registra erro para diagnóstico
            const totalTime = Date.now() - startTime;
            this.logger.error(`[${requestId}] Erro em ${totalTime}ms: ${error.message}`);
            throw error;
        }
    }
};
exports.CidadaoController = CidadaoController;
__decorate([
    (0, common_1.Get)(),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.listar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'user.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Listar cidadãos',
        description: 'Retorna uma lista paginada de cidadãos com opções de filtro.',
    }),
    (0, swagger_1.ApiOkResponse)({
        description: 'Lista de cidadãos retornada com sucesso',
        type: cidadao_response_dto_1.CidadaoPaginatedResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Não autorizado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 403,
        description: 'Acesso negado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiQuery)({
        name: 'page',
        required: false,
        type: Number,
        description: 'Número da página (padrão: 1)',
        example: 1,
    }),
    (0, swagger_1.ApiQuery)({
        name: 'limit',
        required: false,
        type: Number,
        description: 'Número de itens por página (padrão: 10, máximo: 100)',
        example: 10,
    }),
    (0, swagger_1.ApiQuery)({
        name: 'search',
        required: false,
        type: String,
        description: 'Termo de busca (busca por nome, CPF ou NIS)',
        example: 'Maria',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'bairro',
        required: false,
        type: String,
        description: 'Filtrar por bairro',
        example: 'Centro',
    }),
    __param(0, (0, common_1.Request)()),
    __param(1, (0, common_1.Query)('page')),
    __param(2, (0, common_1.Query)('limit')),
    __param(3, (0, common_1.Query)('search')),
    __param(4, (0, common_1.Query)('bairro')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, Object, Object, String, String]),
    __metadata("design:returntype", typeof (_c = typeof Promise !== "undefined" && Promise) === "function" ? _c : Object)
], CidadaoController.prototype, "findAll", null);
__decorate([
    (0, common_1.Get)('cursor'),
    (0, swagger_1.ApiBearerAuth)(),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiOperation)({
        summary: 'Lista cidadãos com paginação por cursor (mais eficiente para grandes volumes)',
        description: 'Implementa paginação baseada em cursor, que é mais eficiente que a paginação por offset para grandes volumes de dados.'
    }),
    (0, swagger_1.ApiQuery)({
        name: 'cursor',
        required: false,
        type: String,
        description: 'Cursor para a próxima página (ID do último item da página anterior)',
        example: '550e8400-e29b-41d4-a716-446655440000',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'limit',
        required: false,
        type: Number,
        description: 'Quantidade de itens por página',
        example: 10,
    }),
    (0, swagger_1.ApiQuery)({
        name: 'search',
        required: false,
        type: String,
        description: 'Busca por nome, CPF ou NIS',
        example: 'João',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'bairro',
        required: false,
        type: String,
        description: 'Filtrar por bairro',
        example: 'Centro',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'orderBy',
        required: false,
        type: String,
        description: 'Campo para ordenação',
        example: 'created_at',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'orderDirection',
        required: false,
        enum: ['ASC', 'DESC'],
        description: 'Direção da ordenação',
        example: 'DESC',
    }),
    __param(0, (0, common_1.Query)('cursor')),
    __param(1, (0, common_1.Query)('limit')),
    __param(2, (0, common_1.Query)('search')),
    __param(3, (0, common_1.Query)('bairro')),
    __param(4, (0, common_1.Query)('orderBy')),
    __param(5, (0, common_1.Query)('orderDirection')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object, String, String, String, String]),
    __metadata("design:returntype", Promise)
], CidadaoController.prototype, "findByCursor", null);
__decorate([
    (0, common_1.Get)('busca'),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.visualizar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'cidadao.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Buscar cidadão',
        description: 'Busca um cidadão por ID, CPF, NIS, telefone ou nome. Permite apenas um parâmetro por vez.',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'id',
        required: false,
        type: String,
        description: 'ID do cidadão (UUID)',
        example: '550e8400-e29b-41d4-a716-446655440000',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'cpf',
        required: false,
        type: String,
        description: 'CPF do cidadão (com ou sem formatação)',
        example: '12345678901',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'nis',
        required: false,
        type: String,
        description: 'NIS do cidadão',
        example: '12345678901',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'telefone',
        required: false,
        type: String,
        description: 'Telefone do cidadão (com ou sem formatação)',
        example: '11987654321',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'nome',
        required: false,
        type: String,
        description: 'Nome do cidadão (busca parcial)',
        example: 'João Silva',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'includeRelations',
        required: false,
        type: Boolean,
        description: 'Incluir relacionamentos (composição familiar, etc.)',
        example: false,
    }),
    (0, swagger_1.ApiOkResponse)({
        description: 'Cidadão(s) encontrado(s) com sucesso',
        schema: {
            oneOf: [
                { $ref: '#/components/schemas/CidadaoResponseDto' },
                {
                    type: 'array',
                    items: { $ref: '#/components/schemas/CidadaoResponseDto' },
                },
            ],
        },
    }),
    (0, swagger_1.ApiBadRequestResponse)({
        description: 'Parâmetros de busca inválidos',
        type: api_error_response_dto_1.ApiErrorResponse,
        schema: {
            example: {
                statusCode: 400,
                message: 'Forneça apenas um parâmetro de busca por vez',
                error: 'Bad Request',
            },
        },
    }),
    (0, swagger_1.ApiNotFoundResponse)({
        description: 'Cidadão não encontrado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    __param(0, (0, common_1.Query)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_d = typeof busca_cidadao_dto_1.BuscaCidadaoDto !== "undefined" && busca_cidadao_dto_1.BuscaCidadaoDto) === "function" ? _d : Object]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], CidadaoController.prototype, "buscarCidadao", null);
__decorate([
    (0, common_1.Get)(':id'),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.visualizar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'cidadao.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Obter detalhes de um cidadão',
        description: 'Retorna os detalhes completos de um cidadão pelo seu ID.',
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        required: true,
        description: 'ID do cidadão',
        example: '550e8400-e29b-41d4-a716-446655440000',
    }),
    (0, swagger_1.ApiOkResponse)({
        description: 'Cidadão encontrado com sucesso',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão não encontrado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'ID inválido',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    __param(0, (0, common_1.Param)('id', new common_1.ParseUUIDPipe({ version: '4' }))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_f = typeof Promise !== "undefined" && Promise) === "function" ? _f : Object)
], CidadaoController.prototype, "findOne", null);
__decorate([
    (0, common_1.Post)(),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.criar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'user.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Criar cidadão',
        description: 'Cadastra um novo cidadão no sistema.',
        requestBody: {
            description: 'Dados do cidadão a ser criado',
            required: true,
            content: {
                'application/json': {
                    schema: {
                        $ref: '#/components/schemas/CreateCidadaoDto',
                    },
                    examples: {
                        'cidadao-completo': {
                            summary: 'Cidadão com dados completos',
                            description: 'Exemplo de criação de cidadão com todos os dados preenchidos',
                            value: {
                                nome: 'Maria da Silva Santos',
                                cpf: '123.456.789-00',
                                rg: '1234567',
                                prontuario_suas: 'SUAS1234567',
                                naturalidade: 'Natal',
                                data_nascimento: '1985-03-15',
                                sexo: 'FEMININO',
                                estado_civil: 'SOLTEIRA',
                                nis: '12345678901',
                                telefone: '(84) 99999-9999',
                                email: 'maria.silva@email.com',
                                endereco: {
                                    logradouro: 'Rua das Flores',
                                    numero: '123',
                                    complemento: 'Apto 101',
                                    bairro: 'Centro',
                                    cidade: 'Natal',
                                    estado: 'RN',
                                    cep: '59000-000',
                                    ponto_referencia: 'Próximo ao Corpo de Bombeiros',
                                    tempo_de_residencia: 2
                                },
                                papeis: [{
                                        tipo_papel: 'requerente',
                                        metadados: {
                                            grau_parentesco: 'Responsável'
                                        }
                                    }]
                            }
                        },
                        'cidadao-minimo': {
                            summary: 'Cidadão com dados mínimos',
                            description: 'Exemplo de criação de cidadão apenas com campos obrigatórios',
                            value: {
                                nome: 'João Santos',
                                cpf: '987.654.321-00',
                                rg: '7654321',
                                prontuario_suas: 'SUAS7654321',
                                naturalidade: 'Natal',
                                data_nascimento: '1990-07-20',
                                sexo: 'MASCULINO',
                                estado_civil: 'SOLTEIRO',
                                nis: '10987654321',
                                telefone: '(84) 88888-8888',
                                endereco: {
                                    logradouro: 'Rua Principal',
                                    numero: '456',
                                    bairro: 'Cidade Nova',
                                    cidade: 'Natal',
                                    estado: 'RN',
                                    cep: '59100-000',
                                    tempo_de_residencia: 5
                                }
                            }
                        }
                    }
                }
            }
        }
    }),
    (0, swagger_1.ApiOkResponse)({
        description: 'Cidadão criado com sucesso',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    (0, swagger_1.ApiBadRequestResponse)({
        description: 'Dados inválidos fornecidos',
        type: api_error_response_dto_1.ApiErrorResponse,
        schema: {
            example: {
                statusCode: 400,
                message: 'CPF inválido',
                error: 'Bad Request',
            },
        },
    }),
    (0, swagger_1.ApiConflictResponse)({
        description: 'Conflito - CPF ou NIS já cadastrado',
        type: api_error_response_dto_1.ApiErrorResponse,
        schema: {
            example: {
                statusCode: 409,
                message: 'Já existe um cidadão cadastrado com este CPF',
                error: 'Conflict',
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Cidadão criado com sucesso',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    __param(0, (0, common_1.Body)()),
    __param(1, (0, common_1.Request)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_g = typeof create_cidadao_dto_1.CreateCidadaoDto !== "undefined" && create_cidadao_dto_1.CreateCidadaoDto) === "function" ? _g : Object, Object]),
    __metadata("design:returntype", typeof (_h = typeof Promise !== "undefined" && Promise) === "function" ? _h : Object)
], CidadaoController.prototype, "create", null);
__decorate([
    (0, common_1.Put)(':id'),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.editar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'cidadao.unidadeId',
    }),
    (0, swagger_1.ApiOperation)({
        summary: 'Atualizar cidadão existente',
        description: 'Atualiza os dados de um cidadão existente.',
    }),
    (0, swagger_1.ApiParam)({
        name: 'id',
        required: true,
        description: 'ID do cidadão a ser atualizado',
        example: '550e8400-e29b-41d4-a716-446655440000',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Cidadão atualizado com sucesso',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Dados inválidos',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Não autorizado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 403,
        description: 'Acesso negado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão não encontrado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 409,
        description: 'CPF ou NIS já em uso',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    __param(0, (0, common_1.Param)('id', new common_1.ParseUUIDPipe({ version: '4' }))),
    __param(1, (0, common_1.Body)()),
    __param(2, (0, common_1.Request)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_j = typeof update_cidadao_dto_1.UpdateCidadaoDto !== "undefined" && update_cidadao_dto_1.UpdateCidadaoDto) === "function" ? _j : Object, Object]),
    __metadata("design:returntype", typeof (_k = typeof Promise !== "undefined" && Promise) === "function" ? _k : Object)
], CidadaoController.prototype, "update", null);
__decorate([
    (0, common_1.Get)('cpf/:cpf'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao.buscar.cpf' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Buscar cidadão por CPF',
        description: 'Busca um cidadão pelo CPF, com ou sem formatação',
    }),
    (0, swagger_1.ApiParam)({
        name: 'cpf',
        type: String,
        description: 'CPF do cidadão (com ou sem formatação)',
        example: '123.456.789-00',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Cidadão encontrado',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'CPF inválido',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão não encontrado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    __param(0, (0, common_1.Param)('cpf')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_l = typeof Promise !== "undefined" && Promise) === "function" ? _l : Object)
], CidadaoController.prototype, "findByCpf", null);
__decorate([
    (0, common_1.Get)('nis/:nis'),
    (0, requires_permission_decorator_1.RequiresPermission)({ permissionName: 'cidadao.buscar.nis' }),
    (0, swagger_1.ApiOperation)({
        summary: 'Buscar cidadão por NIS',
        description: 'Busca um cidadão pelo número do NIS (PIS/PASEP).',
    }),
    (0, swagger_1.ApiParam)({
        name: 'nis',
        required: true,
        description: 'Número do NIS (PIS/PASEP)',
        example: '12345678901',
    }),
    (0, swagger_1.ApiOkResponse)({
        description: 'Cidadão encontrado com sucesso',
        type: cidadao_response_dto_1.CidadaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'NIS inválido',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Cidadão não encontrado',
        type: api_error_response_dto_1.ApiErrorResponse,
    }),
    __param(0, (0, common_1.Param)('nis')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_m = typeof Promise !== "undefined" && Promise) === "function" ? _m : Object)
], CidadaoController.prototype, "findByNis", null);
__decorate([
    (0, common_1.Get)(':id/solicitacao'),
    (0, swagger_1.ApiOperation)({ summary: 'Histórico de solicitações' }),
    (0, swagger_1.ApiResponse)({ status: 200, description: 'Histórico retornado com sucesso' }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Cidadão não encontrado' }),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.visualizar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'cidadao.unidadeId',
    }, { permissionName: 'solicitacao.listar' }),
    __param(0, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], CidadaoController.prototype, "findSolicitacoes", null);
__decorate([
    (0, common_1.Post)(':id/composicao'),
    (0, swagger_1.ApiOperation)({ summary: 'Adicionar membro à composição familiar' }),
    (0, swagger_1.ApiResponse)({ status: 201, description: 'Membro adicionado com sucesso' }),
    (0, swagger_1.ApiResponse)({ status: 400, description: 'Dados inválidos' }),
    (0, swagger_1.ApiResponse)({ status: 404, description: 'Cidadão não encontrado' }),
    (0, requires_permission_decorator_1.RequiresPermission)({
        permissionName: 'cidadao.editar',
        scopeType: user_permission_entity_1.ScopeType.UNIT,
        scopeIdExpression: 'cidadao.unidadeId',
    }),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)()),
    __param(2, (0, common_1.Request)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_o = typeof create_composicao_familiar_dto_1.CreateComposicaoFamiliarDto !== "undefined" && create_composicao_familiar_dto_1.CreateComposicaoFamiliarDto) === "function" ? _o : Object, Object]),
    __metadata("design:returntype", Promise)
], CidadaoController.prototype, "addComposicaoFamiliar", null);
exports.CidadaoController = CidadaoController = CidadaoController_1 = __decorate([
    (0, swagger_1.ApiTags)('Cidadão'),
    (0, swagger_1.ApiExtraModels)(cidadao_response_dto_1.CidadaoResponseDto, cidadao_response_dto_1.CidadaoComposicaoFamiliarDto),
    (0, common_1.Controller)('cidadao'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)(),
    __metadata("design:paramtypes", [typeof (_a = typeof cidadao_service_1.CidadaoService !== "undefined" && cidadao_service_1.CidadaoService) === "function" ? _a : Object, typeof (_b = typeof cidadao_repository_1.CidadaoRepository !== "undefined" && cidadao_repository_1.CidadaoRepository) === "function" ? _b : Object])
], CidadaoController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNpZGFkYW9cXGNvbnRyb2xsZXJzXFxjaWRhZGFvLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FxQndCO0FBQ3hCLDZDQVl5QjtBQUN6QixrRUFBNkQ7QUFDN0Qsa0VBQTZEO0FBQzdELDBGQUFvRjtBQUNwRixnRUFBMkQ7QUFDM0QsaUVBQTZEO0FBQzdELDJFQUF1RTtBQUN2RSx3RUFBbUU7QUFDbkUsMkVBQTJFO0FBQzNFLDBHQUE0RjtBQUU1RixxRkFBcUU7QUFDckUsc0VBSXFDO0FBQ3JDLHdGQUErRTtBQUUvRTs7OztHQUlHO0FBTUksSUFBTSxpQkFBaUIseUJBQXZCLE1BQU0saUJBQWlCO0lBSVQ7SUFDQTtJQUpGLE1BQU0sR0FBRyxJQUFJLGVBQU0sQ0FBQyxtQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUU3RCxZQUNtQixjQUE4QixFQUM5QixpQkFBb0M7UUFEcEMsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7SUFDcEQsQ0FBQztJQUVKOztPQUVHO0lBc0RHLEFBQU4sS0FBSyxDQUFDLE9BQU8sQ0FDQSxHQUFHLEVBQ0MsT0FBTyxDQUFDLEVBQ1AsUUFBUSxFQUFFLEVBQ1QsTUFBZSxFQUNmLE1BQWU7UUFFaEMsMkNBQTJDO1FBQzNDLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUM3QixNQUFNLFNBQVMsR0FBRyxRQUFRLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksU0FBUyxtREFBbUQsQ0FBQyxDQUFDO1FBRWxGLElBQUksQ0FBQztZQUNILGlFQUFpRTtZQUNqRSxNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUks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Q1gsV0FBQSxJQUFBLGFBQUksR0FBRSxDQUFBO0lBQ04sV0FBQSxJQUFBLGdCQUFPLEdBQUUsQ0FBQTs7aUVBRDJCLDREQUEyQixvQkFBM0IsNERBQTJCOzs4REErQmpFOzRCQXBzQlUsaUJBQWlCO0lBTDdCLElBQUEsaUJBQU8sRUFBQyxTQUFTLENBQUM7SUFDbEIsSUFBQSx3QkFBYyxFQUFDLHlDQUFrQixFQUFFLG1EQUE0QixDQUFDO0lBQ2hFLElBQUEsbUJBQVUsRUFBQyxTQUFTLENBQUM7SUFDckIsSUFBQSxrQkFBUyxFQUFDLDZCQUFZLENBQUM7SUFDdkIsSUFBQSx1QkFBYSxHQUFFO3lEQUtxQixnQ0FBYyxvQkFBZCxnQ0FBYyxvREFDWCxzQ0FBaUIsb0JBQWpCLHNDQUFpQjtHQUw1QyxpQkFBaUIsQ0Fxc0I3QiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcY2lkYWRhb1xcY29udHJvbGxlcnNcXGNpZGFkYW8uY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb250cm9sbGVyLFxuICBHZXQsXG4gIFBvc3QsXG4gIEJvZHksXG4gIFBhcmFtLFxuICBRdWVyeSxcbiAgUHV0LFxuICBEZWxldGUsXG4gIFBhcnNlVVVJRFBpcGUsXG4gIERlZmF1bHRWYWx1ZVBpcGUsXG4gIFBhcnNlSW50UGlwZSxcbiAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgVXNlSW50ZXJjZXB0b3JzLFxuICBVcGxvYWRlZEZpbGVzLFxuICBVc2VHdWFyZHMsXG4gIEh0dHBTdGF0dXMsXG4gIFJlcyxcbiAgU2V0TWV0YWRhdGEsXG4gIExvZ2dlcixcbiAgUmVxdWVzdCxcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQmVhcmVyQXV0aCxcbiAgQXBpUXVlcnksXG4gIEFwaVBhcmFtLFxuICBBcGlPa1Jlc3BvbnNlLFxuICBBcGlDb25mbGljdFJlc3BvbnNlLFxuICBBcGlOb3RGb3VuZFJlc3BvbnNlLFxuICBBcGlCYWRSZXF1ZXN0UmVzcG9uc2UsXG4gIEFwaUV4dHJhTW9kZWxzLFxufSBmcm9tICdAbmVzdGpzL3N3YWdnZXInO1xuaW1wb3J0IHsgQ3JlYXRlQ2lkYWRhb0R0byB9IGZyb20gJy4uL2R0by9jcmVhdGUtY2lkYWRhby5kdG8nO1xuaW1wb3J0IHsgVXBkYXRlQ2lkYWRhb0R0byB9IGZyb20gJy4uL2R0by91cGRhdGUtY2lkYWRhby5kdG8nO1xuaW1wb3J0IHsgQ3JlYXRlQ29tcG9zaWNhb0ZhbWlsaWFyRHRvIH0gZnJvbSAnLi4vZHRvL2NyZWF0ZS1jb21wb3NpY2FvLWZhbWlsaWFyLmR0byc7XG5pbXBvcnQgeyBCdXNjYUNpZGFkYW9EdG8gfSBmcm9tICcuLi9kdG8vYnVzY2EtY2lkYWRhby5kdG8nO1xuaW1wb3J0IHsgQ2lkYWRhb1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9jaWRhZGFvLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ2lkYWRhb1JlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvY2lkYWRhby5yZXBvc2l0b3J5JztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uLy4uLy4uL2F1dGgvZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbi8vIGltcG9ydCB7IE11bHRlclVwbG9hZGVyIH0gZnJvbSAnLi4vLi4vY29tbW9uL3VwbG9hZGVycy9tdWx0ZXIudXBsb2FkZXInO1xuaW1wb3J0IHsgUmVxdWlyZXNQZXJtaXNzaW9uIH0gZnJvbSAnLi4vLi4vLi4vYXV0aC9kZWNvcmF0b3JzL3JlcXVpcmVzLXBlcm1pc3Npb24uZGVjb3JhdG9yJztcbmltcG9ydCB7IENpZGFkYW8gfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9jaWRhZGFvLmVudGl0eSc7XG5pbXBvcnQgeyBTY29wZVR5cGUgfSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy91c2VyLXBlcm1pc3Npb24uZW50aXR5JztcbmltcG9ydCB7XG4gIENpZGFkYW9SZXNwb25zZUR0byxcbiAgQ2lkYWRhb1BhZ2luYXRlZFJlc3BvbnNlRHRvLFxuICBDaWRhZGFvQ29tcG9zaWNhb0ZhbWlsaWFyRHRvLFxufSBmcm9tICcuLi9kdG8vY2lkYWRhby1yZXNwb25zZS5kdG8nO1xuaW1wb3J0IHsgQXBpRXJyb3JSZXNwb25zZSB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9kdG9zL2FwaS1lcnJvci1yZXNwb25zZS5kdG8nO1xuXG4vKipcbiAqIENvbnRyb2xhZG9yIGRlIGNpZGFkw6Nvc1xuICpcbiAqIFJlc3BvbnPDoXZlbCBwb3IgZ2VyZW5jaWFyIGFzIHJvdGFzIHJlbGFjaW9uYWRhcyBhIGNpZGFkw6Nvcy9iZW5lZmljacOhcmlvc1xuICovXG5AQXBpVGFncygnQ2lkYWTDo28nKVxuQEFwaUV4dHJhTW9kZWxzKENpZGFkYW9SZXNwb25zZUR0bywgQ2lkYWRhb0NvbXBvc2ljYW9GYW1pbGlhckR0bylcbkBDb250cm9sbGVyKCdjaWRhZGFvJylcbkBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuQEFwaUJlYXJlckF1dGgoKVxuZXhwb3J0IGNsYXNzIENpZGFkYW9Db250cm9sbGVyIHtcbiAgcHJpdmF0ZSByZWFkb25seSBsb2dnZXIgPSBuZXcgTG9nZ2VyKENpZGFkYW9Db250cm9sbGVyLm5hbWUpO1xuICBcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBjaWRhZGFvU2VydmljZTogQ2lkYWRhb1NlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBjaWRhZGFvUmVwb3NpdG9yeTogQ2lkYWRhb1JlcG9zaXRvcnksXG4gICkge31cblxuICAvKipcbiAgICogTGlzdGEgdG9kb3Mgb3MgY2lkYWTDo29zIGNvbSBmaWx0cm9zIGUgcGFnaW5hw6fDo29cbiAgICovXG4gIEBHZXQoKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKFxuICB7XG4gICAgcGVybWlzc2lvbk5hbWU6ICdjaWRhZGFvLmxpc3RhcicsXG4gICAgc2NvcGVUeXBlOiBTY29wZVR5cGUuVU5JVCxcbiAgICBzY29wZUlkRXhwcmVzc2lvbjogJ3VzZXIudW5pZGFkZUlkJyxcbiAgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0xpc3RhciBjaWRhZMOjb3MnLFxuICAgIGRlc2NyaXB0aW9uOiAnUmV0b3JuYSB1bWEgbGlzdGEgcGFnaW5hZGEgZGUgY2lkYWTDo29zIGNvbSBvcMOnw7VlcyBkZSBmaWx0cm8uJyxcbiAgfSlcbiAgQEFwaU9rUmVzcG9uc2Uoe1xuICAgIGRlc2NyaXB0aW9uOiAnTGlzdGEgZGUgY2lkYWTDo29zIHJldG9ybmFkYSBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQ2lkYWRhb1BhZ2luYXRlZFJlc3BvbnNlRHRvLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAxLFxuICAgIGRlc2NyaXB0aW9uOiAnTsOjbyBhdXRvcml6YWRvJyxcbiAgICB0eXBlOiBBcGlFcnJvclJlc3BvbnNlLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAzLFxuICAgIGRlc2NyaXB0aW9uOiAnQWNlc3NvIG5lZ2FkbycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAncGFnZScsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIHR5cGU6IE51bWJlcixcbiAgICBkZXNjcmlwdGlvbjogJ07Dum1lcm8gZGEgcMOhZ2luYSAocGFkcsOjbzogMSknLFxuICAgIGV4YW1wbGU6IDEsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ2xpbWl0JyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogTnVtYmVyLFxuICAgIGRlc2NyaXB0aW9uOiAnTsO6bWVybyBkZSBpdGVucyBwb3IgcMOhZ2luYSAocGFkcsOjbzogMTAsIG3DoXhpbW86IDEwMCknLFxuICAgIGV4YW1wbGU6IDEwLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdzZWFyY2gnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVzY3JpcHRpb246ICdUZXJtbyBkZSBidXNjYSAoYnVzY2EgcG9yIG5vbWUsIENQRiBvdSBOSVMpJyxcbiAgICBleGFtcGxlOiAnTWFyaWEnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdiYWlycm8nLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVzY3JpcHRpb246ICdGaWx0cmFyIHBvciBiYWlycm8nLFxuICAgIGV4YW1wbGU6ICdDZW50cm8nLFxuICB9KVxuICBhc3luYyBmaW5kQWxsKFxuICAgIEBSZXF1ZXN0KCkgcmVxLFxuICAgIEBRdWVyeSgncGFnZScpIHBhZ2UgPSAxLFxuICAgIEBRdWVyeSgnbGltaXQnKSBsaW1pdCA9IDEwLFxuICAgIEBRdWVyeSgnc2VhcmNoJykgc2VhcmNoPzogc3RyaW5nLFxuICAgIEBRdWVyeSgnYmFpcnJvJykgYmFpcnJvPzogc3RyaW5nLFxuICApOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIEluaWNpYSBtZWRpw6fDo28gZGUgdGVtcG8gcGFyYSBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVxdWVzdElkID0gYExJU1QtJHtEYXRlLm5vdygpfWA7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBbJHtyZXF1ZXN0SWR9XSBJbsOtY2lvIGRlIHByb2Nlc3NhbWVudG8gZGEgbGlzdGFnZW0gZGUgY2lkYWTDo29zYCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlc3RhdXJhbmRvIG8gY8OzZGlnbyBvcmlnaW5hbCBjb20gbW9uaXRvcmFtZW50byBkZSBwZXJmb3JtYW5jZVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaWRhZGFvU2VydmljZS5maW5kQWxsKHtcbiAgICAgICAgcGFnZSxcbiAgICAgICAgbGltaXQsXG4gICAgICAgIHNlYXJjaCxcbiAgICAgICAgYmFpcnJvLFxuICAgICAgICB1bmlkYWRlSWQ6IHJlcT8udXNlcj8udW5pZGFkZV9pZCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBSZWdpc3RyYSB0ZW1wbyB0b3RhbCBkYSBvcGVyYcOnw6NvIHBhcmEgbW9uaXRvcmFtZW50b1xuICAgICAgY29uc3QgdG90YWxUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGlmICh0b3RhbFRpbWUgPiA1MDApIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihgWyR7cmVxdWVzdElkfV0gT3BlcmHDp8OjbyBsZW50YSAoZmluZEFsbCk6ICR7dG90YWxUaW1lfW1zYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2coYFske3JlcXVlc3RJZH1dIE9wZXJhw6fDo28gY29uY2x1w61kYSBlbSAke3RvdGFsVGltZX1tc2ApO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBSZWdpc3RyYSBlcnJvIHBhcmEgZGlhZ27Ds3N0aWNvXG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYFske3JlcXVlc3RJZH1dIEVycm8gZW0gJHt0b3RhbFRpbWV9bXM6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIEBHZXQoJ2N1cnNvcicpXG4gIEBBcGlCZWFyZXJBdXRoKClcbiAgQFVzZUd1YXJkcyhKd3RBdXRoR3VhcmQpXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnTGlzdGEgY2lkYWTDo29zIGNvbSBwYWdpbmHDp8OjbyBwb3IgY3Vyc29yIChtYWlzIGVmaWNpZW50ZSBwYXJhIGdyYW5kZXMgdm9sdW1lcyknLCBcbiAgICBkZXNjcmlwdGlvbjogJ0ltcGxlbWVudGEgcGFnaW5hw6fDo28gYmFzZWFkYSBlbSBjdXJzb3IsIHF1ZSDDqSBtYWlzIGVmaWNpZW50ZSBxdWUgYSBwYWdpbmHDp8OjbyBwb3Igb2Zmc2V0IHBhcmEgZ3JhbmRlcyB2b2x1bWVzIGRlIGRhZG9zLidcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnY3Vyc29yJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiAnQ3Vyc29yIHBhcmEgYSBwcsOzeGltYSBww6FnaW5hIChJRCBkbyDDumx0aW1vIGl0ZW0gZGEgcMOhZ2luYSBhbnRlcmlvciknLFxuICAgIGV4YW1wbGU6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdsaW1pdCcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIHR5cGU6IE51bWJlcixcbiAgICBkZXNjcmlwdGlvbjogJ1F1YW50aWRhZGUgZGUgaXRlbnMgcG9yIHDDoWdpbmEnLFxuICAgIGV4YW1wbGU6IDEwLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdzZWFyY2gnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVzY3JpcHRpb246ICdCdXNjYSBwb3Igbm9tZSwgQ1BGIG91IE5JUycsXG4gICAgZXhhbXBsZTogJ0pvw6NvJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnYmFpcnJvJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiAnRmlsdHJhciBwb3IgYmFpcnJvJyxcbiAgICBleGFtcGxlOiAnQ2VudHJvJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnb3JkZXJCeScsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZXNjcmlwdGlvbjogJ0NhbXBvIHBhcmEgb3JkZW5hw6fDo28nLFxuICAgIGV4YW1wbGU6ICdjcmVhdGVkX2F0JyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnb3JkZXJEaXJlY3Rpb24nLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICBlbnVtOiBbJ0FTQycsICdERVNDJ10sXG4gICAgZGVzY3JpcHRpb246ICdEaXJlw6fDo28gZGEgb3JkZW5hw6fDo28nLFxuICAgIGV4YW1wbGU6ICdERVNDJyxcbiAgfSlcbiAgYXN5bmMgZmluZEJ5Q3Vyc29yKFxuICAgIEBRdWVyeSgnY3Vyc29yJykgY3Vyc29yPzogc3RyaW5nLFxuICAgIEBRdWVyeSgnbGltaXQnKSBsaW1pdCA9IDEwLFxuICAgIEBRdWVyeSgnc2VhcmNoJykgc2VhcmNoPzogc3RyaW5nLFxuICAgIEBRdWVyeSgnYmFpcnJvJykgYmFpcnJvPzogc3RyaW5nLFxuICAgIEBRdWVyeSgnb3JkZXJCeScpIG9yZGVyQnk/OiBzdHJpbmcsXG4gICAgQFF1ZXJ5KCdvcmRlckRpcmVjdGlvbicpIG9yZGVyRGlyZWN0aW9uPzogJ0FTQycgfCAnREVTQycsXG4gICkge1xuICAgIHJldHVybiB7IGRhdGE6IFtdLCBtZXNzYWdlOiAnRW5kcG9pbnQgZGVzYXRpdmFkbyB0ZW1wb3JhcmlhbWVudGUgcGFyYSBkaWFnbsOzc3RpY28nIH07XG4gICAgLy8gQ8OzZGlnbyBvcmlnaW5hbCBjb21lbnRhZG8gcGFyYSBwZXJtaXRpciBjb21waWxhw6fDo29cbiAgICAvKnJldHVybiB0aGlzLmNpZGFkYW9TZXJ2aWNlLmZpbmRCeUN1cnNvcih7XG4gICAgICBjdXJzb3IsXG4gICAgICBsaW1pdCxcbiAgICAgIHNlYXJjaCxcbiAgICAgIGJhaXJybyxcbiAgICAgIHVuaWRhZGVJZDogcmVxPy51c2VyPy51bmlkYWRlX2lkLFxuICAgICAgb3JkZXJCeSxcbiAgICAgIG9yZGVyRGlyZWN0aW9uLFxuICAgIH0pOyovXG4gIH1cblxuICAvKipcbiAgICogQnVzY2EgdW5pZmljYWRhIGRlIGNpZGFkw6NvIHBvciBJRCwgQ1BGLCBOSVMsIHRlbGVmb25lIG91IG5vbWVcbiAgICovXG4gIEBHZXQoJ2J1c2NhJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7XG4gICAgcGVybWlzc2lvbk5hbWU6ICdjaWRhZGFvLnZpc3VhbGl6YXInLFxuICAgIHNjb3BlVHlwZTogU2NvcGVUeXBlLlVOSVQsXG4gICAgc2NvcGVJZEV4cHJlc3Npb246ICdjaWRhZGFvLnVuaWRhZGVJZCcsXG4gIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdCdXNjYXIgY2lkYWTDo28nLFxuICAgIGRlc2NyaXB0aW9uOiAnQnVzY2EgdW0gY2lkYWTDo28gcG9yIElELCBDUEYsIE5JUywgdGVsZWZvbmUgb3Ugbm9tZS4gUGVybWl0ZSBhcGVuYXMgdW0gcGFyw6JtZXRybyBwb3IgdmV6LicsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ2lkJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgZG8gY2lkYWTDo28gKFVVSUQpJyxcbiAgICBleGFtcGxlOiAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAnY3BmJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiAnQ1BGIGRvIGNpZGFkw6NvIChjb20gb3Ugc2VtIGZvcm1hdGHDp8OjbyknLFxuICAgIGV4YW1wbGU6ICcxMjM0NTY3ODkwMScsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ25pcycsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZXNjcmlwdGlvbjogJ05JUyBkbyBjaWRhZMOjbycsXG4gICAgZXhhbXBsZTogJzEyMzQ1Njc4OTAxJyxcbiAgfSlcbiAgQEFwaVF1ZXJ5KHtcbiAgICBuYW1lOiAndGVsZWZvbmUnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVzY3JpcHRpb246ICdUZWxlZm9uZSBkbyBjaWRhZMOjbyAoY29tIG91IHNlbSBmb3JtYXRhw6fDo28pJyxcbiAgICBleGFtcGxlOiAnMTE5ODc2NTQzMjEnLFxuICB9KVxuICBAQXBpUXVlcnkoe1xuICAgIG5hbWU6ICdub21lJyxcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiAnTm9tZSBkbyBjaWRhZMOjbyAoYnVzY2EgcGFyY2lhbCknLFxuICAgIGV4YW1wbGU6ICdKb8OjbyBTaWx2YScsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ2luY2x1ZGVSZWxhdGlvbnMnLFxuICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlc2NyaXB0aW9uOiAnSW5jbHVpciByZWxhY2lvbmFtZW50b3MgKGNvbXBvc2nDp8OjbyBmYW1pbGlhciwgZXRjLiknLFxuICAgIGV4YW1wbGU6IGZhbHNlLFxuICB9KVxuICBAQXBpT2tSZXNwb25zZSh7XG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyhzKSBlbmNvbnRyYWRvKHMpIGNvbSBzdWNlc3NvJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIG9uZU9mOiBbXG4gICAgICAgIHsgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL0NpZGFkYW9SZXNwb25zZUR0bycgfSxcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdhcnJheScsXG4gICAgICAgICAgaXRlbXM6IHsgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL0NpZGFkYW9SZXNwb25zZUR0bycgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgfSlcbiAgQEFwaUJhZFJlcXVlc3RSZXNwb25zZSh7XG4gICAgZGVzY3JpcHRpb246ICdQYXLDom1ldHJvcyBkZSBidXNjYSBpbnbDoWxpZG9zJyxcbiAgICB0eXBlOiBBcGlFcnJvclJlc3BvbnNlLFxuICAgIHNjaGVtYToge1xuICAgICAgZXhhbXBsZToge1xuICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICAgIG1lc3NhZ2U6ICdGb3JuZcOnYSBhcGVuYXMgdW0gcGFyw6JtZXRybyBkZSBidXNjYSBwb3IgdmV6JyxcbiAgICAgICAgZXJyb3I6ICdCYWQgUmVxdWVzdCcsXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlOb3RGb3VuZFJlc3BvbnNlKHtcbiAgICBkZXNjcmlwdGlvbjogJ0NpZGFkw6NvIG7Do28gZW5jb250cmFkbycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgYXN5bmMgYnVzY2FyQ2lkYWRhbyhcbiAgICBAUXVlcnkoKSBxdWVyeTogQnVzY2FDaWRhZGFvRHRvLFxuICApOiBQcm9taXNlPENpZGFkYW9SZXNwb25zZUR0byB8IENpZGFkYW9SZXNwb25zZUR0b1tdPiB7XG4gICAgcmV0dXJuIHRoaXMuY2lkYWRhb1NlcnZpY2UuYnVzY2FyQ2lkYWRhbyhxdWVyeSk7XG4gIH1cbiAgXG5cblxuICAvKipcbiAgICogT2J0w6ltIGRldGFsaGVzIGRlIHVtIGNpZGFkw6NvIGVzcGVjw61maWNvXG4gICAqL1xuICBAR2V0KCc6aWQnKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHtcbiAgICBwZXJtaXNzaW9uTmFtZTogJ2NpZGFkYW8udmlzdWFsaXphcicsXG4gICAgc2NvcGVUeXBlOiBTY29wZVR5cGUuVU5JVCxcbiAgICBzY29wZUlkRXhwcmVzc2lvbjogJ2NpZGFkYW8udW5pZGFkZUlkJyxcbiAgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ09idGVyIGRldGFsaGVzIGRlIHVtIGNpZGFkw6NvJyxcbiAgICBkZXNjcmlwdGlvbjogJ1JldG9ybmEgb3MgZGV0YWxoZXMgY29tcGxldG9zIGRlIHVtIGNpZGFkw6NvIHBlbG8gc2V1IElELicsXG4gIH0pXG4gIEBBcGlQYXJhbSh7XG4gICAgbmFtZTogJ2lkJyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICBkZXNjcmlwdGlvbjogJ0lEIGRvIGNpZGFkw6NvJyxcbiAgICBleGFtcGxlOiAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgfSlcbiAgQEFwaU9rUmVzcG9uc2Uoe1xuICAgIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gZW5jb250cmFkbyBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQ2lkYWRhb1Jlc3BvbnNlRHRvLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDA0LFxuICAgIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gbsOjbyBlbmNvbnRyYWRvJyxcbiAgICB0eXBlOiBBcGlFcnJvclJlc3BvbnNlLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAwLFxuICAgIGRlc2NyaXB0aW9uOiAnSUQgaW52w6FsaWRvJyxcbiAgICB0eXBlOiBBcGlFcnJvclJlc3BvbnNlLFxuICB9KVxuICBhc3luYyBmaW5kT25lKFxuICAgIEBQYXJhbSgnaWQnLCBuZXcgUGFyc2VVVUlEUGlwZSh7IHZlcnNpb246ICc0JyB9KSkgaWQ6IHN0cmluZyxcbiAgKTogUHJvbWlzZTxDaWRhZGFvUmVzcG9uc2VEdG8+IHtcbiAgICByZXR1cm4gdGhpcy5jaWRhZGFvU2VydmljZS5maW5kQnlJZChpZCwgZmFsc2UpOyAvLyBOw6NvIGNhcnJlZ2FyIHJlbGFjaW9uYW1lbnRvcyBwb3IgcGFkcsOjbyBwYXJhIG1lbGhvciBwZXJmb3JtYW5jZVxuICB9XG5cbiAgLyoqXG4gICAqIENyaWEgdW0gbm92byBjaWRhZMOjb1xuICAgKi9cbiAgQFBvc3QoKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHtcbiAgICBwZXJtaXNzaW9uTmFtZTogJ2NpZGFkYW8uY3JpYXInLFxuICAgIHNjb3BlVHlwZTogU2NvcGVUeXBlLlVOSVQsXG4gICAgc2NvcGVJZEV4cHJlc3Npb246ICd1c2VyLnVuaWRhZGVJZCcsXG4gIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDcmlhciBjaWRhZMOjbycsXG4gICAgZGVzY3JpcHRpb246ICdDYWRhc3RyYSB1bSBub3ZvIGNpZGFkw6NvIG5vIHNpc3RlbWEuJyxcbiAgICByZXF1ZXN0Qm9keToge1xuICAgICAgZGVzY3JpcHRpb246ICdEYWRvcyBkbyBjaWRhZMOjbyBhIHNlciBjcmlhZG8nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBjb250ZW50OiB7XG4gICAgICAgICdhcHBsaWNhdGlvbi9qc29uJzoge1xuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL0NyZWF0ZUNpZGFkYW9EdG8nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhhbXBsZXM6IHtcbiAgICAgICAgICAgICdjaWRhZGFvLWNvbXBsZXRvJzoge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiAnQ2lkYWTDo28gY29tIGRhZG9zIGNvbXBsZXRvcycsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRXhlbXBsbyBkZSBjcmlhw6fDo28gZGUgY2lkYWTDo28gY29tIHRvZG9zIG9zIGRhZG9zIHByZWVuY2hpZG9zJyxcbiAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICBub21lOiAnTWFyaWEgZGEgU2lsdmEgU2FudG9zJyxcbiAgICAgICAgICAgICAgICBjcGY6ICcxMjMuNDU2Ljc4OS0wMCcsXG4gICAgICAgICAgICAgICAgcmc6ICcxMjM0NTY3JyxcbiAgICAgICAgICAgICAgICBwcm9udHVhcmlvX3N1YXM6ICdTVUFTMTIzNDU2NycsXG4gICAgICAgICAgICAgICAgbmF0dXJhbGlkYWRlOiAnTmF0YWwnLFxuICAgICAgICAgICAgICAgIGRhdGFfbmFzY2ltZW50bzogJzE5ODUtMDMtMTUnLFxuICAgICAgICAgICAgICAgIHNleG86ICdGRU1JTklOTycsXG4gICAgICAgICAgICAgICAgZXN0YWRvX2NpdmlsOiAnU09MVEVJUkEnLFxuICAgICAgICAgICAgICAgIG5pczogJzEyMzQ1Njc4OTAxJyxcbiAgICAgICAgICAgICAgICB0ZWxlZm9uZTogJyg4NCkgOTk5OTktOTk5OScsXG4gICAgICAgICAgICAgICAgZW1haWw6ICdtYXJpYS5zaWx2YUBlbWFpbC5jb20nLFxuICAgICAgICAgICAgICAgIGVuZGVyZWNvOiB7XG4gICAgICAgICAgICAgICAgICBsb2dyYWRvdXJvOiAnUnVhIGRhcyBGbG9yZXMnLFxuICAgICAgICAgICAgICAgICAgbnVtZXJvOiAnMTIzJyxcbiAgICAgICAgICAgICAgICAgIGNvbXBsZW1lbnRvOiAnQXB0byAxMDEnLFxuICAgICAgICAgICAgICAgICAgYmFpcnJvOiAnQ2VudHJvJyxcbiAgICAgICAgICAgICAgICAgIGNpZGFkZTogJ05hdGFsJyxcbiAgICAgICAgICAgICAgICAgIGVzdGFkbzogJ1JOJyxcbiAgICAgICAgICAgICAgICAgIGNlcDogJzU5MDAwLTAwMCcsXG4gICAgICAgICAgICAgICAgICBwb250b19yZWZlcmVuY2lhOiAnUHLDs3hpbW8gYW8gQ29ycG8gZGUgQm9tYmVpcm9zJyxcbiAgICAgICAgICAgICAgICAgIHRlbXBvX2RlX3Jlc2lkZW5jaWE6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBhcGVpczogW3tcbiAgICAgICAgICAgICAgICAgIHRpcG9fcGFwZWw6ICdyZXF1ZXJlbnRlJyxcbiAgICAgICAgICAgICAgICAgIG1ldGFkYWRvczoge1xuICAgICAgICAgICAgICAgICAgICBncmF1X3BhcmVudGVzY286ICdSZXNwb25zw6F2ZWwnXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdjaWRhZGFvLW1pbmltbyc6IHtcbiAgICAgICAgICAgICAgc3VtbWFyeTogJ0NpZGFkw6NvIGNvbSBkYWRvcyBtw61uaW1vcycsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRXhlbXBsbyBkZSBjcmlhw6fDo28gZGUgY2lkYWTDo28gYXBlbmFzIGNvbSBjYW1wb3Mgb2JyaWdhdMOzcmlvcycsXG4gICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgbm9tZTogJ0pvw6NvIFNhbnRvcycsXG4gICAgICAgICAgICAgICAgY3BmOiAnOTg3LjY1NC4zMjEtMDAnLFxuICAgICAgICAgICAgICAgIHJnOiAnNzY1NDMyMScsXG4gICAgICAgICAgICAgICAgcHJvbnR1YXJpb19zdWFzOiAnU1VBUzc2NTQzMjEnLFxuICAgICAgICAgICAgICAgIG5hdHVyYWxpZGFkZTogJ05hdGFsJyxcbiAgICAgICAgICAgICAgICBkYXRhX25hc2NpbWVudG86ICcxOTkwLTA3LTIwJyxcbiAgICAgICAgICAgICAgICBzZXhvOiAnTUFTQ1VMSU5PJyxcbiAgICAgICAgICAgICAgICBlc3RhZG9fY2l2aWw6ICdTT0xURUlSTycsXG4gICAgICAgICAgICAgICAgbmlzOiAnMTA5ODc2NTQzMjEnLFxuICAgICAgICAgICAgICAgIHRlbGVmb25lOiAnKDg0KSA4ODg4OC04ODg4JyxcbiAgICAgICAgICAgICAgICBlbmRlcmVjbzoge1xuICAgICAgICAgICAgICAgICAgbG9ncmFkb3VybzogJ1J1YSBQcmluY2lwYWwnLFxuICAgICAgICAgICAgICAgICAgbnVtZXJvOiAnNDU2JyxcbiAgICAgICAgICAgICAgICAgIGJhaXJybzogJ0NpZGFkZSBOb3ZhJyxcbiAgICAgICAgICAgICAgICAgIGNpZGFkZTogJ05hdGFsJyxcbiAgICAgICAgICAgICAgICAgIGVzdGFkbzogJ1JOJyxcbiAgICAgICAgICAgICAgICAgIGNlcDogJzU5MTAwLTAwMCcsXG4gICAgICAgICAgICAgICAgICB0ZW1wb19kZV9yZXNpZGVuY2lhOiA1XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICBAQXBpT2tSZXNwb25zZSh7XG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBjcmlhZG8gY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IENpZGFkYW9SZXNwb25zZUR0byxcbiAgfSlcbiAgQEFwaUJhZFJlcXVlc3RSZXNwb25zZSh7XG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zIGZvcm5lY2lkb3MnLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gICAgc2NoZW1hOiB7XG4gICAgICBleGFtcGxlOiB7XG4gICAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgICAgbWVzc2FnZTogJ0NQRiBpbnbDoWxpZG8nLFxuICAgICAgICBlcnJvcjogJ0JhZCBSZXF1ZXN0JyxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbiAgQEFwaUNvbmZsaWN0UmVzcG9uc2Uoe1xuICAgIGRlc2NyaXB0aW9uOiAnQ29uZmxpdG8gLSBDUEYgb3UgTklTIGrDoSBjYWRhc3RyYWRvJyxcbiAgICB0eXBlOiBBcGlFcnJvclJlc3BvbnNlLFxuICAgIHNjaGVtYToge1xuICAgICAgZXhhbXBsZToge1xuICAgICAgICBzdGF0dXNDb2RlOiA0MDksXG4gICAgICAgIG1lc3NhZ2U6ICdKw6EgZXhpc3RlIHVtIGNpZGFkw6NvIGNhZGFzdHJhZG8gY29tIGVzdGUgQ1BGJyxcbiAgICAgICAgZXJyb3I6ICdDb25mbGljdCcsXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDEsXG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBjcmlhZG8gY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IENpZGFkYW9SZXNwb25zZUR0byxcbiAgfSlcbiAgYXN5bmMgY3JlYXRlKFxuICAgIEBCb2R5KCkgY3JlYXRlQ2lkYWRhb0R0bzogQ3JlYXRlQ2lkYWRhb0R0byxcbiAgICBAUmVxdWVzdCgpIHJlcSxcbiAgKTogUHJvbWlzZTxDaWRhZGFvUmVzcG9uc2VEdG8+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuY2lkYWRhb1NlcnZpY2UuY3JlYXRlKFxuICAgICAgICBjcmVhdGVDaWRhZGFvRHRvLFxuICAgICAgICByZXE/LnVzZXI/LmlkLFxuICAgICAgICByZXE/LnVzZXI/LnVuaWRhZGVfaWQsXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICB0aGlzLmxvZ2dlci5sb2coYOKchSBDaWRhZMOjbyBjcmlhZG8gY29tIHN1Y2Vzc28gZW0gJHtkdXJhdGlvbn1tc2AsIHtcbiAgICAgICAgY2lkYWRhb0lkOiByZXN1bHQuaWQsXG4gICAgICAgIGR1cmF0aW9uXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYOKdjCBFcnJvIGFvIGNyaWFyIGNpZGFkw6NvIGFww7NzICR7ZHVyYXRpb259bXM6YCwge1xuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgZHVyYXRpb25cbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEF0dWFsaXphIHVtIGNpZGFkw6NvIGV4aXN0ZW50ZVxuICAgKi9cbiAgQFB1dCgnOmlkJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7XG4gICAgcGVybWlzc2lvbk5hbWU6ICdjaWRhZGFvLmVkaXRhcicsXG4gICAgc2NvcGVUeXBlOiBTY29wZVR5cGUuVU5JVCxcbiAgICBzY29wZUlkRXhwcmVzc2lvbjogJ2NpZGFkYW8udW5pZGFkZUlkJyxcbiAgfSlcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0F0dWFsaXphciBjaWRhZMOjbyBleGlzdGVudGUnLFxuICAgIGRlc2NyaXB0aW9uOiAnQXR1YWxpemEgb3MgZGFkb3MgZGUgdW0gY2lkYWTDo28gZXhpc3RlbnRlLicsXG4gIH0pXG4gIEBBcGlQYXJhbSh7XG4gICAgbmFtZTogJ2lkJyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICBkZXNjcmlwdGlvbjogJ0lEIGRvIGNpZGFkw6NvIGEgc2VyIGF0dWFsaXphZG8nLFxuICAgIGV4YW1wbGU6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gYXR1YWxpemFkbyBjb20gc3VjZXNzbycsXG4gICAgdHlwZTogQ2lkYWRhb1Jlc3BvbnNlRHRvLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAwLFxuICAgIGRlc2NyaXB0aW9uOiAnRGFkb3MgaW52w6FsaWRvcycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwMSxcbiAgICBkZXNjcmlwdGlvbjogJ07Do28gYXV0b3JpemFkbycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwMyxcbiAgICBkZXNjcmlwdGlvbjogJ0FjZXNzbyBuZWdhZG8nLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDQsXG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBuw6NvIGVuY29udHJhZG8nLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDksXG4gICAgZGVzY3JpcHRpb246ICdDUEYgb3UgTklTIGrDoSBlbSB1c28nLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gIH0pXG4gIGFzeW5jIHVwZGF0ZShcbiAgICBAUGFyYW0oJ2lkJywgbmV3IFBhcnNlVVVJRFBpcGUoeyB2ZXJzaW9uOiAnNCcgfSkpIGlkOiBzdHJpbmcsXG4gICAgQEJvZHkoKSB1cGRhdGVDaWRhZGFvRHRvOiBVcGRhdGVDaWRhZGFvRHRvLFxuICAgIEBSZXF1ZXN0KCkgcmVxLFxuICApOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIEluaWNpYSBtZWRpw6fDo28gZGUgdGVtcG8gcGFyYSBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVxdWVzdElkID0gYFVQREFURS0ke2lkLnN1YnN0cmluZygwLCA4KX0tJHtEYXRlLm5vdygpfWA7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBbJHtyZXF1ZXN0SWR9XSBJbsOtY2lvIGRlIHByb2Nlc3NhbWVudG8gZGUgYXR1YWxpemHDp8OjbyBkZSBjaWRhZMOjb2ApO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBSZXN0YXVyYW5kbyBvIGPDs2RpZ28gb3JpZ2luYWwgY29tIG1vbml0b3JhbWVudG8gZGUgcGVyZm9ybWFuY2VcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuY2lkYWRhb1NlcnZpY2UudXBkYXRlKGlkLCB1cGRhdGVDaWRhZGFvRHRvLCByZXEudXNlci5pZCk7XG4gICAgICBcbiAgICAgIC8vIFJlZ2lzdHJhIHRlbXBvIHRvdGFsIGRhIG9wZXJhw6fDo28gcGFyYSBtb25pdG9yYW1lbnRvXG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgaWYgKHRvdGFsVGltZSA+IDUwMCkge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKGBbJHtyZXF1ZXN0SWR9XSBPcGVyYcOnw6NvIGxlbnRhICh1cGRhdGUpOiAke3RvdGFsVGltZX1tc2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sb2dnZXIubG9nKGBbJHtyZXF1ZXN0SWR9XSBPcGVyYcOnw6NvIGNvbmNsdcOtZGEgZW0gJHt0b3RhbFRpbWV9bXNgKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gUmVnaXN0cmEgZXJybyBwYXJhIGRpYWduw7NzdGljb1xuICAgICAgY29uc3QgdG90YWxUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGBbJHtyZXF1ZXN0SWR9XSBFcnJvIGVtICR7dG90YWxUaW1lfW1zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQnVzY2EgdW0gY2lkYWTDo28gcGVsbyBDUEZcbiAgICogQHBhcmFtIGNwZiBDUEYgZG8gY2lkYWTDo29cbiAgICogQHJldHVybnMgRGFkb3MgZG8gY2lkYWTDo28gZW5jb250cmFkb1xuICAgKi9cbiAgQEdldCgnY3BmLzpjcGYnKVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHsgcGVybWlzc2lvbk5hbWU6ICdjaWRhZGFvLmJ1c2Nhci5jcGYnIH0pXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdCdXNjYXIgY2lkYWTDo28gcG9yIENQRicsXG4gICAgZGVzY3JpcHRpb246ICdCdXNjYSB1bSBjaWRhZMOjbyBwZWxvIENQRiwgY29tIG91IHNlbSBmb3JtYXRhw6fDo28nLFxuICB9KVxuICBAQXBpUGFyYW0oe1xuICAgIG5hbWU6ICdjcGYnLFxuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZXNjcmlwdGlvbjogJ0NQRiBkbyBjaWRhZMOjbyAoY29tIG91IHNlbSBmb3JtYXRhw6fDo28pJyxcbiAgICBleGFtcGxlOiAnMTIzLjQ1Ni43ODktMDAnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gZW5jb250cmFkbycsXG4gICAgdHlwZTogQ2lkYWRhb1Jlc3BvbnNlRHRvLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQ1BGIGludsOhbGlkbycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBkZXNjcmlwdGlvbjogJ0NpZGFkw6NvIG7Do28gZW5jb250cmFkbycsXG4gICAgdHlwZTogQXBpRXJyb3JSZXNwb25zZSxcbiAgfSlcbiAgYXN5bmMgZmluZEJ5Q3BmKEBQYXJhbSgnY3BmJykgY3BmOiBzdHJpbmcpOiBQcm9taXNlPENpZGFkYW9SZXNwb25zZUR0bz4ge1xuICAgIC8vIEluaWNpYSBtZWRpw6fDo28gZGUgdGVtcG8gcGFyYSBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVxdWVzdElkID0gYENQRi0ke2NwZi5zdWJzdHJpbmcoTWF0aC5tYXgoMCwgY3BmLmxlbmd0aCAtIDQpKX0tJHtEYXRlLm5vdygpfWA7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBbJHtyZXF1ZXN0SWR9XSBJbsOtY2lvIGRlIHByb2Nlc3NhbWVudG8gZGEgcmVxdWlzacOnw6NvIENQRmApO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBDaGFtYSBvIHNlcnZpw6dvIG90aW1pemFkbyBwYXJhIGJ1c2NhciBwb3IgQ1BGXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNpZGFkYW9TZXJ2aWNlLmZpbmRCeUNwZihjcGYsIHRydWUpO1xuICAgICAgXG4gICAgICAvLyBSZWdpc3RyYSB0ZW1wbyB0b3RhbCBkYSBvcGVyYcOnw6NvIHBhcmEgbW9uaXRvcmFtZW50b1xuICAgICAgY29uc3QgdG90YWxUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGlmICh0b3RhbFRpbWUgPiA1MDApIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihgWyR7cmVxdWVzdElkfV0gT3BlcmHDp8OjbyBsZW50YTogJHt0b3RhbFRpbWV9bXNgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhgWyR7cmVxdWVzdElkfV0gT3BlcmHDp8OjbyBjb25jbHXDrWRhIGVtICR7dG90YWxUaW1lfW1zYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIFJlZ2lzdHJhIGVycm8gcGFyYSBkaWFnbsOzc3RpY29cbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgWyR7cmVxdWVzdElkfV0gRXJybyBlbSAke3RvdGFsVGltZX1tczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJ1c2NhIGNpZGFkw6NvIHBvciBOSVNcbiAgICovXG4gIEBHZXQoJ25pcy86bmlzJylcbiAgQFJlcXVpcmVzUGVybWlzc2lvbih7IHBlcm1pc3Npb25OYW1lOiAnY2lkYWRhby5idXNjYXIubmlzJyB9KVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnQnVzY2FyIGNpZGFkw6NvIHBvciBOSVMnLFxuICAgIGRlc2NyaXB0aW9uOiAnQnVzY2EgdW0gY2lkYWTDo28gcGVsbyBuw7ptZXJvIGRvIE5JUyAoUElTL1BBU0VQKS4nLFxuICB9KVxuICBAQXBpUGFyYW0oe1xuICAgIG5hbWU6ICduaXMnLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGRlc2NyaXB0aW9uOiAnTsO6bWVybyBkbyBOSVMgKFBJUy9QQVNFUCknLFxuICAgIGV4YW1wbGU6ICcxMjM0NTY3ODkwMScsXG4gIH0pXG4gIEBBcGlPa1Jlc3BvbnNlKHtcbiAgICBkZXNjcmlwdGlvbjogJ0NpZGFkw6NvIGVuY29udHJhZG8gY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IENpZGFkYW9SZXNwb25zZUR0byxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwMCxcbiAgICBkZXNjcmlwdGlvbjogJ05JUyBpbnbDoWxpZG8nLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDQsXG4gICAgZGVzY3JpcHRpb246ICdDaWRhZMOjbyBuw6NvIGVuY29udHJhZG8nLFxuICAgIHR5cGU6IEFwaUVycm9yUmVzcG9uc2UsXG4gIH0pXG4gIGFzeW5jIGZpbmRCeU5pcyhAUGFyYW0oJ25pcycpIG5pczogc3RyaW5nKTogUHJvbWlzZTxDaWRhZGFvUmVzcG9uc2VEdG8+IHtcbiAgICAvLyBJbmljaWEgbWVkacOnw6NvIGRlIHRlbXBvIHBhcmEgcGVyZm9ybWFuY2VcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHJlcXVlc3RJZCA9IGBOSVMtJHtuaXMuc3Vic3RyaW5nKE1hdGgubWF4KDAsIG5pcy5sZW5ndGggLSA0KSl9LSR7RGF0ZS5ub3coKX1gO1xuICAgIHRoaXMubG9nZ2VyLmxvZyhgWyR7cmVxdWVzdElkfV0gSW7DrWNpbyBkZSBwcm9jZXNzYW1lbnRvIGRhIHJlcXVpc2nDp8OjbyBOSVNgKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gQ2hhbWEgbyBzZXJ2acOnbyBvdGltaXphZG8gcGFyYSBidXNjYXIgcG9yIE5JU1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaWRhZGFvU2VydmljZS5maW5kQnlOaXMobmlzLCB0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gUmVnaXN0cmEgdGVtcG8gdG90YWwgZGEgb3BlcmHDp8OjbyBwYXJhIG1vbml0b3JhbWVudG9cbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBpZiAodG90YWxUaW1lID4gNTAwKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oYFske3JlcXVlc3RJZH1dIE9wZXJhw6fDo28gbGVudGE6ICR7dG90YWxUaW1lfW1zYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2coYFske3JlcXVlc3RJZH1dIE9wZXJhw6fDo28gY29uY2x1w61kYSBlbSAke3RvdGFsVGltZX1tc2ApO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBSZWdpc3RyYSBlcnJvIHBhcmEgZGlhZ27Ds3N0aWNvXG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYFske3JlcXVlc3RJZH1dIEVycm8gZW0gJHt0b3RhbFRpbWV9bXM6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gaGlzdMOzcmljbyBkZSBzb2xpY2l0YcOnw7VlcyBkZSB1bSBjaWRhZMOjb1xuICAgKi9cbiAgQEdldCgnOmlkL3NvbGljaXRhY2FvJylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdIaXN0w7NyaWNvIGRlIHNvbGljaXRhw6fDtWVzJyB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDIwMCwgZGVzY3JpcHRpb246ICdIaXN0w7NyaWNvIHJldG9ybmFkbyBjb20gc3VjZXNzbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDQsIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gbsOjbyBlbmNvbnRyYWRvJyB9KVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKFxuICAgIHtcbiAgICAgIHBlcm1pc3Npb25OYW1lOiAnY2lkYWRhby52aXN1YWxpemFyJyxcbiAgICAgIHNjb3BlVHlwZTogU2NvcGVUeXBlLlVOSVQsXG4gICAgICBzY29wZUlkRXhwcmVzc2lvbjogJ2NpZGFkYW8udW5pZGFkZUlkJyxcbiAgICB9LFxuICAgIHsgcGVybWlzc2lvbk5hbWU6ICdzb2xpY2l0YWNhby5saXN0YXInIH1cbiAgKVxuICBhc3luYyBmaW5kU29saWNpdGFjb2VzKEBQYXJhbSgnaWQnKSBpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuY2lkYWRhb1NlcnZpY2UuZmluZFNvbGljaXRhY29lc0J5Q2lkYWRhb0lkKGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGljaW9uYSBtZW1icm8gw6AgY29tcG9zacOnw6NvIGZhbWlsaWFyXG4gICAqL1xuICBAUG9zdCgnOmlkL2NvbXBvc2ljYW8nKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ0FkaWNpb25hciBtZW1icm8gw6AgY29tcG9zacOnw6NvIGZhbWlsaWFyJyB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDIwMSwgZGVzY3JpcHRpb246ICdNZW1icm8gYWRpY2lvbmFkbyBjb20gc3VjZXNzbycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDAsIGRlc2NyaXB0aW9uOiAnRGFkb3MgaW52w6FsaWRvcycgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDQsIGRlc2NyaXB0aW9uOiAnQ2lkYWTDo28gbsOjbyBlbmNvbnRyYWRvJyB9KVxuICBAUmVxdWlyZXNQZXJtaXNzaW9uKHtcbiAgICBwZXJtaXNzaW9uTmFtZTogJ2NpZGFkYW8uZWRpdGFyJyxcbiAgICBzY29wZVR5cGU6IFNjb3BlVHlwZS5VTklULFxuICAgIHNjb3BlSWRFeHByZXNzaW9uOiAnY2lkYWRhby51bmlkYWRlSWQnLFxuICB9KVxuICBhc3luYyBhZGRDb21wb3NpY2FvRmFtaWxpYXIoXG4gICAgQFBhcmFtKCdpZCcpIGlkOiBzdHJpbmcsXG4gICAgQEJvZHkoKSBjcmVhdGVDb21wb3NpY2FvRmFtaWxpYXJEdG86IENyZWF0ZUNvbXBvc2ljYW9GYW1pbGlhckR0byxcbiAgICBAUmVxdWVzdCgpIHJlcSxcbiAgKSB7XG4gICAgLy8gSW5pY2lhIG1lZGnDp8OjbyBkZSB0ZW1wbyBwYXJhIHBlcmZvcm1hbmNlXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCByZXF1ZXN0SWQgPSBgQ09NUC0ke2lkLnN1YnN0cmluZygwLCA4KX0tJHtEYXRlLm5vdygpfWA7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBbJHtyZXF1ZXN0SWR9XSBJbsOtY2lvIGRlIHByb2Nlc3NhbWVudG8gZGUgYWRpw6fDo28gbmEgY29tcG9zacOnw6NvIGZhbWlsaWFyYCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlc3RhdXJhbmRvIG8gY8OzZGlnbyBvcmlnaW5hbCBjb20gbW9uaXRvcmFtZW50byBkZSBwZXJmb3JtYW5jZVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaWRhZGFvU2VydmljZS5hZGRDb21wb3NpY2FvRmFtaWxpYXIoXG4gICAgICAgIGlkLFxuICAgICAgICBjcmVhdGVDb21wb3NpY2FvRmFtaWxpYXJEdG8sXG4gICAgICAgIHJlcT8udXNlcj8uaWQsXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBSZWdpc3RyYSB0ZW1wbyB0b3RhbCBkYSBvcGVyYcOnw6NvIHBhcmEgbW9uaXRvcmFtZW50b1xuICAgICAgY29uc3QgdG90YWxUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGlmICh0b3RhbFRpbWUgPiA1MDApIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihgWyR7cmVxdWVzdElkfV0gT3BlcmHDp8OjbyBsZW50YSAoYWRkQ29tcG9zaWNhb0ZhbWlsaWFyKTogJHt0b3RhbFRpbWV9bXNgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhgWyR7cmVxdWVzdElkfV0gT3BlcmHDp8OjbyBjb25jbHXDrWRhIGVtICR7dG90YWxUaW1lfW1zYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIFJlZ2lzdHJhIGVycm8gcGFyYSBkaWFnbsOzc3RpY29cbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgWyR7cmVxdWVzdElkfV0gRXJybyBlbSAke3RvdGFsVGltZX1tczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=