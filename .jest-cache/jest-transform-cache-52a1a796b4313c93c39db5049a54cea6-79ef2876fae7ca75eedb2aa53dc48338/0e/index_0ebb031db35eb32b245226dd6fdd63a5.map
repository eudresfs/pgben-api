{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\request-context\\util\\index.ts","mappings":";;AAoBA,oDAYC;AAnBD,+CAGyB;AACzB,gEAAwD;AAExD,+CAA+C;AAC/C,SAAgB,oBAAoB,CAAC,OAAgB;IACnD,MAAM,GAAG,GAAG,IAAI,oCAAc,EAAE,CAAC;IACjC,GAAG,CAAC,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,mCAAuB,CAAC,CAAC;IACxD,GAAG,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;IACtB,GAAG,CAAC,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC,sCAA0B,CAAC;QACjD,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,sCAA0B,CAAC;QAC5C,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;IAEf,gEAAgE;IAChE,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,CAAE,OAAO,CAAC,IAA8B,CAAC,CAAC,CAAC,IAAI,CAAC;IAEzE,OAAO,GAAG,CAAC;AACb,CAAC","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\request-context\\util\\index.ts"],"sourcesContent":["import { plainToClass } from 'class-transformer';\nimport { Request } from 'express';\n\nimport { UserAccessTokenClaims } from '../../../auth/dtos/auth-token-output.dto';\n\n// Extend Express Request interface to include user property\ndeclare global {\n  namespace Express {\n    interface Request {\n      user?: UserAccessTokenClaims;\n    }\n  }\n}\nimport {\n  FORWARDED_FOR_TOKEN_HEADER,\n  REQUEST_ID_TOKEN_HEADER,\n} from '../../constants';\nimport { RequestContext } from '../request-context.dto';\n\n// Creates a RequestContext object from Request\nexport function createRequestContext(request: Request): RequestContext {\n  const ctx = new RequestContext();\n  ctx.requestID = request.header(REQUEST_ID_TOKEN_HEADER);\n  ctx.url = request.url;\n  ctx.ip = request.header(FORWARDED_FOR_TOKEN_HEADER)\n    ? request.header(FORWARDED_FOR_TOKEN_HEADER)\n    : request.ip;\n\n  // If request.user does not exist, we explicitly set it to null.\n  ctx.user = request.user ? (request.user as UserAccessTokenClaims) : null;\n\n  return ctx;\n}\n"],"version":3}