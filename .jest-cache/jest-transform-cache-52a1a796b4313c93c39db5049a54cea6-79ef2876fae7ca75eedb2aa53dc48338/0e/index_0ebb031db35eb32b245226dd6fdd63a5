99ede31bcf9c7b5f813ff5d0e6a6d680
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createRequestContext = createRequestContext;
const constants_1 = require("../../constants");
const request_context_dto_1 = require("../request-context.dto");
// Creates a RequestContext object from Request
function createRequestContext(request) {
    const ctx = new request_context_dto_1.RequestContext();
    ctx.requestID = request.header(constants_1.REQUEST_ID_TOKEN_HEADER);
    ctx.url = request.url;
    ctx.ip = request.header(constants_1.FORWARDED_FOR_TOKEN_HEADER)
        ? request.header(constants_1.FORWARDED_FOR_TOKEN_HEADER)
        : request.ip;
    // If request.user does not exist, we explicitly set it to null.
    ctx.user = request.user ? request.user : null;
    return ctx;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxccmVxdWVzdC1jb250ZXh0XFx1dGlsXFxpbmRleC50cyIsIm1hcHBpbmdzIjoiOztBQW9CQSxvREFZQztBQW5CRCwrQ0FHeUI7QUFDekIsZ0VBQXdEO0FBRXhELCtDQUErQztBQUMvQyxTQUFnQixvQkFBb0IsQ0FBQyxPQUFnQjtJQUNuRCxNQUFNLEdBQUcsR0FBRyxJQUFJLG9DQUFjLEVBQUUsQ0FBQztJQUNqQyxHQUFHLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsbUNBQXVCLENBQUMsQ0FBQztJQUN4RCxHQUFHLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7SUFDdEIsR0FBRyxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLHNDQUEwQixDQUFDO1FBQ2pELENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLHNDQUEwQixDQUFDO1FBQzVDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO0lBRWYsZ0VBQWdFO0lBQ2hFLEdBQUcsQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUUsT0FBTyxDQUFDLElBQThCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUV6RSxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXHNoYXJlZFxccmVxdWVzdC1jb250ZXh0XFx1dGlsXFxpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwbGFpblRvQ2xhc3MgfSBmcm9tICdjbGFzcy10cmFuc2Zvcm1lcic7XG5pbXBvcnQgeyBSZXF1ZXN0IH0gZnJvbSAnZXhwcmVzcyc7XG5cbmltcG9ydCB7IFVzZXJBY2Nlc3NUb2tlbkNsYWltcyB9IGZyb20gJy4uLy4uLy4uL2F1dGgvZHRvcy9hdXRoLXRva2VuLW91dHB1dC5kdG8nO1xuXG4vLyBFeHRlbmQgRXhwcmVzcyBSZXF1ZXN0IGludGVyZmFjZSB0byBpbmNsdWRlIHVzZXIgcHJvcGVydHlcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgbmFtZXNwYWNlIEV4cHJlc3Mge1xuICAgIGludGVyZmFjZSBSZXF1ZXN0IHtcbiAgICAgIHVzZXI/OiBVc2VyQWNjZXNzVG9rZW5DbGFpbXM7XG4gICAgfVxuICB9XG59XG5pbXBvcnQge1xuICBGT1JXQVJERURfRk9SX1RPS0VOX0hFQURFUixcbiAgUkVRVUVTVF9JRF9UT0tFTl9IRUFERVIsXG59IGZyb20gJy4uLy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBSZXF1ZXN0Q29udGV4dCB9IGZyb20gJy4uL3JlcXVlc3QtY29udGV4dC5kdG8nO1xuXG4vLyBDcmVhdGVzIGEgUmVxdWVzdENvbnRleHQgb2JqZWN0IGZyb20gUmVxdWVzdFxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlcXVlc3RDb250ZXh0KHJlcXVlc3Q6IFJlcXVlc3QpOiBSZXF1ZXN0Q29udGV4dCB7XG4gIGNvbnN0IGN0eCA9IG5ldyBSZXF1ZXN0Q29udGV4dCgpO1xuICBjdHgucmVxdWVzdElEID0gcmVxdWVzdC5oZWFkZXIoUkVRVUVTVF9JRF9UT0tFTl9IRUFERVIpO1xuICBjdHgudXJsID0gcmVxdWVzdC51cmw7XG4gIGN0eC5pcCA9IHJlcXVlc3QuaGVhZGVyKEZPUldBUkRFRF9GT1JfVE9LRU5fSEVBREVSKVxuICAgID8gcmVxdWVzdC5oZWFkZXIoRk9SV0FSREVEX0ZPUl9UT0tFTl9IRUFERVIpXG4gICAgOiByZXF1ZXN0LmlwO1xuXG4gIC8vIElmIHJlcXVlc3QudXNlciBkb2VzIG5vdCBleGlzdCwgd2UgZXhwbGljaXRseSBzZXQgaXQgdG8gbnVsbC5cbiAgY3R4LnVzZXIgPSByZXF1ZXN0LnVzZXIgPyAocmVxdWVzdC51c2VyIGFzIFVzZXJBY2Nlc3NUb2tlbkNsYWltcykgOiBudWxsO1xuXG4gIHJldHVybiBjdHg7XG59XG4iXSwidmVyc2lvbiI6M30=