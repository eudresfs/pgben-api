{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\auditoria\\auditoria-shared.module.ts","mappings":";;;;;;;;;AAAA,2CAAgD;AAChD,6CAAgD;AAChD,uCAA0C;AAC1C,2CAA6D;AAC7D,qCAAwC;AAExC,8EAAmE;AACnE,sGAAiG;AACjG,4GAAuG;AACvG,8GAAyG;AAEzG;;;;;;;GAOG;AA2CI,IAAM,qBAAqB,GAA3B,MAAM,qBAAqB;CAAG,CAAA;AAAxB,sDAAqB;gCAArB,qBAAqB;IA1CjC,IAAA,eAAM,GAAE;IACR,IAAA,eAAM,EAAC;QACN,OAAO,EAAE;YACP,mDAAmD;YACnD,uBAAa,CAAC,UAAU,CAAC,CAAC,mCAAY,CAAC,CAAC;YAExC,wCAAwC;YACxC,iBAAU,CAAC,kBAAkB,CAAC;gBAC5B,IAAI,EAAE,WAAW;gBACjB,OAAO,EAAE,CAAC,qBAAY,CAAC;gBACvB,UAAU,EAAE,CAAC,aAA4B,EAAE,EAAE,CAAC,CAAC;oBAC7C,KAAK,EAAE;wBACL,IAAI,EAAE,aAAa,CAAC,GAAG,CAAS,YAAY,EAAE,WAAW,CAAC;wBAC1D,IAAI,EAAE,aAAa,CAAC,GAAG,CAAS,YAAY,EAAE,IAAI,CAAC;qBACpD;iBACF,CAAC;gBACF,MAAM,EAAE,CAAC,sBAAa,CAAC;aACxB,CAAC;YAEF,uCAAuC;YACvC,eAAS,CAAC,aAAa,CAAC;gBACtB,OAAO,EAAE,CAAC,qBAAY,CAAC;gBACvB,UAAU,EAAE,CAAC,aAA4B,EAAE,EAAE,CAAC,CAAC;oBAC7C,MAAM,EAAE,aAAa,CAAC,GAAG,CAAS,YAAY,CAAC;oBAC/C,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE;iBACjC,CAAC;gBACF,MAAM,EAAE,CAAC,sBAAa,CAAC;aACxB,CAAC;SACH;QACD,SAAS,EAAE;YACT,sBAAsB;YACtB,+CAAqB;YACrB,iDAAsB;YACtB,uDAAyB;SAC1B;QACD,OAAO,EAAE;YACP,4DAA4D;YAC5D,+CAAqB;YACrB,iDAAsB;YACtB,uDAAyB;SAC1B;KACF,CAAC;GACW,qBAAqB,CAAG","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\shared\\auditoria\\auditoria-shared.module.ts"],"sourcesContent":["import { Module, Global } from '@nestjs/common';\nimport { TypeOrmModule } from '@nestjs/typeorm';\nimport { BullModule } from '@nestjs/bull';\nimport { ConfigModule, ConfigService } from '@nestjs/config';\nimport { JwtModule } from '@nestjs/jwt';\n\nimport { LogAuditoria } from '../../entities/log-auditoria.entity';\nimport { AuditoriaQueueService } from '../../modules/auditoria/services/auditoria-queue.service';\nimport { LogAuditoriaRepository } from '../../modules/auditoria/repositories/log-auditoria.repository';\nimport { AuditoriaSignatureService } from '../../modules/auditoria/services/auditoria-signature.service';\n\n/**\n * Módulo compartilhado de Auditoria\n *\n * Este módulo exporta os serviços essenciais de auditoria que podem\n * ser usados por outros módulos sem criar dependências circulares.\n *\n * É usado para quebrar a dependência circular entre os módulos.\n */\n@Global()\n@Module({\n  imports: [\n    // Configuração do TypeORM para entidades do módulo\n    TypeOrmModule.forFeature([LogAuditoria]),\n\n    // Configuração assíncrona do BullModule\n    BullModule.registerQueueAsync({\n      name: 'auditoria',\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        redis: {\n          host: configService.get<string>('REDIS_HOST', 'localhost'),\n          port: configService.get<number>('REDIS_PORT', 6379),\n        },\n      }),\n      inject: [ConfigService],\n    }),\n\n    // Configuração assíncrona do JwtModule\n    JwtModule.registerAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        secret: configService.get<string>('JWT_SECRET'),\n        signOptions: { expiresIn: '1d' },\n      }),\n      inject: [ConfigService],\n    }),\n  ],\n  providers: [\n    // Serviços essenciais\n    AuditoriaQueueService,\n    LogAuditoriaRepository,\n    AuditoriaSignatureService,\n  ],\n  exports: [\n    // Exporta os serviços principais para uso em outros módulos\n    AuditoriaQueueService,\n    LogAuditoriaRepository,\n    AuditoriaSignatureService,\n  ],\n})\nexport class AuditoriaSharedModule {}\n"],"version":3}