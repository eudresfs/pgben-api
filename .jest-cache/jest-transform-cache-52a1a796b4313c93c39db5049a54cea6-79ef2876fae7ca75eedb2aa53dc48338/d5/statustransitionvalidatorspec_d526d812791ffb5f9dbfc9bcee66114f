25e2494f2c0bd78c982fc97248f479a5
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const status_transition_validator_1 = require("../../../validators/status-transition-validator");
const status_pagamento_enum_1 = require("../../../enums/status-pagamento.enum");
describe('StatusTransitionValidator', () => {
    let validator;
    beforeEach(() => {
        validator = new status_transition_validator_1.StatusTransitionValidator();
    });
    describe('canTransition', () => {
        it('deve permitir transição de AGENDADO para LIBERADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de LIBERADO para CONFIRMADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de AGENDADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve permitir transição de LIBERADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeTruthy();
            expect(result.message).toBe('Transição permitida');
        });
        it('deve rejeitar transição de CONFIRMADO para LIBERADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('não permitida');
        });
        it('deve rejeitar transição de CANCELADO para qualquer outro status', () => {
            const resultParaLiberado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            const resultParaConfirmado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            const resultParaAgendado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(resultParaLiberado.allowed).toBeFalsy();
            expect(resultParaConfirmado.allowed).toBeFalsy();
            expect(resultParaAgendado.allowed).toBeFalsy();
        });
        it('deve rejeitar transição para o mesmo status', () => {
            const resultAgendado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            const resultLiberado = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(resultAgendado.allowed).toBeFalsy();
            expect(resultLiberado.allowed).toBeFalsy();
            expect(resultAgendado.message).toContain('mesmo status');
            expect(resultLiberado.message).toContain('mesmo status');
        });
        it('deve rejeitar transição para status inválido', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, 'STATUS_INEXISTENTE');
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('inválido');
        });
        it('deve rejeitar transição de CONFIRMADO para CANCELADO', () => {
            const result = validator.canTransition(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(result.allowed).toBeFalsy();
            expect(result.message).toContain('não permitida');
        });
    });
    describe('getValidTransitions', () => {
        it('deve retornar as transições válidas para AGENDADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(2);
        });
        it('deve retornar as transições válidas para LIBERADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(transitions).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(2);
        });
        it('deve retornar lista vazia para CONFIRMADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(transitions.length).toBe(0);
        });
        it('deve retornar lista vazia para CANCELADO', () => {
            const transitions = validator.getValidTransitions(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(transitions.length).toBe(0);
        });
        it('deve retornar lista vazia para status inválido', () => {
            const transitions = validator.getValidTransitions('STATUS_INEXISTENTE');
            expect(transitions.length).toBe(0);
        });
    });
    describe('getTransitionMatrix', () => {
        it('deve retornar a matriz de transição completa', () => {
            const matrix = validator.getTransitionMatrix();
            // Verifica se a matriz tem a estrutura esperada
            expect(matrix).toBeDefined();
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(Object.keys(matrix)).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            // Verifica transições específicas
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO]).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO]).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO].length).toBe(0);
            expect(matrix[status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO].length).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXHVuaXRcXHZhbGlkYXRvcnNcXHN0YXR1cy10cmFuc2l0aW9uLXZhbGlkYXRvci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsaUdBQTRGO0FBQzVGLGdGQUEyRTtBQUUzRSxRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLElBQUksU0FBb0MsQ0FBQztJQUV6QyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsU0FBUyxHQUFHLElBQUksdURBQXlCLEVBQUUsQ0FBQztJQUM5QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxHQUFHLEVBQUU7WUFDM0QsTUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLGFBQWEsQ0FDcEMsMkNBQW1CLENBQUMsUUFBUSxFQUM1QiwyQ0FBbUIsQ0FBQyxRQUFRLENBQzdCLENBQUM7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1lBQzdELE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQ3BDLDJDQUFtQixDQUFDLFFBQVEsRUFDNUIsMkNBQW1CLENBQUMsVUFBVSxDQUMvQixDQUFDO1lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNwQyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIs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VSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxNQUFNLENBQUMsMkNBQW1CLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xccGFnYW1lbnRvXFx0ZXN0c1xcdW5pdFxcdmFsaWRhdG9yc1xcc3RhdHVzLXRyYW5zaXRpb24tdmFsaWRhdG9yLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3RhdHVzVHJhbnNpdGlvblZhbGlkYXRvciB9IGZyb20gJy4uLy4uLy4uL3ZhbGlkYXRvcnMvc3RhdHVzLXRyYW5zaXRpb24tdmFsaWRhdG9yJztcbmltcG9ydCB7IFN0YXR1c1BhZ2FtZW50b0VudW0gfSBmcm9tICcuLi8uLi8uLi9lbnVtcy9zdGF0dXMtcGFnYW1lbnRvLmVudW0nO1xuXG5kZXNjcmliZSgnU3RhdHVzVHJhbnNpdGlvblZhbGlkYXRvcicsICgpID0+IHtcbiAgbGV0IHZhbGlkYXRvcjogU3RhdHVzVHJhbnNpdGlvblZhbGlkYXRvcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB2YWxpZGF0b3IgPSBuZXcgU3RhdHVzVHJhbnNpdGlvblZhbGlkYXRvcigpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2FuVHJhbnNpdGlvbicsICgpID0+IHtcbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBBR0VOREFETyBwYXJhIExJQkVSQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVHJhbnNpw6fDo28gcGVybWl0aWRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBMSUJFUkFETyBwYXJhIENPTkZJUk1BRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxvd2VkKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1RyYW5zacOnw6NvIHBlcm1pdGlkYScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcGVybWl0aXIgdHJhbnNpw6fDo28gZGUgQUdFTkRBRE8gcGFyYSBDQU5DRUxBRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVHJhbnNpw6fDo28gcGVybWl0aWRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBMSUJFUkFETyBwYXJhIENBTkNFTEFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZVRydXRoeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdUcmFuc2nDp8OjbyBwZXJtaXRpZGEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIHRyYW5zacOnw6NvIGRlIENPTkZJUk1BRE8gcGFyYSBMSUJFUkFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVGYWxzeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0NvbnRhaW4oJ27Do28gcGVybWl0aWRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciB0cmFuc2nDp8OjbyBkZSBDQU5DRUxBRE8gcGFyYSBxdWFscXVlciBvdXRybyBzdGF0dXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRQYXJhTGliZXJhZG8gPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXN1bHRQYXJhQ29uZmlybWFkbyA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzdWx0UGFyYUFnZW5kYWRvID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFBhcmFMaWJlcmFkby5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICAgIGV4cGVjdChyZXN1bHRQYXJhQ29uZmlybWFkby5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICAgIGV4cGVjdChyZXN1bHRQYXJhQWdlbmRhZG8uYWxsb3dlZCkudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciB0cmFuc2nDp8OjbyBwYXJhIG8gbWVzbW8gc3RhdHVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0QWdlbmRhZG8gPSB2YWxpZGF0b3IuY2FuVHJhbnNpdGlvbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdExpYmVyYWRvID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0QWdlbmRhZG8uYWxsb3dlZCkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QocmVzdWx0TGliZXJhZG8uYWxsb3dlZCkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QocmVzdWx0QWdlbmRhZG8ubWVzc2FnZSkudG9Db250YWluKCdtZXNtbyBzdGF0dXMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHRMaWJlcmFkby5tZXNzYWdlKS50b0NvbnRhaW4oJ21lc21vIHN0YXR1cycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgdHJhbnNpw6fDo28gcGFyYSBzdGF0dXMgaW52w6FsaWRvJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdG9yLmNhblRyYW5zaXRpb24oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sXG4gICAgICAgICdTVEFUVVNfSU5FWElTVEVOVEUnIGFzIFN0YXR1c1BhZ2FtZW50b0VudW0sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmVGYWxzeSgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0NvbnRhaW4oJ2ludsOhbGlkbycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgdHJhbnNpw6fDo28gZGUgQ09ORklSTUFETyBwYXJhIENBTkNFTEFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvci5jYW5UcmFuc2l0aW9uKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxvd2VkKS50b0JlRmFsc3koKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9Db250YWluKCduw6NvIHBlcm1pdGlkYScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0VmFsaWRUcmFuc2l0aW9ucycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBhcyB0cmFuc2nDp8O1ZXMgdsOhbGlkYXMgcGFyYSBBR0VOREFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPKTtcbiAgICAgIGV4cGVjdCh0cmFuc2l0aW9ucykudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPKTtcbiAgICAgIGV4cGVjdCh0cmFuc2l0aW9ucy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBhcyB0cmFuc2nDp8O1ZXMgdsOhbGlkYXMgcGFyYSBMSUJFUkFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8pO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGxpc3RhIHZhemlhIHBhcmEgQ09ORklSTUFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh0cmFuc2l0aW9ucy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBsaXN0YSB2YXppYSBwYXJhIENBTkNFTEFETycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHRyYW5zaXRpb25zLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGxpc3RhIHZhemlhIHBhcmEgc3RhdHVzIGludsOhbGlkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25zID0gdmFsaWRhdG9yLmdldFZhbGlkVHJhbnNpdGlvbnMoXG4gICAgICAgICdTVEFUVVNfSU5FWElTVEVOVEUnIGFzIFN0YXR1c1BhZ2FtZW50b0VudW0sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodHJhbnNpdGlvbnMubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0VHJhbnNpdGlvbk1hdHJpeCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBhIG1hdHJpeiBkZSB0cmFuc2nDp8OjbyBjb21wbGV0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1hdHJpeCA9IHZhbGlkYXRvci5nZXRUcmFuc2l0aW9uTWF0cml4KCk7XG5cbiAgICAgIC8vIFZlcmlmaWNhIHNlIGEgbWF0cml6IHRlbSBhIGVzdHJ1dHVyYSBlc3BlcmFkYVxuICAgICAgZXhwZWN0KG1hdHJpeCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChPYmplY3Qua2V5cyhtYXRyaXgpKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyk7XG4gICAgICBleHBlY3QoT2JqZWN0LmtleXMobWF0cml4KSkudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE8pO1xuICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKG1hdHJpeCkpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKG1hdHJpeCkpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyk7XG5cbiAgICAgIC8vIFZlcmlmaWNhIHRyYW5zacOnw7VlcyBlc3BlY8OtZmljYXNcbiAgICAgIGV4cGVjdChtYXRyaXhbU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFET10pLnRvQ29udGFpbihcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyxcbiAgICAgICk7XG4gICAgICBleHBlY3QobWF0cml4W1N0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9dKS50b0NvbnRhaW4oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETyxcbiAgICAgICk7XG4gICAgICBleHBlY3QobWF0cml4W1N0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFET10ubGVuZ3RoKS50b0JlKDApO1xuICAgICAgZXhwZWN0KG1hdHJpeFtTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFET10ubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9