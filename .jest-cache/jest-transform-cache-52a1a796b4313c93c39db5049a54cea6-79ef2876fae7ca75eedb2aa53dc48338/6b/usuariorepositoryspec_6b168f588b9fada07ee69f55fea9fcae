0c5b942ff4e147d2dd029a58e445c93f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("@nestjs/typeorm");
const typeorm_2 = require("typeorm");
const usuario_repository_1 = require("./usuario.repository");
const usuario_entity_1 = require("../../../entities/usuario.entity");
const usuario_errors_1 = require("../../../errors/usuario.errors");
/**
 * Testes unitários para o UsuarioRepository
 *
 * Cobertura de testes:
 * - Criação de usuários
 * - Busca por ID, email, CPF
 * - Listagem com filtros e paginação
 * - Atualização de dados
 * - Atualização de status
 * - Atualização de senha
 * - Soft delete
 * - Contagem de registros
 */
describe('UsuarioRepository', () => {
    let repository;
    let typeormRepository;
    const mockRole = {
        id: 'role-id',
        nome: 'ASSISTENTE_SOCIAL',
        descricao: 'Assistente Social',
        ativo: true,
        usuarios: [],
        created_at: new Date(),
        updated_at: new Date(),
    };
    const mockUnidade = {
        id: 'unidade-123',
        nome: 'Unidade Teste',
        endereco: 'Endereço Teste',
        telefone: '(84) 99999-9999',
        email: 'unidade@test.com',
        ativo: true,
        setores: [],
        usuarios: [],
        created_at: new Date(),
        updated_at: new Date(),
    };
    const mockSetor = {
        id: 'setor-123',
        nome: 'Setor Teste',
        descricao: 'Descrição do Setor',
        ativo: true,
        unidade: mockUnidade,
        unidadeId: 'unidade-123',
        usuarios: [],
        created_at: new Date(),
        updated_at: new Date(),
    };
    const mockUsuario = {
        id: '123e4567-e89b-12d3-a456-426614174000',
        nome: 'João da Silva',
        email: 'joao.silva@semtas.natal.gov.br',
        cpf: '123.456.789-00',
        telefone: '(84) 99999-9999',
        matricula: '12345',
        senhaHash: '$2b$12$hashedpassword',
        role: mockRole,
        role_id: 'role-id',
        status: 'ativo',
        primeiro_acesso: false,
        tentativas_login: 0,
        ultimo_login: new Date(),
        unidadeId: 'unidade-123',
        setorId: 'setor-123',
        created_at: new Date(),
        updated_at: new Date(),
        removed_at: null,
        unidade: mockUnidade,
        setor: mockSetor,
        refreshTokens: [],
        solicitacoes: [],
        auditoriasCreated: [],
        auditoriasUpdated: [],
    };
    beforeEach(async () => {
        const mockTypeormRepository = {
            create: jest.fn(),
            save: jest.fn(),
            findOne: jest.fn(),
            findAndCount: jest.fn(),
            update: jest.fn(),
            softDelete: jest.fn(),
            createQueryBuilder: jest.fn(),
            count: jest.fn(),
        };
        const mockDataSource = {
            getRepository: jest.fn().mockReturnValue(mockTypeormRepository),
        };
        const module = await testing_1.Test.createTestingModule({
            providers: [
                usuario_repository_1.UsuarioRepository,
                {
                    provide: (0, typeorm_1.getRepositoryToken)(usuario_entity_1.Usuario),
                    useValue: mockTypeormRepository,
                },
                {
                    provide: typeorm_2.DataSource,
                    useValue: mockDataSource,
                },
            ],
        }).compile();
        repository = module.get(usuario_repository_1.UsuarioRepository);
        typeormRepository = module.get((0, typeorm_1.getRepositoryToken)(usuario_entity_1.Usuario));
    });
    describe('create', () => {
        it('deve criar um novo usuário', async () => {
            const createDto = {
                nome: 'João da Silva',
                email: 'joao.silva@semtas.natal.gov.br',
                senha: 'Senha@123',
                cpf: '123.456.789-00',
                telefone: '(84) 99999-9999',
                matricula: '12345',
                role_id: 'role-id',
                unidade_id: 'unidade-123',
                setor_id: 'setor-123',
            };
            typeormRepository.create.mockReturnValue(mockUsuario);
            typeormRepository.save.mockResolvedValue(mockUsuario);
            const result = await repository.create(createDto);
            expect(typeormRepository.create).toHaveBeenCalledWith(createDto);
            expect(typeormRepository.save).toHaveBeenCalledWith(mockUsuario);
            expect(result).toEqual(mockUsuario);
        });
    });
    describe('findById', () => {
        it('deve retornar usuário por ID', async () => {
            typeormRepository.findOne.mockResolvedValue(mockUsuario);
            const result = await repository.findById('123e4567-e89b-12d3-a456-426614174000');
            expect(typeormRepository.findOne).toHaveBeenCalledWith({
                where: { id: '123e4567-e89b-12d3-a456-426614174000' },
                relations: ['unidade', 'setor'],
            });
            expect(result).toEqual(mockUsuario);
        });
        it('deve lançar UsuarioError quando usuário não encontrado', async () => {
            typeormRepository.findOne.mockResolvedValue(null);
            await expect(repository.findById('id-inexistente')).rejects.toThrow(usuario_errors_1.UsuarioError);
        });
    });
    describe('findByEmail', () => {
        it('deve retornar usuário por email', async () => {
            typeormRepository.findOne.mockResolvedValue(mockUsuario);
            const result = await repository.findByEmail('joao.silva@semtas.natal.gov.br');
            expect(typeormRepository.findOne).toHaveBeenCalledWith({
                where: { email: 'joao.silva@semtas.natal.gov.br' },
            });
            expect(result).toEqual(mockUsuario);
        });
        it('deve retornar null quando email não encontrado', async () => {
            typeormRepository.findOne.mockResolvedValue(null);
            const result = await repository.findByEmail('email@inexistente.com');
            expect(result).toBeNull();
        });
    });
    describe('findByCpf', () => {
        it('deve retornar usuário por CPF', async () => {
            typeormRepository.findOne.mockResolvedValue(mockUsuario);
            const result = await repository.findByCpf('123.456.789-00');
            expect(typeormRepository.findOne).toHaveBeenCalledWith({
                where: { cpf: '123.456.789-00' },
            });
            expect(result).toEqual(mockUsuario);
        });
    });
    describe('findAll', () => {
        it('deve retornar lista paginada de usuários', async () => {
            typeormRepository.findAndCount.mockResolvedValue([[mockUsuario], 1]);
            const options = {
                skip: 0,
                take: 10,
                where: {
                    nome: 'João',
                    role_id: 'role-id',
                    status: 'ativo',
                    unidadeId: 'unidade-123',
                },
            };
            const result = await repository.findAll(options);
            expect(result).toEqual([[mockUsuario], 1]);
            expect(typeormRepository.findAndCount).toHaveBeenCalledWith({
                skip: 0,
                take: 10,
                where: {
                    nome: 'João',
                    role_id: 'role-id',
                    status: 'ativo',
                    unidadeId: 'unidade-123',
                },
                order: { created_at: 'DESC' },
            });
        });
        it('deve aplicar filtros corretamente', async () => {
            typeormRepository.findAndCount.mockResolvedValue([[mockUsuario], 1]);
            const options = {
                where: {
                    search: 'João',
                    role: 'ASSISTENTE_SOCIAL',
                    status: 'ativo',
                    unidadeId: 'unidade-123',
                },
            };
            const result = await repository.findAll(options);
            expect(typeormRepository.findAndCount).toHaveBeenCalledWith({
                skip: 0,
                take: 10,
                where: {
                    search: 'João',
                    role: 'ASSISTENTE_SOCIAL',
                    status: 'ativo',
                    unidadeId: 'unidade-123',
                },
                order: { created_at: 'DESC' },
            });
            expect(result).toEqual([[mockUsuario], 1]);
        });
    });
    describe('update', () => {
        it('deve atualizar usuário', async () => {
            const updateDto = {
                nome: 'João Silva Santos',
                cpf: '123.456.789-00',
                telefone: '(84) 88888-8888',
            };
            const usuarioAtualizado = { ...mockUsuario, ...updateDto };
            typeormRepository.update.mockResolvedValue({ affected: 1 });
            typeormRepository.findOne.mockResolvedValue(usuarioAtualizado);
            const result = await repository.update('123e4567-e89b-12d3-a456-426614174000', updateDto);
            expect(typeormRepository.update).toHaveBeenCalledWith('123e4567-e89b-12d3-a456-426614174000', updateDto);
            expect(result).toEqual(usuarioAtualizado);
        });
        it('deve lançar UsuarioError quando usuário não encontrado para atualização', async () => {
            typeormRepository.update.mockResolvedValue({ affected: 0 });
            await expect(repository.update('id-inexistente', { nome: 'Novo Nome' })).rejects.toThrow(usuario_errors_1.UsuarioError);
        });
    });
    describe('updateStatus', () => {
        it('deve atualizar status do usuário', async () => {
            const updateData = {
                status: 'inativo',
            };
            const usuarioAtualizado = { ...mockUsuario, status: 'inativo' };
            typeormRepository.update.mockResolvedValue({ affected: 1 });
            typeormRepository.findOne.mockResolvedValue(usuarioAtualizado);
            const result = await repository.updateStatus('123e4567-e89b-12d3-a456-426614174000', 'inativo');
            expect(typeormRepository.update).toHaveBeenCalledWith('123e4567-e89b-12d3-a456-426614174000', updateData);
            expect(result).toEqual(usuarioAtualizado);
        });
    });
    describe('updateSenha', () => {
        it('deve atualizar senha do usuário', async () => {
            const updateData = {
                senhaHash: 'novaSenhaHash',
                primeiro_acesso: false,
            };
            const usuarioAtualizado = { ...mockUsuario, senhaHash: 'novaSenhaHash' };
            typeormRepository.update.mockResolvedValue({ affected: 1 });
            typeormRepository.findOne.mockResolvedValue(usuarioAtualizado);
            const result = await repository.updateSenha('123e4567-e89b-12d3-a456-426614174000', 'novaSenhaHash');
            expect(typeormRepository.update).toHaveBeenCalledWith('123e4567-e89b-12d3-a456-426614174000', updateData);
            expect(result).toEqual(usuarioAtualizado);
        });
    });
    describe('remove', () => {
        it('deve fazer soft delete do usuário', async () => {
            typeormRepository.softDelete.mockResolvedValue({ affected: 1 });
            await repository.remove('123e4567-e89b-12d3-a456-426614174000');
            expect(typeormRepository.softDelete).toHaveBeenCalledWith('123e4567-e89b-12d3-a456-426614174000');
        });
        it('deve lançar UsuarioError quando usuário não encontrado para remoção', async () => {
            typeormRepository.softDelete.mockResolvedValue({ affected: 0 });
            await expect(repository.remove('id-inexistente')).rejects.toThrow(usuario_errors_1.UsuarioError);
        });
    });
    describe('count', () => {
        it('deve retornar contagem de usuários', async () => {
            typeormRepository.count.mockResolvedValue(5);
            const result = await repository.count();
            expect(result).toBe(5);
            expect(typeormRepository.count).toHaveBeenCalledWith({
                where: undefined,
            });
        });
        it('deve retornar contagem de usuários com filtro', async () => {
            const whereCondition = { status: 'ativo' };
            typeormRepository.count.mockResolvedValue(3);
            const result = await repository.count(whereCondition);
            expect(result).toBe(3);
            expect(typeormRepository.count).toHaveBeenCalledWith({
                where: whereCondition,
            });
        });
    });
    it('deve estar definido', () => {
        expect(repository).toBeDefined();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHVzdWFyaW9cXHJlcG9zaXRvcmllc1xcdXN1YXJpby5yZXBvc2l0b3J5LnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsNkNBQXFEO0FBQ3JELHFDQUE4RDtBQUM5RCw2REFBeUQ7QUFDekQscUVBQTJEO0FBRzNELG1FQUE4RDtBQUU5RDs7Ozs7Ozs7Ozs7O0dBWUc7QUFDSCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO0lBQ2pDLElBQUksVUFBNkIsQ0FBQztJQUNsQyxJQUFJLGlCQUFtRCxDQUFDO0lBRXhELE1BQU0sUUFBUSxHQUFHO1FBQ2YsRUFBRSxFQUFFLFNBQVM7UUFDYixJQUFJLEVBQUUsbUJBQW1CO1FBQ3pCLFNBQVMsRUFBRSxtQkFBbUI7UUFDOUIsS0FBSyxFQUFFLElBQUk7UUFDWCxRQUFRLEVBQUUsRUFBRTtRQUNaLFVBQVUsRUFBRSxJQUFJLElBQUksRUFBRTtRQUN0QixVQUFVLEVBQUUsSUFBSSxJQUFJLEVBQUU7S0FDdkIsQ0FBQztJQUVGLE1BQU0sV0FBVyxHQUFHO1FBQ2xCLEVBQUUsRUFBRSxhQUFhO1FBQ2pCLElBQUksRUFBRSxlQUFlO1FBQ3JCLFFBQVEsRUFBRSxnQkFBZ0I7UUFDMUIsUUFBUSxFQUFFLGlCQUFpQjtRQUMzQixLQUFLLEVBQUUsa0JBQWtCO1FBQ3pCLEtBQUssRUFBRSxJQUFJO1FBQ1gsT0FBTyxFQUFFLEVBQUU7UUFDWCxRQUFRLEVBQUUsRUFBRTtRQUNaLFVBQVUsRUFBRSxJQUFJLElBQUksRUFBRTtRQUN0QixVQUFVLEVBQUUsSUFBSSxJQUFJLEVBQUU7S0FDdkIsQ0FBQztJQUVGLE1BQU0sU0FBUyxHQUFHO1FBQ2hCLEVBQUUsRUFBRSxXQUFXO1FBQ2YsSUFBSSxFQUFFLGFBQWE7UUFDbkIsU0FBUyxFQUFFLG9CQUFvQjtRQUMvQixLQUFLLEVBQUUsSUFBSTtRQUNYLE9BQU8sRUFBRSxXQUFXO1FBQ3BCLFNBQVMsRUFBRSxhQUFhO1FBQ3hCLFFBQVEsRUFBRSxFQUFFO1FBQ1osVUFBVSxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3RCLFVBQVUsRUFBRSxJQUFJLElBQUksRUFBRTtLQUN2QixDQUFDO0lBRUYsTUFBTSxXQUFXLEdBQVk7UUFDM0IsRUFBRSxFQUFFLHNDQUFzQztRQUMxQyxJQUFJLEVBQUUsZUFBZTtRQUNyQixLQUFLLEVBQUUsZ0NBQWdDO1FBQ3ZDLEdBQUcsRUFBRSxnQkFBZ0I7UUFDckIsUUFBUSxFQUFFLGlCQUFpQjtRQUMzQixTQUFTLEVBQUUsT0FBTztRQUNsQixTQUFTLEVBQUUsdUJBQXVCO1FBQ2xDLElBQUksRUFBRSxRQUFRO1FBQ2QsT0FBTyxFQUFFLFNBQVM7UUFDbEIsTUFBTSxFQUFFLE9BQU87UUFDZixlQUFlLEVBQUUsS0FBSztRQUN0QixnQkFBZ0IsRUFBRSxDQUFDO1FBQ25CLFlBQVksRUFBRSxJQUFJLElBQUksRUFBRTtRQUN4QixTQUFTLEVBQUUsYUFBYTtRQUN4QixPQUFPLEVBQUUsV0FBVztRQUNwQixVQUFVLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDdEIsVUFBVSxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3RCLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLE9BQU8sRUFBRSxXQUFXO1FBQ3BCLEtBQUssRUFBRSxTQUFTO1FBQ2hCLGFBQWEsRUFBRSxFQUFFO1FBQ2pCLFlBQVksRUFBRSxFQUFFO1FBQ2hCLGlCQUFpQixFQUFFLEVBQUU7UUFDckIsaUJBQWlCLEVBQUUsRUFBRTtLQUNmLENBQUM7SUFFVCxVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsTUFBTSxxQkFBcUIsR0FBRztZQUM1QixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNqQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLFlBQVksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ3ZCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2pCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ3JCLGtCQUFrQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDN0IsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDakIsQ0FBQztRQUVGLE1BQU0sY0FBYyxHQUFHO1lBQ3JCLGFBQWEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLHFCQUFxQixDQUFDO1NBQ2hFLENBQUM7UUFFRixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFO2dCQUNULHNDQUFpQjtnQkFDakI7b0JBQ0UsT0FBTyxFQUFFLElBQUEsNEJBQWtCLEVBQUMsd0JBQU8sQ0FBQztvQkFDcEMsUUFBUSxFQUFFLHFCQUFxQjtpQkFDaEM7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLG9CQUFVO29CQUNuQixRQUFRLEVBQUUsY0FBYztpQkFDekI7YUFDRjtTQUNGLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUViLFVBQVUsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFvQixzQ0FBaUIsQ0FBQyxDQUFDO1FBQzlELGlCQUFpQixHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBQSw0QkFBa0IsRUFBQyx3QkFBTyxDQUFDLENBQUMsQ0FBQztJQUM5RCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMxQyxNQUFNLFNBQVMsR0FBcUI7Z0JBQ2xDLElBQUksRUFBRSxlQUFlO2dCQUNyQixLQUFLLEVBQUUsZ0NBQWdDO2dCQUN2QyxLQUFLLEVBQUUsV0FBVztnQkFDbEIsR0FBRyxFQUFFLGdCQUFnQjtnQkFDckIsUUFBUSxFQUFFLGlCQUFpQjtnQkFDM0IsU0FBUyxFQUFFLE9BQU87Z0JBQ2xCLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixVQUFVLEVBQUUsYUFBYTtnQkFDekIsUUFBUSxFQUFFLFdBQVc7YUFDdEIsQ0FBQztZQUVGLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsV0FBa0IsQ0FBQyxDQUFDO1lBQzdELGlCQUFpQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUV0RCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFbEQsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ2pFLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtRQUN4QixFQUFFLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXpELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLFFBQVEsQ0FDdEMsc0NBQXNDLENBQ3ZDLENBQUM7WUFFRixNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3JELEtBQUssRUFBRSxFQUFFLEVBQUUsRUFBRSxzQ0FBc0MsRUFBRTtnQkFDckQsU0FBUyxFQUFFLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQzthQUNoQyxDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RFLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVsRCxNQUFNLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUNqRSw2QkFBWSxDQUNiLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQy9DLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUV6RCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxXQUFXLENBQ3pDLGdDQUFnQyxDQUNqQyxDQUFDO1lBRUYsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNyRCxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsZ0NBQWdDLEVBQUU7YUFDbkQsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM5RCxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFbEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsV0FBVyxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFFckUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzVCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRTtRQUN6QixFQUFFLENBQUMsK0JBQStCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0MsaUJBQWlCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXpELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRTVELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDckQsS0FBSyxFQUFFLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixFQUFFO2FBQ2pDLENBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxTQUFTLEVBQUUsR0FBRyxFQUFFO1FBQ3ZCLEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFckUsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsSUFBSSxFQUFFLENBQUM7Z0JBQ1AsSUFBSSxFQUFFLEVBQUU7Z0JBQ1IsS0FBSyxFQUFFO29CQUNMLElBQUksRUFBRSxNQUFNO29CQUNaLE9BQU8sRUFBRSxTQUFTO29CQUNsQixNQUFNLEVBQUUsT0FBTztvQkFDZixTQUFTLEVBQUUsYUFBYTtpQkFDekI7YUFDRixDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRWpELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUMxRCxJQUFJLEVBQUUsQ0FBQztnQkFDUCxJQUFJLEVBQUUsRUFBRTtnQkFDUixLQUFLLEVBQUU7b0JBQ0wsSUFBSSxFQUFFLE1BQU07b0JBQ1osT0FBTyxFQUFFLFNBQVM7b0JBQ2xCLE1BQU0sRUFBRSxPQUFPO29CQUNmLFNBQVMsRUFBRSxhQUFhO2lCQUN6QjtnQkFDRCxLQUFLLEVBQUUsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFO2FBQzlCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pELGlCQUFpQixDQUFDLFlBQVksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVyRSxNQUFNLE9BQU8sR0FBRztnQkFDZCxLQUFLLEVBQUU7b0JBQ0wsTUFBTSxFQUFFLE1BQU07b0JBQ2QsSUFBSSxFQUFFLG1CQUFtQjtvQkFDekIsTUFBTSxFQUFFLE9BQU87b0JBQ2YsU0FBUyxFQUFFLGFBQWE7aUJBQ3pCO2FBQ0YsQ0FBQztZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUVqRCxNQUFNLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQzFELElBQUksRUFBRSxDQUFDO2dCQUNQLElBQUksRUFBRSxFQUFFO2dCQUNSLEtBQUssRUFBRTtvQkFDTCxNQUFNLEVBQUUsTUFBTTtvQkFDZCxJQUFJLEVBQUUsbUJBQW1CO29CQUN6QixNQUFNLEVBQUUsT0FBTztvQkFDZixTQUFTLEVBQUUsYUFBYTtpQkFDekI7Z0JBQ0QsS0FBSyxFQUFFLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRTthQUM5QixDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtRQUN0QixFQUFFLENBQUMsd0JBQXdCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdEMsTUFBTSxTQUFTLEdBQXFCO2dCQUNsQyxJQUFJLEVBQUUsbUJBQW1CO2dCQUN6QixHQUFHLEVBQUUsZ0JBQWdCO2dCQUNyQixRQUFRLEVBQUUsaUJBQWlCO2FBQzVCLENBQUM7WUFDRixNQUFNLGlCQUFpQixHQUFHLEVBQUUsR0FBRyxXQUFXLEVBQUUsR0FBRyxTQUFTLEVBQUUsQ0FBQztZQUUzRCxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUNuRSxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUUvRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLHNDQUFzQyxFQUN0QyxTQUFTLENBQ1YsQ0FBQztZQUVGLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDbkQsc0NBQXNDLEVBQ3RDLFNBQVMsQ0FDVixDQUFDO1lBQ0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlFQUF5RSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZGLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRW5FLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FDM0QsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLDZCQUFZLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7UUFDNUIsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hELE1BQU0sVUFBVSxHQUF5QjtnQkFDdkMsTUFBTSxFQUFFLFNBQVM7YUFDbEIsQ0FBQztZQUNGLE1BQU0saUJBQWlCLEdBQUcsRUFBRSxHQUFHLFdBQVcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLENBQUM7WUFFaEUsaUJBQWlCLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBUyxDQUFDLENBQUM7WUFDbkUsaUJBQWlCLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFFL0QsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsWUFBWSxDQUMxQyxzQ0FBc0MsRUFDdEMsU0FBUyxDQUNWLENBQUM7WUFFRixNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQ25ELHNDQUFzQyxFQUN0QyxVQUFVLENBQ1gsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQy9DLE1BQU0sVUFBVSxHQUF5QjtnQkFDdkMsU0FBUyxFQUFFLGVBQWU7Z0JBQzFCLGVBQWUsRUFBRSxLQUFLO2FBQ3ZCLENBQUM7WUFDRixNQUFNLGlCQUFpQixHQUFHLEVBQUUsR0FBRyxXQUFXLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxDQUFDO1lBRXpFLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBQ25FLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLFdBQVcsQ0FDekMsc0NBQXNDLEVBQ3RDLGVBQWUsQ0FDaEIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDbkQsc0NBQXNDLEVBQ3RDLFVBQVUsQ0FDWCxDQUFDO1lBQ0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtRQUN0QixFQUFFLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakQsaUJBQWlCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFdkUsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUFDLHNDQUFzQyxDQUFDLENBQUM7WUFFaEUsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUN2RCxzQ0FBc0MsQ0FDdkMsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFFQUFxRSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ25GLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXZFLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQy9ELDZCQUFZLENBQ2IsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtRQUNyQixFQUFFLENBQUMsb0NBQW9DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsaUJBQWlCLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRTdDLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBRXhDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdkIsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNuRCxLQUFLLEVBQUUsU0FBUzthQUNqQixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RCxNQUFNLGNBQWMsR0FBRyxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQztZQUMzQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFN0MsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdkIsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNuRCxLQUFLLEVBQUUsY0FBYzthQUN0QixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtRQUM3QixNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDbkMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcdXN1YXJpb1xccmVwb3NpdG9yaWVzXFx1c3VhcmlvLnJlcG9zaXRvcnkuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IGdldFJlcG9zaXRvcnlUb2tlbiB9IGZyb20gJ0BuZXN0anMvdHlwZW9ybSc7XG5pbXBvcnQgeyBSZXBvc2l0b3J5LCBEZWVwUGFydGlhbCwgRGF0YVNvdXJjZSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgVXN1YXJpb1JlcG9zaXRvcnkgfSBmcm9tICcuL3VzdWFyaW8ucmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBVc3VhcmlvIH0gZnJvbSAnLi4vLi4vLi4vZW50aXRpZXMvdXN1YXJpby5lbnRpdHknO1xuaW1wb3J0IHsgQ3JlYXRlVXN1YXJpb0R0byB9IGZyb20gJy4uL2R0by9jcmVhdGUtdXN1YXJpby5kdG8nO1xuaW1wb3J0IHsgVXBkYXRlVXN1YXJpb0R0byB9IGZyb20gJy4uL2R0by91cGRhdGUtdXN1YXJpby5kdG8nO1xuaW1wb3J0IHsgVXN1YXJpb0Vycm9yIH0gZnJvbSAnLi4vLi4vLi4vZXJyb3JzL3VzdWFyaW8uZXJyb3JzJztcblxuLyoqXG4gKiBUZXN0ZXMgdW5pdMOhcmlvcyBwYXJhIG8gVXN1YXJpb1JlcG9zaXRvcnlcbiAqXG4gKiBDb2JlcnR1cmEgZGUgdGVzdGVzOlxuICogLSBDcmlhw6fDo28gZGUgdXN1w6FyaW9zXG4gKiAtIEJ1c2NhIHBvciBJRCwgZW1haWwsIENQRlxuICogLSBMaXN0YWdlbSBjb20gZmlsdHJvcyBlIHBhZ2luYcOnw6NvXG4gKiAtIEF0dWFsaXphw6fDo28gZGUgZGFkb3NcbiAqIC0gQXR1YWxpemHDp8OjbyBkZSBzdGF0dXNcbiAqIC0gQXR1YWxpemHDp8OjbyBkZSBzZW5oYVxuICogLSBTb2Z0IGRlbGV0ZVxuICogLSBDb250YWdlbSBkZSByZWdpc3Ryb3NcbiAqL1xuZGVzY3JpYmUoJ1VzdWFyaW9SZXBvc2l0b3J5JywgKCkgPT4ge1xuICBsZXQgcmVwb3NpdG9yeTogVXN1YXJpb1JlcG9zaXRvcnk7XG4gIGxldCB0eXBlb3JtUmVwb3NpdG9yeTogamVzdC5Nb2NrZWQ8UmVwb3NpdG9yeTxVc3VhcmlvPj47XG5cbiAgY29uc3QgbW9ja1JvbGUgPSB7XG4gICAgaWQ6ICdyb2xlLWlkJyxcbiAgICBub21lOiAnQVNTSVNURU5URV9TT0NJQUwnLFxuICAgIGRlc2NyaWNhbzogJ0Fzc2lzdGVudGUgU29jaWFsJyxcbiAgICBhdGl2bzogdHJ1ZSxcbiAgICB1c3VhcmlvczogW10sXG4gICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tVbmlkYWRlID0ge1xuICAgIGlkOiAndW5pZGFkZS0xMjMnLFxuICAgIG5vbWU6ICdVbmlkYWRlIFRlc3RlJyxcbiAgICBlbmRlcmVjbzogJ0VuZGVyZcOnbyBUZXN0ZScsXG4gICAgdGVsZWZvbmU6ICcoODQpIDk5OTk5LTk5OTknLFxuICAgIGVtYWlsOiAndW5pZGFkZUB0ZXN0LmNvbScsXG4gICAgYXRpdm86IHRydWUsXG4gICAgc2V0b3JlczogW10sXG4gICAgdXN1YXJpb3M6IFtdLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgfTtcblxuICBjb25zdCBtb2NrU2V0b3IgPSB7XG4gICAgaWQ6ICdzZXRvci0xMjMnLFxuICAgIG5vbWU6ICdTZXRvciBUZXN0ZScsXG4gICAgZGVzY3JpY2FvOiAnRGVzY3Jpw6fDo28gZG8gU2V0b3InLFxuICAgIGF0aXZvOiB0cnVlLFxuICAgIHVuaWRhZGU6IG1vY2tVbmlkYWRlLFxuICAgIHVuaWRhZGVJZDogJ3VuaWRhZGUtMTIzJyxcbiAgICB1c3VhcmlvczogW10sXG4gICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tVc3VhcmlvOiBVc3VhcmlvID0ge1xuICAgIGlkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwJyxcbiAgICBub21lOiAnSm/Do28gZGEgU2lsdmEnLFxuICAgIGVtYWlsOiAnam9hby5zaWx2YUBzZW10YXMubmF0YWwuZ292LmJyJyxcbiAgICBjcGY6ICcxMjMuNDU2Ljc4OS0wMCcsXG4gICAgdGVsZWZvbmU6ICcoODQpIDk5OTk5LTk5OTknLFxuICAgIG1hdHJpY3VsYTogJzEyMzQ1JyxcbiAgICBzZW5oYUhhc2g6ICckMmIkMTIkaGFzaGVkcGFzc3dvcmQnLFxuICAgIHJvbGU6IG1vY2tSb2xlLFxuICAgIHJvbGVfaWQ6ICdyb2xlLWlkJyxcbiAgICBzdGF0dXM6ICdhdGl2bycsXG4gICAgcHJpbWVpcm9fYWNlc3NvOiBmYWxzZSxcbiAgICB0ZW50YXRpdmFzX2xvZ2luOiAwLFxuICAgIHVsdGltb19sb2dpbjogbmV3IERhdGUoKSxcbiAgICB1bmlkYWRlSWQ6ICd1bmlkYWRlLTEyMycsXG4gICAgc2V0b3JJZDogJ3NldG9yLTEyMycsXG4gICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgIHJlbW92ZWRfYXQ6IG51bGwsXG4gICAgdW5pZGFkZTogbW9ja1VuaWRhZGUsXG4gICAgc2V0b3I6IG1vY2tTZXRvcixcbiAgICByZWZyZXNoVG9rZW5zOiBbXSxcbiAgICBzb2xpY2l0YWNvZXM6IFtdLFxuICAgIGF1ZGl0b3JpYXNDcmVhdGVkOiBbXSxcbiAgICBhdWRpdG9yaWFzVXBkYXRlZDogW10sXG4gIH0gYXMgYW55O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tUeXBlb3JtUmVwb3NpdG9yeSA9IHtcbiAgICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgICAgc2F2ZTogamVzdC5mbigpLFxuICAgICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgICAgZmluZEFuZENvdW50OiBqZXN0LmZuKCksXG4gICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgIHNvZnREZWxldGU6IGplc3QuZm4oKSxcbiAgICAgIGNyZWF0ZVF1ZXJ5QnVpbGRlcjogamVzdC5mbigpLFxuICAgICAgY291bnQ6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja0RhdGFTb3VyY2UgPSB7XG4gICAgICBnZXRSZXBvc2l0b3J5OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG1vY2tUeXBlb3JtUmVwb3NpdG9yeSksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgVXN1YXJpb1JlcG9zaXRvcnksXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oVXN1YXJpbyksXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tUeXBlb3JtUmVwb3NpdG9yeSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IERhdGFTb3VyY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tEYXRhU291cmNlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICByZXBvc2l0b3J5ID0gbW9kdWxlLmdldDxVc3VhcmlvUmVwb3NpdG9yeT4oVXN1YXJpb1JlcG9zaXRvcnkpO1xuICAgIHR5cGVvcm1SZXBvc2l0b3J5ID0gbW9kdWxlLmdldChnZXRSZXBvc2l0b3J5VG9rZW4oVXN1YXJpbykpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JlYXRlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGNyaWFyIHVtIG5vdm8gdXN1w6FyaW8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVEdG86IENyZWF0ZVVzdWFyaW9EdG8gPSB7XG4gICAgICAgIG5vbWU6ICdKb8OjbyBkYSBTaWx2YScsXG4gICAgICAgIGVtYWlsOiAnam9hby5zaWx2YUBzZW10YXMubmF0YWwuZ292LmJyJyxcbiAgICAgICAgc2VuaGE6ICdTZW5oYUAxMjMnLFxuICAgICAgICBjcGY6ICcxMjMuNDU2Ljc4OS0wMCcsXG4gICAgICAgIHRlbGVmb25lOiAnKDg0KSA5OTk5OS05OTk5JyxcbiAgICAgICAgbWF0cmljdWxhOiAnMTIzNDUnLFxuICAgICAgICByb2xlX2lkOiAncm9sZS1pZCcsXG4gICAgICAgIHVuaWRhZGVfaWQ6ICd1bmlkYWRlLTEyMycsXG4gICAgICAgIHNldG9yX2lkOiAnc2V0b3ItMTIzJyxcbiAgICAgIH07XG5cbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmNyZWF0ZS5tb2NrUmV0dXJuVmFsdWUobW9ja1VzdWFyaW8gYXMgYW55KTtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LnNhdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzdWFyaW8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmNyZWF0ZShjcmVhdGVEdG8pO1xuXG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjcmVhdGVEdG8pO1xuICAgICAgZXhwZWN0KHR5cGVvcm1SZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tVc3VhcmlvKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzdWFyaW8pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEJ5SWQnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgdXN1w6FyaW8gcG9yIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXN1YXJpbyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5SWQoXG4gICAgICAgICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnIH0sXG4gICAgICAgIHJlbGF0aW9uczogWyd1bmlkYWRlJywgJ3NldG9yJ10sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzdWFyaW8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBVc3VhcmlvRXJyb3IgcXVhbmRvIHVzdcOhcmlvIG7Do28gZW5jb250cmFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChyZXBvc2l0b3J5LmZpbmRCeUlkKCdpZC1pbmV4aXN0ZW50ZScpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIFVzdWFyaW9FcnJvcixcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlFbWFpbCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciB1c3XDoXJpbyBwb3IgZW1haWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICB0eXBlb3JtUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc3VhcmlvKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVwb3NpdG9yeS5maW5kQnlFbWFpbChcbiAgICAgICAgJ2pvYW8uc2lsdmFAc2VtdGFzLm5hdGFsLmdvdi5icicsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBlbWFpbDogJ2pvYW8uc2lsdmFAc2VtdGFzLm5hdGFsLmdvdi5icicgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXN1YXJpbyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBudWxsIHF1YW5kbyBlbWFpbCBuw6NvIGVuY29udHJhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICB0eXBlb3JtUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmZpbmRCeUVtYWlsKCdlbWFpbEBpbmV4aXN0ZW50ZS5jb20nKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRCeUNwZicsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciB1c3XDoXJpbyBwb3IgQ1BGJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXN1YXJpbyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEJ5Q3BmKCcxMjMuNDU2Ljc4OS0wMCcpO1xuXG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBjcGY6ICcxMjMuNDU2Ljc4OS0wMCcgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXN1YXJpbyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQWxsJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIGxpc3RhIHBhZ2luYWRhIGRlIHVzdcOhcmlvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRBbmRDb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZShbW21vY2tVc3VhcmlvXSwgMV0pO1xuXG4gICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICBza2lwOiAwLFxuICAgICAgICB0YWtlOiAxMCxcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBub21lOiAnSm/Do28nLFxuICAgICAgICAgIHJvbGVfaWQ6ICdyb2xlLWlkJyxcbiAgICAgICAgICBzdGF0dXM6ICdhdGl2bycsXG4gICAgICAgICAgdW5pZGFkZUlkOiAndW5pZGFkZS0xMjMnLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVwb3NpdG9yeS5maW5kQWxsKG9wdGlvbnMpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtbbW9ja1VzdWFyaW9dLCAxXSk7XG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuZmluZEFuZENvdW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHNraXA6IDAsXG4gICAgICAgIHRha2U6IDEwLFxuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG5vbWU6ICdKb8OjbycsXG4gICAgICAgICAgcm9sZV9pZDogJ3JvbGUtaWQnLFxuICAgICAgICAgIHN0YXR1czogJ2F0aXZvJyxcbiAgICAgICAgICB1bmlkYWRlSWQ6ICd1bmlkYWRlLTEyMycsXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyOiB7IGNyZWF0ZWRfYXQ6ICdERVNDJyB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBhcGxpY2FyIGZpbHRyb3MgY29ycmV0YW1lbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdHlwZW9ybVJlcG9zaXRvcnkuZmluZEFuZENvdW50Lm1vY2tSZXNvbHZlZFZhbHVlKFtbbW9ja1VzdWFyaW9dLCAxXSk7XG5cbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgc2VhcmNoOiAnSm/Do28nLFxuICAgICAgICAgIHJvbGU6ICdBU1NJU1RFTlRFX1NPQ0lBTCcsXG4gICAgICAgICAgc3RhdHVzOiAnYXRpdm8nLFxuICAgICAgICAgIHVuaWRhZGVJZDogJ3VuaWRhZGUtMTIzJyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEFsbChvcHRpb25zKTtcblxuICAgICAgZXhwZWN0KHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRBbmRDb3VudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBza2lwOiAwLFxuICAgICAgICB0YWtlOiAxMCxcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBzZWFyY2g6ICdKb8OjbycsXG4gICAgICAgICAgcm9sZTogJ0FTU0lTVEVOVEVfU09DSUFMJyxcbiAgICAgICAgICBzdGF0dXM6ICdhdGl2bycsXG4gICAgICAgICAgdW5pZGFkZUlkOiAndW5pZGFkZS0xMjMnLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlcjogeyBjcmVhdGVkX2F0OiAnREVTQycgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbW21vY2tVc3VhcmlvXSwgMV0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGF0dWFsaXphciB1c3XDoXJpbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZUR0bzogVXBkYXRlVXN1YXJpb0R0byA9IHtcbiAgICAgICAgbm9tZTogJ0pvw6NvIFNpbHZhIFNhbnRvcycsXG4gICAgICAgIGNwZjogJzEyMy40NTYuNzg5LTAwJyxcbiAgICAgICAgdGVsZWZvbmU6ICcoODQpIDg4ODg4LTg4ODgnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVzdWFyaW9BdHVhbGl6YWRvID0geyAuLi5tb2NrVXN1YXJpbywgLi4udXBkYXRlRHRvIH07XG5cbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAxIH0gYXMgYW55KTtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUodXN1YXJpb0F0dWFsaXphZG8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LnVwZGF0ZShcbiAgICAgICAgJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gICAgICAgIHVwZGF0ZUR0byxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh0eXBlb3JtUmVwb3NpdG9yeS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwJyxcbiAgICAgICAgdXBkYXRlRHRvLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXN1YXJpb0F0dWFsaXphZG8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBVc3VhcmlvRXJyb3IgcXVhbmRvIHVzdcOhcmlvIG7Do28gZW5jb250cmFkbyBwYXJhIGF0dWFsaXphw6fDo28nLCBhc3luYyAoKSA9PiB7XG4gICAgICB0eXBlb3JtUmVwb3NpdG9yeS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoeyBhZmZlY3RlZDogMCB9IGFzIGFueSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgcmVwb3NpdG9yeS51cGRhdGUoJ2lkLWluZXhpc3RlbnRlJywgeyBub21lOiAnTm92byBOb21lJyB9KSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KFVzdWFyaW9FcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVTdGF0dXMnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYXR1YWxpemFyIHN0YXR1cyBkbyB1c3XDoXJpbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IERlZXBQYXJ0aWFsPFVzdWFyaW8+ID0ge1xuICAgICAgICBzdGF0dXM6ICdpbmF0aXZvJyxcbiAgICAgIH07XG4gICAgICBjb25zdCB1c3VhcmlvQXR1YWxpemFkbyA9IHsgLi4ubW9ja1VzdWFyaW8sIHN0YXR1czogJ2luYXRpdm8nIH07XG5cbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAxIH0gYXMgYW55KTtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUodXN1YXJpb0F0dWFsaXphZG8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LnVwZGF0ZVN0YXR1cyhcbiAgICAgICAgJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gICAgICAgICdpbmF0aXZvJyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh0eXBlb3JtUmVwb3NpdG9yeS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwJyxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVzdWFyaW9BdHVhbGl6YWRvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZVNlbmhhJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGF0dWFsaXphciBzZW5oYSBkbyB1c3XDoXJpbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IERlZXBQYXJ0aWFsPFVzdWFyaW8+ID0ge1xuICAgICAgICBzZW5oYUhhc2g6ICdub3ZhU2VuaGFIYXNoJyxcbiAgICAgICAgcHJpbWVpcm9fYWNlc3NvOiBmYWxzZSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1c3VhcmlvQXR1YWxpemFkbyA9IHsgLi4ubW9ja1VzdWFyaW8sIHNlbmhhSGFzaDogJ25vdmFTZW5oYUhhc2gnIH07XG5cbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAxIH0gYXMgYW55KTtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUodXN1YXJpb0F0dWFsaXphZG8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LnVwZGF0ZVNlbmhhKFxuICAgICAgICAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwJyxcbiAgICAgICAgJ25vdmFTZW5oYUhhc2gnLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHR5cGVvcm1SZXBvc2l0b3J5LnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnLFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXN1YXJpb0F0dWFsaXphZG8pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGZhemVyIHNvZnQgZGVsZXRlIGRvIHVzdcOhcmlvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdHlwZW9ybVJlcG9zaXRvcnkuc29mdERlbGV0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGFmZmVjdGVkOiAxIH0gYXMgYW55KTtcblxuICAgICAgYXdhaXQgcmVwb3NpdG9yeS5yZW1vdmUoJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcpO1xuXG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuc29mdERlbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgVXN1YXJpb0Vycm9yIHF1YW5kbyB1c3XDoXJpbyBuw6NvIGVuY29udHJhZG8gcGFyYSByZW1vw6fDo28nLCBhc3luYyAoKSA9PiB7XG4gICAgICB0eXBlb3JtUmVwb3NpdG9yeS5zb2Z0RGVsZXRlLm1vY2tSZXNvbHZlZFZhbHVlKHsgYWZmZWN0ZWQ6IDAgfSBhcyBhbnkpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocmVwb3NpdG9yeS5yZW1vdmUoJ2lkLWluZXhpc3RlbnRlJykpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgVXN1YXJpb0Vycm9yLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NvdW50JywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIGNvbnRhZ2VtIGRlIHVzdcOhcmlvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIHR5cGVvcm1SZXBvc2l0b3J5LmNvdW50Lm1vY2tSZXNvbHZlZFZhbHVlKDUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXBvc2l0b3J5LmNvdW50KCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoNSk7XG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuY291bnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHVuZGVmaW5lZCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgY29udGFnZW0gZGUgdXN1w6FyaW9zIGNvbSBmaWx0cm8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB3aGVyZUNvbmRpdGlvbiA9IHsgc3RhdHVzOiAnYXRpdm8nIH07XG4gICAgICB0eXBlb3JtUmVwb3NpdG9yeS5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVwb3NpdG9yeS5jb3VudCh3aGVyZUNvbmRpdGlvbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoMyk7XG4gICAgICBleHBlY3QodHlwZW9ybVJlcG9zaXRvcnkuY291bnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHdoZXJlQ29uZGl0aW9uLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdkZXZlIGVzdGFyIGRlZmluaWRvJywgKCkgPT4ge1xuICAgIGV4cGVjdChyZXBvc2l0b3J5KS50b0JlRGVmaW5lZCgpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9