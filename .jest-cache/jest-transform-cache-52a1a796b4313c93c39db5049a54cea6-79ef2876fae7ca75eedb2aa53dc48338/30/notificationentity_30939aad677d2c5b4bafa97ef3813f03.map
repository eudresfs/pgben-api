{"file":"C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\notification.entity.ts","mappings":"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","names":[],"sources":["C:\\Users\\eudre\\OneDrive\\Desktop\\Projetos\\pgben\\pgben-server\\src\\entities\\notification.entity.ts"],"sourcesContent":["import {\n  Entity,\n  Column,\n  PrimaryGeneratedColumn,\n  CreateDateColumn,\n  UpdateDateColumn,\n  ManyToOne,\n  JoinColumn,\n  Index,\n} from 'typeorm';\nimport {\n  IsNotEmpty,\n  IsUUID,\n  IsOptional,\n  IsEnum,\n  IsNumber,\n  Min,\n} from 'class-validator';\nimport { NotificationTemplate } from './notification-template.entity';\n\n/**\n * Enum para os tipos de notificação\n */\nexport enum TipoNotificacao {\n  SISTEMA = 'sistema',\n  SOLICITACAO = 'solicitacao',\n  PENDENCIA = 'pendencia',\n  APROVACAO = 'aprovacao',\n  LIBERACAO = 'liberacao',\n  ALERTA = 'alerta',\n}\n\n/**\n * Enum para os possíveis estados de uma notificação do sistema\n */\nexport enum StatusNotificacaoProcessamento {\n  PENDENTE = 'pendente',\n  EM_PROCESSAMENTO = 'em_processamento',\n  ENVIADA = 'enviada',\n  FALHA = 'falha',\n  CANCELADA = 'cancelada',\n  NAO_LIDA = 'nao_lida',\n  LIDA = 'lida',\n  ARQUIVADA = 'arquivada',\n}\n\n/**\n * Interface para registrar tentativas de entrega\n */\nexport interface TentativaEntrega {\n  data_tentativa: Date;\n  canal: string;\n  sucesso: boolean;\n  mensagem_erro?: string;\n  dados_resposta?: Record<string, any>;\n}\n\n/**\n * Entidade que representa uma notificação para um destinatário específico\n */\n@Entity('notificacoes_sistema')\n// Nome da classe alterado para evitar conflitos com a entidade Notificacao\n@Index(['destinatario_id', 'created_at'])\n@Index(['status', 'created_at'])\nexport class NotificacaoSistema {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column({ name: 'destinatario_id' })\n  @IsNotEmpty({ message: 'ID do destinatário é obrigatório' })\n  @IsUUID('4', { message: 'ID do destinatário inválido' })\n  destinatario_id: string;\n\n  @ManyToOne(() => NotificationTemplate)\n  @JoinColumn({ name: 'template_id' })\n  template: NotificationTemplate;\n\n  @Column({ name: 'template_id' })\n  @IsNotEmpty({ message: 'ID do template é obrigatório' })\n  @IsUUID('4', { message: 'ID do template inválido' })\n  template_id: string;\n\n  @Column({ type: 'jsonb', name: 'dados_contexto' })\n  dados_contexto: Record<string, any>;\n\n  @Column({\n    type: 'enum',\n    enum: StatusNotificacaoProcessamento,\n    enumName: 'status_notificacao_processamento',\n    default: StatusNotificacaoProcessamento.PENDENTE,\n  })\n  @IsEnum(StatusNotificacaoProcessamento, { message: 'Status inválido' })\n  status: StatusNotificacaoProcessamento;\n\n  @Column({ type: 'jsonb', name: 'tentativas_entrega', nullable: true })\n  tentativas_entrega: TentativaEntrega[];\n\n  @Column({ type: 'jsonb', name: 'dados_envio', nullable: true })\n  dados_envio: Record<string, any>;\n\n  @Column({ name: 'ultima_tentativa', nullable: true })\n  ultima_tentativa: Date;\n\n  @Column({ name: 'tentativas_envio', default: 0 })\n  @IsNumber({}, { message: 'Tentativas de envio deve ser um número' })\n  @Min(0, { message: 'Tentativas de envio não pode ser negativo' })\n  tentativas_envio: number;\n\n  @Column({ name: 'proxima_tentativa', nullable: true })\n  proxima_tentativa: Date;\n\n  @Column({ name: 'numero_tentativas', default: 0 })\n  @IsNumber({}, { message: 'Número de tentativas deve ser um número' })\n  @Min(0, { message: 'Número de tentativas não pode ser negativo' })\n  numero_tentativas: number;\n\n  @Column({ name: 'data_entrega', nullable: true })\n  @IsOptional()\n  data_entrega: Date;\n\n  @Column({ name: 'data_envio', nullable: true })\n  @IsOptional()\n  data_envio: Date;\n\n  @Column({ name: 'data_agendamento', nullable: true })\n  @IsOptional()\n  data_agendamento: Date;\n\n  @Column({ name: 'data_leitura', nullable: true })\n  @IsOptional()\n  data_leitura: Date;\n\n  @CreateDateColumn({ name: 'created_at' })\n  created_at: Date;\n\n  @UpdateDateColumn({ name: 'updated_at' })\n  updated_at: Date;\n}\n"],"version":3}