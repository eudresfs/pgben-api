e285f5457bb158454473fd67e2a24d98
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const typeorm_1 = require("@nestjs/typeorm");
const typeorm_2 = require("typeorm");
const common_1 = require("@nestjs/common");
const papel_cidadao_service_1 = require("@modules/cidadao/services/papel-cidadao.service");
const cidadao_service_1 = require("@modules/cidadao/services/cidadao.service");
const verificacao_papel_service_1 = require("@modules/cidadao/services/verificacao-papel.service");
const papel_cidadao_entity_1 = require("@modules/cidadao/entities/papel-cidadao.entity");
const tipo_papel_enum_1 = require("@modules/cidadao/enums/tipo-papel.enum");
describe('PapelCidadaoService', () => {
    let service;
    let repository;
    let cidadaoService;
    let verificacaoPapelService;
    let dataSource;
    const mockRepository = {
        create: jest.fn(),
        save: jest.fn(),
        find: jest.fn(),
        findOne: jest.fn(),
        update: jest.fn(),
    };
    const mockCidadaoService = {
        findById: jest.fn(),
    };
    const mockVerificacaoPapelService = {
        verificarConflitoPapeis: jest.fn(),
    };
    const mockQueryRunner = {
        connect: jest.fn(),
        startTransaction: jest.fn(),
        commitTransaction: jest.fn(),
        rollbackTransaction: jest.fn(),
        release: jest.fn(),
        manager: {
            create: jest.fn(),
            save: jest.fn(),
            findOne: jest.fn(),
        },
    };
    const mockDataSource = {
        createQueryRunner: jest.fn().mockReturnValue(mockQueryRunner),
        transaction: jest.fn(),
    };
    const mockCidadaoResponse = {
        id: '550e8400-e29b-41d4-a716-446655440000',
        nome: 'João da Silva',
        cpf: '12345678901',
        email: 'joao@example.com',
    };
    const mockPapelCidadao = {
        id: '660e8400-e29b-41d4-a716-446655440000',
        cidadao_id: '550e8400-e29b-41d4-a716-446655440000',
        tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
        ativo: true,
        metadados: {},
        created_at: new Date(),
        updated_at: new Date(),
    };
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                papel_cidadao_service_1.PapelCidadaoService,
                {
                    provide: (0, typeorm_1.getRepositoryToken)(papel_cidadao_entity_1.PapelCidadao),
                    useValue: mockRepository,
                },
                {
                    provide: cidadao_service_1.CidadaoService,
                    useValue: mockCidadaoService,
                },
                {
                    provide: verificacao_papel_service_1.VerificacaoPapelService,
                    useValue: mockVerificacaoPapelService,
                },
                {
                    provide: typeorm_2.DataSource,
                    useValue: mockDataSource,
                },
            ],
        }).compile();
        service = module.get(papel_cidadao_service_1.PapelCidadaoService);
        repository = module.get((0, typeorm_1.getRepositoryToken)(papel_cidadao_entity_1.PapelCidadao));
        cidadaoService = module.get(cidadao_service_1.CidadaoService);
        verificacaoPapelService = module.get(verificacao_papel_service_1.VerificacaoPapelService);
        dataSource = module.get(typeorm_2.DataSource);
        jest.clearAllMocks();
    });
    it('deve estar definido', () => {
        expect(service).toBeDefined();
    });
    describe('create', () => {
        const createPapelDto = {
            cidadao_id: '550e8400-e29b-41d4-a716-446655440000',
            tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
            metadados: {},
        };
        it('deve criar um papel com sucesso', async () => {
            // Mock para verificação de cidadão existente
            mockCidadaoService.findById.mockResolvedValue(mockCidadaoResponse);
            // Mock para verificação inicial de papel existente
            mockRepository.findOne.mockResolvedValue(null);
            mockDataSource.transaction.mockImplementation(async (callback) => {
                const manager = {
                    findOne: jest.fn().mockResolvedValue(mockCidadaoResponse), // Cidadão encontrado na transação
                    create: jest.fn().mockReturnValue(mockPapelCidadao),
                    save: jest.fn().mockResolvedValue(mockPapelCidadao),
                };
                return callback(manager);
            });
            const result = await service.create(createPapelDto);
            expect(mockCidadaoService.findById).toHaveBeenCalledWith(createPapelDto.cidadao_id, false);
            expect(mockRepository.findOne).toHaveBeenCalledWith({
                where: {
                    cidadao_id: createPapelDto.cidadao_id,
                    tipo_papel: createPapelDto.tipo_papel,
                    ativo: true,
                },
            });
            expect(result).toEqual(mockPapelCidadao);
        });
        it('deve lançar NotFoundException quando cidadão não existir', async () => {
            mockCidadaoService.findById.mockResolvedValue(null);
            await expect(service.create(createPapelDto)).rejects.toThrow(common_1.NotFoundException);
            expect(mockCidadaoService.findById).toHaveBeenCalledWith(createPapelDto.cidadao_id, false);
        });
        it('deve lançar ConflictException quando cidadão já possuir o papel', async () => {
            // Mock para verificação de cidadão existente
            mockCidadaoService.findById.mockResolvedValue(mockCidadaoResponse);
            // Mock para verificação inicial de papel existente - retorna papel existente
            mockRepository.findOne.mockResolvedValue(mockPapelCidadao);
            await expect(service.create(createPapelDto)).rejects.toThrow(common_1.ConflictException);
            expect(mockCidadaoService.findById).toHaveBeenCalledWith(createPapelDto.cidadao_id, false);
            expect(mockRepository.findOne).toHaveBeenCalledWith({
                where: {
                    cidadao_id: createPapelDto.cidadao_id,
                    tipo_papel: createPapelDto.tipo_papel,
                    ativo: true,
                },
            });
        });
        it('deve lançar NotFoundException quando cidadão não existir na transação', async () => {
            // Mock para verificação inicial de papel existente
            mockRepository.findOne.mockResolvedValue(null);
            mockDataSource.transaction.mockImplementation(async (callback) => {
                const manager = {
                    findOne: jest.fn().mockResolvedValue(null), // Cidadão não encontrado na transação
                    create: jest.fn(),
                    save: jest.fn(),
                };
                return callback(manager);
            });
            await expect(service.create(createPapelDto)).rejects.toThrow(common_1.NotFoundException);
        });
    });
    describe('createMany', () => {
        const cidadaoId = '550e8400-e29b-41d4-a716-446655440000';
        const papeis = [
            {
                tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
                metadados: {},
            },
            {
                tipo_papel: tipo_papel_enum_1.TipoPapel.MEMBRO_COMPOSICAO,
                metadados: {},
            },
        ];
        it('deve criar múltiplos papéis com sucesso', async () => {
            mockDataSource.transaction.mockImplementation(async (callback) => {
                const manager = {
                    findOne: jest.fn()
                        .mockResolvedValueOnce(null) // Primeiro papel não existe
                        .mockResolvedValueOnce(mockCidadaoResponse) // Cidadão encontrado para verificação de conflitos do primeiro papel
                        .mockResolvedValueOnce(null) // Segundo papel não existe
                        .mockResolvedValueOnce(mockCidadaoResponse), // Cidadão encontrado para verificação de conflitos do segundo papel
                    create: jest.fn().mockReturnValue([mockPapelCidadao]),
                    save: jest.fn().mockResolvedValue([mockPapelCidadao]),
                };
                return callback(manager);
            });
            mockCidadaoService.findById.mockResolvedValue(mockCidadaoResponse);
            mockVerificacaoPapelService.verificarConflitoPapeis.mockResolvedValue({
                temConflito: false,
                detalhes: '',
            });
            const result = await service.createMany(cidadaoId, papeis);
            expect(mockCidadaoService.findById).toHaveBeenCalledWith(cidadaoId, false);
            expect(result).toEqual([mockPapelCidadao]);
        });
        it('deve lançar BadRequestException quando lista estiver vazia', async () => {
            await expect(service.createMany(cidadaoId, [])).rejects.toThrow(common_1.BadRequestException);
        });
        it('deve lançar BadRequestException quando houver papéis duplicados', async () => {
            const papeisDuplicados = [
                {
                    tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
                    metadados: {},
                },
                {
                    tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
                    metadados: {},
                },
            ];
            mockDataSource.transaction.mockImplementation(async (callback) => {
                const manager = {
                    findOne: jest.fn(),
                    create: jest.fn(),
                    save: jest.fn(),
                };
                return callback(manager);
            });
            mockCidadaoService.findById.mockResolvedValue(mockCidadaoResponse);
            await expect(service.createMany(cidadaoId, papeisDuplicados)).rejects.toThrow(common_1.BadRequestException);
        });
        it('deve lançar NotFoundException quando cidadão não existir', async () => {
            mockDataSource.transaction.mockImplementation(async (callback) => {
                const manager = {
                    findOne: jest.fn(),
                    create: jest.fn(),
                    save: jest.fn(),
                };
                return callback(manager);
            });
            mockCidadaoService.findById.mockResolvedValue(null);
            await expect(service.createMany(cidadaoId, papeis)).rejects.toThrow(common_1.NotFoundException);
        });
    });
    describe('findByCidadaoId', () => {
        it('deve retornar papéis do cidadão', async () => {
            const papeis = [mockPapelCidadao];
            mockRepository.find.mockResolvedValue(papeis);
            const result = await service.findByCidadaoId('550e8400-e29b-41d4-a716-446655440000');
            expect(mockRepository.find).toHaveBeenCalledWith({
                where: { cidadao_id: '550e8400-e29b-41d4-a716-446655440000', ativo: true },
            });
            expect(result).toEqual(papeis);
        });
        it('deve filtrar por status ativo quando especificado', async () => {
            const papeis = [mockPapelCidadao];
            mockRepository.find.mockResolvedValue(papeis);
            const result = await service.findByCidadaoId('550e8400-e29b-41d4-a716-446655440000');
            expect(mockRepository.find).toHaveBeenCalledWith({
                where: {
                    cidadao_id: '550e8400-e29b-41d4-a716-446655440000',
                    ativo: true,
                },
            });
            expect(result).toEqual(papeis);
        });
    });
    describe('verificarPapel', () => {
        it('deve retornar true quando cidadão possuir o papel ativo', async () => {
            mockRepository.findOne.mockResolvedValue(mockPapelCidadao);
            const result = await service.verificarPapel('550e8400-e29b-41d4-a716-446655440000', tipo_papel_enum_1.TipoPapel.BENEFICIARIO);
            expect(mockRepository.findOne).toHaveBeenCalledWith({
                where: {
                    cidadao_id: '550e8400-e29b-41d4-a716-446655440000',
                    tipo_papel: tipo_papel_enum_1.TipoPapel.BENEFICIARIO,
                    ativo: true,
                },
            });
            expect(result).toBe(true);
        });
        it('deve retornar false quando cidadão não possuir o papel', async () => {
            mockRepository.findOne.mockResolvedValue(null);
            const result = await service.verificarPapel('550e8400-e29b-41d4-a716-446655440000', tipo_papel_enum_1.TipoPapel.BENEFICIARIO);
            expect(result).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFx0ZXN0XFx1bml0XFxjaWRhZGFvXFxwYXBlbC1jaWRhZGFvLnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCw2Q0FBcUQ7QUFDckQscUNBQWlEO0FBQ2pELDJDQUEyRjtBQUMzRiwyRkFBc0Y7QUFDdEYsK0VBQTJFO0FBQzNFLG1HQUE4RjtBQUM5Rix5RkFBOEU7QUFDOUUsNEVBQW1FO0FBSW5FLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7SUFDbkMsSUFBSSxPQUE0QixDQUFDO0lBQ2pDLElBQUksVUFBb0MsQ0FBQztJQUN6QyxJQUFJLGNBQThCLENBQUM7SUFDbkMsSUFBSSx1QkFBZ0QsQ0FBQztJQUNyRCxJQUFJLFVBQXNCLENBQUM7SUFFM0IsTUFBTSxjQUFjLEdBQUc7UUFDckIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2xCLENBQUM7SUFFRixNQUFNLGtCQUFrQixHQUFHO1FBQ3pCLFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ3BCLENBQUM7SUFFRixNQUFNLDJCQUEyQixHQUFHO1FBQ2xDLHVCQUF1QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDbkMsQ0FBQztJQUVGLE1BQU0sZUFBZSxHQUFHO1FBQ3RCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDM0IsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUM1QixtQkFB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QUMsS0FBSyxDQUFDLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcdGVzdFxcdW5pdFxcY2lkYWRhb1xccGFwZWwtY2lkYWRhby5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBnZXRSZXBvc2l0b3J5VG9rZW4gfSBmcm9tICdAbmVzdGpzL3R5cGVvcm0nO1xuaW1wb3J0IHsgUmVwb3NpdG9yeSwgRGF0YVNvdXJjZSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgTm90Rm91bmRFeGNlcHRpb24sIENvbmZsaWN0RXhjZXB0aW9uLCBCYWRSZXF1ZXN0RXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgUGFwZWxDaWRhZGFvU2VydmljZSB9IGZyb20gJ0Btb2R1bGVzL2NpZGFkYW8vc2VydmljZXMvcGFwZWwtY2lkYWRhby5zZXJ2aWNlJztcbmltcG9ydCB7IENpZGFkYW9TZXJ2aWNlIH0gZnJvbSAnQG1vZHVsZXMvY2lkYWRhby9zZXJ2aWNlcy9jaWRhZGFvLnNlcnZpY2UnO1xuaW1wb3J0IHsgVmVyaWZpY2FjYW9QYXBlbFNlcnZpY2UgfSBmcm9tICdAbW9kdWxlcy9jaWRhZGFvL3NlcnZpY2VzL3ZlcmlmaWNhY2FvLXBhcGVsLnNlcnZpY2UnO1xuaW1wb3J0IHsgUGFwZWxDaWRhZGFvIH0gZnJvbSAnQG1vZHVsZXMvY2lkYWRhby9lbnRpdGllcy9wYXBlbC1jaWRhZGFvLmVudGl0eSc7XG5pbXBvcnQgeyBUaXBvUGFwZWwgfSBmcm9tICdAbW9kdWxlcy9jaWRhZGFvL2VudW1zL3RpcG8tcGFwZWwuZW51bSc7XG5pbXBvcnQgeyBDcmVhdGVQYXBlbENpZGFkYW9EdG8gfSBmcm9tICdAbW9kdWxlcy9jaWRhZGFvL2R0by9jcmVhdGUtcGFwZWwtY2lkYWRhby5kdG8nO1xuaW1wb3J0IHsgQ2lkYWRhb1Jlc3BvbnNlRHRvIH0gZnJvbSAnQG1vZHVsZXMvY2lkYWRhby9kdG8vY2lkYWRhby1yZXNwb25zZS5kdG8nO1xuXG5kZXNjcmliZSgnUGFwZWxDaWRhZGFvU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IFBhcGVsQ2lkYWRhb1NlcnZpY2U7XG4gIGxldCByZXBvc2l0b3J5OiBSZXBvc2l0b3J5PFBhcGVsQ2lkYWRhbz47XG4gIGxldCBjaWRhZGFvU2VydmljZTogQ2lkYWRhb1NlcnZpY2U7XG4gIGxldCB2ZXJpZmljYWNhb1BhcGVsU2VydmljZTogVmVyaWZpY2FjYW9QYXBlbFNlcnZpY2U7XG4gIGxldCBkYXRhU291cmNlOiBEYXRhU291cmNlO1xuXG4gIGNvbnN0IG1vY2tSZXBvc2l0b3J5ID0ge1xuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICBmaW5kOiBqZXN0LmZuKCksXG4gICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tDaWRhZGFvU2VydmljZSA9IHtcbiAgICBmaW5kQnlJZDogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tWZXJpZmljYWNhb1BhcGVsU2VydmljZSA9IHtcbiAgICB2ZXJpZmljYXJDb25mbGl0b1BhcGVpczogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tRdWVyeVJ1bm5lciA9IHtcbiAgICBjb25uZWN0OiBqZXN0LmZuKCksXG4gICAgc3RhcnRUcmFuc2FjdGlvbjogamVzdC5mbigpLFxuICAgIGNvbW1pdFRyYW5zYWN0aW9uOiBqZXN0LmZuKCksXG4gICAgcm9sbGJhY2tUcmFuc2FjdGlvbjogamVzdC5mbigpLFxuICAgIHJlbGVhc2U6IGplc3QuZm4oKSxcbiAgICBtYW5hZ2VyOiB7XG4gICAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICB9LFxuICB9O1xuXG4gIGNvbnN0IG1vY2tEYXRhU291cmNlID0ge1xuICAgIGNyZWF0ZVF1ZXJ5UnVubmVyOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG1vY2tRdWVyeVJ1bm5lciksXG4gICAgdHJhbnNhY3Rpb246IGplc3QuZm4oKSxcbiAgfTtcblxuICBjb25zdCBtb2NrQ2lkYWRhb1Jlc3BvbnNlOiBDaWRhZGFvUmVzcG9uc2VEdG8gPSB7XG4gICAgaWQ6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgIG5vbWU6ICdKb8OjbyBkYSBTaWx2YScsXG4gICAgY3BmOiAnMTIzNDU2Nzg5MDEnLFxuICAgIGVtYWlsOiAnam9hb0BleGFtcGxlLmNvbScsXG4gIH0gYXMgQ2lkYWRhb1Jlc3BvbnNlRHRvO1xuXG4gIGNvbnN0IG1vY2tQYXBlbENpZGFkYW86IFBhcGVsQ2lkYWRhbyA9IHtcbiAgICBpZDogJzY2MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgY2lkYWRhb19pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgdGlwb19wYXBlbDogVGlwb1BhcGVsLkJFTkVGSUNJQVJJTyxcbiAgICBhdGl2bzogdHJ1ZSxcbiAgICBtZXRhZGFkb3M6IHt9LFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgfSBhcyBQYXBlbENpZGFkYW87XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBQYXBlbENpZGFkYW9TZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogZ2V0UmVwb3NpdG9yeVRva2VuKFBhcGVsQ2lkYWRhbyksXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tSZXBvc2l0b3J5LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogQ2lkYWRhb1NlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tDaWRhZGFvU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFZlcmlmaWNhY2FvUGFwZWxTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrVmVyaWZpY2FjYW9QYXBlbFNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBEYXRhU291cmNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrRGF0YVNvdXJjZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8UGFwZWxDaWRhZGFvU2VydmljZT4oUGFwZWxDaWRhZGFvU2VydmljZSk7XG4gICAgcmVwb3NpdG9yeSA9IG1vZHVsZS5nZXQ8UmVwb3NpdG9yeTxQYXBlbENpZGFkYW8+PihnZXRSZXBvc2l0b3J5VG9rZW4oUGFwZWxDaWRhZGFvKSk7XG4gICAgY2lkYWRhb1NlcnZpY2UgPSBtb2R1bGUuZ2V0PENpZGFkYW9TZXJ2aWNlPihDaWRhZGFvU2VydmljZSk7XG4gICAgdmVyaWZpY2FjYW9QYXBlbFNlcnZpY2UgPSBtb2R1bGUuZ2V0PFZlcmlmaWNhY2FvUGFwZWxTZXJ2aWNlPihWZXJpZmljYWNhb1BhcGVsU2VydmljZSk7XG4gICAgZGF0YVNvdXJjZSA9IG1vZHVsZS5nZXQ8RGF0YVNvdXJjZT4oRGF0YVNvdXJjZSk7XG5cbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgaXQoJ2RldmUgZXN0YXIgZGVmaW5pZG8nLCAoKSA9PiB7XG4gICAgZXhwZWN0KHNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlUGFwZWxEdG86IENyZWF0ZVBhcGVsQ2lkYWRhb0R0byA9IHtcbiAgICAgIGNpZGFkYW9faWQ6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgdGlwb19wYXBlbDogVGlwb1BhcGVsLkJFTkVGSUNJQVJJTyxcbiAgICAgIG1ldGFkYWRvczoge30sXG4gICAgfTtcblxuICAgIGl0KCdkZXZlIGNyaWFyIHVtIHBhcGVsIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBwYXJhIHZlcmlmaWNhw6fDo28gZGUgY2lkYWTDo28gZXhpc3RlbnRlXG4gICAgICBtb2NrQ2lkYWRhb1NlcnZpY2UuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NpZGFkYW9SZXNwb25zZSk7XG4gICAgICAvLyBNb2NrIHBhcmEgdmVyaWZpY2HDp8OjbyBpbmljaWFsIGRlIHBhcGVsIGV4aXN0ZW50ZVxuICAgICAgbW9ja1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIFxuICAgICAgbW9ja0RhdGFTb3VyY2UudHJhbnNhY3Rpb24ubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChjYWxsYmFjaykgPT4ge1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0ge1xuICAgICAgICAgIGZpbmRPbmU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhb1Jlc3BvbnNlKSwgLy8gQ2lkYWTDo28gZW5jb250cmFkbyBuYSB0cmFuc2HDp8Ojb1xuICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShtb2NrUGFwZWxDaWRhZGFvKSxcbiAgICAgICAgICBzYXZlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhcGVsQ2lkYWRhbyksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhtYW5hZ2VyKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZShjcmVhdGVQYXBlbER0byk7XG5cbiAgICAgIGV4cGVjdChtb2NrQ2lkYWRhb1NlcnZpY2UuZmluZEJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBjcmVhdGVQYXBlbER0by5jaWRhZGFvX2lkLFxuICAgICAgICBmYWxzZSxcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja1JlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNpZGFkYW9faWQ6IGNyZWF0ZVBhcGVsRHRvLmNpZGFkYW9faWQsXG4gICAgICAgICAgdGlwb19wYXBlbDogY3JlYXRlUGFwZWxEdG8udGlwb19wYXBlbCxcbiAgICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUGFwZWxDaWRhZGFvKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgTm90Rm91bmRFeGNlcHRpb24gcXVhbmRvIGNpZGFkw6NvIG7Do28gZXhpc3RpcicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tDaWRhZGFvU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlKGNyZWF0ZVBhcGVsRHRvKSkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1vY2tDaWRhZGFvU2VydmljZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGNyZWF0ZVBhcGVsRHRvLmNpZGFkYW9faWQsXG4gICAgICAgIGZhbHNlLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgQ29uZmxpY3RFeGNlcHRpb24gcXVhbmRvIGNpZGFkw6NvIGrDoSBwb3NzdWlyIG8gcGFwZWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHBhcmEgdmVyaWZpY2HDp8OjbyBkZSBjaWRhZMOjbyBleGlzdGVudGVcbiAgICAgIG1vY2tDaWRhZGFvU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhb1Jlc3BvbnNlKTtcbiAgICAgIC8vIE1vY2sgcGFyYSB2ZXJpZmljYcOnw6NvIGluaWNpYWwgZGUgcGFwZWwgZXhpc3RlbnRlIC0gcmV0b3JuYSBwYXBlbCBleGlzdGVudGVcbiAgICAgIG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhcGVsQ2lkYWRhbyk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyZWF0ZShjcmVhdGVQYXBlbER0bykpLnJlamVjdHMudG9UaHJvdyhDb25mbGljdEV4Y2VwdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrQ2lkYWRhb1NlcnZpY2UuZmluZEJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBjcmVhdGVQYXBlbER0by5jaWRhZGFvX2lkLFxuICAgICAgICBmYWxzZSxcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja1JlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNpZGFkYW9faWQ6IGNyZWF0ZVBhcGVsRHRvLmNpZGFkYW9faWQsXG4gICAgICAgICAgdGlwb19wYXBlbDogY3JlYXRlUGFwZWxEdG8udGlwb19wYXBlbCxcbiAgICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBOb3RGb3VuZEV4Y2VwdGlvbiBxdWFuZG8gY2lkYWTDo28gbsOjbyBleGlzdGlyIG5hIHRyYW5zYcOnw6NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBwYXJhIHZlcmlmaWNhw6fDo28gaW5pY2lhbCBkZSBwYXBlbCBleGlzdGVudGVcbiAgICAgIG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBcbiAgICAgIG1vY2tEYXRhU291cmNlLnRyYW5zYWN0aW9uLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IHtcbiAgICAgICAgICBmaW5kT25lOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobnVsbCksIC8vIENpZGFkw6NvIG7Do28gZW5jb250cmFkbyBuYSB0cmFuc2HDp8Ojb1xuICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgICAgICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG1hbmFnZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyZWF0ZShjcmVhdGVQYXBlbER0bykpLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVNYW55JywgKCkgPT4ge1xuICAgIGNvbnN0IGNpZGFkYW9JZCA9ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnO1xuICAgIGNvbnN0IHBhcGVpcyA9IFtcbiAgICAgIHtcbiAgICAgICAgdGlwb19wYXBlbDogVGlwb1BhcGVsLkJFTkVGSUNJQVJJTyxcbiAgICAgICAgbWV0YWRhZG9zOiB7fSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHRpcG9fcGFwZWw6IFRpcG9QYXBlbC5NRU1CUk9fQ09NUE9TSUNBTyxcbiAgICAgICAgbWV0YWRhZG9zOiB7fSxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIGl0KCdkZXZlIGNyaWFyIG3Dumx0aXBsb3MgcGFww6lpcyBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tEYXRhU291cmNlLnRyYW5zYWN0aW9uLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IHtcbiAgICAgICAgICBmaW5kT25lOiBqZXN0LmZuKClcbiAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobnVsbCkgLy8gUHJpbWVpcm8gcGFwZWwgbsOjbyBleGlzdGVcbiAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja0NpZGFkYW9SZXNwb25zZSkgLy8gQ2lkYWTDo28gZW5jb250cmFkbyBwYXJhIHZlcmlmaWNhw6fDo28gZGUgY29uZmxpdG9zIGRvIHByaW1laXJvIHBhcGVsXG4gICAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG51bGwpIC8vIFNlZ3VuZG8gcGFwZWwgbsOjbyBleGlzdGVcbiAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja0NpZGFkYW9SZXNwb25zZSksIC8vIENpZGFkw6NvIGVuY29udHJhZG8gcGFyYSB2ZXJpZmljYcOnw6NvIGRlIGNvbmZsaXRvcyBkbyBzZWd1bmRvIHBhcGVsXG4gICAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKFttb2NrUGFwZWxDaWRhZGFvXSksXG4gICAgICAgICAgc2F2ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFttb2NrUGFwZWxDaWRhZGFvXSksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhtYW5hZ2VyKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2lkYWRhb1NlcnZpY2UuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NpZGFkYW9SZXNwb25zZSk7XG4gICAgICBtb2NrVmVyaWZpY2FjYW9QYXBlbFNlcnZpY2UudmVyaWZpY2FyQ29uZmxpdG9QYXBlaXMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICB0ZW1Db25mbGl0bzogZmFsc2UsXG4gICAgICAgIGRldGFsaGVzOiAnJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZU1hbnkoY2lkYWRhb0lkLCBwYXBlaXMpO1xuXG4gICAgICBleHBlY3QobW9ja0NpZGFkYW9TZXJ2aWNlLmZpbmRCeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjaWRhZGFvSWQsIGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW21vY2tQYXBlbENpZGFkYW9dKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgQmFkUmVxdWVzdEV4Y2VwdGlvbiBxdWFuZG8gbGlzdGEgZXN0aXZlciB2YXppYScsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyZWF0ZU1hbnkoY2lkYWRhb0lkLCBbXSkpLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGxhbsOnYXIgQmFkUmVxdWVzdEV4Y2VwdGlvbiBxdWFuZG8gaG91dmVyIHBhcMOpaXMgZHVwbGljYWRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBhcGVpc0R1cGxpY2Fkb3MgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICB0aXBvX3BhcGVsOiBUaXBvUGFwZWwuQkVORUZJQ0lBUklPLFxuICAgICAgICAgIG1ldGFkYWRvczoge30sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB0aXBvX3BhcGVsOiBUaXBvUGFwZWwuQkVORUZJQ0lBUklPLFxuICAgICAgICAgIG1ldGFkYWRvczoge30sXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBtb2NrRGF0YVNvdXJjZS50cmFuc2FjdGlvbi5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB7XG4gICAgICAgICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgICAgICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG1hbmFnZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIG1vY2tDaWRhZGFvU2VydmljZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2lkYWRhb1Jlc3BvbnNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlTWFueShjaWRhZGFvSWQsIHBhcGVpc0R1cGxpY2Fkb3MpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbGFuw6dhciBOb3RGb3VuZEV4Y2VwdGlvbiBxdWFuZG8gY2lkYWTDo28gbsOjbyBleGlzdGlyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0RhdGFTb3VyY2UudHJhbnNhY3Rpb24ubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChjYWxsYmFjaykgPT4ge1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0ge1xuICAgICAgICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICAgICAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICAgICAgICBzYXZlOiBqZXN0LmZuKCksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhtYW5hZ2VyKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrQ2lkYWRhb1NlcnZpY2UuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmNyZWF0ZU1hbnkoY2lkYWRhb0lkLCBwYXBlaXMpKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEJ5Q2lkYWRhb0lkJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIHBhcMOpaXMgZG8gY2lkYWTDo28nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXBlaXMgPSBbbW9ja1BhcGVsQ2lkYWRhb107XG4gICAgICBtb2NrUmVwb3NpdG9yeS5maW5kLm1vY2tSZXNvbHZlZFZhbHVlKHBhcGVpcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZmluZEJ5Q2lkYWRhb0lkKCc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXBvc2l0b3J5LmZpbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgY2lkYWRhb19pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsIGF0aXZvOiB0cnVlIH0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwocGFwZWlzKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGZpbHRyYXIgcG9yIHN0YXR1cyBhdGl2byBxdWFuZG8gZXNwZWNpZmljYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFwZWlzID0gW21vY2tQYXBlbENpZGFkYW9dO1xuICAgICAgbW9ja1JlcG9zaXRvcnkuZmluZC5tb2NrUmVzb2x2ZWRWYWx1ZShwYXBlaXMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmZpbmRCeUNpZGFkYW9JZChcbiAgICAgICAgJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja1JlcG9zaXRvcnkuZmluZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNpZGFkYW9faWQ6ICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgICAgIGF0aXZvOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHBhcGVpcyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2ZXJpZmljYXJQYXBlbCcsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZXRvcm5hciB0cnVlIHF1YW5kbyBjaWRhZMOjbyBwb3NzdWlyIG8gcGFwZWwgYXRpdm8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQYXBlbENpZGFkYW8pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZlcmlmaWNhclBhcGVsKFxuICAgICAgICAnNTUwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAwJyxcbiAgICAgICAgVGlwb1BhcGVsLkJFTkVGSUNJQVJJTyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVwb3NpdG9yeS5maW5kT25lKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY2lkYWRhb19pZDogJzU1MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMCcsXG4gICAgICAgICAgdGlwb19wYXBlbDogVGlwb1BhcGVsLkJFTkVGSUNJQVJJTyxcbiAgICAgICAgICBhdGl2bzogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGZhbHNlIHF1YW5kbyBjaWRhZMOjbyBuw6NvIHBvc3N1aXIgbyBwYXBlbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudmVyaWZpY2FyUGFwZWwoXG4gICAgICAgICc1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAnLFxuICAgICAgICBUaXBvUGFwZWwuQkVORUZJQ0lBUklPLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9