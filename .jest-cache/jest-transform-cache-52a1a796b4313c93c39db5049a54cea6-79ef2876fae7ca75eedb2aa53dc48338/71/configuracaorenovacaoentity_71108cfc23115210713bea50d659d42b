9b374e6f471cbf7025d645f85524d428
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var _a, _b, _c;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfiguracaoRenovacao = void 0;
const typeorm_1 = require("typeorm");
const class_validator_1 = require("class-validator");
const tipo_beneficio_entity_1 = require("./tipo-beneficio.entity");
/**
 * Entidade de Configuração de Renovação Automática
 *
 * Armazena as configurações para renovação automática de benefícios,
 * permitindo definir regras específicas por tipo de benefício.
 */
let ConfiguracaoRenovacao = class ConfiguracaoRenovacao {
    id;
    tipo_beneficio_id;
    tipo_beneficio;
    renovacao_automatica;
    dias_antecedencia_renovacao;
    numero_maximo_renovacoes;
    requer_aprovacao_renovacao;
    ativo;
    usuario_id;
    observacoes;
    created_at;
    updated_at;
    // Getters e Setters
    get createdAt() {
        return this.created_at;
    }
    get updatedAt() {
        return this.updated_at;
    }
    // Métodos Utilitários
    /**
     * Verifica se a configuração foi criada recentemente (últimas 24 horas)
     */
    isCriadoRecentemente() {
        const agora = new Date();
        const umDiaAtras = new Date(agora.getTime() - 24 * 60 * 60 * 1000);
        return this.created_at > umDiaAtras;
    }
    /**
     * Calcula a idade do registro em dias
     */
    getIdadeRegistroEmDias() {
        const agora = new Date();
        const diffTime = Math.abs(agora.getTime() - this.created_at.getTime());
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    /**
     * Verifica se a configuração está ativa
     */
    isAtivo() {
        return this.ativo;
    }
    /**
     * Verifica se a renovação automática está habilitada
     */
    isRenovacaoAutomaticaHabilitada() {
        return this.renovacao_automatica && this.ativo;
    }
    /**
     * Verifica se requer aprovação para renovação
     */
    requerAprovacaoRenovacao() {
        return this.requer_aprovacao_renovacao;
    }
    /**
     * Verifica se tem limite de renovações
     */
    temLimiteRenovacoes() {
        return (this.numero_maximo_renovacoes !== null &&
            this.numero_maximo_renovacoes !== undefined &&
            this.numero_maximo_renovacoes > 0);
    }
    /**
     * Obtém o número máximo de renovações
     */
    getNumeroMaximoRenovacoes() {
        return this.numero_maximo_renovacoes || null;
    }
    /**
     * Obtém os dias de antecedência para renovação
     */
    getDiasAntecedenciaRenovacao() {
        return this.dias_antecedencia_renovacao;
    }
    /**
     * Calcula a data limite para iniciar o processo de renovação
     * baseado na data de vencimento do benefício
     */
    calcularDataInicioRenovacao(dataVencimento) {
        const dataInicio = new Date(dataVencimento);
        dataInicio.setDate(dataInicio.getDate() - this.dias_antecedencia_renovacao);
        return dataInicio;
    }
    /**
     * Verifica se é hora de iniciar o processo de renovação
     */
    isHoraDeRenovar(dataVencimento) {
        if (!this.isRenovacaoAutomaticaHabilitada())
            return false;
        const agora = new Date();
        const dataInicioRenovacao = this.calcularDataInicioRenovacao(dataVencimento);
        return agora >= dataInicioRenovacao;
    }
    /**
     * Verifica se ainda pode renovar baseado no limite
     */
    podeRenovar(numeroRenovacoesRealizadas) {
        if (!this.isRenovacaoAutomaticaHabilitada())
            return false;
        if (!this.temLimiteRenovacoes())
            return true;
        return (this.numero_maximo_renovacoes !== undefined &&
            numeroRenovacoesRealizadas < this.numero_maximo_renovacoes);
    }
    /**
     * Calcula quantas renovações ainda são possíveis
     */
    getRenovacoesRestantes(numeroRenovacoesRealizadas) {
        if (!this.temLimiteRenovacoes())
            return -1; // Ilimitado
        const restantes = (this.numero_maximo_renovacoes ?? 0) - numeroRenovacoesRealizadas;
        return Math.max(0, restantes);
    }
    /**
     * Verifica se pertence a um tipo de benefício
     */
    pertenceAoTipoBeneficio(tipoBeneficioId) {
        return this.tipo_beneficio_id === tipoBeneficioId;
    }
    /**
     * Verifica se foi configurado por um usuário
     */
    foiConfiguradoPorUsuario(usuarioId) {
        return this.usuario_id === usuarioId;
    }
    /**
     * Obtém um resumo da configuração
     */
    getSummary() {
        const renovacao = this.isRenovacaoAutomaticaHabilitada()
            ? 'Habilitada'
            : 'Desabilitada';
        const aprovacao = this.requerAprovacaoRenovacao()
            ? 'Requer aprovação'
            : 'Automática';
        const limite = this.temLimiteRenovacoes()
            ? `Máx: ${this.numero_maximo_renovacoes}`
            : 'Ilimitado';
        return `Renovação: ${renovacao} | ${aprovacao} | ${limite} | ${this.dias_antecedencia_renovacao} dias antecedência`;
    }
    /**
     * Gera uma chave única para a configuração
     */
    getUniqueKey() {
        return `config_renovacao_${this.tipo_beneficio_id}`;
    }
    /**
     * Verifica se a configuração é consistente
     */
    isConsistente() {
        // Verifica se tem tipo de benefício
        if (!this.tipo_beneficio_id)
            return false;
        // Verifica se tem usuário
        if (!this.usuario_id)
            return false;
        // Verifica se dias de antecedência é válido
        if (this.dias_antecedencia_renovacao < 1)
            return false;
        // Se tem limite, deve ser positivo
        if (this.temLimiteRenovacoes() &&
            this.numero_maximo_renovacoes !== undefined &&
            this.numero_maximo_renovacoes <= 0) {
            return false;
        }
        return true;
    }
    /**
     * Verifica se pode ser removida
     */
    podeSerRemovida() {
        // Pode implementar lógica adicional aqui
        // Por exemplo, verificar se tem benefícios ativos usando esta configuração
        return true;
    }
    /**
     * Clona a configuração (sem ID)
     */
    clone() {
        return {
            tipo_beneficio_id: this.tipo_beneficio_id,
            renovacao_automatica: this.renovacao_automatica,
            dias_antecedencia_renovacao: this.dias_antecedencia_renovacao,
            numero_maximo_renovacoes: this.numero_maximo_renovacoes,
            requer_aprovacao_renovacao: this.requer_aprovacao_renovacao,
            ativo: this.ativo,
            usuario_id: this.usuario_id,
            observacoes: this.observacoes,
        };
    }
    /**
     * Verifica se é uma configuração crítica
     */
    isCritica() {
        // Configurações com renovação automática sem aprovação são críticas
        return (this.isRenovacaoAutomaticaHabilitada() && !this.requerAprovacaoRenovacao());
    }
    /**
     * Obtém o nível de automação
     */
    getNivelAutomacao() {
        if (!this.renovacao_automatica)
            return 'MANUAL';
        if (this.requer_aprovacao_renovacao)
            return 'SEMI_AUTOMATICO';
        return 'AUTOMATICO';
    }
    /**
     * Obtém a descrição do nível de automação
     */
    getDescricaoNivelAutomacao() {
        const descricoes = {
            MANUAL: 'Renovação manual - requer intervenção do usuário',
            SEMI_AUTOMATICO: 'Renovação semi-automática - processo automático com aprovação',
            AUTOMATICO: 'Renovação totalmente automática - sem intervenção manual',
        };
        return descricoes[this.getNivelAutomacao()];
    }
    /**
     * Formata a data de criação
     */
    getCriacaoFormatada() {
        return this.created_at.toLocaleDateString('pt-BR');
    }
    /**
     * Formata a data de atualização
     */
    getAtualizacaoFormatada() {
        return this.updated_at.toLocaleDateString('pt-BR');
    }
    /**
     * Remove informações sensíveis para logs
     */
    toSafeLog() {
        return {
            id: this.id,
            tipo_beneficio_id: this.tipo_beneficio_id,
            renovacao_automatica: this.renovacao_automatica,
            dias_antecedencia_renovacao: this.dias_antecedencia_renovacao,
            numero_maximo_renovacoes: this.numero_maximo_renovacoes,
            requer_aprovacao_renovacao: this.requer_aprovacao_renovacao,
            ativo: this.ativo,
            created_at: this.created_at,
            updated_at: this.updated_at,
        };
    }
    /**
     * Obtém sugestões de melhoria para a configuração
     */
    getSugestoesMelhoria() {
        const sugestoes = [];
        if (!this.observacoes || this.observacoes.trim().length === 0) {
            sugestoes.push('Adicionar observações sobre a configuração');
        }
        if (this.isRenovacaoAutomaticaHabilitada() &&
            !this.requerAprovacaoRenovacao()) {
            sugestoes.push('Considerar exigir aprovação para renovações automáticas');
        }
        if (!this.temLimiteRenovacoes()) {
            sugestoes.push('Considerar definir um limite máximo de renovações');
        }
        if (this.dias_antecedencia_renovacao < 7) {
            sugestoes.push('Considerar aumentar os dias de antecedência para pelo menos 7 dias');
        }
        if (!this.isConsistente()) {
            sugestoes.push('Verificar e corrigir inconsistências nos dados');
        }
        return sugestoes;
    }
    /**
     * Verifica se precisa de atualização (dados muito antigos)
     */
    precisaAtualizacao() {
        // Configurações com mais de 1 ano podem precisar de revisão
        const umAnoAtras = new Date();
        umAnoAtras.setFullYear(umAnoAtras.getFullYear() - 1);
        return this.updated_at < umAnoAtras;
    }
    /**
     * Obtém estatísticas da configuração
     */
    getEstatisticas() {
        return {
            nivelAutomacao: this.getNivelAutomacao(),
            diasAntecedencia: this.dias_antecedencia_renovacao,
            temLimite: this.temLimiteRenovacoes(),
            limiteRenovacoes: this.getNumeroMaximoRenovacoes(),
            requerAprovacao: this.requer_aprovacao_renovacao,
            ativo: this.ativo,
        };
    }
    /**
     * Simula o processo de renovação
     */
    simularRenovacao(dataVencimento, numeroRenovacoesRealizadas) {
        const podeRenovar = this.podeRenovar(numeroRenovacoesRealizadas);
        const dataInicioRenovacao = this.calcularDataInicioRenovacao(dataVencimento);
        const renovacoesRestantes = this.getRenovacoesRestantes(numeroRenovacoesRealizadas);
        let motivo;
        if (!podeRenovar) {
            if (!this.isRenovacaoAutomaticaHabilitada()) {
                motivo = 'Renovação automática não está habilitada';
            }
            else if (this.temLimiteRenovacoes() &&
                this.numero_maximo_renovacoes !== undefined &&
                numeroRenovacoesRealizadas >= this.numero_maximo_renovacoes) {
                motivo = 'Limite máximo de renovações atingido';
            }
        }
        return {
            podeRenovar,
            dataInicioRenovacao,
            renovacoesRestantes,
            requerAprovacao: this.requer_aprovacao_renovacao,
            motivo,
        };
    }
};
exports.ConfiguracaoRenovacao = ConfiguracaoRenovacao;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], ConfiguracaoRenovacao.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'tipo_beneficio_id', type: 'uuid' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID do tipo de benefício é obrigatório' }),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do tipo de benefício inválido' }),
    __metadata("design:type", String)
], ConfiguracaoRenovacao.prototype, "tipo_beneficio_id", void 0);
__decorate([
    (0, typeorm_1.ManyToOne)(() => tipo_beneficio_entity_1.TipoBeneficio, { onDelete: 'CASCADE' }),
    (0, typeorm_1.JoinColumn)({ name: 'tipo_beneficio_id' }),
    __metadata("design:type", typeof (_a = typeof tipo_beneficio_entity_1.TipoBeneficio !== "undefined" && tipo_beneficio_entity_1.TipoBeneficio) === "function" ? _a : Object)
], ConfiguracaoRenovacao.prototype, "tipo_beneficio", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'renovacao_automatica', type: 'boolean', default: false }),
    (0, class_validator_1.IsBoolean)({ message: 'Renovação automática deve ser um booleano' }),
    __metadata("design:type", Boolean)
], ConfiguracaoRenovacao.prototype, "renovacao_automatica", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'dias_antecedencia_renovacao', type: 'integer', default: 7 }),
    (0, class_validator_1.IsNumber)({}, { message: 'Dias de antecedência deve ser um número' }),
    (0, class_validator_1.Min)(1, { message: 'Dias de antecedência deve ser no mínimo 1' }),
    __metadata("design:type", Number)
], ConfiguracaoRenovacao.prototype, "dias_antecedencia_renovacao", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'numero_maximo_renovacoes', type: 'integer', nullable: true }),
    (0, class_validator_1.IsOptional)(),
    (0, class_validator_1.IsNumber)({}, { message: 'Número máximo de renovações deve ser um número' }),
    (0, class_validator_1.Min)(0, { message: 'Número máximo de renovações não pode ser negativo' }),
    __metadata("design:type", Number)
], ConfiguracaoRenovacao.prototype, "numero_maximo_renovacoes", void 0);
__decorate([
    (0, typeorm_1.Column)({
        name: 'requer_aprovacao_renovacao',
        type: 'boolean',
        default: true,
    }),
    (0, class_validator_1.IsBoolean)({ message: 'Requer aprovação de renovação deve ser um booleano' }),
    __metadata("design:type", Boolean)
], ConfiguracaoRenovacao.prototype, "requer_aprovacao_renovacao", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'ativo', type: 'boolean', default: true }),
    (0, class_validator_1.IsBoolean)({ message: 'Ativo deve ser um booleano' }),
    __metadata("design:type", Boolean)
], ConfiguracaoRenovacao.prototype, "ativo", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'usuario_id', type: 'uuid' }),
    (0, class_validator_1.IsNotEmpty)({ message: 'ID do usuário é obrigatório' }),
    (0, class_validator_1.IsUUID)('4', { message: 'ID do usuário inválido' }),
    __metadata("design:type", String)
], ConfiguracaoRenovacao.prototype, "usuario_id", void 0);
__decorate([
    (0, typeorm_1.Column)({ name: 'observacoes', type: 'text', nullable: true }),
    (0, class_validator_1.IsOptional)(),
    __metadata("design:type", String)
], ConfiguracaoRenovacao.prototype, "observacoes", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)({ name: 'created_at' }),
    __metadata("design:type", typeof (_b = typeof Date !== "undefined" && Date) === "function" ? _b : Object)
], ConfiguracaoRenovacao.prototype, "created_at", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)({ name: 'updated_at' }),
    __metadata("design:type", typeof (_c = typeof Date !== "undefined" && Date) === "function" ? _c : Object)
], ConfiguracaoRenovacao.prototype, "updated_at", void 0);
exports.ConfiguracaoRenovacao = ConfiguracaoRenovacao = __decorate([
    (0, typeorm_1.Entity)('configuracao_renovacao'),
    (0, typeorm_1.Index)(['tipo_beneficio_id'])
], ConfiguracaoRenovacao);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXGVudGl0aWVzXFxjb25maWd1cmFjYW8tcmVub3ZhY2FvLmVudGl0eS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEscUNBU2lCO0FBQ2pCLHFEQU95QjtBQUN6QixtRUFBd0Q7QUFFeEQ7Ozs7O0dBS0c7QUFHSSxJQUFNLHFCQUFxQixHQUEzQixNQUFNLHFCQUFxQjtJQUVoQyxFQUFFLENBQVM7SUFLWCxpQkFBaUIsQ0FBUztJQUkxQixjQUFjLENBQWdCO0lBSTlCLG9CQUFvQixDQUFVO0lBSzlCLDJCQUEyQixDQUFTO0lBTXBDLHdCQUF3QixDQUFVO0lBUWxDLDBCQUEwQixDQUFVO0lBSXBDLEtBQUssQ0FBVTtJQUtmLFVBQVUsQ0FBUztJQUluQixXQUFXLENBQVU7SUFHckIsVUFBVSxDQUFPO0lBR2pCLFVBQVUsQ0FBTztJQUVqQixvQkFBb0I7SUFDcEIsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVELHNCQUFzQjtJQUV0Qjs7T0FFRztJQUNILG9CQUFvQjtRQUNsQixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUNuRSxPQUFPLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO0lBQ3RDLENBQUM7SUFFRDs7T0FFRztJQUNILHNCQUFzQjtRQUNwQixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3pCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFH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LDJCQUFTLEVBQUMsRUFBRSxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsQ0FBQzs7b0RBQ3RDO0FBS2Y7SUFIQyxJQUFBLGdCQUFNLEVBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQztJQUM1QyxJQUFBLDRCQUFVLEVBQUMsRUFBRSxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsQ0FBQztJQUN0RCxJQUFBLHdCQUFNLEVBQUMsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLENBQUM7O3lEQUNoQztBQUluQjtJQUZDLElBQUEsZ0JBQU0sRUFBQyxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDN0QsSUFBQSw0QkFBVSxHQUFFOzswREFDUTtBQUdyQjtJQURDLElBQUEsMEJBQWdCLEVBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLENBQUM7a0RBQzdCLElBQUksb0JBQUosSUFBSTt5REFBQztBQUdqQjtJQURDLElBQUEsMEJBQWdCLEVBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLENBQUM7a0RBQzdCLElBQUksb0JBQUosSUFBSTt5REFBQztnQ0FyRE4scUJBQXFCO0lBRmpDLElBQUEsZ0JBQU0sRUFBQyx3QkFBd0IsQ0FBQztJQUNoQyxJQUFBLGVBQUssRUFBQyxDQUFDLG1CQUFtQixDQUFDLENBQUM7R0FDaEIscUJBQXFCLENBbWJqQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcZW50aXRpZXNcXGNvbmZpZ3VyYWNhby1yZW5vdmFjYW8uZW50aXR5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEVudGl0eSxcbiAgUHJpbWFyeUdlbmVyYXRlZENvbHVtbixcbiAgQ29sdW1uLFxuICBDcmVhdGVEYXRlQ29sdW1uLFxuICBVcGRhdGVEYXRlQ29sdW1uLFxuICBNYW55VG9PbmUsXG4gIEpvaW5Db2x1bW4sXG4gIEluZGV4LFxufSBmcm9tICd0eXBlb3JtJztcbmltcG9ydCB7XG4gIElzTm90RW1wdHksXG4gIElzT3B0aW9uYWwsXG4gIElzQm9vbGVhbixcbiAgSXNOdW1iZXIsXG4gIE1pbixcbiAgSXNVVUlELFxufSBmcm9tICdjbGFzcy12YWxpZGF0b3InO1xuaW1wb3J0IHsgVGlwb0JlbmVmaWNpbyB9IGZyb20gJy4vdGlwby1iZW5lZmljaW8uZW50aXR5JztcblxuLyoqXG4gKiBFbnRpZGFkZSBkZSBDb25maWd1cmHDp8OjbyBkZSBSZW5vdmHDp8OjbyBBdXRvbcOhdGljYVxuICpcbiAqIEFybWF6ZW5hIGFzIGNvbmZpZ3VyYcOnw7VlcyBwYXJhIHJlbm92YcOnw6NvIGF1dG9tw6F0aWNhIGRlIGJlbmVmw61jaW9zLFxuICogcGVybWl0aW5kbyBkZWZpbmlyIHJlZ3JhcyBlc3BlY8OtZmljYXMgcG9yIHRpcG8gZGUgYmVuZWbDrWNpby5cbiAqL1xuQEVudGl0eSgnY29uZmlndXJhY2FvX3Jlbm92YWNhbycpXG5ASW5kZXgoWyd0aXBvX2JlbmVmaWNpb19pZCddKVxuZXhwb3J0IGNsYXNzIENvbmZpZ3VyYWNhb1Jlbm92YWNhbyB7XG4gIEBQcmltYXJ5R2VuZXJhdGVkQ29sdW1uKCd1dWlkJylcbiAgaWQ6IHN0cmluZztcblxuICBAQ29sdW1uKHsgbmFtZTogJ3RpcG9fYmVuZWZpY2lvX2lkJywgdHlwZTogJ3V1aWQnIH0pXG4gIEBJc05vdEVtcHR5KHsgbWVzc2FnZTogJ0lEIGRvIHRpcG8gZGUgYmVuZWbDrWNpbyDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc1VVSUQoJzQnLCB7IG1lc3NhZ2U6ICdJRCBkbyB0aXBvIGRlIGJlbmVmw61jaW8gaW52w6FsaWRvJyB9KVxuICB0aXBvX2JlbmVmaWNpb19pZDogc3RyaW5nO1xuXG4gIEBNYW55VG9PbmUoKCkgPT4gVGlwb0JlbmVmaWNpbywgeyBvbkRlbGV0ZTogJ0NBU0NBREUnIH0pXG4gIEBKb2luQ29sdW1uKHsgbmFtZTogJ3RpcG9fYmVuZWZpY2lvX2lkJyB9KVxuICB0aXBvX2JlbmVmaWNpbzogVGlwb0JlbmVmaWNpbztcblxuICBAQ29sdW1uKHsgbmFtZTogJ3Jlbm92YWNhb19hdXRvbWF0aWNhJywgdHlwZTogJ2Jvb2xlYW4nLCBkZWZhdWx0OiBmYWxzZSB9KVxuICBASXNCb29sZWFuKHsgbWVzc2FnZTogJ1Jlbm92YcOnw6NvIGF1dG9tw6F0aWNhIGRldmUgc2VyIHVtIGJvb2xlYW5vJyB9KVxuICByZW5vdmFjYW9fYXV0b21hdGljYTogYm9vbGVhbjtcblxuICBAQ29sdW1uKHsgbmFtZTogJ2RpYXNfYW50ZWNlZGVuY2lhX3Jlbm92YWNhbycsIHR5cGU6ICdpbnRlZ2VyJywgZGVmYXVsdDogNyB9KVxuICBASXNOdW1iZXIoe30sIHsgbWVzc2FnZTogJ0RpYXMgZGUgYW50ZWNlZMOqbmNpYSBkZXZlIHNlciB1bSBuw7ptZXJvJyB9KVxuICBATWluKDEsIHsgbWVzc2FnZTogJ0RpYXMgZGUgYW50ZWNlZMOqbmNpYSBkZXZlIHNlciBubyBtw61uaW1vIDEnIH0pXG4gIGRpYXNfYW50ZWNlZGVuY2lhX3Jlbm92YWNhbzogbnVtYmVyO1xuXG4gIEBDb2x1bW4oeyBuYW1lOiAnbnVtZXJvX21heGltb19yZW5vdmFjb2VzJywgdHlwZTogJ2ludGVnZXInLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIEBJc051bWJlcih7fSwgeyBtZXNzYWdlOiAnTsO6bWVybyBtw6F4aW1vIGRlIHJlbm92YcOnw7VlcyBkZXZlIHNlciB1bSBuw7ptZXJvJyB9KVxuICBATWluKDAsIHsgbWVzc2FnZTogJ07Dum1lcm8gbcOheGltbyBkZSByZW5vdmHDp8O1ZXMgbsOjbyBwb2RlIHNlciBuZWdhdGl2bycgfSlcbiAgbnVtZXJvX21heGltb19yZW5vdmFjb2VzPzogbnVtYmVyO1xuXG4gIEBDb2x1bW4oe1xuICAgIG5hbWU6ICdyZXF1ZXJfYXByb3ZhY2FvX3Jlbm92YWNhbycsXG4gICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIGRlZmF1bHQ6IHRydWUsXG4gIH0pXG4gIEBJc0Jvb2xlYW4oeyBtZXNzYWdlOiAnUmVxdWVyIGFwcm92YcOnw6NvIGRlIHJlbm92YcOnw6NvIGRldmUgc2VyIHVtIGJvb2xlYW5vJyB9KVxuICByZXF1ZXJfYXByb3ZhY2FvX3Jlbm92YWNhbzogYm9vbGVhbjtcblxuICBAQ29sdW1uKHsgbmFtZTogJ2F0aXZvJywgdHlwZTogJ2Jvb2xlYW4nLCBkZWZhdWx0OiB0cnVlIH0pXG4gIEBJc0Jvb2xlYW4oeyBtZXNzYWdlOiAnQXRpdm8gZGV2ZSBzZXIgdW0gYm9vbGVhbm8nIH0pXG4gIGF0aXZvOiBib29sZWFuO1xuXG4gIEBDb2x1bW4oeyBuYW1lOiAndXN1YXJpb19pZCcsIHR5cGU6ICd1dWlkJyB9KVxuICBASXNOb3RFbXB0eSh7IG1lc3NhZ2U6ICdJRCBkbyB1c3XDoXJpbyDDqSBvYnJpZ2F0w7NyaW8nIH0pXG4gIEBJc1VVSUQoJzQnLCB7IG1lc3NhZ2U6ICdJRCBkbyB1c3XDoXJpbyBpbnbDoWxpZG8nIH0pXG4gIHVzdWFyaW9faWQ6IHN0cmluZztcblxuICBAQ29sdW1uKHsgbmFtZTogJ29ic2VydmFjb2VzJywgdHlwZTogJ3RleHQnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBASXNPcHRpb25hbCgpXG4gIG9ic2VydmFjb2VzPzogc3RyaW5nO1xuXG4gIEBDcmVhdGVEYXRlQ29sdW1uKHsgbmFtZTogJ2NyZWF0ZWRfYXQnIH0pXG4gIGNyZWF0ZWRfYXQ6IERhdGU7XG5cbiAgQFVwZGF0ZURhdGVDb2x1bW4oeyBuYW1lOiAndXBkYXRlZF9hdCcgfSlcbiAgdXBkYXRlZF9hdDogRGF0ZTtcblxuICAvLyBHZXR0ZXJzIGUgU2V0dGVyc1xuICBnZXQgY3JlYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQ7XG4gIH1cblxuICBnZXQgdXBkYXRlZEF0KCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZWRfYXQ7XG4gIH1cblxuICAvLyBNw6l0b2RvcyBVdGlsaXTDoXJpb3NcblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBjb25maWd1cmHDp8OjbyBmb2kgY3JpYWRhIHJlY2VudGVtZW50ZSAow7psdGltYXMgMjQgaG9yYXMpXG4gICAqL1xuICBpc0NyaWFkb1JlY2VudGVtZW50ZSgpOiBib29sZWFuIHtcbiAgICBjb25zdCBhZ29yYSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgdW1EaWFBdHJhcyA9IG5ldyBEYXRlKGFnb3JhLmdldFRpbWUoKSAtIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQgPiB1bURpYUF0cmFzO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgYSBpZGFkZSBkbyByZWdpc3RybyBlbSBkaWFzXG4gICAqL1xuICBnZXRJZGFkZVJlZ2lzdHJvRW1EaWFzKCk6IG51bWJlciB7XG4gICAgY29uc3QgYWdvcmEgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRpZmZUaW1lID0gTWF0aC5hYnMoYWdvcmEuZ2V0VGltZSgpIC0gdGhpcy5jcmVhdGVkX2F0LmdldFRpbWUoKSk7XG4gICAgcmV0dXJuIE1hdGguY2VpbChkaWZmVGltZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgYSBjb25maWd1cmHDp8OjbyBlc3TDoSBhdGl2YVxuICAgKi9cbiAgaXNBdGl2bygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5hdGl2bztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBhIHJlbm92YcOnw6NvIGF1dG9tw6F0aWNhIGVzdMOhIGhhYmlsaXRhZGFcbiAgICovXG4gIGlzUmVub3ZhY2FvQXV0b21hdGljYUhhYmlsaXRhZGEoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucmVub3ZhY2FvX2F1dG9tYXRpY2EgJiYgdGhpcy5hdGl2bztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSByZXF1ZXIgYXByb3Zhw6fDo28gcGFyYSByZW5vdmHDp8Ojb1xuICAgKi9cbiAgcmVxdWVyQXByb3ZhY2FvUmVub3ZhY2FvKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnJlcXVlcl9hcHJvdmFjYW9fcmVub3ZhY2FvO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHRlbSBsaW1pdGUgZGUgcmVub3Zhw6fDtWVzXG4gICAqL1xuICB0ZW1MaW1pdGVSZW5vdmFjb2VzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLm51bWVyb19tYXhpbW9fcmVub3ZhY29lcyAhPT0gbnVsbCAmJlxuICAgICAgdGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXMgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgdGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXMgPiAwXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gbyBuw7ptZXJvIG3DoXhpbW8gZGUgcmVub3Zhw6fDtWVzXG4gICAqL1xuICBnZXROdW1lcm9NYXhpbW9SZW5vdmFjb2VzKCk6IG51bWJlciB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLm51bWVyb19tYXhpbW9fcmVub3ZhY29lcyB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBvcyBkaWFzIGRlIGFudGVjZWTDqm5jaWEgcGFyYSByZW5vdmHDp8Ojb1xuICAgKi9cbiAgZ2V0RGlhc0FudGVjZWRlbmNpYVJlbm92YWNhbygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmRpYXNfYW50ZWNlZGVuY2lhX3Jlbm92YWNhbztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGEgZGF0YSBsaW1pdGUgcGFyYSBpbmljaWFyIG8gcHJvY2Vzc28gZGUgcmVub3Zhw6fDo29cbiAgICogYmFzZWFkbyBuYSBkYXRhIGRlIHZlbmNpbWVudG8gZG8gYmVuZWbDrWNpb1xuICAgKi9cbiAgY2FsY3VsYXJEYXRhSW5pY2lvUmVub3ZhY2FvKGRhdGFWZW5jaW1lbnRvOiBEYXRlKTogRGF0ZSB7XG4gICAgY29uc3QgZGF0YUluaWNpbyA9IG5ldyBEYXRlKGRhdGFWZW5jaW1lbnRvKTtcbiAgICBkYXRhSW5pY2lvLnNldERhdGUoZGF0YUluaWNpby5nZXREYXRlKCkgLSB0aGlzLmRpYXNfYW50ZWNlZGVuY2lhX3Jlbm92YWNhbyk7XG4gICAgcmV0dXJuIGRhdGFJbmljaW87XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgaG9yYSBkZSBpbmljaWFyIG8gcHJvY2Vzc28gZGUgcmVub3Zhw6fDo29cbiAgICovXG4gIGlzSG9yYURlUmVub3ZhcihkYXRhVmVuY2ltZW50bzogRGF0ZSk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5pc1Jlbm92YWNhb0F1dG9tYXRpY2FIYWJpbGl0YWRhKCkpIHJldHVybiBmYWxzZTtcblxuICAgIGNvbnN0IGFnb3JhID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBkYXRhSW5pY2lvUmVub3ZhY2FvID1cbiAgICAgIHRoaXMuY2FsY3VsYXJEYXRhSW5pY2lvUmVub3ZhY2FvKGRhdGFWZW5jaW1lbnRvKTtcblxuICAgIHJldHVybiBhZ29yYSA+PSBkYXRhSW5pY2lvUmVub3ZhY2FvO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGFpbmRhIHBvZGUgcmVub3ZhciBiYXNlYWRvIG5vIGxpbWl0ZVxuICAgKi9cbiAgcG9kZVJlbm92YXIobnVtZXJvUmVub3ZhY29lc1JlYWxpemFkYXM6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5pc1Jlbm92YWNhb0F1dG9tYXRpY2FIYWJpbGl0YWRhKCkpIHJldHVybiBmYWxzZTtcblxuICAgIGlmICghdGhpcy50ZW1MaW1pdGVSZW5vdmFjb2VzKCkpIHJldHVybiB0cnVlO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMubnVtZXJvX21heGltb19yZW5vdmFjb2VzICE9PSB1bmRlZmluZWQgJiZcbiAgICAgIG51bWVyb1Jlbm92YWNvZXNSZWFsaXphZGFzIDwgdGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXNcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgcXVhbnRhcyByZW5vdmHDp8O1ZXMgYWluZGEgc8OjbyBwb3Nzw612ZWlzXG4gICAqL1xuICBnZXRSZW5vdmFjb2VzUmVzdGFudGVzKG51bWVyb1Jlbm92YWNvZXNSZWFsaXphZGFzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy50ZW1MaW1pdGVSZW5vdmFjb2VzKCkpIHJldHVybiAtMTsgLy8gSWxpbWl0YWRvXG5cbiAgICBjb25zdCByZXN0YW50ZXMgPVxuICAgICAgKHRoaXMubnVtZXJvX21heGltb19yZW5vdmFjb2VzID8/IDApIC0gbnVtZXJvUmVub3ZhY29lc1JlYWxpemFkYXM7XG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIHJlc3RhbnRlcyk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2UgcGVydGVuY2UgYSB1bSB0aXBvIGRlIGJlbmVmw61jaW9cbiAgICovXG4gIHBlcnRlbmNlQW9UaXBvQmVuZWZpY2lvKHRpcG9CZW5lZmljaW9JZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudGlwb19iZW5lZmljaW9faWQgPT09IHRpcG9CZW5lZmljaW9JZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBmb2kgY29uZmlndXJhZG8gcG9yIHVtIHVzdcOhcmlvXG4gICAqL1xuICBmb2lDb25maWd1cmFkb1BvclVzdWFyaW8odXN1YXJpb0lkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy51c3VhcmlvX2lkID09PSB1c3VhcmlvSWQ7XG4gIH1cblxuICAvKipcbiAgICogT2J0w6ltIHVtIHJlc3VtbyBkYSBjb25maWd1cmHDp8Ojb1xuICAgKi9cbiAgZ2V0U3VtbWFyeSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlbm92YWNhbyA9IHRoaXMuaXNSZW5vdmFjYW9BdXRvbWF0aWNhSGFiaWxpdGFkYSgpXG4gICAgICA/ICdIYWJpbGl0YWRhJ1xuICAgICAgOiAnRGVzYWJpbGl0YWRhJztcbiAgICBjb25zdCBhcHJvdmFjYW8gPSB0aGlzLnJlcXVlckFwcm92YWNhb1Jlbm92YWNhbygpXG4gICAgICA/ICdSZXF1ZXIgYXByb3Zhw6fDo28nXG4gICAgICA6ICdBdXRvbcOhdGljYSc7XG4gICAgY29uc3QgbGltaXRlID0gdGhpcy50ZW1MaW1pdGVSZW5vdmFjb2VzKClcbiAgICAgID8gYE3DoXg6ICR7dGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXN9YFxuICAgICAgOiAnSWxpbWl0YWRvJztcblxuICAgIHJldHVybiBgUmVub3Zhw6fDo286ICR7cmVub3ZhY2FvfSB8ICR7YXByb3ZhY2FvfSB8ICR7bGltaXRlfSB8ICR7dGhpcy5kaWFzX2FudGVjZWRlbmNpYV9yZW5vdmFjYW99IGRpYXMgYW50ZWNlZMOqbmNpYWA7XG4gIH1cblxuICAvKipcbiAgICogR2VyYSB1bWEgY2hhdmUgw7puaWNhIHBhcmEgYSBjb25maWd1cmHDp8Ojb1xuICAgKi9cbiAgZ2V0VW5pcXVlS2V5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBjb25maWdfcmVub3ZhY2FvXyR7dGhpcy50aXBvX2JlbmVmaWNpb19pZH1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIGEgY29uZmlndXJhw6fDo28gw6kgY29uc2lzdGVudGVcbiAgICovXG4gIGlzQ29uc2lzdGVudGUoKTogYm9vbGVhbiB7XG4gICAgLy8gVmVyaWZpY2Egc2UgdGVtIHRpcG8gZGUgYmVuZWbDrWNpb1xuICAgIGlmICghdGhpcy50aXBvX2JlbmVmaWNpb19pZCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gVmVyaWZpY2Egc2UgdGVtIHVzdcOhcmlvXG4gICAgaWYgKCF0aGlzLnVzdWFyaW9faWQpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIFZlcmlmaWNhIHNlIGRpYXMgZGUgYW50ZWNlZMOqbmNpYSDDqSB2w6FsaWRvXG4gICAgaWYgKHRoaXMuZGlhc19hbnRlY2VkZW5jaWFfcmVub3ZhY2FvIDwgMSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gU2UgdGVtIGxpbWl0ZSwgZGV2ZSBzZXIgcG9zaXRpdm9cbiAgICBpZiAoXG4gICAgICB0aGlzLnRlbUxpbWl0ZVJlbm92YWNvZXMoKSAmJlxuICAgICAgdGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXMgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgdGhpcy5udW1lcm9fbWF4aW1vX3Jlbm92YWNvZXMgPD0gMFxuICAgICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhIHNlIHBvZGUgc2VyIHJlbW92aWRhXG4gICAqL1xuICBwb2RlU2VyUmVtb3ZpZGEoKTogYm9vbGVhbiB7XG4gICAgLy8gUG9kZSBpbXBsZW1lbnRhciBsw7NnaWNhIGFkaWNpb25hbCBhcXVpXG4gICAgLy8gUG9yIGV4ZW1wbG8sIHZlcmlmaWNhciBzZSB0ZW0gYmVuZWbDrWNpb3MgYXRpdm9zIHVzYW5kbyBlc3RhIGNvbmZpZ3VyYcOnw6NvXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogQ2xvbmEgYSBjb25maWd1cmHDp8OjbyAoc2VtIElEKVxuICAgKi9cbiAgY2xvbmUoKTogUGFydGlhbDxDb25maWd1cmFjYW9SZW5vdmFjYW8+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdGlwb19iZW5lZmljaW9faWQ6IHRoaXMudGlwb19iZW5lZmljaW9faWQsXG4gICAgICByZW5vdmFjYW9fYXV0b21hdGljYTogdGhpcy5yZW5vdmFjYW9fYXV0b21hdGljYSxcbiAgICAgIGRpYXNfYW50ZWNlZGVuY2lhX3Jlbm92YWNhbzogdGhpcy5kaWFzX2FudGVjZWRlbmNpYV9yZW5vdmFjYW8sXG4gICAgICBudW1lcm9fbWF4aW1vX3Jlbm92YWNvZXM6IHRoaXMubnVtZXJvX21heGltb19yZW5vdmFjb2VzLFxuICAgICAgcmVxdWVyX2Fwcm92YWNhb19yZW5vdmFjYW86IHRoaXMucmVxdWVyX2Fwcm92YWNhb19yZW5vdmFjYW8sXG4gICAgICBhdGl2bzogdGhpcy5hdGl2byxcbiAgICAgIHVzdWFyaW9faWQ6IHRoaXMudXN1YXJpb19pZCxcbiAgICAgIG9ic2VydmFjb2VzOiB0aGlzLm9ic2VydmFjb2VzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2Ugw6kgdW1hIGNvbmZpZ3VyYcOnw6NvIGNyw610aWNhXG4gICAqL1xuICBpc0NyaXRpY2EoKTogYm9vbGVhbiB7XG4gICAgLy8gQ29uZmlndXJhw6fDtWVzIGNvbSByZW5vdmHDp8OjbyBhdXRvbcOhdGljYSBzZW0gYXByb3Zhw6fDo28gc8OjbyBjcsOtdGljYXNcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5pc1Jlbm92YWNhb0F1dG9tYXRpY2FIYWJpbGl0YWRhKCkgJiYgIXRoaXMucmVxdWVyQXByb3ZhY2FvUmVub3ZhY2FvKClcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBvIG7DrXZlbCBkZSBhdXRvbWHDp8Ojb1xuICAgKi9cbiAgZ2V0Tml2ZWxBdXRvbWFjYW8oKTogJ01BTlVBTCcgfCAnU0VNSV9BVVRPTUFUSUNPJyB8ICdBVVRPTUFUSUNPJyB7XG4gICAgaWYgKCF0aGlzLnJlbm92YWNhb19hdXRvbWF0aWNhKSByZXR1cm4gJ01BTlVBTCc7XG4gICAgaWYgKHRoaXMucmVxdWVyX2Fwcm92YWNhb19yZW5vdmFjYW8pIHJldHVybiAnU0VNSV9BVVRPTUFUSUNPJztcbiAgICByZXR1cm4gJ0FVVE9NQVRJQ08nO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idMOpbSBhIGRlc2NyacOnw6NvIGRvIG7DrXZlbCBkZSBhdXRvbWHDp8Ojb1xuICAgKi9cbiAgZ2V0RGVzY3JpY2FvTml2ZWxBdXRvbWFjYW8oKTogc3RyaW5nIHtcbiAgICBjb25zdCBkZXNjcmljb2VzID0ge1xuICAgICAgTUFOVUFMOiAnUmVub3Zhw6fDo28gbWFudWFsIC0gcmVxdWVyIGludGVydmVuw6fDo28gZG8gdXN1w6FyaW8nLFxuICAgICAgU0VNSV9BVVRPTUFUSUNPOlxuICAgICAgICAnUmVub3Zhw6fDo28gc2VtaS1hdXRvbcOhdGljYSAtIHByb2Nlc3NvIGF1dG9tw6F0aWNvIGNvbSBhcHJvdmHDp8OjbycsXG4gICAgICBBVVRPTUFUSUNPOiAnUmVub3Zhw6fDo28gdG90YWxtZW50ZSBhdXRvbcOhdGljYSAtIHNlbSBpbnRlcnZlbsOnw6NvIG1hbnVhbCcsXG4gICAgfTtcbiAgICByZXR1cm4gZGVzY3JpY29lc1t0aGlzLmdldE5pdmVsQXV0b21hY2FvKCldO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1hdGEgYSBkYXRhIGRlIGNyaWHDp8Ojb1xuICAgKi9cbiAgZ2V0Q3JpYWNhb0Zvcm1hdGFkYSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZWRfYXQudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcm1hdGEgYSBkYXRhIGRlIGF0dWFsaXphw6fDo29cbiAgICovXG4gIGdldEF0dWFsaXphY2FvRm9ybWF0YWRhKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlZF9hdC50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJyk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGluZm9ybWHDp8O1ZXMgc2Vuc8OtdmVpcyBwYXJhIGxvZ3NcbiAgICovXG4gIHRvU2FmZUxvZygpOiBQYXJ0aWFsPENvbmZpZ3VyYWNhb1Jlbm92YWNhbz4ge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCxcbiAgICAgIHRpcG9fYmVuZWZpY2lvX2lkOiB0aGlzLnRpcG9fYmVuZWZpY2lvX2lkLFxuICAgICAgcmVub3ZhY2FvX2F1dG9tYXRpY2E6IHRoaXMucmVub3ZhY2FvX2F1dG9tYXRpY2EsXG4gICAgICBkaWFzX2FudGVjZWRlbmNpYV9yZW5vdmFjYW86IHRoaXMuZGlhc19hbnRlY2VkZW5jaWFfcmVub3ZhY2FvLFxuICAgICAgbnVtZXJvX21heGltb19yZW5vdmFjb2VzOiB0aGlzLm51bWVyb19tYXhpbW9fcmVub3ZhY29lcyxcbiAgICAgIHJlcXVlcl9hcHJvdmFjYW9fcmVub3ZhY2FvOiB0aGlzLnJlcXVlcl9hcHJvdmFjYW9fcmVub3ZhY2FvLFxuICAgICAgYXRpdm86IHRoaXMuYXRpdm8sXG4gICAgICBjcmVhdGVkX2F0OiB0aGlzLmNyZWF0ZWRfYXQsXG4gICAgICB1cGRhdGVkX2F0OiB0aGlzLnVwZGF0ZWRfYXQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gc3VnZXN0w7VlcyBkZSBtZWxob3JpYSBwYXJhIGEgY29uZmlndXJhw6fDo29cbiAgICovXG4gIGdldFN1Z2VzdG9lc01lbGhvcmlhKCk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdWdlc3RvZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoIXRoaXMub2JzZXJ2YWNvZXMgfHwgdGhpcy5vYnNlcnZhY29lcy50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdlc3RvZXMucHVzaCgnQWRpY2lvbmFyIG9ic2VydmHDp8O1ZXMgc29icmUgYSBjb25maWd1cmHDp8OjbycpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIHRoaXMuaXNSZW5vdmFjYW9BdXRvbWF0aWNhSGFiaWxpdGFkYSgpICYmXG4gICAgICAhdGhpcy5yZXF1ZXJBcHJvdmFjYW9SZW5vdmFjYW8oKVxuICAgICkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ0NvbnNpZGVyYXIgZXhpZ2lyIGFwcm92YcOnw6NvIHBhcmEgcmVub3Zhw6fDtWVzIGF1dG9tw6F0aWNhcycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy50ZW1MaW1pdGVSZW5vdmFjb2VzKCkpIHtcbiAgICAgIHN1Z2VzdG9lcy5wdXNoKCdDb25zaWRlcmFyIGRlZmluaXIgdW0gbGltaXRlIG3DoXhpbW8gZGUgcmVub3Zhw6fDtWVzJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGlhc19hbnRlY2VkZW5jaWFfcmVub3ZhY2FvIDwgNykge1xuICAgICAgc3VnZXN0b2VzLnB1c2goXG4gICAgICAgICdDb25zaWRlcmFyIGF1bWVudGFyIG9zIGRpYXMgZGUgYW50ZWNlZMOqbmNpYSBwYXJhIHBlbG8gbWVub3MgNyBkaWFzJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmlzQ29uc2lzdGVudGUoKSkge1xuICAgICAgc3VnZXN0b2VzLnB1c2goJ1ZlcmlmaWNhciBlIGNvcnJpZ2lyIGluY29uc2lzdMOqbmNpYXMgbm9zIGRhZG9zJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Z2VzdG9lcztcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYSBzZSBwcmVjaXNhIGRlIGF0dWFsaXphw6fDo28gKGRhZG9zIG11aXRvIGFudGlnb3MpXG4gICAqL1xuICBwcmVjaXNhQXR1YWxpemFjYW8oKTogYm9vbGVhbiB7XG4gICAgLy8gQ29uZmlndXJhw6fDtWVzIGNvbSBtYWlzIGRlIDEgYW5vIHBvZGVtIHByZWNpc2FyIGRlIHJldmlzw6NvXG4gICAgY29uc3QgdW1Bbm9BdHJhcyA9IG5ldyBEYXRlKCk7XG4gICAgdW1Bbm9BdHJhcy5zZXRGdWxsWWVhcih1bUFub0F0cmFzLmdldEZ1bGxZZWFyKCkgLSAxKTtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVkX2F0IDwgdW1Bbm9BdHJhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnTDqW0gZXN0YXTDrXN0aWNhcyBkYSBjb25maWd1cmHDp8Ojb1xuICAgKi9cbiAgZ2V0RXN0YXRpc3RpY2FzKCk6IHtcbiAgICBuaXZlbEF1dG9tYWNhbzogc3RyaW5nO1xuICAgIGRpYXNBbnRlY2VkZW5jaWE6IG51bWJlcjtcbiAgICB0ZW1MaW1pdGU6IGJvb2xlYW47XG4gICAgbGltaXRlUmVub3ZhY29lczogbnVtYmVyIHwgbnVsbDtcbiAgICByZXF1ZXJBcHJvdmFjYW86IGJvb2xlYW47XG4gICAgYXRpdm86IGJvb2xlYW47XG4gIH0ge1xuICAgIHJldHVybiB7XG4gICAgICBuaXZlbEF1dG9tYWNhbzogdGhpcy5nZXROaXZlbEF1dG9tYWNhbygpLFxuICAgICAgZGlhc0FudGVjZWRlbmNpYTogdGhpcy5kaWFzX2FudGVjZWRlbmNpYV9yZW5vdmFjYW8sXG4gICAgICB0ZW1MaW1pdGU6IHRoaXMudGVtTGltaXRlUmVub3ZhY29lcygpLFxuICAgICAgbGltaXRlUmVub3ZhY29lczogdGhpcy5nZXROdW1lcm9NYXhpbW9SZW5vdmFjb2VzKCksXG4gICAgICByZXF1ZXJBcHJvdmFjYW86IHRoaXMucmVxdWVyX2Fwcm92YWNhb19yZW5vdmFjYW8sXG4gICAgICBhdGl2bzogdGhpcy5hdGl2byxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFNpbXVsYSBvIHByb2Nlc3NvIGRlIHJlbm92YcOnw6NvXG4gICAqL1xuICBzaW11bGFyUmVub3ZhY2FvKFxuICAgIGRhdGFWZW5jaW1lbnRvOiBEYXRlLFxuICAgIG51bWVyb1Jlbm92YWNvZXNSZWFsaXphZGFzOiBudW1iZXIsXG4gICk6IHtcbiAgICBwb2RlUmVub3ZhcjogYm9vbGVhbjtcbiAgICBkYXRhSW5pY2lvUmVub3ZhY2FvOiBEYXRlO1xuICAgIHJlbm92YWNvZXNSZXN0YW50ZXM6IG51bWJlcjtcbiAgICByZXF1ZXJBcHJvdmFjYW86IGJvb2xlYW47XG4gICAgbW90aXZvPzogc3RyaW5nO1xuICB9IHtcbiAgICBjb25zdCBwb2RlUmVub3ZhciA9IHRoaXMucG9kZVJlbm92YXIobnVtZXJvUmVub3ZhY29lc1JlYWxpemFkYXMpO1xuICAgIGNvbnN0IGRhdGFJbmljaW9SZW5vdmFjYW8gPVxuICAgICAgdGhpcy5jYWxjdWxhckRhdGFJbmljaW9SZW5vdmFjYW8oZGF0YVZlbmNpbWVudG8pO1xuICAgIGNvbnN0IHJlbm92YWNvZXNSZXN0YW50ZXMgPSB0aGlzLmdldFJlbm92YWNvZXNSZXN0YW50ZXMoXG4gICAgICBudW1lcm9SZW5vdmFjb2VzUmVhbGl6YWRhcyxcbiAgICApO1xuXG4gICAgbGV0IG1vdGl2bzogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIGlmICghcG9kZVJlbm92YXIpIHtcbiAgICAgIGlmICghdGhpcy5pc1Jlbm92YWNhb0F1dG9tYXRpY2FIYWJpbGl0YWRhKCkpIHtcbiAgICAgICAgbW90aXZvID0gJ1Jlbm92YcOnw6NvIGF1dG9tw6F0aWNhIG7Do28gZXN0w6EgaGFiaWxpdGFkYSc7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICB0aGlzLnRlbUxpbWl0ZVJlbm92YWNvZXMoKSAmJlxuICAgICAgICB0aGlzLm51bWVyb19tYXhpbW9fcmVub3ZhY29lcyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIG51bWVyb1Jlbm92YWNvZXNSZWFsaXphZGFzID49IHRoaXMubnVtZXJvX21heGltb19yZW5vdmFjb2VzXG4gICAgICApIHtcbiAgICAgICAgbW90aXZvID0gJ0xpbWl0ZSBtw6F4aW1vIGRlIHJlbm92YcOnw7VlcyBhdGluZ2lkbyc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBvZGVSZW5vdmFyLFxuICAgICAgZGF0YUluaWNpb1Jlbm92YWNhbyxcbiAgICAgIHJlbm92YWNvZXNSZXN0YW50ZXMsXG4gICAgICByZXF1ZXJBcHJvdmFjYW86IHRoaXMucmVxdWVyX2Fwcm92YWNhb19yZW5vdmFjYW8sXG4gICAgICBtb3Rpdm8sXG4gICAgfTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9