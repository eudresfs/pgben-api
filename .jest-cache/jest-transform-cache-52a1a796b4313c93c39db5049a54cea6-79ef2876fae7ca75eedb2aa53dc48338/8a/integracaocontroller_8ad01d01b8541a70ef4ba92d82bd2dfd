20b86024e9237a7668e30b21d76e8acc
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;
Object.defineProperty(exports, "__esModule", { value: true });
exports.IntegracaoController = void 0;
const common_1 = require("@nestjs/common");
const swagger_1 = require("@nestjs/swagger");
const integracao_service_1 = require("../services/integracao.service");
const integracao_update_dto_1 = require("../dtos/integracao/integracao-update.dto");
const integracao_test_dto_1 = require("../dtos/integracao/integracao-test.dto");
const integracao_response_dto_1 = require("../dtos/integracao/integracao-response.dto");
const integracao_tipo_enum_1 = require("../../../enums/integracao-tipo.enum");
const exceptions_1 = require("../../../shared/exceptions");
/**
 * Controlador responsável pelas operações de configurações de integração externa
 */
let IntegracaoController = class IntegracaoController {
    integracaoService;
    constructor(integracaoService) {
        this.integracaoService = integracaoService;
    }
    /**
     * Busca todas as configurações de integração
     * @param tipo Tipo opcional para filtrar
     * @returns Lista de configurações
     */
    async buscarTodas(tipo) {
        return this.integracaoService.buscarTodas(tipo);
    }
    /**
     * Busca uma configuração de integração específica por seu código
     * @param codigo Código da configuração
     * @returns Configuração encontrada
     */
    async buscarPorCodigo(codigo) {
        return this.integracaoService.buscarPorCodigo(codigo);
    }
    /**
     * Cria ou atualiza uma configuração de integração
     * @param codigo Código da configuração
     * @param dto Dados para atualização
     * @returns Configuração atualizada
     */
    async atualizarOuCriar(codigo, dto) {
        return this.integracaoService.atualizarOuCriar(codigo, dto);
    }
    /**
     * Remove uma configuração de integração
     * @param codigo Código da configuração
     */
    async remover(codigo) {
        await this.integracaoService.remover(codigo);
    }
    /**
     * Testa uma configuração de integração
     * @param dto Dados para teste da configuração
     * @returns Resultado do teste
     */
    async testar(dto) {
        return this.integracaoService.testar(dto);
    }
    /**
     * Ativa ou desativa uma configuração de integração
     * @param codigo Código da configuração
     * @param ativo Status de ativação
     * @returns Configuração atualizada
     */
    async alterarStatus(codigo, { ativo }) {
        return this.integracaoService.alterarStatus(codigo, ativo);
    }
    /**
     * Busca a configuração ativa para um determinado tipo de integração
     * @param tipo Tipo da integração
     * @returns Configuração ativa ou null
     */
    async buscarConfigAtiva(tipo) {
        const config = await this.integracaoService.buscarConfigAtiva(tipo);
        if (!config) {
            throw new exceptions_1.EntityNotFoundException('Configuração de integração', tipo, 'tipo');
        }
        return config;
    }
};
exports.IntegracaoController = IntegracaoController;
__decorate([
    (0, common_1.Get)(),
    (0, swagger_1.ApiOperation)({ summary: 'Buscar todas as configurações de integração' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Lista de configurações encontradas',
        type: [integracao_response_dto_1.IntegracaoResponseDto],
    }),
    __param(0, (0, common_1.Query)('tipo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_b = typeof integracao_tipo_enum_1.IntegracaoTipoEnum !== "undefined" && integracao_tipo_enum_1.IntegracaoTipoEnum) === "function" ? _b : Object]),
    __metadata("design:returntype", typeof (_c = typeof Promise !== "undefined" && Promise) === "function" ? _c : Object)
], IntegracaoController.prototype, "buscarTodas", null);
__decorate([
    (0, common_1.Get)(':codigo'),
    (0, swagger_1.ApiOperation)({ summary: 'Buscar configuração de integração por código' }),
    (0, swagger_1.ApiParam)({
        name: 'codigo',
        description: 'Código único da configuração',
        example: 'smtp-principal',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração encontrada',
        type: integracao_response_dto_1.IntegracaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Configuração não encontrada',
    }),
    __param(0, (0, common_1.Param)('codigo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_d = typeof Promise !== "undefined" && Promise) === "function" ? _d : Object)
], IntegracaoController.prototype, "buscarPorCodigo", null);
__decorate([
    (0, common_1.Put)(':codigo'),
    (0, swagger_1.ApiOperation)({ summary: 'Criar ou atualizar configuração de integração' }),
    (0, swagger_1.ApiParam)({
        name: 'codigo',
        description: 'Código único da configuração',
        example: 'smtp-principal',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração criada/atualizada com sucesso',
        type: integracao_response_dto_1.IntegracaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Dados inválidos',
    }),
    __param(0, (0, common_1.Param)('codigo')),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_e = typeof integracao_update_dto_1.IntegracaoUpdateDto !== "undefined" && integracao_update_dto_1.IntegracaoUpdateDto) === "function" ? _e : Object]),
    __metadata("design:returntype", typeof (_f = typeof Promise !== "undefined" && Promise) === "function" ? _f : Object)
], IntegracaoController.prototype, "atualizarOuCriar", null);
__decorate([
    (0, common_1.Delete)(':codigo'),
    (0, swagger_1.ApiOperation)({ summary: 'Remover configuração de integração' }),
    (0, swagger_1.ApiParam)({
        name: 'codigo',
        description: 'Código único da configuração',
        example: 'smtp-principal',
    }),
    (0, swagger_1.ApiResponse)({
        status: 204,
        description: 'Configuração removida com sucesso',
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Configuração não encontrada',
    }),
    __param(0, (0, common_1.Param)('codigo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", typeof (_g = typeof Promise !== "undefined" && Promise) === "function" ? _g : Object)
], IntegracaoController.prototype, "remover", null);
__decorate([
    (0, common_1.Post)('testar'),
    (0, swagger_1.ApiOperation)({ summary: 'Testar configuração de integração' }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Teste executado com sucesso',
        schema: {
            type: 'object',
            properties: {
                sucesso: {
                    type: 'boolean',
                    description: 'Indica se o teste foi bem-sucedido',
                },
                mensagem: {
                    type: 'string',
                    description: 'Mensagem detalhada do resultado do teste',
                },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Dados inválidos ou erro no teste',
    }),
    __param(0, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_h = typeof integracao_test_dto_1.IntegracaoTestDto !== "undefined" && integracao_test_dto_1.IntegracaoTestDto) === "function" ? _h : Object]),
    __metadata("design:returntype", typeof (_j = typeof Promise !== "undefined" && Promise) === "function" ? _j : Object)
], IntegracaoController.prototype, "testar", null);
__decorate([
    (0, common_1.Put)(':codigo/status'),
    (0, swagger_1.ApiOperation)({ summary: 'Ativar ou desativar configuração de integração' }),
    (0, swagger_1.ApiParam)({
        name: 'codigo',
        description: 'Código único da configuração',
        example: 'smtp-principal',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Status da configuração atualizado com sucesso',
        type: integracao_response_dto_1.IntegracaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Configuração não encontrada',
    }),
    __param(0, (0, common_1.Param)('codigo')),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object]),
    __metadata("design:returntype", typeof (_k = typeof Promise !== "undefined" && Promise) === "function" ? _k : Object)
], IntegracaoController.prototype, "alterarStatus", null);
__decorate([
    (0, common_1.Get)('ativa/:tipo'),
    (0, swagger_1.ApiOperation)({ summary: 'Buscar configuração ativa por tipo' }),
    (0, swagger_1.ApiParam)({
        name: 'tipo',
        description: 'Tipo de integração',
        enum: integracao_tipo_enum_1.IntegracaoTipoEnum,
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Configuração ativa encontrada',
        type: integracao_response_dto_1.IntegracaoResponseDto,
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Nenhuma configuração ativa encontrada',
    }),
    __param(0, (0, common_1.Param)('tipo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_l = typeof integracao_tipo_enum_1.IntegracaoTipoEnum !== "undefined" && integracao_tipo_enum_1.IntegracaoTipoEnum) === "function" ? _l : Object]),
    __metadata("design:returntype", typeof (_m = typeof Promise !== "undefined" && Promise) === "function" ? _m : Object)
], IntegracaoController.prototype, "buscarConfigAtiva", null);
exports.IntegracaoController = IntegracaoController = __decorate([
    (0, swagger_1.ApiTags)('Configuração'),
    (0, common_1.Controller)('configuracao/integracoes'),
    __metadata("design:paramtypes", [typeof (_a = typeof integracao_service_1.IntegracaoService !== "undefined" && integracao_service_1.IntegracaoService) === "function" ? _a : Object])
], IntegracaoController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXGNvbmZpZ3VyYWNhb1xcY29udHJvbGxlcnNcXGludGVncmFjYW8uY29udHJvbGxlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBV3dCO0FBQ3hCLDZDQU15QjtBQUN6Qix1RUFBbUU7QUFDbkUsb0ZBQStFO0FBQy9FLGdGQUEyRTtBQUMzRSx3RkFBbUY7QUFDbkYsOEVBQXlFO0FBSXpFLDJEQUFxRTtBQUVyRTs7R0FFRztBQUdJLElBQU0sb0JBQW9CLEdBQTFCLE1BQU0sb0JBQW9CO0lBQ0Y7SUFBN0IsWUFBNkIsaUJBQW9DO1FBQXBDLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7SUFBRyxDQUFDO0lBRXJFOzs7O09BSUc7SUFRRyxBQUFOLEtBQUssQ0FBQyxXQUFXLENBQ0EsSUFBeUI7UUFFeEMsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRDs7OztPQUlHO0lBaUJHLEFBQU4sS0FBSyxDQUFDLGVBQWUsQ0FDRixNQUFjO1FBRS9CLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFpQkcsQUFBTixLQUFLLENBQUMsZ0JBQWdCLENBQ0gsTUFBYyxFQUN2QixHQUF3QjtRQUVoQyxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVEOzs7T0FHRztJQWdCRyxBQUFOLEtBQUssQ0FBQyxPQUFPLENBQWtCLE1BQWM7UUFDM0MsTUFBTSxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRDs7OztPQUlH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QkFBb0I7SUFGaEMsSUFBQSxpQkFBTyxFQUFDLGNBQWMsQ0FBQztJQUN2QixJQUFBLG1CQUFVLEVBQUMsMEJBQTBCLENBQUM7eURBRVcsc0NBQWlCLG9CQUFqQixzQ0FBaUI7R0FEdEQsb0JBQW9CLENBcU1oQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGV1ZHJlXFxPbmVEcml2ZVxcRGVza3RvcFxcUHJvamV0b3NcXHBnYmVuXFxwZ2Jlbi1zZXJ2ZXJcXHNyY1xcbW9kdWxlc1xcY29uZmlndXJhY2FvXFxjb250cm9sbGVyc1xcaW50ZWdyYWNhby5jb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbnRyb2xsZXIsXG4gIEdldCxcbiAgUG9zdCxcbiAgQm9keSxcbiAgUGF0Y2gsXG4gIFBhcmFtLFxuICBEZWxldGUsXG4gIFVzZUd1YXJkcyxcbiAgUXVlcnksXG4gIFB1dCxcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQmVhcmVyQXV0aCxcbiAgQXBpUGFyYW0sXG59IGZyb20gJ0BuZXN0anMvc3dhZ2dlcic7XG5pbXBvcnQgeyBJbnRlZ3JhY2FvU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ludGVncmFjYW8uc2VydmljZSc7XG5pbXBvcnQgeyBJbnRlZ3JhY2FvVXBkYXRlRHRvIH0gZnJvbSAnLi4vZHRvcy9pbnRlZ3JhY2FvL2ludGVncmFjYW8tdXBkYXRlLmR0byc7XG5pbXBvcnQgeyBJbnRlZ3JhY2FvVGVzdER0byB9IGZyb20gJy4uL2R0b3MvaW50ZWdyYWNhby9pbnRlZ3JhY2FvLXRlc3QuZHRvJztcbmltcG9ydCB7IEludGVncmFjYW9SZXNwb25zZUR0byB9IGZyb20gJy4uL2R0b3MvaW50ZWdyYWNhby9pbnRlZ3JhY2FvLXJlc3BvbnNlLmR0byc7XG5pbXBvcnQgeyBJbnRlZ3JhY2FvVGlwb0VudW0gfSBmcm9tICcuLi8uLi8uLi9lbnVtcy9pbnRlZ3JhY2FvLXRpcG8uZW51bSc7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi8uLi8uLi9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBSZXF1aXJlc1Blcm1pc3Npb24gfSBmcm9tICcuLi8uLi8uLi9hdXRoL2RlY29yYXRvcnMvcmVxdWlyZXMtcGVybWlzc2lvbi5kZWNvcmF0b3InO1xuaW1wb3J0IHsgQXBpRXJyb3JSZXNwb25zZSB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9kdG9zL2FwaS1lcnJvci1yZXNwb25zZS5kdG8nO1xuaW1wb3J0IHsgRW50aXR5Tm90Rm91bmRFeGNlcHRpb24gfSBmcm9tICcuLi8uLi8uLi9zaGFyZWQvZXhjZXB0aW9ucyc7XG5cbi8qKlxuICogQ29udHJvbGFkb3IgcmVzcG9uc8OhdmVsIHBlbGFzIG9wZXJhw6fDtWVzIGRlIGNvbmZpZ3VyYcOnw7VlcyBkZSBpbnRlZ3Jhw6fDo28gZXh0ZXJuYVxuICovXG5AQXBpVGFncygnQ29uZmlndXJhw6fDo28nKVxuQENvbnRyb2xsZXIoJ2NvbmZpZ3VyYWNhby9pbnRlZ3JhY29lcycpXG5leHBvcnQgY2xhc3MgSW50ZWdyYWNhb0NvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGludGVncmFjYW9TZXJ2aWNlOiBJbnRlZ3JhY2FvU2VydmljZSkge31cblxuICAvKipcbiAgICogQnVzY2EgdG9kYXMgYXMgY29uZmlndXJhw6fDtWVzIGRlIGludGVncmHDp8Ojb1xuICAgKiBAcGFyYW0gdGlwbyBUaXBvIG9wY2lvbmFsIHBhcmEgZmlsdHJhclxuICAgKiBAcmV0dXJucyBMaXN0YSBkZSBjb25maWd1cmHDp8O1ZXNcbiAgICovXG4gIEBHZXQoKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ0J1c2NhciB0b2RhcyBhcyBjb25maWd1cmHDp8O1ZXMgZGUgaW50ZWdyYcOnw6NvJyB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnTGlzdGEgZGUgY29uZmlndXJhw6fDtWVzIGVuY29udHJhZGFzJyxcbiAgICB0eXBlOiBbSW50ZWdyYWNhb1Jlc3BvbnNlRHRvXSxcbiAgfSlcbiAgYXN5bmMgYnVzY2FyVG9kYXMoXG4gICAgQFF1ZXJ5KCd0aXBvJykgdGlwbz86IEludGVncmFjYW9UaXBvRW51bSxcbiAgKTogUHJvbWlzZTxJbnRlZ3JhY2FvUmVzcG9uc2VEdG9bXT4ge1xuICAgIHJldHVybiB0aGlzLmludGVncmFjYW9TZXJ2aWNlLmJ1c2NhclRvZGFzKHRpcG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1c2NhIHVtYSBjb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo28gZXNwZWPDrWZpY2EgcG9yIHNldSBjw7NkaWdvXG4gICAqIEBwYXJhbSBjb2RpZ28gQ8OzZGlnbyBkYSBjb25maWd1cmHDp8Ojb1xuICAgKiBAcmV0dXJucyBDb25maWd1cmHDp8OjbyBlbmNvbnRyYWRhXG4gICAqL1xuICBAR2V0KCc6Y29kaWdvJylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdCdXNjYXIgY29uZmlndXJhw6fDo28gZGUgaW50ZWdyYcOnw6NvIHBvciBjw7NkaWdvJyB9KVxuICBAQXBpUGFyYW0oe1xuICAgIG5hbWU6ICdjb2RpZ28nLFxuICAgIGRlc2NyaXB0aW9uOiAnQ8OzZGlnbyDDum5pY28gZGEgY29uZmlndXJhw6fDo28nLFxuICAgIGV4YW1wbGU6ICdzbXRwLXByaW5jaXBhbCcsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyBlbmNvbnRyYWRhJyxcbiAgICB0eXBlOiBJbnRlZ3JhY2FvUmVzcG9uc2VEdG8sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDQsXG4gICAgZGVzY3JpcHRpb246ICdDb25maWd1cmHDp8OjbyBuw6NvIGVuY29udHJhZGEnLFxuICB9KVxuICBhc3luYyBidXNjYXJQb3JDb2RpZ28oXG4gICAgQFBhcmFtKCdjb2RpZ28nKSBjb2RpZ286IHN0cmluZyxcbiAgKTogUHJvbWlzZTxJbnRlZ3JhY2FvUmVzcG9uc2VEdG8+IHtcbiAgICByZXR1cm4gdGhpcy5pbnRlZ3JhY2FvU2VydmljZS5idXNjYXJQb3JDb2RpZ28oY29kaWdvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmlhIG91IGF0dWFsaXphIHVtYSBjb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo29cbiAgICogQHBhcmFtIGNvZGlnbyBDw7NkaWdvIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEBwYXJhbSBkdG8gRGFkb3MgcGFyYSBhdHVhbGl6YcOnw6NvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvIGF0dWFsaXphZGFcbiAgICovXG4gIEBQdXQoJzpjb2RpZ28nKVxuICBAQXBpT3BlcmF0aW9uKHsgc3VtbWFyeTogJ0NyaWFyIG91IGF0dWFsaXphciBjb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo28nIH0pXG4gIEBBcGlQYXJhbSh7XG4gICAgbmFtZTogJ2NvZGlnbycsXG4gICAgZGVzY3JpcHRpb246ICdDw7NkaWdvIMO6bmljbyBkYSBjb25maWd1cmHDp8OjbycsXG4gICAgZXhhbXBsZTogJ3NtdHAtcHJpbmNpcGFsJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyYcOnw6NvIGNyaWFkYS9hdHVhbGl6YWRhIGNvbSBzdWNlc3NvJyxcbiAgICB0eXBlOiBJbnRlZ3JhY2FvUmVzcG9uc2VEdG8sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zJyxcbiAgfSlcbiAgYXN5bmMgYXR1YWxpemFyT3VDcmlhcihcbiAgICBAUGFyYW0oJ2NvZGlnbycpIGNvZGlnbzogc3RyaW5nLFxuICAgIEBCb2R5KCkgZHRvOiBJbnRlZ3JhY2FvVXBkYXRlRHRvLFxuICApOiBQcm9taXNlPEludGVncmFjYW9SZXNwb25zZUR0bz4ge1xuICAgIHJldHVybiB0aGlzLmludGVncmFjYW9TZXJ2aWNlLmF0dWFsaXphck91Q3JpYXIoY29kaWdvLCBkdG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB1bWEgY29uZmlndXJhw6fDo28gZGUgaW50ZWdyYcOnw6NvXG4gICAqIEBwYXJhbSBjb2RpZ28gQ8OzZGlnbyBkYSBjb25maWd1cmHDp8Ojb1xuICAgKi9cbiAgQERlbGV0ZSgnOmNvZGlnbycpXG4gIEBBcGlPcGVyYXRpb24oeyBzdW1tYXJ5OiAnUmVtb3ZlciBjb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo28nIH0pXG4gIEBBcGlQYXJhbSh7XG4gICAgbmFtZTogJ2NvZGlnbycsXG4gICAgZGVzY3JpcHRpb246ICdDw7NkaWdvIMO6bmljbyBkYSBjb25maWd1cmHDp8OjbycsXG4gICAgZXhhbXBsZTogJ3NtdHAtcHJpbmNpcGFsJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwNCxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyYcOnw6NvIHJlbW92aWRhIGNvbSBzdWNlc3NvJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyYcOnw6NvIG7Do28gZW5jb250cmFkYScsXG4gIH0pXG4gIGFzeW5jIHJlbW92ZXIoQFBhcmFtKCdjb2RpZ28nKSBjb2RpZ286IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuaW50ZWdyYWNhb1NlcnZpY2UucmVtb3Zlcihjb2RpZ28pO1xuICB9XG5cbiAgLyoqXG4gICAqIFRlc3RhIHVtYSBjb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo29cbiAgICogQHBhcmFtIGR0byBEYWRvcyBwYXJhIHRlc3RlIGRhIGNvbmZpZ3VyYcOnw6NvXG4gICAqIEByZXR1cm5zIFJlc3VsdGFkbyBkbyB0ZXN0ZVxuICAgKi9cbiAgQFBvc3QoJ3Rlc3RhcicpXG4gIEBBcGlPcGVyYXRpb24oeyBzdW1tYXJ5OiAnVGVzdGFyIGNvbmZpZ3VyYcOnw6NvIGRlIGludGVncmHDp8OjbycgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ1Rlc3RlIGV4ZWN1dGFkbyBjb20gc3VjZXNzbycsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgc3VjZXNzbzoge1xuICAgICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0luZGljYSBzZSBvIHRlc3RlIGZvaSBiZW0tc3VjZWRpZG8nLFxuICAgICAgICB9LFxuICAgICAgICBtZW5zYWdlbToge1xuICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTWVuc2FnZW0gZGV0YWxoYWRhIGRvIHJlc3VsdGFkbyBkbyB0ZXN0ZScsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdEYWRvcyBpbnbDoWxpZG9zIG91IGVycm8gbm8gdGVzdGUnLFxuICB9KVxuICBhc3luYyB0ZXN0YXIoXG4gICAgQEJvZHkoKSBkdG86IEludGVncmFjYW9UZXN0RHRvLFxuICApOiBQcm9taXNlPHsgc3VjZXNzbzogYm9vbGVhbjsgbWVuc2FnZW06IHN0cmluZyB9PiB7XG4gICAgcmV0dXJuIHRoaXMuaW50ZWdyYWNhb1NlcnZpY2UudGVzdGFyKGR0byk7XG4gIH1cblxuICAvKipcbiAgICogQXRpdmEgb3UgZGVzYXRpdmEgdW1hIGNvbmZpZ3VyYcOnw6NvIGRlIGludGVncmHDp8Ojb1xuICAgKiBAcGFyYW0gY29kaWdvIEPDs2RpZ28gZGEgY29uZmlndXJhw6fDo29cbiAgICogQHBhcmFtIGF0aXZvIFN0YXR1cyBkZSBhdGl2YcOnw6NvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvIGF0dWFsaXphZGFcbiAgICovXG4gIEBQdXQoJzpjb2RpZ28vc3RhdHVzJylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdBdGl2YXIgb3UgZGVzYXRpdmFyIGNvbmZpZ3VyYcOnw6NvIGRlIGludGVncmHDp8OjbycgfSlcbiAgQEFwaVBhcmFtKHtcbiAgICBuYW1lOiAnY29kaWdvJyxcbiAgICBkZXNjcmlwdGlvbjogJ0PDs2RpZ28gw7puaWNvIGRhIGNvbmZpZ3VyYcOnw6NvJyxcbiAgICBleGFtcGxlOiAnc210cC1wcmluY2lwYWwnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnU3RhdHVzIGRhIGNvbmZpZ3VyYcOnw6NvIGF0dWFsaXphZG8gY29tIHN1Y2Vzc28nLFxuICAgIHR5cGU6IEludGVncmFjYW9SZXNwb25zZUR0byxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyYcOnw6NvIG7Do28gZW5jb250cmFkYScsXG4gIH0pXG4gIGFzeW5jIGFsdGVyYXJTdGF0dXMoXG4gICAgQFBhcmFtKCdjb2RpZ28nKSBjb2RpZ286IHN0cmluZyxcbiAgICBAQm9keSgpIHsgYXRpdm8gfTogeyBhdGl2bzogYm9vbGVhbiB9LFxuICApOiBQcm9taXNlPEludGVncmFjYW9SZXNwb25zZUR0bz4ge1xuICAgIHJldHVybiB0aGlzLmludGVncmFjYW9TZXJ2aWNlLmFsdGVyYXJTdGF0dXMoY29kaWdvLCBhdGl2byk7XG4gIH1cblxuICAvKipcbiAgICogQnVzY2EgYSBjb25maWd1cmHDp8OjbyBhdGl2YSBwYXJhIHVtIGRldGVybWluYWRvIHRpcG8gZGUgaW50ZWdyYcOnw6NvXG4gICAqIEBwYXJhbSB0aXBvIFRpcG8gZGEgaW50ZWdyYcOnw6NvXG4gICAqIEByZXR1cm5zIENvbmZpZ3VyYcOnw6NvIGF0aXZhIG91IG51bGxcbiAgICovXG4gIEBHZXQoJ2F0aXZhLzp0aXBvJylcbiAgQEFwaU9wZXJhdGlvbih7IHN1bW1hcnk6ICdCdXNjYXIgY29uZmlndXJhw6fDo28gYXRpdmEgcG9yIHRpcG8nIH0pXG4gIEBBcGlQYXJhbSh7XG4gICAgbmFtZTogJ3RpcG8nLFxuICAgIGRlc2NyaXB0aW9uOiAnVGlwbyBkZSBpbnRlZ3Jhw6fDo28nLFxuICAgIGVudW06IEludGVncmFjYW9UaXBvRW51bSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyYcOnw6NvIGF0aXZhIGVuY29udHJhZGEnLFxuICAgIHR5cGU6IEludGVncmFjYW9SZXNwb25zZUR0byxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBkZXNjcmlwdGlvbjogJ05lbmh1bWEgY29uZmlndXJhw6fDo28gYXRpdmEgZW5jb250cmFkYScsXG4gIH0pXG4gIGFzeW5jIGJ1c2NhckNvbmZpZ0F0aXZhKFxuICAgIEBQYXJhbSgndGlwbycpIHRpcG86IEludGVncmFjYW9UaXBvRW51bSxcbiAgKTogUHJvbWlzZTxJbnRlZ3JhY2FvUmVzcG9uc2VEdG8+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmludGVncmFjYW9TZXJ2aWNlLmJ1c2NhckNvbmZpZ0F0aXZhKHRpcG8pO1xuICAgIGlmICghY29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRW50aXR5Tm90Rm91bmRFeGNlcHRpb24oXG4gICAgICAgICdDb25maWd1cmHDp8OjbyBkZSBpbnRlZ3Jhw6fDo28nLFxuICAgICAgICB0aXBvLFxuICAgICAgICAndGlwbycsXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gY29uZmlnO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=