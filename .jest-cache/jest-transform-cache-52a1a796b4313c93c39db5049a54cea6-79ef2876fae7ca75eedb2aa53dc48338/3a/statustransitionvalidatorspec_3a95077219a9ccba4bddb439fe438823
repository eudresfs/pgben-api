002a3e1e62228ae55e7cb9b3e330eba5
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const status_transition_validator_1 = require("../../validators/status-transition-validator");
const status_pagamento_enum_1 = require("../../enums/status-pagamento.enum");
/**
 * Testes unitários para o validador de transições de status
 *
 * Verifica o funcionamento correto das validações de transições entre
 * os diferentes estados de um pagamento, garantindo que apenas transições
 * válidas sejam permitidas.
 *
 * @author Equipe PGBen
 */
describe('StatusTransitionValidator', () => {
    let validator;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [status_transition_validator_1.StatusTransitionValidator],
        }).compile();
        validator = module.get(status_transition_validator_1.StatusTransitionValidator);
    });
    describe('validarTransicao', () => {
        it('deve permitir transição de AGENDADO para LIBERADO', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(true);
        });
        it('deve permitir transição de AGENDADO para CANCELADO', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO)).toBe(true);
        });
        it('deve permitir transição de LIBERADO para CONFIRMADO', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO)).toBe(true);
        });
        it('deve permitir transição de LIBERADO para CANCELADO', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO)).toBe(true);
        });
        it('não deve permitir transição de CANCELADO para qualquer outro status', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO)).toBe(false);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(false);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO)).toBe(false);
        });
        it('não deve permitir transição de CONFIRMADO para qualquer outro status', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO)).toBe(false);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(false);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO, status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO)).toBe(false);
        });
        it('não deve permitir transição de AGENDADO para CONFIRMADO (pula etapa)', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO)).toBe(false);
        });
        it('deve retornar false para status inválidos', () => {
            expect(validator.validarTransicao('STATUS_INVALIDO', status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(false);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, 'STATUS_INVALIDO')).toBe(false);
        });
        it('deve permitir manter o mesmo status', () => {
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO, status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO)).toBe(true);
            expect(validator.validarTransicao(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO, status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(true);
        });
    });
    describe('getProximosStatusPossiveis', () => {
        it('deve retornar os próximos status possíveis para AGENDADO', () => {
            const proximos = validator.getProximosStatusPossiveis(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(proximos).toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(proximos).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(proximos).not.toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
        });
        it('deve retornar os próximos status possíveis para LIBERADO', () => {
            const proximos = validator.getProximosStatusPossiveis(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
            expect(proximos).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(proximos).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(proximos).not.toContain(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
        });
        it('deve retornar array vazio para CONFIRMADO', () => {
            const proximos = validator.getProximosStatusPossiveis(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(proximos.length).toBe(0);
        });
        it('deve retornar array vazio para CANCELADO', () => {
            const proximos = validator.getProximosStatusPossiveis(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(proximos.length).toBe(0);
        });
        it('deve retornar array vazio para status inválido', () => {
            const proximos = validator.getProximosStatusPossiveis('STATUS_INVALIDO');
            expect(proximos.length).toBe(0);
        });
    });
    describe('getStatusInicial', () => {
        it('deve retornar AGENDADO como status inicial', () => {
            expect(validator.getStatusInicial()).toBe(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
        });
    });
    describe('getStatusFinais', () => {
        it('deve retornar CONFIRMADO e CANCELADO como status finais', () => {
            const statusFinais = validator.getStatusFinais();
            expect(statusFinais).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO);
            expect(statusFinais).toContain(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO);
            expect(statusFinais).not.toContain(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO);
            expect(statusFinais).not.toContain(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO);
        });
    });
    describe('isStatusFinal', () => {
        it('deve identificar corretamente status finais', () => {
            expect(validator.isStatusFinal(status_pagamento_enum_1.StatusPagamentoEnum.CONFIRMADO)).toBe(true);
            expect(validator.isStatusFinal(status_pagamento_enum_1.StatusPagamentoEnum.CANCELADO)).toBe(true);
        });
        it('deve identificar corretamente status não finais', () => {
            expect(validator.isStatusFinal(status_pagamento_enum_1.StatusPagamentoEnum.AGENDADO)).toBe(false);
            expect(validator.isStatusFinal(status_pagamento_enum_1.StatusPagamentoEnum.LIBERADO)).toBe(false);
        });
        it('deve retornar false para status inválido', () => {
            expect(validator.isStatusFinal('STATUS_INVALIDO')).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXHZhbGlkYXRvcnNcXHN0YXR1cy10cmFuc2l0aW9uLXZhbGlkYXRvci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELDhGQUF5RjtBQUN6Riw2RUFBd0U7QUFFeEU7Ozs7Ozs7O0dBUUc7QUFDSCxRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLElBQUksU0FBb0MsQ0FBQztJQUV6QyxVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsTUFBTSxNQUFNLEdBQWtCLE1BQU0sY0FBSSxDQUFDLG1CQUFtQixDQUFDO1lBQzNELFNBQVMsRUFBRSxDQUFDLHVEQUF5QixDQUFDO1NBQ3ZDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUViLFNBQVMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUE0Qix1REFBeUIsQ0FBQyxDQUFDO0lBQy9FLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtRQUNoQyxFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzNELE1BQU0sQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQy9CLDJDQUFtQixDQUFDLFFBQVEsRUFDNUIsMkNBQW1CLENBQUMsUUFBUSxDQUM3QixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLEdBQUcsRUFBRTtZQUM1RCxNQUFNLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUMvQiwyQ0FBbUIsQ0FBQyxRQUFRLEVBQzVCLDJDQUFtQixDQUFDLFNBQVMsQ0FDOUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztR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Q0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLGlCQUF3QyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxwYWdhbWVudG9cXHRlc3RzXFx2YWxpZGF0b3JzXFxzdGF0dXMtdHJhbnNpdGlvbi12YWxpZGF0b3Iuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IFN0YXR1c1RyYW5zaXRpb25WYWxpZGF0b3IgfSBmcm9tICcuLi8uLi92YWxpZGF0b3JzL3N0YXR1cy10cmFuc2l0aW9uLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTdGF0dXNQYWdhbWVudG9FbnVtIH0gZnJvbSAnLi4vLi4vZW51bXMvc3RhdHVzLXBhZ2FtZW50by5lbnVtJztcblxuLyoqXG4gKiBUZXN0ZXMgdW5pdMOhcmlvcyBwYXJhIG8gdmFsaWRhZG9yIGRlIHRyYW5zacOnw7VlcyBkZSBzdGF0dXNcbiAqIFxuICogVmVyaWZpY2EgbyBmdW5jaW9uYW1lbnRvIGNvcnJldG8gZGFzIHZhbGlkYcOnw7VlcyBkZSB0cmFuc2nDp8O1ZXMgZW50cmVcbiAqIG9zIGRpZmVyZW50ZXMgZXN0YWRvcyBkZSB1bSBwYWdhbWVudG8sIGdhcmFudGluZG8gcXVlIGFwZW5hcyB0cmFuc2nDp8O1ZXNcbiAqIHbDoWxpZGFzIHNlamFtIHBlcm1pdGlkYXMuXG4gKiBcbiAqIEBhdXRob3IgRXF1aXBlIFBHQmVuXG4gKi9cbmRlc2NyaWJlKCdTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yJywgKCkgPT4ge1xuICBsZXQgdmFsaWRhdG9yOiBTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtTdGF0dXNUcmFuc2l0aW9uVmFsaWRhdG9yXSxcbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICB2YWxpZGF0b3IgPSBtb2R1bGUuZ2V0PFN0YXR1c1RyYW5zaXRpb25WYWxpZGF0b3I+KFN0YXR1c1RyYW5zaXRpb25WYWxpZGF0b3IpO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhclRyYW5zaWNhbycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBBR0VOREFETyBwYXJhIExJQkVSQURPJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRvci52YWxpZGFyVHJhbnNpY2FvKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPXG4gICAgICApKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcGVybWl0aXIgdHJhbnNpw6fDo28gZGUgQUdFTkRBRE8gcGFyYSBDQU5DRUxBRE8nLCAoKSA9PiB7XG4gICAgICBleHBlY3QodmFsaWRhdG9yLnZhbGlkYXJUcmFuc2ljYW8oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPXG4gICAgICApKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcGVybWl0aXIgdHJhbnNpw6fDo28gZGUgTElCRVJBRE8gcGFyYSBDT05GSVJNQURPJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRvci52YWxpZGFyVHJhbnNpY2FvKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE9cbiAgICAgICkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBMSUJFUkFETyBwYXJhIENBTkNFTEFETycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE9cbiAgICAgICkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnbsOjbyBkZXZlIHBlcm1pdGlyIHRyYW5zacOnw6NvIGRlIENBTkNFTEFETyBwYXJhIHF1YWxxdWVyIG91dHJvIHN0YXR1cycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE9cbiAgICAgICkpLnRvQmUoZmFsc2UpO1xuICAgICAgXG4gICAgICBleHBlY3QodmFsaWRhdG9yLnZhbGlkYXJUcmFuc2ljYW8oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPXG4gICAgICApKS50b0JlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHZhbGlkYXRvci52YWxpZGFyVHJhbnNpY2FvKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPXG4gICAgICApKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCduw6NvIGRldmUgcGVybWl0aXIgdHJhbnNpw6fDo28gZGUgQ09ORklSTUFETyBwYXJhIHF1YWxxdWVyIG91dHJvIHN0YXR1cycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DT05GSVJNQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPXG4gICAgICApKS50b0JlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHZhbGlkYXRvci52YWxpZGFyVHJhbnNpY2FvKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uTElCRVJBRE9cbiAgICAgICkpLnRvQmUoZmFsc2UpO1xuICAgICAgXG4gICAgICBleHBlY3QodmFsaWRhdG9yLnZhbGlkYXJUcmFuc2ljYW8oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE9cbiAgICAgICkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ27Do28gZGV2ZSBwZXJtaXRpciB0cmFuc2nDp8OjbyBkZSBBR0VOREFETyBwYXJhIENPTkZJUk1BRE8gKHB1bGEgZXRhcGEpJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRvci52YWxpZGFyVHJhbnNpY2FvKFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPLFxuICAgICAgICBTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE9cbiAgICAgICkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgZmFsc2UgcGFyYSBzdGF0dXMgaW52w6FsaWRvcycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgJ1NUQVRVU19JTlZBTElETycgYXMgU3RhdHVzUGFnYW1lbnRvRW51bSxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFET1xuICAgICAgKSkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyxcbiAgICAgICAgJ1NUQVRVU19JTlZBTElETycgYXMgU3RhdHVzUGFnYW1lbnRvRW51bVxuICAgICAgKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwZXJtaXRpciBtYW50ZXIgbyBtZXNtbyBzdGF0dXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QodmFsaWRhdG9yLnZhbGlkYXJUcmFuc2ljYW8oXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8sXG4gICAgICAgIFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE9cbiAgICAgICkpLnRvQmUodHJ1ZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IudmFsaWRhclRyYW5zaWNhbyhcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyxcbiAgICAgICAgU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFET1xuICAgICAgKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFByb3hpbW9zU3RhdHVzUG9zc2l2ZWlzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIG9zIHByw7N4aW1vcyBzdGF0dXMgcG9zc8OtdmVpcyBwYXJhIEFHRU5EQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJveGltb3MgPSB2YWxpZGF0b3IuZ2V0UHJveGltb3NTdGF0dXNQb3NzaXZlaXMoU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyk7XG4gICAgICBleHBlY3QocHJveGltb3MpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPKTtcbiAgICAgIGV4cGVjdChwcm94aW1vcykudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uQ0FOQ0VMQURPKTtcbiAgICAgIGV4cGVjdChwcm94aW1vcykubm90LnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgb3MgcHLDs3hpbW9zIHN0YXR1cyBwb3Nzw612ZWlzIHBhcmEgTElCRVJBRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm94aW1vcyA9IHZhbGlkYXRvci5nZXRQcm94aW1vc1N0YXR1c1Bvc3NpdmVpcyhTdGF0dXNQYWdhbWVudG9FbnVtLkxJQkVSQURPKTtcbiAgICAgIGV4cGVjdChwcm94aW1vcykudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETyk7XG4gICAgICBleHBlY3QocHJveGltb3MpLnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkNBTkNFTEFETyk7XG4gICAgICBleHBlY3QocHJveGltb3MpLm5vdC50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5BR0VOREFETyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBhcnJheSB2YXppbyBwYXJhIENPTkZJUk1BRE8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm94aW1vcyA9IHZhbGlkYXRvci5nZXRQcm94aW1vc1N0YXR1c1Bvc3NpdmVpcyhTdGF0dXNQYWdhbWVudG9FbnVtLkNPTkZJUk1BRE8pO1xuICAgICAgZXhwZWN0KHByb3hpbW9zLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGFycmF5IHZhemlvIHBhcmEgQ0FOQ0VMQURPJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJveGltb3MgPSB2YWxpZGF0b3IuZ2V0UHJveGltb3NTdGF0dXNQb3NzaXZlaXMoU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8pO1xuICAgICAgZXhwZWN0KHByb3hpbW9zLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGFycmF5IHZhemlvIHBhcmEgc3RhdHVzIGludsOhbGlkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3hpbW9zID0gdmFsaWRhdG9yLmdldFByb3hpbW9zU3RhdHVzUG9zc2l2ZWlzKCdTVEFUVVNfSU5WQUxJRE8nIGFzIFN0YXR1c1BhZ2FtZW50b0VudW0pO1xuICAgICAgZXhwZWN0KHByb3hpbW9zLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFN0YXR1c0luaWNpYWwnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgQUdFTkRBRE8gY29tbyBzdGF0dXMgaW5pY2lhbCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IuZ2V0U3RhdHVzSW5pY2lhbCgpKS50b0JlKFN0YXR1c1BhZ2FtZW50b0VudW0uQUdFTkRBRE8pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0U3RhdHVzRmluYWlzJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHJldG9ybmFyIENPTkZJUk1BRE8gZSBDQU5DRUxBRE8gY29tbyBzdGF0dXMgZmluYWlzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdHVzRmluYWlzID0gdmFsaWRhdG9yLmdldFN0YXR1c0ZpbmFpcygpO1xuICAgICAgZXhwZWN0KHN0YXR1c0ZpbmFpcykudG9Db250YWluKFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETyk7XG4gICAgICBleHBlY3Qoc3RhdHVzRmluYWlzKS50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8pO1xuICAgICAgZXhwZWN0KHN0YXR1c0ZpbmFpcykubm90LnRvQ29udGFpbihTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPKTtcbiAgICAgIGV4cGVjdChzdGF0dXNGaW5haXMpLm5vdC50b0NvbnRhaW4oU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpc1N0YXR1c0ZpbmFsJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIGlkZW50aWZpY2FyIGNvcnJldGFtZW50ZSBzdGF0dXMgZmluYWlzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRvci5pc1N0YXR1c0ZpbmFsKFN0YXR1c1BhZ2FtZW50b0VudW0uQ09ORklSTUFETykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QodmFsaWRhdG9yLmlzU3RhdHVzRmluYWwoU3RhdHVzUGFnYW1lbnRvRW51bS5DQU5DRUxBRE8pKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgaWRlbnRpZmljYXIgY29ycmV0YW1lbnRlIHN0YXR1cyBuw6NvIGZpbmFpcycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZGF0b3IuaXNTdGF0dXNGaW5hbChTdGF0dXNQYWdhbWVudG9FbnVtLkFHRU5EQURPKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdG9yLmlzU3RhdHVzRmluYWwoU3RhdHVzUGFnYW1lbnRvRW51bS5MSUJFUkFETykpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgZmFsc2UgcGFyYSBzdGF0dXMgaW52w6FsaWRvJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRvci5pc1N0YXR1c0ZpbmFsKCdTVEFUVVNfSU5WQUxJRE8nIGFzIFN0YXR1c1BhZ2FtZW50b0VudW0pKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==