b87d778a9cc5607c22e2dff4402fe5b8
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const request = __importStar(require("supertest"));
const typeorm_1 = require("@nestjs/typeorm");
const config_1 = require("@nestjs/config");
const jwt_1 = require("@nestjs/jwt");
const axios_1 = require("@nestjs/axios");
const pagamento_module_1 = require("../../pagamento.module");
const entities_1 = require("../../entities");
const status_pagamento_enum_1 = require("../../enums/status-pagamento.enum");
const metodo_pagamento_enum_1 = require("../../enums/metodo-pagamento.enum");
const pagamento_service_1 = require("../../services/pagamento.service");
const auditoria_pagamento_service_1 = require("../../services/auditoria-pagamento.service");
/**
 * Testes de integração para confirmações de recebimento de pagamento
 *
 * Verifica o funcionamento correto das operações de registro, consulta
 * e listagem de confirmações de recebimento de pagamentos.
 *
 * @author Equipe PGBen
 */
describe('Confirmações de Recebimento (Integration)', () => {
    let app;
    let jwtService;
    let pagamentoService;
    let auditoriaPagamentoService;
    let pagamentoRepository;
    let confirmacaoRepository;
    // Dados de teste
    const usuarioId = 'usuario-teste-id';
    const gestorId = 'gestor-teste-id';
    const unidadeId = 'unidade-teste-id';
    const pagamentoId = 'pagamento-teste-id';
    const confirmacaoId = 'confirmacao-teste-id';
    const beneficiarioId = 'beneficiario-teste-id';
    // Mock dos repositórios
    const mockPagamentoRepository = {
        findOne: jest.fn(),
        save: jest.fn(),
        update: jest.fn()
    };
    const mockConfirmacaoRepository = {
        create: jest.fn(),
        save: jest.fn(),
        findOne: jest.fn(),
        find: jest.fn(),
        findAndCount: jest.fn()
    };
    // Mock do serviço de auditoria
    const mockAuditoriaPagamentoService = {
        logConfirmacaoRecebimento: jest.fn(),
        logErroProcessamento: jest.fn(),
        logTentativaAcessoNaoAutorizado: jest.fn()
    };
    beforeAll(async () => {
        const moduleFixture = await testing_1.Test.createTestingModule({
            imports: [
                pagamento_module_1.PagamentoModule,
                config_1.ConfigModule.forRoot({
                    isGlobal: true,
                    envFilePath: '.env.test'
                }),
                jwt_1.JwtModule.registerAsync({
                    imports: [config_1.ConfigModule],
                    useFactory: (configService) => ({
                        secret: configService.get('JWT_SECRET') || 'teste-secret',
                        signOptions: { expiresIn: '1h' },
                    }),
                    inject: [config_1.ConfigService]
                }),
                axios_1.HttpModule
            ],
            providers: [
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.Pagamento),
                    useValue: mockPagamentoRepository
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.ConfirmacaoRecebimento),
                    useValue: mockConfirmacaoRepository
                },
                {
                    provide: (0, typeorm_1.getRepositoryToken)(entities_1.ComprovantePagamento),
                    useValue: {}
                },
                {
                    provide: auditoria_pagamento_service_1.AuditoriaPagamentoService,
                    useValue: mockAuditoriaPagamentoService
                }
            ]
        }).compile();
        app = moduleFixture.createNestApplication();
        jwtService = moduleFixture.get(jwt_1.JwtService);
        pagamentoService = moduleFixture.get(pagamento_service_1.PagamentoService);
        auditoriaPagamentoService = moduleFixture.get(auditoria_pagamento_service_1.AuditoriaPagamentoService);
        pagamentoRepository = moduleFixture.get((0, typeorm_1.getRepositoryToken)(entities_1.Pagamento));
        confirmacaoRepository = moduleFixture.get((0, typeorm_1.getRepositoryToken)(entities_1.ConfirmacaoRecebimento));
        await app.init();
    });
    afterAll(async () => {
        await app.close();
    });
    beforeEach(() => {
        jest.clearAllMocks();
        // Configurar mocks padrão
        mockPagamentoRepository.findOne.mockImplementation((options) => {
            if (options.where?.id === pagamentoId) {
                return Promise.resolve({
                    id: pagamentoId,
                    status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
                    unidadeId,
                    beneficiarioId,
                    valor: 500.00,
                    metodoPagamento: metodo_pagamento_enum_1.MetodoPagamentoEnum.PIX
                });
            }
            return Promise.resolve(null);
        });
        mockConfirmacaoRepository.findOne.mockImplementation((options) => {
            if (options.where?.id === confirmacaoId) {
                return Promise.resolve({
                    id: confirmacaoId,
                    pagamentoId,
                    dataConfirmacao: new Date(),
                    observacoes: 'Pagamento recebido via PIX',
                    numeroProtocolo: '123456789',
                    confirmadoPor: beneficiarioId,
                    createdAt: new Date()
                });
            }
            else if (options.where?.pagamentoId === pagamentoId) {
                return Promise.resolve({
                    id: confirmacaoId,
                    pagamentoId,
                    dataConfirmacao: new Date(),
                    observacoes: 'Pagamento recebido via PIX',
                    numeroProtocolo: '123456789',
                    confirmadoPor: beneficiarioId,
                    createdAt: new Date()
                });
            }
            return Promise.resolve(null);
        });
        mockConfirmacaoRepository.create.mockImplementation((dto) => ({
            id: confirmacaoId,
            pagamentoId: dto.pagamentoId,
            dataConfirmacao: dto.dataConfirmacao || new Date(),
            observacoes: dto.observacoes,
            numeroProtocolo: dto.numeroProtocolo || '123456789',
            confirmadoPor: dto.confirmadoPor || beneficiarioId,
            createdAt: new Date()
        }));
        mockConfirmacaoRepository.save.mockImplementation((dto) => Promise.resolve(dto));
    });
    // Função auxiliar para gerar tokens JWT
    const gerarToken = (userId, perfis = ['usuario'], unidadeId = 'unidade-teste-id') => {
        return jwtService.sign({
            sub: userId,
            perfis,
            unidade: unidadeId
        });
    };
    describe('Registro de Confirmações', () => {
        it('deve registrar confirmação de recebimento com sucesso', async () => {
            const token = gerarToken(beneficiarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Pagamento recebido via PIX',
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(201);
            expect(response.body).toHaveProperty('id');
            expect(response.body.pagamentoId).toBe(pagamentoId);
            expect(mockConfirmacaoRepository.create).toHaveBeenCalled();
            expect(mockConfirmacaoRepository.save).toHaveBeenCalled();
            expect(auditoriaPagamentoService.logConfirmacaoRecebimento).toHaveBeenCalled();
        });
        it('deve rejeitar confirmação para pagamento não encontrado', async () => {
            // Sobrescrever mock para este teste
            mockPagamentoRepository.findOne.mockResolvedValueOnce(null);
            const token = gerarToken(beneficiarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/pagamento-inexistente/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Pagamento recebido via PIX',
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(404);
            expect(response.body.message).toContain('não encontrado');
        });
        it('deve rejeitar confirmação sem dados obrigatórios', async () => {
            const token = gerarToken(beneficiarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                // Faltando observacoes
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(400);
            expect(response.body.message).toContain('observacoes');
        });
        it('deve rejeitar confirmação duplicada', async () => {
            // Mock para simular que já existe confirmação para o pagamento
            mockConfirmacaoRepository.findOne.mockImplementation((options) => {
                if (options.where?.pagamentoId === pagamentoId) {
                    return Promise.resolve({
                        id: confirmacaoId,
                        pagamentoId,
                        dataConfirmacao: new Date(),
                        observacoes: 'Confirmação anterior',
                        confirmadoPor: beneficiarioId
                    });
                }
                return Promise.resolve(null);
            });
            const token = gerarToken(beneficiarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Segunda confirmação',
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(409); // Conflict
            expect(response.body.message).toContain('já possui uma confirmação');
        });
    });
    describe('Consulta de Confirmações', () => {
        it('deve buscar confirmação por ID com sucesso', async () => {
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/confirmacoes/${confirmacaoId}`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('id', confirmacaoId);
            expect(response.body).toHaveProperty('pagamentoId', pagamentoId);
        });
        it('deve buscar confirmação por pagamentoId com sucesso', async () => {
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/pagamentos/${pagamentoId}/confirmacao`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('id', confirmacaoId);
            expect(response.body).toHaveProperty('pagamentoId', pagamentoId);
        });
        it('deve retornar 404 ao buscar confirmação inexistente', async () => {
            // Sobrescrever mock para este teste
            mockConfirmacaoRepository.findOne.mockResolvedValueOnce(null);
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/confirmacoes/confirmacao-inexistente`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(404);
            expect(response.body.message).toContain('não encontrada');
        });
        it('deve listar confirmações com paginação', async () => {
            // Mock para listar confirmações
            mockConfirmacaoRepository.findAndCount.mockResolvedValueOnce([
                [
                    {
                        id: confirmacaoId,
                        pagamentoId,
                        dataConfirmacao: new Date(),
                        observacoes: 'Pagamento recebido via PIX',
                        numeroProtocolo: '123456789',
                        confirmadoPor: beneficiarioId,
                        createdAt: new Date()
                    },
                    {
                        id: 'confirmacao-id-2',
                        pagamentoId: 'outro-pagamento-id',
                        dataConfirmacao: new Date(),
                        observacoes: 'Outro pagamento recebido',
                        numeroProtocolo: '987654321',
                        confirmadoPor: 'outro-beneficiario-id',
                        createdAt: new Date()
                    }
                ],
                2 // Total count
            ]);
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .get(`/confirmacoes`)
                .query({ page: 1, limit: 10 })
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(200);
            expect(response.body).toHaveProperty('items');
            expect(response.body).toHaveProperty('meta');
            expect(response.body.items).toBeInstanceOf(Array);
            expect(response.body.items).toHaveLength(2);
            expect(response.body.meta.totalItems).toBe(2);
        });
    });
    describe('Segurança e Autorização', () => {
        it('deve permitir beneficiário confirmar próprio pagamento', async () => {
            // Sobrescrever mock para este teste
            mockPagamentoRepository.findOne.mockResolvedValueOnce({
                id: pagamentoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
                unidadeId,
                beneficiarioId,
                valor: 500.00
            });
            const token = gerarToken(beneficiarioId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Confirmação pelo beneficiário',
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(201);
        });
        it('deve permitir gestor registrar confirmação', async () => {
            const token = gerarToken(gestorId, ['gestor'], unidadeId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Confirmação pelo gestor',
                dataConfirmacao: new Date().toISOString(),
                confirmadoPor: beneficiarioId
            });
            expect(response.status).toBe(201);
        });
        it('deve rejeitar acesso de usuário sem permissão às confirmações', async () => {
            const token = gerarToken('outro-usuario', ['usuario_basico'], 'outra-unidade');
            const response = await request(app.getHttpServer())
                .get(`/confirmacoes`)
                .set('Authorization', `Bearer ${token}`);
            expect(response.status).toBe(403);
            expect(mockAuditoriaPagamentoService.logTentativaAcessoNaoAutorizado).toHaveBeenCalled();
        });
        it('deve rejeitar confirmação de pagamento de outra unidade', async () => {
            // Sobrescrever mock para este teste
            mockPagamentoRepository.findOne.mockResolvedValueOnce({
                id: pagamentoId,
                status: status_pagamento_enum_1.StatusPagamentoEnum.PAGO,
                unidadeId: 'outra-unidade-id',
                beneficiarioId: 'outro-beneficiario-id',
                valor: 500.00
            });
            const token = gerarToken(usuarioId, ['usuario'], unidadeId);
            const response = await request(app.getHttpServer())
                .post(`/pagamentos/${pagamentoId}/confirmar`)
                .set('Authorization', `Bearer ${token}`)
                .send({
                observacoes: 'Tentativa de confirmação',
                dataConfirmacao: new Date().toISOString()
            });
            expect(response.status).toBe(403);
            expect(mockAuditoriaPagamentoService.logTentativaAcessoNaoAutorizado).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXGludGVncmF0aW9uXFxjb25maXJtYWNvZXMuc3BlYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDZDQUFzRDtBQUV0RCxtREFBcUM7QUFDckMsNkNBQXFEO0FBRXJELDJDQUE2RDtBQUM3RCxxQ0FBb0Q7QUFDcEQseUNBQTJDO0FBRTNDLDZEQUF5RDtBQUN6RCw2Q0FJd0I7QUFDeEIsNkVBQXdFO0FBQ3hFLDZFQUF3RTtBQUN4RSx3RUFBb0U7QUFDcEUsNEZBQXVGO0FBRXZGOzs7Ozs7O0dBT0c7QUFDSCxRQUFRLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO0lBQ3pELElBQUksR0FBcUIsQ0FBQztJQUMxQixJQUFJLFVBQXNCLENBQUM7SUFDM0IsSUFBSSxnQkFBa0MsQ0FBQztJQUN2QyxJQUFJLHlCQUFvRCxDQUFDO0lBRXpELElBQUksbUJBQTBDLENBQUM7SUFDL0MsSUFBSSxxQkFBeUQsQ0FBQztJQUU5RCxpQkFBaUI7SUFDakIsTUFBTSxTQUFTLEdBQUcsa0JBQWtCLENBQUM7SUFDckMsTUFBTSxRQUFRLEdBQUcsaUJBQWlCLENBQUM7SUFDbkMsTUFBTSxTQUFTLEdBQUcsa0JBQWtCLENBQUM7SUFDckMsTUFBTSxXQUFXLEdBQUcsb0JBQW9CLENBQUM7SUFDekMsTUFBTSxhQUFhLEdBQUcsc0JBQXNCLENBQUM7SUFDN0MsTUFBTSxjQUFjLEdBQUcsdUJBQXVCLENBQUM7SUFFL0Msd0JBQXdCO0lBQ3hCLE1BQU0sdUJBQXVCLEdBQUc7UUFDOUIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUNsQixDQUFD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S0FBSyxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUU1RCxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7aUJBQ2hELElBQUksQ0FBQyxlQUFlLFdBQVcsWUFBWSxDQUFDO2lCQUM1QyxHQUFHLENBQUMsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLENBQUM7aUJBQ3ZDLElBQUksQ0FBQztnQkFDSixXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxlQUFlLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7YUFDMUMsQ0FBQyxDQUFDO1lBRUwsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLDZCQUE2QixDQUFDLCtCQUErQixDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUMzRixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHBhZ2FtZW50b1xcdGVzdHNcXGludGVncmF0aW9uXFxjb25maXJtYWNvZXMuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IElOZXN0QXBwbGljYXRpb24gfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgKiBhcyByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgeyBnZXRSZXBvc2l0b3J5VG9rZW4gfSBmcm9tICdAbmVzdGpzL3R5cGVvcm0nO1xuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgQ29uZmlnTW9kdWxlLCBDb25maWdTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9jb25maWcnO1xuaW1wb3J0IHsgSnd0TW9kdWxlLCBKd3RTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9qd3QnO1xuaW1wb3J0IHsgSHR0cE1vZHVsZSB9IGZyb20gJ0BuZXN0anMvYXhpb3MnO1xuXG5pbXBvcnQgeyBQYWdhbWVudG9Nb2R1bGUgfSBmcm9tICcuLi8uLi9wYWdhbWVudG8ubW9kdWxlJztcbmltcG9ydCB7IFxuICBQYWdhbWVudG8sIFxuICBDb21wcm92YW50ZVBhZ2FtZW50bywgXG4gIENvbmZpcm1hY2FvUmVjZWJpbWVudG8gXG59IGZyb20gJy4uLy4uL2VudGl0aWVzJztcbmltcG9ydCB7IFN0YXR1c1BhZ2FtZW50b0VudW0gfSBmcm9tICcuLi8uLi9lbnVtcy9zdGF0dXMtcGFnYW1lbnRvLmVudW0nO1xuaW1wb3J0IHsgTWV0b2RvUGFnYW1lbnRvRW51bSB9IGZyb20gJy4uLy4uL2VudW1zL21ldG9kby1wYWdhbWVudG8uZW51bSc7XG5pbXBvcnQgeyBQYWdhbWVudG9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcGFnYW1lbnRvLnNlcnZpY2UnO1xuaW1wb3J0IHsgQXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2F1ZGl0b3JpYS1wYWdhbWVudG8uc2VydmljZSc7XG5cbi8qKlxuICogVGVzdGVzIGRlIGludGVncmHDp8OjbyBwYXJhIGNvbmZpcm1hw6fDtWVzIGRlIHJlY2ViaW1lbnRvIGRlIHBhZ2FtZW50b1xuICogXG4gKiBWZXJpZmljYSBvIGZ1bmNpb25hbWVudG8gY29ycmV0byBkYXMgb3BlcmHDp8O1ZXMgZGUgcmVnaXN0cm8sIGNvbnN1bHRhXG4gKiBlIGxpc3RhZ2VtIGRlIGNvbmZpcm1hw6fDtWVzIGRlIHJlY2ViaW1lbnRvIGRlIHBhZ2FtZW50b3MuXG4gKiBcbiAqIEBhdXRob3IgRXF1aXBlIFBHQmVuXG4gKi9cbmRlc2NyaWJlKCdDb25maXJtYcOnw7VlcyBkZSBSZWNlYmltZW50byAoSW50ZWdyYXRpb24pJywgKCkgPT4ge1xuICBsZXQgYXBwOiBJTmVzdEFwcGxpY2F0aW9uO1xuICBsZXQgand0U2VydmljZTogSnd0U2VydmljZTtcbiAgbGV0IHBhZ2FtZW50b1NlcnZpY2U6IFBhZ2FtZW50b1NlcnZpY2U7XG4gIGxldCBhdWRpdG9yaWFQYWdhbWVudG9TZXJ2aWNlOiBBdWRpdG9yaWFQYWdhbWVudG9TZXJ2aWNlO1xuICBcbiAgbGV0IHBhZ2FtZW50b1JlcG9zaXRvcnk6IFJlcG9zaXRvcnk8UGFnYW1lbnRvPjtcbiAgbGV0IGNvbmZpcm1hY2FvUmVwb3NpdG9yeTogUmVwb3NpdG9yeTxDb25maXJtYWNhb1JlY2ViaW1lbnRvPjtcbiAgXG4gIC8vIERhZG9zIGRlIHRlc3RlXG4gIGNvbnN0IHVzdWFyaW9JZCA9ICd1c3VhcmlvLXRlc3RlLWlkJztcbiAgY29uc3QgZ2VzdG9ySWQgPSAnZ2VzdG9yLXRlc3RlLWlkJztcbiAgY29uc3QgdW5pZGFkZUlkID0gJ3VuaWRhZGUtdGVzdGUtaWQnO1xuICBjb25zdCBwYWdhbWVudG9JZCA9ICdwYWdhbWVudG8tdGVzdGUtaWQnO1xuICBjb25zdCBjb25maXJtYWNhb0lkID0gJ2NvbmZpcm1hY2FvLXRlc3RlLWlkJztcbiAgY29uc3QgYmVuZWZpY2lhcmlvSWQgPSAnYmVuZWZpY2lhcmlvLXRlc3RlLWlkJztcbiAgXG4gIC8vIE1vY2sgZG9zIHJlcG9zaXTDs3Jpb3NcbiAgY29uc3QgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkgPSB7XG4gICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgIHNhdmU6IGplc3QuZm4oKSxcbiAgICB1cGRhdGU6IGplc3QuZm4oKVxuICB9O1xuXG4gIGNvbnN0IG1vY2tDb25maXJtYWNhb1JlcG9zaXRvcnkgPSB7XG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgc2F2ZTogamVzdC5mbigpLFxuICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICBmaW5kOiBqZXN0LmZuKCksXG4gICAgZmluZEFuZENvdW50OiBqZXN0LmZuKClcbiAgfTtcblxuICAvLyBNb2NrIGRvIHNlcnZpw6dvIGRlIGF1ZGl0b3JpYVxuICBjb25zdCBtb2NrQXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZSA9IHtcbiAgICBsb2dDb25maXJtYWNhb1JlY2ViaW1lbnRvOiBqZXN0LmZuKCksXG4gICAgbG9nRXJyb1Byb2Nlc3NhbWVudG86IGplc3QuZm4oKSxcbiAgICBsb2dUZW50YXRpdmFBY2Vzc29OYW9BdXRvcml6YWRvOiBqZXN0LmZuKClcbiAgfTtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vZHVsZUZpeHR1cmU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgaW1wb3J0czogW1xuICAgICAgICBQYWdhbWVudG9Nb2R1bGUsXG4gICAgICAgIENvbmZpZ01vZHVsZS5mb3JSb290KHtcbiAgICAgICAgICBpc0dsb2JhbDogdHJ1ZSxcbiAgICAgICAgICBlbnZGaWxlUGF0aDogJy5lbnYudGVzdCdcbiAgICAgICAgfSksXG4gICAgICAgIEp3dE1vZHVsZS5yZWdpc3RlckFzeW5jKHtcbiAgICAgICAgICBpbXBvcnRzOiBbQ29uZmlnTW9kdWxlXSxcbiAgICAgICAgICB1c2VGYWN0b3J5OiAoY29uZmlnU2VydmljZTogQ29uZmlnU2VydmljZSkgPT4gKHtcbiAgICAgICAgICAgIHNlY3JldDogY29uZmlnU2VydmljZS5nZXQoJ0pXVF9TRUNSRVQnKSB8fCAndGVzdGUtc2VjcmV0JyxcbiAgICAgICAgICAgIHNpZ25PcHRpb25zOiB7IGV4cGlyZXNJbjogJzFoJyB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIGluamVjdDogW0NvbmZpZ1NlcnZpY2VdXG4gICAgICAgIH0pLFxuICAgICAgICBIdHRwTW9kdWxlXG4gICAgICBdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBnZXRSZXBvc2l0b3J5VG9rZW4oUGFnYW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnlcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IGdldFJlcG9zaXRvcnlUb2tlbihDb25maXJtYWNhb1JlY2ViaW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogZ2V0UmVwb3NpdG9yeVRva2VuKENvbXByb3ZhbnRlUGFnYW1lbnRvKSxcbiAgICAgICAgICB1c2VWYWx1ZToge31cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IEF1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tBdWRpdG9yaWFQYWdhbWVudG9TZXJ2aWNlXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KS5jb21waWxlKCk7XG5cbiAgICBhcHAgPSBtb2R1bGVGaXh0dXJlLmNyZWF0ZU5lc3RBcHBsaWNhdGlvbigpO1xuICAgIGp3dFNlcnZpY2UgPSBtb2R1bGVGaXh0dXJlLmdldDxKd3RTZXJ2aWNlPihKd3RTZXJ2aWNlKTtcbiAgICBwYWdhbWVudG9TZXJ2aWNlID0gbW9kdWxlRml4dHVyZS5nZXQ8UGFnYW1lbnRvU2VydmljZT4oUGFnYW1lbnRvU2VydmljZSk7XG4gICAgYXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZSA9IG1vZHVsZUZpeHR1cmUuZ2V0PEF1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2U+KEF1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UpO1xuICAgIFxuICAgIHBhZ2FtZW50b1JlcG9zaXRvcnkgPSBtb2R1bGVGaXh0dXJlLmdldDxSZXBvc2l0b3J5PFBhZ2FtZW50bz4+KGdldFJlcG9zaXRvcnlUb2tlbihQYWdhbWVudG8pKTtcbiAgICBjb25maXJtYWNhb1JlcG9zaXRvcnkgPSBtb2R1bGVGaXh0dXJlLmdldDxSZXBvc2l0b3J5PENvbmZpcm1hY2FvUmVjZWJpbWVudG8+PihnZXRSZXBvc2l0b3J5VG9rZW4oQ29uZmlybWFjYW9SZWNlYmltZW50bykpO1xuICAgIFxuICAgIGF3YWl0IGFwcC5pbml0KCk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBhcHAuY2xvc2UoKTtcbiAgfSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8gQ29uZmlndXJhciBtb2NrcyBwYWRyw6NvXG4gICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrSW1wbGVtZW50YXRpb24oKG9wdGlvbnMpID0+IHtcbiAgICAgIGlmIChvcHRpb25zLndoZXJlPy5pZCA9PT0gcGFnYW1lbnRvSWQpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgaWQ6IHBhZ2FtZW50b0lkLFxuICAgICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5QQUdPLFxuICAgICAgICAgIHVuaWRhZGVJZCxcbiAgICAgICAgICBiZW5lZmljaWFyaW9JZCxcbiAgICAgICAgICB2YWxvcjogNTAwLjAwLFxuICAgICAgICAgIG1ldG9kb1BhZ2FtZW50bzogTWV0b2RvUGFnYW1lbnRvRW51bS5QSVhcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH0pO1xuICAgIFxuICAgIG1vY2tDb25maXJtYWNhb1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrSW1wbGVtZW50YXRpb24oKG9wdGlvbnMpID0+IHtcbiAgICAgIGlmIChvcHRpb25zLndoZXJlPy5pZCA9PT0gY29uZmlybWFjYW9JZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBpZDogY29uZmlybWFjYW9JZCxcbiAgICAgICAgICBwYWdhbWVudG9JZCxcbiAgICAgICAgICBkYXRhQ29uZmlybWFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgICAgb2JzZXJ2YWNvZXM6ICdQYWdhbWVudG8gcmVjZWJpZG8gdmlhIFBJWCcsXG4gICAgICAgICAgbnVtZXJvUHJvdG9jb2xvOiAnMTIzNDU2Nzg5JyxcbiAgICAgICAgICBjb25maXJtYWRvUG9yOiBiZW5lZmljaWFyaW9JZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbnMud2hlcmU/LnBhZ2FtZW50b0lkID09PSBwYWdhbWVudG9JZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBpZDogY29uZmlybWFjYW9JZCxcbiAgICAgICAgICBwYWdhbWVudG9JZCxcbiAgICAgICAgICBkYXRhQ29uZmlybWFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgICAgb2JzZXJ2YWNvZXM6ICdQYWdhbWVudG8gcmVjZWJpZG8gdmlhIFBJWCcsXG4gICAgICAgICAgbnVtZXJvUHJvdG9jb2xvOiAnMTIzNDU2Nzg5JyxcbiAgICAgICAgICBjb25maXJtYWRvUG9yOiBiZW5lZmljaWFyaW9JZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH0pO1xuICAgIFxuICAgIG1vY2tDb25maXJtYWNhb1JlcG9zaXRvcnkuY3JlYXRlLm1vY2tJbXBsZW1lbnRhdGlvbigoZHRvKSA9PiAoe1xuICAgICAgaWQ6IGNvbmZpcm1hY2FvSWQsXG4gICAgICBwYWdhbWVudG9JZDogZHRvLnBhZ2FtZW50b0lkLFxuICAgICAgZGF0YUNvbmZpcm1hY2FvOiBkdG8uZGF0YUNvbmZpcm1hY2FvIHx8IG5ldyBEYXRlKCksXG4gICAgICBvYnNlcnZhY29lczogZHRvLm9ic2VydmFjb2VzLFxuICAgICAgbnVtZXJvUHJvdG9jb2xvOiBkdG8ubnVtZXJvUHJvdG9jb2xvIHx8ICcxMjM0NTY3ODknLFxuICAgICAgY29uZmlybWFkb1BvcjogZHRvLmNvbmZpcm1hZG9Qb3IgfHwgYmVuZWZpY2lhcmlvSWQsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICB9KSk7XG4gICAgXG4gICAgbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeS5zYXZlLm1vY2tJbXBsZW1lbnRhdGlvbigoZHRvKSA9PiBQcm9taXNlLnJlc29sdmUoZHRvKSk7XG4gIH0pO1xuXG4gIC8vIEZ1bsOnw6NvIGF1eGlsaWFyIHBhcmEgZ2VyYXIgdG9rZW5zIEpXVFxuICBjb25zdCBnZXJhclRva2VuID0gKHVzZXJJZDogc3RyaW5nLCBwZXJmaXM6IHN0cmluZ1tdID0gWyd1c3VhcmlvJ10sIHVuaWRhZGVJZDogc3RyaW5nID0gJ3VuaWRhZGUtdGVzdGUtaWQnKSA9PiB7XG4gICAgcmV0dXJuIGp3dFNlcnZpY2Uuc2lnbih7XG4gICAgICBzdWI6IHVzZXJJZCxcbiAgICAgIHBlcmZpcyxcbiAgICAgIHVuaWRhZGU6IHVuaWRhZGVJZFxuICAgIH0pO1xuICB9O1xuXG4gIGRlc2NyaWJlKCdSZWdpc3RybyBkZSBDb25maXJtYcOnw7VlcycsICgpID0+IHtcbiAgICBpdCgnZGV2ZSByZWdpc3RyYXIgY29uZmlybWHDp8OjbyBkZSByZWNlYmltZW50byBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihiZW5lZmljaWFyaW9JZCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29uZmlybWFyYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgb2JzZXJ2YWNvZXM6ICdQYWdhbWVudG8gcmVjZWJpZG8gdmlhIFBJWCcsXG4gICAgICAgICAgZGF0YUNvbmZpcm1hY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnBhZ2FtZW50b0lkKS50b0JlKHBhZ2FtZW50b0lkKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1vY2tDb25maXJtYWNhb1JlcG9zaXRvcnkuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoYXVkaXRvcmlhUGFnYW1lbnRvU2VydmljZS5sb2dDb25maXJtYWNhb1JlY2ViaW1lbnRvKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZWplaXRhciBjb25maXJtYcOnw6NvIHBhcmEgcGFnYW1lbnRvIG7Do28gZW5jb250cmFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNvYnJlc2NyZXZlciBtb2NrIHBhcmEgZXN0ZSB0ZXN0ZVxuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobnVsbCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihiZW5lZmljaWFyaW9JZCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvcGFnYW1lbnRvLWluZXhpc3RlbnRlL2NvbmZpcm1hcmApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIG9ic2VydmFjb2VzOiAnUGFnYW1lbnRvIHJlY2ViaWRvIHZpYSBQSVgnLFxuICAgICAgICAgIGRhdGFDb25maXJtYWNhbzogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwNCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5tZXNzYWdlKS50b0NvbnRhaW4oJ27Do28gZW5jb250cmFkbycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgY29uZmlybWHDp8OjbyBzZW0gZGFkb3Mgb2JyaWdhdMOzcmlvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihiZW5lZmljaWFyaW9JZCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAucG9zdChgL3BhZ2FtZW50b3MvJHtwYWdhbWVudG9JZH0vY29uZmlybWFyYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgLy8gRmFsdGFuZG8gb2JzZXJ2YWNvZXNcbiAgICAgICAgICBkYXRhQ29uZmlybWFjYW86IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubWVzc2FnZSkudG9Db250YWluKCdvYnNlcnZhY29lcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmVqZWl0YXIgY29uZmlybWHDp8OjbyBkdXBsaWNhZGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHBhcmEgc2ltdWxhciBxdWUgasOhIGV4aXN0ZSBjb25maXJtYcOnw6NvIHBhcmEgbyBwYWdhbWVudG9cbiAgICAgIG1vY2tDb25maXJtYWNhb1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrSW1wbGVtZW50YXRpb24oKG9wdGlvbnMpID0+IHtcbiAgICAgICAgaWYgKG9wdGlvbnMud2hlcmU/LnBhZ2FtZW50b0lkID09PSBwYWdhbWVudG9JZCkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgaWQ6IGNvbmZpcm1hY2FvSWQsXG4gICAgICAgICAgICBwYWdhbWVudG9JZCxcbiAgICAgICAgICAgIGRhdGFDb25maXJtYWNhbzogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIG9ic2VydmFjb2VzOiAnQ29uZmlybWHDp8OjbyBhbnRlcmlvcicsXG4gICAgICAgICAgICBjb25maXJtYWRvUG9yOiBiZW5lZmljaWFyaW9JZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGJlbmVmaWNpYXJpb0lkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5wb3N0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9jb25maXJtYXJgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBvYnNlcnZhY29lczogJ1NlZ3VuZGEgY29uZmlybWHDp8OjbycsXG4gICAgICAgICAgZGF0YUNvbmZpcm1hY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA5KTsgLy8gQ29uZmxpY3RcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignasOhIHBvc3N1aSB1bWEgY29uZmlybWHDp8OjbycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29uc3VsdGEgZGUgQ29uZmlybWHDp8O1ZXMnLCAoKSA9PiB7XG4gICAgaXQoJ2RldmUgYnVzY2FyIGNvbmZpcm1hw6fDo28gcG9yIElEIGNvbSBzdWNlc3NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvciddLCB1bmlkYWRlSWQpO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldChgL2NvbmZpcm1hY29lcy8ke2NvbmZpcm1hY2FvSWR9YClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpZCcsIGNvbmZpcm1hY2FvSWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdwYWdhbWVudG9JZCcsIHBhZ2FtZW50b0lkKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGJ1c2NhciBjb25maXJtYcOnw6NvIHBvciBwYWdhbWVudG9JZCBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InXSwgdW5pZGFkZUlkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5nZXQoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L2NvbmZpcm1hY2FvYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpZCcsIGNvbmZpcm1hY2FvSWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdwYWdhbWVudG9JZCcsIHBhZ2FtZW50b0lkKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIDQwNCBhbyBidXNjYXIgY29uZmlybWHDp8OjbyBpbmV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNvYnJlc2NyZXZlciBtb2NrIHBhcmEgZXN0ZSB0ZXN0ZVxuICAgICAgbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlT25jZShudWxsKTtcbiAgICAgIFxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvciddLCB1bmlkYWRlSWQpO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLmdldChgL2NvbmZpcm1hY29lcy9jb25maXJtYWNhby1pbmV4aXN0ZW50ZWApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA0KTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignbsOjbyBlbmNvbnRyYWRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsaXN0YXIgY29uZmlybWHDp8O1ZXMgY29tIHBhZ2luYcOnw6NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBwYXJhIGxpc3RhciBjb25maXJtYcOnw7Vlc1xuICAgICAgbW9ja0NvbmZpcm1hY2FvUmVwb3NpdG9yeS5maW5kQW5kQ291bnQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFtcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiBjb25maXJtYWNhb0lkLFxuICAgICAgICAgICAgcGFnYW1lbnRvSWQsXG4gICAgICAgICAgICBkYXRhQ29uZmlybWFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBvYnNlcnZhY29lczogJ1BhZ2FtZW50byByZWNlYmlkbyB2aWEgUElYJyxcbiAgICAgICAgICAgIG51bWVyb1Byb3RvY29sbzogJzEyMzQ1Njc4OScsXG4gICAgICAgICAgICBjb25maXJtYWRvUG9yOiBiZW5lZmljaWFyaW9JZCxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdjb25maXJtYWNhby1pZC0yJyxcbiAgICAgICAgICAgIHBhZ2FtZW50b0lkOiAnb3V0cm8tcGFnYW1lbnRvLWlkJyxcbiAgICAgICAgICAgIGRhdGFDb25maXJtYWNhbzogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIG9ic2VydmFjb2VzOiAnT3V0cm8gcGFnYW1lbnRvIHJlY2ViaWRvJyxcbiAgICAgICAgICAgIG51bWVyb1Byb3RvY29sbzogJzk4NzY1NDMyMScsXG4gICAgICAgICAgICBjb25maXJtYWRvUG9yOiAnb3V0cm8tYmVuZWZpY2lhcmlvLWlkJyxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgMiAvLyBUb3RhbCBjb3VudFxuICAgICAgXSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbihnZXN0b3JJZCwgWydnZXN0b3InXSwgdW5pZGFkZUlkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5nZXQoYC9jb25maXJtYWNvZXNgKVxuICAgICAgICAucXVlcnkoeyBwYWdlOiAxLCBsaW1pdDogMTAgfSlcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpdGVtcycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdtZXRhJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5pdGVtcykudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuaXRlbXMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm1ldGEudG90YWxJdGVtcykudG9CZSgyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlZ3VyYW7Dp2EgZSBBdXRvcml6YcOnw6NvJywgKCkgPT4ge1xuICAgIGl0KCdkZXZlIHBlcm1pdGlyIGJlbmVmaWNpw6FyaW8gY29uZmlybWFyIHByw7NwcmlvIHBhZ2FtZW50bycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNvYnJlc2NyZXZlciBtb2NrIHBhcmEgZXN0ZSB0ZXN0ZVxuICAgICAgbW9ja1BhZ2FtZW50b1JlcG9zaXRvcnkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBpZDogcGFnYW1lbnRvSWQsXG4gICAgICAgIHN0YXR1czogU3RhdHVzUGFnYW1lbnRvRW51bS5QQUdPLFxuICAgICAgICB1bmlkYWRlSWQsXG4gICAgICAgIGJlbmVmaWNpYXJpb0lkLFxuICAgICAgICB2YWxvcjogNTAwLjAwXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGJlbmVmaWNpYXJpb0lkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXG4gICAgICAgIC5wb3N0KGAvcGFnYW1lbnRvcy8ke3BhZ2FtZW50b0lkfS9jb25maXJtYXJgKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICBvYnNlcnZhY29lczogJ0NvbmZpcm1hw6fDo28gcGVsbyBiZW5lZmljacOhcmlvJyxcbiAgICAgICAgICBkYXRhQ29uZmlybWFjYW86IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcGVybWl0aXIgZ2VzdG9yIHJlZ2lzdHJhciBjb25maXJtYcOnw6NvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXJhclRva2VuKGdlc3RvcklkLCBbJ2dlc3RvciddLCB1bmlkYWRlSWQpO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLnBvc3QoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L2NvbmZpcm1hcmApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIG9ic2VydmFjb2VzOiAnQ29uZmlybWHDp8OjbyBwZWxvIGdlc3RvcicsXG4gICAgICAgICAgZGF0YUNvbmZpcm1hY2FvOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgY29uZmlybWFkb1BvcjogYmVuZWZpY2lhcmlvSWRcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIGFjZXNzbyBkZSB1c3XDoXJpbyBzZW0gcGVybWlzc8OjbyDDoHMgY29uZmlybWHDp8O1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IGdlcmFyVG9rZW4oJ291dHJvLXVzdWFyaW8nLCBbJ3VzdWFyaW9fYmFzaWNvJ10sICdvdXRyYS11bmlkYWRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxuICAgICAgICAuZ2V0KGAvY29uZmlybWFjb2VzYClcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHt0b2tlbn1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KG1vY2tBdWRpdG9yaWFQYWdhbWVudG9TZXJ2aWNlLmxvZ1RlbnRhdGl2YUFjZXNzb05hb0F1dG9yaXphZG8pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIGNvbmZpcm1hw6fDo28gZGUgcGFnYW1lbnRvIGRlIG91dHJhIHVuaWRhZGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTb2JyZXNjcmV2ZXIgbW9jayBwYXJhIGVzdGUgdGVzdGVcbiAgICAgIG1vY2tQYWdhbWVudG9SZXBvc2l0b3J5LmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgaWQ6IHBhZ2FtZW50b0lkLFxuICAgICAgICBzdGF0dXM6IFN0YXR1c1BhZ2FtZW50b0VudW0uUEFHTyxcbiAgICAgICAgdW5pZGFkZUlkOiAnb3V0cmEtdW5pZGFkZS1pZCcsXG4gICAgICAgIGJlbmVmaWNpYXJpb0lkOiAnb3V0cm8tYmVuZWZpY2lhcmlvLWlkJyxcbiAgICAgICAgdmFsb3I6IDUwMC4wMFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VyYXJUb2tlbih1c3VhcmlvSWQsIFsndXN1YXJpbyddLCB1bmlkYWRlSWQpO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcbiAgICAgICAgLnBvc3QoYC9wYWdhbWVudG9zLyR7cGFnYW1lbnRvSWR9L2NvbmZpcm1hcmApXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YClcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIG9ic2VydmFjb2VzOiAnVGVudGF0aXZhIGRlIGNvbmZpcm1hw6fDo28nLFxuICAgICAgICAgIGRhdGFDb25maXJtYWNhbzogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMyk7XG4gICAgICBleHBlY3QobW9ja0F1ZGl0b3JpYVBhZ2FtZW50b1NlcnZpY2UubG9nVGVudGF0aXZhQWNlc3NvTmFvQXV0b3JpemFkbykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9