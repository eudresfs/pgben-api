d73f08c4873775c81f288c082671b888
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var EventosService_1;
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.EventosService = void 0;
const common_1 = require("@nestjs/common");
const event_emitter_1 = require("@nestjs/event-emitter");
const solicitacao_events_1 = require("../events/solicitacao-events");
const solicitacao_entity_1 = require("../../../entities/solicitacao.entity");
/**
 * Serviço responsável pelo gerenciamento de eventos do módulo de solicitação
 *
 * Este serviço centraliza a emissão de eventos relacionados ao ciclo de vida das solicitações,
 * facilitando a comunicação assíncrona entre os diferentes componentes do sistema.
 */
let EventosService = EventosService_1 = class EventosService {
    eventEmitter;
    logger = new common_1.Logger(EventosService_1.name);
    constructor(eventEmitter) {
        this.eventEmitter = eventEmitter;
    }
    /**
     * Emite um evento relacionado a uma solicitação
     * @param evento Evento a ser emitido
     */
    emitirEvento(evento) {
        try {
            this.logger.debug(`Emitindo evento: ${evento.type} - Solicitação ID: ${evento.solicitacaoId}`);
            // Define timestamp caso não tenha sido definido
            if (!evento.timestamp) {
                evento.timestamp = new Date();
            }
            // Emite o evento
            this.eventEmitter.emit(evento.type, evento);
            this.logger.debug(`Evento emitido com sucesso: ${evento.type}`);
        }
        catch (error) {
            this.logger.error(`Erro ao emitir evento ${evento.type}: ${error.message}`, error.stack);
        }
    }
    /**
     * Emite evento de criação de solicitação
     * @param solicitacao Solicitação criada
     */
    emitirEventoCriacao(solicitacao) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.CREATED,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                protocolo: solicitacao.protocolo,
                tipoBeneficioId: solicitacao.tipo_beneficio_id || '',
                cidadaoId: solicitacao.beneficiario?.id || '',
                tecnicoId: solicitacao.tecnico_id || '',
                unidadeId: solicitacao.unidade_id || '',
            },
        });
    }
    /**
     * Emite evento de alteração de status
     * @param solicitacao Solicitação alterada
     * @param statusAnterior Status anterior
     * @param usuarioId ID do usuário que realizou a alteração
     * @param observacao Observação sobre a alteração
     */
    emitirEventoAlteracaoStatus(solicitacao, statusAnterior, usuarioId, observacao) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.STATUS_CHANGED,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                statusAnterior,
                statusAtual: solicitacao.status,
                usuarioId,
                observacao,
            },
        });
        // Emitir eventos específicos com base no novo status
        switch (solicitacao.status) {
            case solicitacao_entity_1.StatusSolicitacao.APROVADA:
                this.emitirEvento({
                    type: solicitacao_events_1.SolicitacaoEventType.APPROVED,
                    solicitacaoId: solicitacao.id,
                    timestamp: new Date(),
                    data: {
                        aprovadorId: usuarioId,
                        observacao,
                        dataAprovacao: solicitacao.data_aprovacao || new Date(),
                    },
                });
                break;
            case solicitacao_entity_1.StatusSolicitacao.INDEFERIDA:
                this.emitirEvento({
                    type: solicitacao_events_1.SolicitacaoEventType.REJECTED,
                    solicitacaoId: solicitacao.id,
                    timestamp: new Date(),
                    data: {
                        reprovadorId: usuarioId,
                        motivoReprovacao: observacao || 'Não especificado',
                        dataReprovacao: new Date(),
                    },
                });
                break;
            case solicitacao_entity_1.StatusSolicitacao.LIBERADA:
                this.emitirEvento({
                    type: solicitacao_events_1.SolicitacaoEventType.RELEASED,
                    solicitacaoId: solicitacao.id,
                    timestamp: new Date(),
                    data: {
                        liberadorId: usuarioId,
                        dataLiberacao: solicitacao.data_liberacao || new Date(),
                        observacao,
                    },
                });
                break;
            case solicitacao_entity_1.StatusSolicitacao.CONCLUIDA:
                this.logger.log(`Solicitação ${solicitacao.id} concluída`);
                break;
            case solicitacao_entity_1.StatusSolicitacao.CANCELADA:
                this.logger.log(`Solicitação ${solicitacao.id} cancelada: ${observacao || 'Não especificado'}`);
                break;
            case solicitacao_entity_1.StatusSolicitacao.ARQUIVADA:
                this.logger.log(`Solicitação ${solicitacao.id} arquivada`);
                break;
        }
    }
    /**
     * Emite evento de prazo próximo do vencimento
     * @param solicitacao Solicitação com prazo próximo
     * @param tipoPrazo Tipo de prazo
     * @param diasRestantes Dias restantes até o vencimento
     */
    emitirEventoPrazoProximo(solicitacao, tipoPrazo, diasRestantes) {
        const dataPrazo = solicitacao[`prazo_${tipoPrazo}`];
        if (!dataPrazo) {
            return;
        }
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.DEADLINE_APPROACHING,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                tipoPrazo,
                dataPrazo,
                diasRestantes,
                determinacaoJudicial: solicitacao.determinacao_judicial_flag || false,
            },
        });
    }
    /**
     * Emite evento de prazo expirado
     * @param solicitacao Solicitação com prazo expirado
     * @param tipoPrazo Tipo de prazo
     * @param diasAtraso Dias de atraso desde o vencimento
     */
    emitirEventoPrazoExpirado(solicitacao, tipoPrazo, diasAtraso) {
        const dataPrazo = solicitacao[`prazo_${tipoPrazo}`];
        if (!dataPrazo) {
            return;
        }
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.DEADLINE_EXPIRED,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                tipoPrazo,
                dataPrazo,
                diasAtraso,
                determinacaoJudicial: solicitacao.determinacao_judicial_flag || false,
            },
        });
    }
    /**
     * Emite evento de anexação de determinação judicial
     * @param solicitacao Solicitação à qual a determinação foi anexada
     * @param determinacaoJudicialId ID da determinação judicial
     * @param usuarioId ID do usuário que realizou a anexação
     * @param observacao Observação sobre a anexação
     */
    emitirEventoDeterminacaoJudicialAnexada(solicitacao, determinacaoJudicialId, usuarioId, observacao) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.JUDICIAL_DETERMINATION_ATTACHED,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                determinacaoJudicialId,
                usuarioId,
                observacao,
            },
        });
    }
    /**
     * Emite evento de criação de pendência
     * @param solicitacaoId ID da solicitação
     * @param pendenciaId ID da pendência criada
     * @param descricao Descrição da pendência
     * @param usuarioId ID do usuário que criou a pendência
     * @param prazo Data limite para resolução da pendência
     */
    emitirEventoPendenciaCriada(solicitacaoId, pendenciaId, descricao, usuarioId, prazo) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.PENDENCY_CREATED,
            solicitacaoId,
            timestamp: new Date(),
            data: {
                pendenciaId,
                descricao,
                prazo,
                usuarioId,
            },
        });
    }
    /**
     * Emite evento de resolução de pendência
     * @param solicitacaoId ID da solicitação
     * @param pendenciaId ID da pendência resolvida
     * @param resolucao Descrição da resolução
     * @param usuarioId ID do usuário que resolveu a pendência
     */
    emitirEventoPendenciaResolvida(solicitacaoId, pendenciaId, resolucao, usuarioId) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.PENDENCY_RESOLVED,
            solicitacaoId,
            timestamp: new Date(),
            data: {
                pendenciaId,
                resolucao,
                usuarioId,
                dataResolucao: new Date(),
            },
        });
    }
    /**
     * Emite evento de atribuição de solicitação a um técnico
     * @param solicitacao Solicitação atribuída
     * @param tecnicoAnteriorId ID do técnico anterior (opcional)
     * @param tecnicoAtualId ID do novo técnico
     * @param usuarioAtribuicaoId ID do usuário que realizou a atribuição
     * @param motivoAtribuicao Motivo da atribuição
     */
    emitirEventoAtribuicao(solicitacao, tecnicoAtualId, usuarioAtribuicaoId, tecnicoAnteriorId, motivoAtribuicao) {
        this.emitirEvento({
            type: solicitacao_events_1.SolicitacaoEventType.ASSIGNED,
            solicitacaoId: solicitacao.id,
            timestamp: new Date(),
            data: {
                tecnicoAnteriorId,
                tecnicoAtualId,
                usuarioAtribuicaoId,
                motivoAtribuicao,
            },
        });
    }
};
exports.EventosService = EventosService;
exports.EventosService = EventosService = EventosService_1 = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [typeof (_a = typeof event_emitter_1.EventEmitter2 !== "undefined" && event_emitter_1.EventEmitter2) === "function" ? _a : Object])
], EventosService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxldWRyZVxcT25lRHJpdmVcXERlc2t0b3BcXFByb2pldG9zXFxwZ2JlblxccGdiZW4tc2VydmVyXFxzcmNcXG1vZHVsZXNcXHNvbGljaXRhY2FvXFxzZXJ2aWNlc1xcZXZlbnRvcy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQW9EO0FBQ3BELHlEQUFzRDtBQUN0RCxxRUFJc0M7QUFDdEMsNkVBRzhDO0FBRTlDOzs7OztHQUtHO0FBRUksSUFBTSxjQUFjLHNCQUFwQixNQUFNLGNBQWM7SUFHSTtJQUZaLE1BQU0sR0FBRyxJQUFJLGVBQU0sQ0FBQyxnQkFBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRTFELFlBQTZCLFlBQTJCO1FBQTNCLGlCQUFZLEdBQVosWUFBWSxDQUFlO0lBQUcsQ0FBQztJQUU1RDs7O09BR0c7SUFDSCxZQUFZLENBQUMsTUFBNkI7UUFDeEMsSUFBSSxDQUFDO1lBQ0gsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQ2Ysb0JBQW9CLE1BQU0sQ0FBQyxJQUFJLHNCQUFzQixNQUFNLENBQUMsYUFBYSxFQUFFLENBQzVFLENBQUM7WUFFRixnREFBZ0Q7WUFDaEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsQ0FBQztnQkFDdEIsTUFBTSxDQUFDLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1lBQ2hDLENBQUM7WUFFRCxpQkFBaUI7WUFDakIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztZQUU1QyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQywrQkFBK0IsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDbEUsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FDZix5QkFBeUIsTUFBTSxDQUFDLElBQUksS0FBSyxLQUFLLENBQUMsT0FBTyxFQUFFLEVBQ3hELEtBQUssQ0FBQyxLQUFLLENBQ1osQ0FBQztRQUNKLENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsbUJBQW1CLENBQUMsV0FBd0I7UUFDMUMsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsT0FBTztZQUNsQyxhQUFhLEVBQUUsV0FBVyxDQUFDLEVBQUU7WUFDN0IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1lBQ3JCLElBQUksRUFBRTtnQkFDSixTQUFTLEVBQUUsV0FBVyxDQUFDLFNBQVM7Z0JBQ2hDLGVBQWUsRUFBRSxXQUFXLENBQUMsaUJBQWlCLElBQUksRUFBRTtnQkFDcEQsU0FBUyxFQUFFLFdBQVcsQ0FBQyxZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUU7Z0JBQzdDLFNBQVMsRUFBRSxXQUFXLENBQUMsVUFBVSxJQUFJLEVBQUU7Z0JBQ3ZDLFNBQVMsRUFBRSxXQUFXLENBQUMsVUFBVSxJQUFJLEVBQUU7YUFDeEM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0gsMkJBQTJCLENBQ3pCLFdBQXdCLEVBQ3hCLGNBQWlDLEVBQ2pDLFNBQWlCLEVBQ2pCLFVBQW1CO1FBRW5CLElBQUksQ0FBQyxZQUFZLENBQUM7WUFDaEIsSUFBSSxFQUFFLHlDQUFvQixDQUFDLGNBQWM7WUFDekMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxFQUFFO1lBQzdCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtZQUNyQixJQUFJLEVBQUU7Z0JBQ0osY0FBYztnQkFDZCxXQUFXLEVBQUUsV0FBVyxDQUFDLE1BQU07Z0JBQy9CLFNBQVM7Z0JBQ1QsVUFBVTthQUNYO1NBQ0YsQ0FBQyxDQUFDO1FBRUgscURBQXFEO1FBQ3JELFFBQVEsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQzNCLEtBQUssc0NBQWlCLENBQUMsUUFBUTtnQkFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQztvQkFDaEIsSUFBSSxFQUFFLHlDQUFvQixDQUFDLFFBQVE7b0JBQ25DLGFBQWEsRUFBRSxXQUFXLENBQUMsRUFBRTtvQkFDN0IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO29CQUNyQixJQUFJLEVBQUU7d0JBQ0osV0FBVyxFQUFFLFNBQVM7d0JBQ3RCLFVBQVU7d0JBQ1YsYUFBYSxFQUFFLFdBQVcsQ0FBQyxjQUFjLElBQUksSUFBSSxJQUFJLEVBQUU7cUJBQ3hEO2lCQUNGLENBQUMsQ0FBQztnQkFDSCxNQUFNO1lBRVIsS0FBSyxzQ0FBaUIsQ0FBQyxVQUFVO2dCQUMvQixJQUFJLENBQUMsWUFBWSxDQUFDO29CQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsUUFBUTtvQkFDbkMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxFQUFFO29CQUM3QixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7b0JBQ3JCLElBQUksRUFBRTt3QkFDSixZQUFZLEVBQUUsU0FBUzt3QkFDdkIsZ0JBQWdCLEVBQUUsVUFBVSxJQUFJLGtCQUFrQjt3QkFDbEQsY0FBYyxFQUFFLElBQUksSUFBSSxFQUFFO3FCQUMzQjtpQkFDRixDQUFDLENBQUM7Z0JBQ0gsTUFBTTtZQUVSLEtBQUssc0NBQWlCLENBQUMsUUFBUTtnQkFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQztvQkFDaEIsSUFBSSxFQUFFLHlDQUFvQixDQUFDLFFBQVE7b0JBQ25DLGFBQWEsRUFBRSxXQUFXLENBQUMsRUFBRTtvQkFDN0IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO29CQUNyQixJQUFJLEVBQUU7d0JBQ0osV0FBVyxFQUFFLFNBQVM7d0JBQ3RCLGFBQWEsRUFBRSxXQUFXLENBQUMsY0FBYyxJQUFJLElBQUksSUFBSSxFQUFFO3dCQUN2RCxVQUFVO3FCQUNYO2lCQUNGLENBQUMsQ0FBQztnQkFDSCxNQUFNO1lBRVIsS0FBSyxzQ0FBaUIsQ0FBQyxTQUFTO2dCQUM5QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxlQUFlLFdBQVcsQ0FBQyxFQUFFLFlBQVksQ0FBQyxDQUFDO2dCQUMzRCxNQUFNO1lBRVIsS0FBSyxzQ0FBaUIsQ0FBQyxTQUFTO2dCQUM5QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FDYixlQUFlLFdBQVcsQ0FBQyxFQUFFLGVBQWUsVUFBVSxJQUFJLGtCQUFrQixFQUFFLENBQy9FLENBQUM7Z0JBQ0YsTUFBTTtZQUVSLEtBQUssc0NBQWlCLENBQUMsU0FBUztnQkFDOUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsZUFBZSxXQUFXLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztnQkFDM0QsTUFBTTtRQUNWLENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCx3QkFBd0IsQ0FDdEIsV0FBd0IsRUFDeEIsU0FBcUQsRUFDckQsYUFBcUI7UUFFckIsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLFNBQVMsU0FBUyxFQUFFLENBQVMsQ0FBQztRQUU1RCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDZixPQUFPO1FBQ1QsQ0FBQztRQUVELElBQUksQ0FBQyxZQUFZLENBQUM7WUFDaEIsSUFBSSxFQUFFLHlDQUFvQixDQUFDLG9CQUFvQjtZQUMvQyxhQUFhLEVBQUUsV0FBVyxDQUFDLEVBQUU7WUFDN0IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1lBQ3JCLElBQUksRUFBRTtnQkFDSixTQUFTO2dCQUNULFNBQVM7Z0JBQ1QsYUFBYTtnQkFDYixvQkFBb0IsRUFBRSxXQUFXLENBQUMsMEJBQTBCLElBQUksS0FBSzthQUN0RTtTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILHlCQUF5QixDQUN2QixXQUF3QixFQUN4QixTQUFxRCxFQUNyRCxVQUFrQjtRQUVsQixNQUFNLFNBQVMsR0FBRyxXQUFXLENBQUMsU0FBUyxTQUFTLEVBQUUsQ0FBUyxDQUFDO1FBRTVELElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUNmLE9BQU87UUFDVCxDQUFDO1FBRUQsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsZ0JBQWdCO1lBQzNDLGFBQWEsRUFBRSxXQUFXLENBQUMsRUFBRTtZQUM3QixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7WUFDckIsSUFBSSxFQUFFO2dCQUNKLFNBQVM7Z0JBQ1QsU0FBUztnQkFDVCxVQUFVO2dCQUNWLG9CQUFvQixFQUFFLFdBQVcsQ0FBQywwQkFBMEIsSUFBSSxLQUFLO2FBQ3RFO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILHVDQUF1QyxDQUNyQyxXQUF3QixFQUN4QixzQkFBOEIsRUFDOUIsU0FBaUIsRUFDakIsVUFBbUI7UUFFbkIsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsK0JBQStCO1lBQzFELGFBQWEsRUFBRSxXQUFXLENBQUMsRUFBRTtZQUM3QixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7WUFDckIsSUFBSSxFQUFFO2dCQUNKLHNCQUFzQjtnQkFDdEIsU0FBUztnQkFDVCxVQUFVO2FBQ1g7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNILDJCQUEyQixDQUN6QixhQUFxQixFQUNyQixXQUFtQixFQUNuQixTQUFpQixFQUNqQixTQUFpQixFQUNqQixLQUFZO1FBRVosSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsZ0JBQWdCO1lBQzNDLGFBQWE7WUFDYixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7WUFDckIsSUFBSSxFQUFFO2dCQUNKLFdBQVc7Z0JBQ1gsU0FBUztnQkFDVCxLQUFLO2dCQUNMLFNBQVM7YUFDVjtTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7O09BTUc7SUFDSCw4QkFBOEIsQ0FDNUIsYUFBcUIsRUFDckIsV0FBbUIsRUFDbkIsU0FBaUIsRUFDakIsU0FBaUI7UUFFakIsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixJQUFJLEVBQUUseUNBQW9CLENBQUMsaUJBQWlCO1lBQzVDLGFBQWE7WUFDYixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7WUFDckIsSUFBSSxFQUFFO2dCQUNKLFdBQVc7Z0JBQ1gsU0FBUztnQkFDVCxTQUFTO2dCQUNULGFBQWEsRUFBRSxJQUFJLElBQUksRUFBRTthQUMxQjtTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0gsc0JBQXNCLENBQ3BCLFdBQXdCLEVBQ3hCLGNBQXNCLEVBQ3RCLG1CQUEyQixFQUMzQixpQkFBMEIsRUFDMUIsZ0JBQXlCO1FBRXpCLElBQUksQ0FBQyxZQUFZLENBQUM7WUFDaEIsSUFBSSxFQUFFLHlDQUFvQixDQUFDLFFBQVE7WUFDbkMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxFQUFFO1lBQzdCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtZQUNyQixJQUFJLEVBQUU7Z0JBQ0osaUJBQWlCO2dCQUNqQixjQUFjO2dCQUNkLG1CQUFtQjtnQkFDbkIsZ0JBQWdCO2FBQ2pCO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGLENBQUE7QUEzU1ksd0NBQWM7eUJBQWQsY0FBYztJQUQxQixJQUFBLG1CQUFVLEdBQUU7eURBSWdDLDZCQUFhLG9CQUFiLDZCQUFhO0dBSDdDLGNBQWMsQ0EyUzFCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZXVkcmVcXE9uZURyaXZlXFxEZXNrdG9wXFxQcm9qZXRvc1xccGdiZW5cXHBnYmVuLXNlcnZlclxcc3JjXFxtb2R1bGVzXFxzb2xpY2l0YWNhb1xcc2VydmljZXNcXGV2ZW50b3Muc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBMb2dnZXIgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIyIH0gZnJvbSAnQG5lc3Rqcy9ldmVudC1lbWl0dGVyJztcbmltcG9ydCB7XG4gIFNvbGljaXRhY2FvRXZlbnQsXG4gIFNvbGljaXRhY2FvRXZlbnRUeXBlLFxuICBTb2xpY2l0YWNhb0V2ZW50VW5pb24sXG59IGZyb20gJy4uL2V2ZW50cy9zb2xpY2l0YWNhby1ldmVudHMnO1xuaW1wb3J0IHtcbiAgU29saWNpdGFjYW8sXG4gIFN0YXR1c1NvbGljaXRhY2FvLFxufSBmcm9tICcuLi8uLi8uLi9lbnRpdGllcy9zb2xpY2l0YWNhby5lbnRpdHknO1xuXG4vKipcbiAqIFNlcnZpw6dvIHJlc3BvbnPDoXZlbCBwZWxvIGdlcmVuY2lhbWVudG8gZGUgZXZlbnRvcyBkbyBtw7NkdWxvIGRlIHNvbGljaXRhw6fDo29cbiAqXG4gKiBFc3RlIHNlcnZpw6dvIGNlbnRyYWxpemEgYSBlbWlzc8OjbyBkZSBldmVudG9zIHJlbGFjaW9uYWRvcyBhbyBjaWNsbyBkZSB2aWRhIGRhcyBzb2xpY2l0YcOnw7VlcyxcbiAqIGZhY2lsaXRhbmRvIGEgY29tdW5pY2HDp8OjbyBhc3PDrW5jcm9uYSBlbnRyZSBvcyBkaWZlcmVudGVzIGNvbXBvbmVudGVzIGRvIHNpc3RlbWEuXG4gKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBFdmVudG9zU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyID0gbmV3IExvZ2dlcihFdmVudG9zU2VydmljZS5uYW1lKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGV2ZW50RW1pdHRlcjogRXZlbnRFbWl0dGVyMikge31cblxuICAvKipcbiAgICogRW1pdGUgdW0gZXZlbnRvIHJlbGFjaW9uYWRvIGEgdW1hIHNvbGljaXRhw6fDo29cbiAgICogQHBhcmFtIGV2ZW50byBFdmVudG8gYSBzZXIgZW1pdGlkb1xuICAgKi9cbiAgZW1pdGlyRXZlbnRvKGV2ZW50bzogU29saWNpdGFjYW9FdmVudFVuaW9uKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKFxuICAgICAgICBgRW1pdGluZG8gZXZlbnRvOiAke2V2ZW50by50eXBlfSAtIFNvbGljaXRhw6fDo28gSUQ6ICR7ZXZlbnRvLnNvbGljaXRhY2FvSWR9YCxcbiAgICAgICk7XG5cbiAgICAgIC8vIERlZmluZSB0aW1lc3RhbXAgY2FzbyBuw6NvIHRlbmhhIHNpZG8gZGVmaW5pZG9cbiAgICAgIGlmICghZXZlbnRvLnRpbWVzdGFtcCkge1xuICAgICAgICBldmVudG8udGltZXN0YW1wID0gbmV3IERhdGUoKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW1pdGUgbyBldmVudG9cbiAgICAgIHRoaXMuZXZlbnRFbWl0dGVyLmVtaXQoZXZlbnRvLnR5cGUsIGV2ZW50byk7XG5cbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBFdmVudG8gZW1pdGlkbyBjb20gc3VjZXNzbzogJHtldmVudG8udHlwZX1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvIGFvIGVtaXRpciBldmVudG8gJHtldmVudG8udHlwZX06ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICBlcnJvci5zdGFjayxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRlIGV2ZW50byBkZSBjcmlhw6fDo28gZGUgc29saWNpdGHDp8Ojb1xuICAgKiBAcGFyYW0gc29saWNpdGFjYW8gU29saWNpdGHDp8OjbyBjcmlhZGFcbiAgICovXG4gIGVtaXRpckV2ZW50b0NyaWFjYW8oc29saWNpdGFjYW86IFNvbGljaXRhY2FvKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0aXJFdmVudG8oe1xuICAgICAgdHlwZTogU29saWNpdGFjYW9FdmVudFR5cGUuQ1JFQVRFRCxcbiAgICAgIHNvbGljaXRhY2FvSWQ6IHNvbGljaXRhY2FvLmlkLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgZGF0YToge1xuICAgICAgICBwcm90b2NvbG86IHNvbGljaXRhY2FvLnByb3RvY29sbyxcbiAgICAgICAgdGlwb0JlbmVmaWNpb0lkOiBzb2xpY2l0YWNhby50aXBvX2JlbmVmaWNpb19pZCB8fCAnJyxcbiAgICAgICAgY2lkYWRhb0lkOiBzb2xpY2l0YWNhby5iZW5lZmljaWFyaW8/LmlkIHx8ICcnLFxuICAgICAgICB0ZWNuaWNvSWQ6IHNvbGljaXRhY2FvLnRlY25pY29faWQgfHwgJycsXG4gICAgICAgIHVuaWRhZGVJZDogc29saWNpdGFjYW8udW5pZGFkZV9pZCB8fCAnJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRW1pdGUgZXZlbnRvIGRlIGFsdGVyYcOnw6NvIGRlIHN0YXR1c1xuICAgKiBAcGFyYW0gc29saWNpdGFjYW8gU29saWNpdGHDp8OjbyBhbHRlcmFkYVxuICAgKiBAcGFyYW0gc3RhdHVzQW50ZXJpb3IgU3RhdHVzIGFudGVyaW9yXG4gICAqIEBwYXJhbSB1c3VhcmlvSWQgSUQgZG8gdXN1w6FyaW8gcXVlIHJlYWxpem91IGEgYWx0ZXJhw6fDo29cbiAgICogQHBhcmFtIG9ic2VydmFjYW8gT2JzZXJ2YcOnw6NvIHNvYnJlIGEgYWx0ZXJhw6fDo29cbiAgICovXG4gIGVtaXRpckV2ZW50b0FsdGVyYWNhb1N0YXR1cyhcbiAgICBzb2xpY2l0YWNhbzogU29saWNpdGFjYW8sXG4gICAgc3RhdHVzQW50ZXJpb3I6IFN0YXR1c1NvbGljaXRhY2FvLFxuICAgIHVzdWFyaW9JZDogc3RyaW5nLFxuICAgIG9ic2VydmFjYW8/OiBzdHJpbmcsXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZW1pdGlyRXZlbnRvKHtcbiAgICAgIHR5cGU6IFNvbGljaXRhY2FvRXZlbnRUeXBlLlNUQVRVU19DSEFOR0VELFxuICAgICAgc29saWNpdGFjYW9JZDogc29saWNpdGFjYW8uaWQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHN0YXR1c0FudGVyaW9yLFxuICAgICAgICBzdGF0dXNBdHVhbDogc29saWNpdGFjYW8uc3RhdHVzLFxuICAgICAgICB1c3VhcmlvSWQsXG4gICAgICAgIG9ic2VydmFjYW8sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gRW1pdGlyIGV2ZW50b3MgZXNwZWPDrWZpY29zIGNvbSBiYXNlIG5vIG5vdm8gc3RhdHVzXG4gICAgc3dpdGNoIChzb2xpY2l0YWNhby5zdGF0dXMpIHtcbiAgICAgIGNhc2UgU3RhdHVzU29saWNpdGFjYW8uQVBST1ZBREE6XG4gICAgICAgIHRoaXMuZW1pdGlyRXZlbnRvKHtcbiAgICAgICAgICB0eXBlOiBTb2xpY2l0YWNhb0V2ZW50VHlwZS5BUFBST1ZFRCxcbiAgICAgICAgICBzb2xpY2l0YWNhb0lkOiBzb2xpY2l0YWNhby5pZCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYXByb3ZhZG9ySWQ6IHVzdWFyaW9JZCxcbiAgICAgICAgICAgIG9ic2VydmFjYW8sXG4gICAgICAgICAgICBkYXRhQXByb3ZhY2FvOiBzb2xpY2l0YWNhby5kYXRhX2Fwcm92YWNhbyB8fCBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBTdGF0dXNTb2xpY2l0YWNhby5JTkRFRkVSSURBOlxuICAgICAgICB0aGlzLmVtaXRpckV2ZW50byh7XG4gICAgICAgICAgdHlwZTogU29saWNpdGFjYW9FdmVudFR5cGUuUkVKRUNURUQsXG4gICAgICAgICAgc29saWNpdGFjYW9JZDogc29saWNpdGFjYW8uaWQsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHJlcHJvdmFkb3JJZDogdXN1YXJpb0lkLFxuICAgICAgICAgICAgbW90aXZvUmVwcm92YWNhbzogb2JzZXJ2YWNhbyB8fCAnTsOjbyBlc3BlY2lmaWNhZG8nLFxuICAgICAgICAgICAgZGF0YVJlcHJvdmFjYW86IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFN0YXR1c1NvbGljaXRhY2FvLkxJQkVSQURBOlxuICAgICAgICB0aGlzLmVtaXRpckV2ZW50byh7XG4gICAgICAgICAgdHlwZTogU29saWNpdGFjYW9FdmVudFR5cGUuUkVMRUFTRUQsXG4gICAgICAgICAgc29saWNpdGFjYW9JZDogc29saWNpdGFjYW8uaWQsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGxpYmVyYWRvcklkOiB1c3VhcmlvSWQsXG4gICAgICAgICAgICBkYXRhTGliZXJhY2FvOiBzb2xpY2l0YWNhby5kYXRhX2xpYmVyYWNhbyB8fCBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgb2JzZXJ2YWNhbyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgU3RhdHVzU29saWNpdGFjYW8uQ09OQ0xVSURBOlxuICAgICAgICB0aGlzLmxvZ2dlci5sb2coYFNvbGljaXRhw6fDo28gJHtzb2xpY2l0YWNhby5pZH0gY29uY2x1w61kYWApO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBTdGF0dXNTb2xpY2l0YWNhby5DQU5DRUxBREE6XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgICAgICBgU29saWNpdGHDp8OjbyAke3NvbGljaXRhY2FvLmlkfSBjYW5jZWxhZGE6ICR7b2JzZXJ2YWNhbyB8fCAnTsOjbyBlc3BlY2lmaWNhZG8nfWAsXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFN0YXR1c1NvbGljaXRhY2FvLkFSUVVJVkFEQTpcbiAgICAgICAgdGhpcy5sb2dnZXIubG9nKGBTb2xpY2l0YcOnw6NvICR7c29saWNpdGFjYW8uaWR9IGFycXVpdmFkYWApO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW1pdGUgZXZlbnRvIGRlIHByYXpvIHByw7N4aW1vIGRvIHZlbmNpbWVudG9cbiAgICogQHBhcmFtIHNvbGljaXRhY2FvIFNvbGljaXRhw6fDo28gY29tIHByYXpvIHByw7N4aW1vXG4gICAqIEBwYXJhbSB0aXBvUHJhem8gVGlwbyBkZSBwcmF6b1xuICAgKiBAcGFyYW0gZGlhc1Jlc3RhbnRlcyBEaWFzIHJlc3RhbnRlcyBhdMOpIG8gdmVuY2ltZW50b1xuICAgKi9cbiAgZW1pdGlyRXZlbnRvUHJhem9Qcm94aW1vKFxuICAgIHNvbGljaXRhY2FvOiBTb2xpY2l0YWNhbyxcbiAgICB0aXBvUHJhem86ICdhbmFsaXNlJyB8ICdkb2N1bWVudG9zJyB8ICdwcm9jZXNzYW1lbnRvJyxcbiAgICBkaWFzUmVzdGFudGVzOiBudW1iZXIsXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGRhdGFQcmF6byA9IHNvbGljaXRhY2FvW2BwcmF6b18ke3RpcG9QcmF6b31gXSBhcyBEYXRlO1xuXG4gICAgaWYgKCFkYXRhUHJhem8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmVtaXRpckV2ZW50byh7XG4gICAgICB0eXBlOiBTb2xpY2l0YWNhb0V2ZW50VHlwZS5ERUFETElORV9BUFBST0FDSElORyxcbiAgICAgIHNvbGljaXRhY2FvSWQ6IHNvbGljaXRhY2FvLmlkLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgZGF0YToge1xuICAgICAgICB0aXBvUHJhem8sXG4gICAgICAgIGRhdGFQcmF6byxcbiAgICAgICAgZGlhc1Jlc3RhbnRlcyxcbiAgICAgICAgZGV0ZXJtaW5hY2FvSnVkaWNpYWw6IHNvbGljaXRhY2FvLmRldGVybWluYWNhb19qdWRpY2lhbF9mbGFnIHx8IGZhbHNlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0ZSBldmVudG8gZGUgcHJhem8gZXhwaXJhZG9cbiAgICogQHBhcmFtIHNvbGljaXRhY2FvIFNvbGljaXRhw6fDo28gY29tIHByYXpvIGV4cGlyYWRvXG4gICAqIEBwYXJhbSB0aXBvUHJhem8gVGlwbyBkZSBwcmF6b1xuICAgKiBAcGFyYW0gZGlhc0F0cmFzbyBEaWFzIGRlIGF0cmFzbyBkZXNkZSBvIHZlbmNpbWVudG9cbiAgICovXG4gIGVtaXRpckV2ZW50b1ByYXpvRXhwaXJhZG8oXG4gICAgc29saWNpdGFjYW86IFNvbGljaXRhY2FvLFxuICAgIHRpcG9QcmF6bzogJ2FuYWxpc2UnIHwgJ2RvY3VtZW50b3MnIHwgJ3Byb2Nlc3NhbWVudG8nLFxuICAgIGRpYXNBdHJhc286IG51bWJlcixcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgZGF0YVByYXpvID0gc29saWNpdGFjYW9bYHByYXpvXyR7dGlwb1ByYXpvfWBdIGFzIERhdGU7XG5cbiAgICBpZiAoIWRhdGFQcmF6bykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZW1pdGlyRXZlbnRvKHtcbiAgICAgIHR5cGU6IFNvbGljaXRhY2FvRXZlbnRUeXBlLkRFQURMSU5FX0VYUElSRUQsXG4gICAgICBzb2xpY2l0YWNhb0lkOiBzb2xpY2l0YWNhby5pZCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdGlwb1ByYXpvLFxuICAgICAgICBkYXRhUHJhem8sXG4gICAgICAgIGRpYXNBdHJhc28sXG4gICAgICAgIGRldGVybWluYWNhb0p1ZGljaWFsOiBzb2xpY2l0YWNhby5kZXRlcm1pbmFjYW9fanVkaWNpYWxfZmxhZyB8fCBmYWxzZSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRW1pdGUgZXZlbnRvIGRlIGFuZXhhw6fDo28gZGUgZGV0ZXJtaW5hw6fDo28ganVkaWNpYWxcbiAgICogQHBhcmFtIHNvbGljaXRhY2FvIFNvbGljaXRhw6fDo28gw6AgcXVhbCBhIGRldGVybWluYcOnw6NvIGZvaSBhbmV4YWRhXG4gICAqIEBwYXJhbSBkZXRlcm1pbmFjYW9KdWRpY2lhbElkIElEIGRhIGRldGVybWluYcOnw6NvIGp1ZGljaWFsXG4gICAqIEBwYXJhbSB1c3VhcmlvSWQgSUQgZG8gdXN1w6FyaW8gcXVlIHJlYWxpem91IGEgYW5leGHDp8Ojb1xuICAgKiBAcGFyYW0gb2JzZXJ2YWNhbyBPYnNlcnZhw6fDo28gc29icmUgYSBhbmV4YcOnw6NvXG4gICAqL1xuICBlbWl0aXJFdmVudG9EZXRlcm1pbmFjYW9KdWRpY2lhbEFuZXhhZGEoXG4gICAgc29saWNpdGFjYW86IFNvbGljaXRhY2FvLFxuICAgIGRldGVybWluYWNhb0p1ZGljaWFsSWQ6IHN0cmluZyxcbiAgICB1c3VhcmlvSWQ6IHN0cmluZyxcbiAgICBvYnNlcnZhY2FvPzogc3RyaW5nLFxuICApOiB2b2lkIHtcbiAgICB0aGlzLmVtaXRpckV2ZW50byh7XG4gICAgICB0eXBlOiBTb2xpY2l0YWNhb0V2ZW50VHlwZS5KVURJQ0lBTF9ERVRFUk1JTkFUSU9OX0FUVEFDSEVELFxuICAgICAgc29saWNpdGFjYW9JZDogc29saWNpdGFjYW8uaWQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGRldGVybWluYWNhb0p1ZGljaWFsSWQsXG4gICAgICAgIHVzdWFyaW9JZCxcbiAgICAgICAgb2JzZXJ2YWNhbyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRW1pdGUgZXZlbnRvIGRlIGNyaWHDp8OjbyBkZSBwZW5kw6puY2lhXG4gICAqIEBwYXJhbSBzb2xpY2l0YWNhb0lkIElEIGRhIHNvbGljaXRhw6fDo29cbiAgICogQHBhcmFtIHBlbmRlbmNpYUlkIElEIGRhIHBlbmTDqm5jaWEgY3JpYWRhXG4gICAqIEBwYXJhbSBkZXNjcmljYW8gRGVzY3Jpw6fDo28gZGEgcGVuZMOqbmNpYVxuICAgKiBAcGFyYW0gdXN1YXJpb0lkIElEIGRvIHVzdcOhcmlvIHF1ZSBjcmlvdSBhIHBlbmTDqm5jaWFcbiAgICogQHBhcmFtIHByYXpvIERhdGEgbGltaXRlIHBhcmEgcmVzb2x1w6fDo28gZGEgcGVuZMOqbmNpYVxuICAgKi9cbiAgZW1pdGlyRXZlbnRvUGVuZGVuY2lhQ3JpYWRhKFxuICAgIHNvbGljaXRhY2FvSWQ6IHN0cmluZyxcbiAgICBwZW5kZW5jaWFJZDogc3RyaW5nLFxuICAgIGRlc2NyaWNhbzogc3RyaW5nLFxuICAgIHVzdWFyaW9JZDogc3RyaW5nLFxuICAgIHByYXpvPzogRGF0ZSxcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0aXJFdmVudG8oe1xuICAgICAgdHlwZTogU29saWNpdGFjYW9FdmVudFR5cGUuUEVOREVOQ1lfQ1JFQVRFRCxcbiAgICAgIHNvbGljaXRhY2FvSWQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHBlbmRlbmNpYUlkLFxuICAgICAgICBkZXNjcmljYW8sXG4gICAgICAgIHByYXpvLFxuICAgICAgICB1c3VhcmlvSWQsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRlIGV2ZW50byBkZSByZXNvbHXDp8OjbyBkZSBwZW5kw6puY2lhXG4gICAqIEBwYXJhbSBzb2xpY2l0YWNhb0lkIElEIGRhIHNvbGljaXRhw6fDo29cbiAgICogQHBhcmFtIHBlbmRlbmNpYUlkIElEIGRhIHBlbmTDqm5jaWEgcmVzb2x2aWRhXG4gICAqIEBwYXJhbSByZXNvbHVjYW8gRGVzY3Jpw6fDo28gZGEgcmVzb2x1w6fDo29cbiAgICogQHBhcmFtIHVzdWFyaW9JZCBJRCBkbyB1c3XDoXJpbyBxdWUgcmVzb2x2ZXUgYSBwZW5kw6puY2lhXG4gICAqL1xuICBlbWl0aXJFdmVudG9QZW5kZW5jaWFSZXNvbHZpZGEoXG4gICAgc29saWNpdGFjYW9JZDogc3RyaW5nLFxuICAgIHBlbmRlbmNpYUlkOiBzdHJpbmcsXG4gICAgcmVzb2x1Y2FvOiBzdHJpbmcsXG4gICAgdXN1YXJpb0lkOiBzdHJpbmcsXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZW1pdGlyRXZlbnRvKHtcbiAgICAgIHR5cGU6IFNvbGljaXRhY2FvRXZlbnRUeXBlLlBFTkRFTkNZX1JFU09MVkVELFxuICAgICAgc29saWNpdGFjYW9JZCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgcGVuZGVuY2lhSWQsXG4gICAgICAgIHJlc29sdWNhbyxcbiAgICAgICAgdXN1YXJpb0lkLFxuICAgICAgICBkYXRhUmVzb2x1Y2FvOiBuZXcgRGF0ZSgpLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0ZSBldmVudG8gZGUgYXRyaWJ1acOnw6NvIGRlIHNvbGljaXRhw6fDo28gYSB1bSB0w6ljbmljb1xuICAgKiBAcGFyYW0gc29saWNpdGFjYW8gU29saWNpdGHDp8OjbyBhdHJpYnXDrWRhXG4gICAqIEBwYXJhbSB0ZWNuaWNvQW50ZXJpb3JJZCBJRCBkbyB0w6ljbmljbyBhbnRlcmlvciAob3BjaW9uYWwpXG4gICAqIEBwYXJhbSB0ZWNuaWNvQXR1YWxJZCBJRCBkbyBub3ZvIHTDqWNuaWNvXG4gICAqIEBwYXJhbSB1c3VhcmlvQXRyaWJ1aWNhb0lkIElEIGRvIHVzdcOhcmlvIHF1ZSByZWFsaXpvdSBhIGF0cmlidWnDp8Ojb1xuICAgKiBAcGFyYW0gbW90aXZvQXRyaWJ1aWNhbyBNb3Rpdm8gZGEgYXRyaWJ1acOnw6NvXG4gICAqL1xuICBlbWl0aXJFdmVudG9BdHJpYnVpY2FvKFxuICAgIHNvbGljaXRhY2FvOiBTb2xpY2l0YWNhbyxcbiAgICB0ZWNuaWNvQXR1YWxJZDogc3RyaW5nLFxuICAgIHVzdWFyaW9BdHJpYnVpY2FvSWQ6IHN0cmluZyxcbiAgICB0ZWNuaWNvQW50ZXJpb3JJZD86IHN0cmluZyxcbiAgICBtb3Rpdm9BdHJpYnVpY2FvPzogc3RyaW5nLFxuICApOiB2b2lkIHtcbiAgICB0aGlzLmVtaXRpckV2ZW50byh7XG4gICAgICB0eXBlOiBTb2xpY2l0YWNhb0V2ZW50VHlwZS5BU1NJR05FRCxcbiAgICAgIHNvbGljaXRhY2FvSWQ6IHNvbGljaXRhY2FvLmlkLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgZGF0YToge1xuICAgICAgICB0ZWNuaWNvQW50ZXJpb3JJZCxcbiAgICAgICAgdGVjbmljb0F0dWFsSWQsXG4gICAgICAgIHVzdWFyaW9BdHJpYnVpY2FvSWQsXG4gICAgICAgIG1vdGl2b0F0cmlidWljYW8sXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=