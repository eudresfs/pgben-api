# ========================================
# CONFIGURAÇÕES DE AMBIENTE - EXEMPLO
# ========================================
# ATENÇÃO: Este arquivo contém apenas exemplos de configuração.
# NUNCA commite chaves reais ou dados sensíveis neste arquivo.
# Copie para .env e configure com valores reais.

# Nome do projeto Docker Compose
COMPOSE_PROJECT_NAME=pgben

# ========================================
# CONFIGURAÇÕES DO BANCO DE DADOS
# ========================================
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASS=your_secure_password_here
DB_NAME=pgben
DB_POOL_SIZE=10
DB_SSL=false

# Timezone do banco de dados e aplicação
# Deve ser consistente com o timezone configurado no PostgreSQL
# Padrão: America/Sao_Paulo (horário de Brasília)
DB_TIMEZONE=America/Sao_Paulo

# ========================================
# CONFIGURAÇÕES JWT - SEGURANÇA CRÍTICA
# ========================================
# IMPORTANTE: Gere suas próprias chaves RSA 2048 bits
# Exemplo de comando (ou use o script do projeto 'scripts/gerar-chaves-jwt.js'): openssl genrsa -out keys/private.key 2048
# Exemplo de comando (ou use o script do projeto 'scripts/gerar-chaves-jwt.js'): openssl rsa -in keys/private.key -pubout -out keys/public.key

JWT_ALGORITHM=RS256
# NUNCA use estas chaves em produção - são apenas exemplos

# Chaves em Base64 (recomendado para Kubernetes)
# Gere executando: node scripts/gerar-chaves-jwt.js --output-format=base64
JWT_PRIVATE_KEY_BASE64=SUBSTITUA_PELA_CHAVE_PRIVADA_BASE64
JWT_PUBLIC_KEY_BASE64=SUBSTITUA_PELA_CHAVE_PUBLICA_BASE64

JWT_ACCESS_TOKEN_EXPIRES_IN=30m
JWT_REFRESH_TOKEN_EXPIRES_IN=7d

# ========================================
# CHAVES DE CRIPTOGRAFIA
# ========================================
# Gere uma chave de 32 caracteres (256 bits)
# Comando: openssl rand -hex 32
ENCRYPTION_KEY=SUBSTITUA_POR_CHAVE_256_BITS_HEX
AUDIT_SIGNING_KEY=SUBSTITUA_POR_CHAVE_AUDITORIA_256_BITS

# ========================================
# CONFIGURAÇÕES DE EMAIL SMTP
# ========================================

# Configuração básica
EMAIL_ENABLED=true
NODE_ENV=production

# SMTP Principal (SendGrid exemplo)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=SG.your_api_key
SMTP_FROM=noreply@empresa.com
SMTP_FROM_NAME=Sistema Empresa

# SMTP Fallback (MailerSend exemplo)
SMTP_FALLBACK_HOST=smtp.mailersend.net
SMTP_FALLBACK_PORT=587
SMTP_FALLBACK_USER=MS_username
SMTP_FALLBACK_PASS=MS_password

# Performance e Segurança
EMAIL_RATE_LIMIT_MS=500
EMAIL_MAX_RETRIES=3
EMAIL_MAX_ATTACHMENT_SIZE=26214400
EMAIL_TEMPLATE_TTL=7200

# Domínios (opcional)
EMAIL_DOMAIN_BLACKLIST=tempmail.com,guerrillamail.com
EMAIL_DOMAIN_WHITELIST=empresa.com,parceiro.com

# Timeouts
SMTP_CONNECTION_TIMEOUT=30000
SMTP_SOCKET_TIMEOUT=60000

# ========================================
# CONFIGURAÇÕES MINIO (ARMAZENAMENTO)
# ========================================
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_ACCESS_KEY=SUBSTITUA_POR_ACCESS_KEY_SEGURA
MINIO_SECRET_KEY=SUBSTITUA_POR_SECRET_KEY_SEGURA
MINIO_BUCKET=documents
MINIO_USE_SSL=false

# ========================================
# CONFIGURAÇÕES DA APLICAÇÃO
# ========================================
APP_PORT=3000
API_PREFIX=/api/v1
NODE_ENV=development
APP_NAME=PGBEN
FRONTEND_URL=http://localhost:5173

# ========================================
# CONFIGURAÇÕES DE RATE LIMITING
# ========================================
# Configurações de Rate Limiting
THROTTLE_TTL=60           # Janela de 60 segundos para o limite padrão
THROTTLE_LIMIT=200        # 200 requisições por minuto por IP (padrão)

# Autenticação (mais restrito)
THROTTLE_AUTH_TTL=300     # 5 minutos de janela
THROTTLE_AUTH_LIMIT=10    # 10 tentativas por janela

# Uploads
THROTTLE_UPLOAD_TTL=60    # 1 minuto de janela
THROTTLE_UPLOAD_LIMIT=20  # 20 uploads por minuto

# API
THROTTLE_API_TTL=60       # 1 minuto de janela
THROTTLE_API_LIMIT=200    # 200 requisições por minuto

# Pular rate limiting em desenvolvimento (opcional)
THROTTLE_SKIP_DEV=true    # Desativa rate limiting em desenvolvimento

# ========================================
# CONFIGURAÇÕES DE SEGURANÇA - COOKIES E SESSÃO
# ========================================
# Chave secreta para assinatura de cookies (32+ caracteres)
# Comando: openssl rand -hex 32
COOKIE_SECRET=SUBSTITUA_POR_CHAVE_COOKIE_SEGURA_256_BITS

# Chave secreta para sessões (32+ caracteres)
# Comando: openssl rand -hex 32
SESSION_SECRET=SUBSTITUA_POR_CHAVE_SESSAO_SEGURA_256_BITS

# Domínios permitidos para CORS (separados por vírgula)
ALLOWED_ORIGINS=http://localhost:5173,https://pgben.gov.br
ALLOWED_DOMAINS=localhost:3000,localhost:5173,pgben.gov.br

# ========================================
# CONFIGURAÇÕES REDIS
# ========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=SUBSTITUA_POR_SENHA_REDIS_SEGURA
REDIS_DB=0
REDIS_TTL=3600
REDIS_KEY_PREFIX=pgben:

# Configurações específicas para SSE
REDIS_SSE_ENABLED=true
REDIS_SSE_CONNECTION_TTL=3600
REDIS_SSE_HEARTBEAT_INTERVAL=30000
REDIS_SSE_CLEANUP_INTERVAL=60000

# Configurações de Performance e Cache
ENABLE_REDIS_CACHE=true
DEFAULT_CACHE_TTL=300
ENABLE_QUERY_OPTIMIZATION=true
MAX_PAGINATION_LIMIT=100

# Configurações de Monitoramento de Performance
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_METRICS_INTERVAL=60000
ENABLE_AUDIT_LOGGING=true

# ========================================
# CONFIGURAÇÕES DE LOGGING
# ========================================
LOG_LEVEL=info
LOG_FILE_PATH=./logs
LOG_MAX_FILES=30
LOG_MAX_SIZE=10m

# ========================================
# CONFIGURAÇÕES DE SEGURANÇA
# ========================================
# Configurações para cookies seguros
CSRF_SECRET=SUBSTITUA_POR_CHAVE_CSRF_SEGURA

# Configurações de CORS
CORS_ORIGIN=http://localhost:5173
CORS_CREDENTIALS=true


# ========================================
# CONFIGURAÇÕES DE NOTIFICAÇÔES
# ========================================
# Configurações SSE
SSE_HEARTBEAT_INTERVAL=30000          # Intervalo de heartbeat em ms (30 segundos)
SSE_CONNECTION_TIMEOUT=300000         # Timeout de conexão em ms (5 minutos)
SSE_MAX_CONNECTIONS_PER_USER=5       # Máximo de conexões por usuário
SSE_CLEANUP_INTERVAL=60000            # Intervalo de limpeza em ms (1 minuto)
SSE_ENABLE_COMPRESSION=true           # Habilitar compressão gzip
SSE_CORS_ORIGINS=http://localhost:3000,https://pgben-server.kemosoft.com.br

# ========================================
# CONFIGURAÇÕES DE DOWNLOAD EM LOTE DE DOCUMENTOS
# ========================================
# Diretório para arquivos temporários de download em lote
# IMPORTANTE: Certifique-se de que o diretório tenha permissões adequadas
DOWNLOAD_LOTE_TEMP_DIR=./temp/download-lote

# Limite máximo de documentos por job de download
# Ajuste conforme a capacidade do servidor e tamanho médio dos documentos
DOWNLOAD_LOTE_MAX_DOCUMENTOS=1000

# Tempo de vida dos jobs em horas (após esse tempo, jobs são removidos automaticamente)
# Recomendado: 24-48 horas para permitir download pelos usuários
DOWNLOAD_LOTE_TTL_HORAS=24

# Agendamento da limpeza automática (formato cron)
# Padrão: todos os dias às 2h da manhã (0 2 * * *)
# Outros exemplos:
#   - A cada 6 horas: 0 */6 * * *
#   - Duas vezes por dia (2h e 14h): 0 2,14 * * *
DOWNLOAD_LOTE_CLEANUP_CRON=0 2 * * *

# Tamanho máximo do arquivo ZIP gerado em MB
# ATENÇÃO: Valores muito altos podem causar problemas de memória
DOWNLOAD_LOTE_MAX_SIZE_MB=500

# Número de documentos processados por lote (otimização de memória)
# Valores menores usam menos memória, mas podem ser mais lentos
DOWNLOAD_LOTE_BATCH_SIZE=50

# Timeout para operações de download em millisegundos
# 300000 = 5 minutos (recomendado para jobs grandes)
DOWNLOAD_LOTE_TIMEOUT_MS=300000

# ========================================
# CONFIGURAÇÕES ABLY - NOTIFICAÇÕES EM TEMPO REAL
# ========================================
# Configurações principais do Ably
ABLY_API_KEY=SUBSTITUA_POR_SUA_ABLY_API_KEY
ABLY_ENVIRONMENT=sandbox                    # sandbox para desenvolvimento, production para produção
ABLY_CLIENT_ID=pgben-server                 # Identificador único do cliente

# Configurações de autenticação JWT
ABLY_JWT_EXPIRES_IN=3600                    # Expiração do token JWT em segundos (1 hora)
ABLY_JWT_CAPABILITY_ADMIN=*                 # Capacidades do administrador (todos os canais)
ABLY_JWT_CAPABILITY_USER=user-*             # Capacidades do usuário (apenas canais específicos)

# Configurações de canais
ABLY_CHANNEL_PREFIX=pgben                   # Prefixo para todos os canais
ABLY_CHANNEL_NOTIFICATIONS=notifications    # Canal principal de notificações
ABLY_CHANNEL_SYSTEM=system                  # Canal de notificações do sistema
ABLY_CHANNEL_AUDIT=audit                    # Canal de auditoria

# Configurações de performance
ABLY_CONNECTION_TIMEOUT=30000               # Timeout de conexão em ms
ABLY_MAX_MESSAGE_SIZE=65536                 # Tamanho máximo da mensagem em bytes (64KB)
ABLY_HEARTBEAT_INTERVAL=15000               # Intervalo de heartbeat em ms
ABLY_RETRY_ATTEMPTS=3                       # Número de tentativas de reconexão

# Configurações de segurança
ABLY_ENABLE_TLS=true                        # Habilitar TLS/SSL
ABLY_LOG_LEVEL=warn                         # Nível de log (debug, info, warn, error)
ABLY_ENABLE_FALLBACK=true                   # Habilitar fallback para SSE em caso de falha

# ========================================
# CONFIGURAÇÕES DE DESENVOLVIMENTO
# ========================================
# Apenas para desenvolvimento
DEBUG=false
SWAGGER_ENABLED=true
API_DOCS_PATH=/api/docs

# =======================================
# CONFIGURAÇÕES API PORTAL TRANSPARENCIA
# =======================================
API_PORTAL_TRANSPARENCIA=chave-api-dados
API_PORTAL_TRANSPARENCIA_URL=https://api.portaltransparencia.gov.br 
ANO_MES_REFERENCIA=202506

# ========================================
# INSTRUÇÕES DE CONFIGURAÇÃO
# ========================================
# 1. Copie este arquivo para .env
# 2. Substitua todos os valores SUBSTITUA_POR_* por valores reais
# 3. Gere chaves RSA para JWT:
#    mkdir keys
#    node .scripts/gerar-chaves-jwt.js
# 4. Configure seu servidor SMTP
# 5. Configure Redis e MinIO
# 6. NUNCA commite o arquivo .env no Git